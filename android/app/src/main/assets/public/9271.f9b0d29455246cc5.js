"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9271],{29430:(le,W,l)=>{l.d(W,{$:()=>P,IB:()=>j,N2:()=>R,RH:()=>_,Ws:()=>ie,ZD:()=>q});var T=l(68677);function j(e){return"r"in e&&"g"in e&&"b"in e}function k(e){return"h"in e&&"s"in e&&"v"in e}function U(e){return"l"in e&&"a"in e&&"b"in e}function S(e){return"l"in e&&"c"in e&&"h"in e}l(53781),l(89141);const $=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],J=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function B(e,h){const p=[];let v,f;if(e[0].length!==h.length)throw new Error("dimensions do not match");const C=e.length,I=e[0].length;let L=0;for(v=0;v<C;v++){for(L=0,f=0;f<I;f++)L+=e[v][f]*h[f];p.push(L)}return p}function F(e){const h=[e.r/255,e.g/255,e.b/255].map(v=>v<=.04045?v/12.92:((v+.055)/1.055)**2.4),p=B($,h);return{x:100*p[0],y:100*p[1],z:100*p[2]}}function z(e){const h=B(J,[e.x/100,e.y/100,e.z/100]).map(p=>Math.min(1,Math.max(p<=.0031308?12.92*p:1.055*p**.4166666666666667-.055,0)));return{r:Math.round(255*h[0]),g:Math.round(255*h[1]),b:Math.round(255*h[2])}}function ee(e){const h=[e.x/95.047,e.y/100,e.z/108.883].map(p=>p>.008856451679035631?p**.3333333333333333:7.787037037037035*p+.13793103448275862);return{l:116*h[1]-16,a:500*(h[0]-h[1]),b:200*(h[1]-h[2])}}function w(e){const h=e.l,p=[(h+16)/116+e.a/500,(h+16)/116,(h+16)/116-e.b/200].map(v=>v>6/29?v**3:3*(6/29)**2*(v-4/29));return{x:95.047*p[0],y:100*p[1],z:108.883*p[2]}}function P(e){return j(e)?e:S(e)?function u(e){return z(w(function s(e){const p=e.c,v=e.h;return{l:e.l,a:p*Math.cos(v),b:p*Math.sin(v)}}(e)))}(e):U(e)?function c(e){return z(w(e))}(e):function M(e){return"x"in e&&"y"in e&&"z"in e}(e)?z(e):k(e)?function b(e){const h=(e.h+360)%360/60,v=e.v/100*255,f=v*(e.s/100),C=f*(1-Math.abs(h%2-1));let I;switch(Math.floor(h)){case 0:I={r:f,g:C,b:0};break;case 1:I={r:C,g:f,b:0};break;case 2:I={r:0,g:f,b:C};break;case 3:I={r:0,g:C,b:f};break;case 4:I={r:C,g:0,b:f};break;case 5:case 6:I={r:f,g:0,b:C};break;default:I={r:0,g:0,b:0}}return I.r=Math.round(I.r+v-f),I.g=Math.round(I.g+v-f),I.b=Math.round(I.b+v-f),I}(e):e}function R(e){return k(e)?e:function A(e){const h=e.r,p=e.g,v=e.b,f=Math.max(h,p,v),C=f-Math.min(h,p,v);let I=f,L=0===C?0:f===h?(p-v)/C%6:f===p?(v-h)/C+2:(h-p)/C+4,oe=0===C?0:C/I;return L<0&&(L+=6),L*=60,oe*=100,I*=100/255,{h:L,s:oe,v:I}}(P(e))}function q(e){return U(e)?e:function o(e){return ee(F(e))}(P(e))}function _(e){return S(e)?e:function d(e){return function D(e){const h=e.l,p=e.a,v=e.b,f=Math.sqrt(p*p+v*v);let C=Math.atan2(v,p);return C=C>0?C:C+2*Math.PI,{l:h,c:f,h:C}}(ee(F(e)))}(P(e))}function ie(e,h){const{r:p,g:v,b:f}=null!=h&&h.ignoreAlpha?e:function G(e){let{r:h,g:p,b:v,a:f}=e;return f<1&&(h=Math.round(f*h+255*(1-f)),p=Math.round(f*p+255*(1-f)),v=Math.round(f*v+255*(1-f))),new T.A({r:h,g:p,b:v})}(e);return.2126*p+.7152*v+.0722*f}var se,e;(e=se||(se={}))[e.Low=160]="Low",e[e.High=225]="High"},1684:(le,W,l)=>{l.d(W,{$:()=>w});var T=l(10467),x=l(68677),K=l(29430),j=l(77806),k=l(48218),U=l(32117),S=l(5922),M=l(35150),$=l(721);function J(D,s,o,c,d){if(null==D)return null;const u=D.referencesGeometry()&&d?function F(D,s,o){const{transform:c,hasZ:d,hasM:u}=o;B.has(s)||B.set(s,function z(D){const s={};switch(D){case"esriGeometryPoint":return(o,c,d,u)=>(0,$.Tr)(c,s,o,d,u);case"esriGeometryPolygon":return(o,c,d,u)=>(0,$.$X)(c,s,o,d,u);case"esriGeometryPolyline":return(o,c,d,u)=>(0,$.P5)(c,s,o,d,u);case"esriGeometryMultipoint":return(o,c,d,u)=>(0,$.SW)(c,s,o,d,u);default:return M.A.getLogger("esri.views.2d.support.arcadeOnDemand").error(new S.A("mapview-arcade",`Unable to handle geometryType: ${D}`)),o=>o}}(s));const A=B.get(s)(D.geometry,c,d,u);return{...D,geometry:A}}(s,c,d):s,A=D.repurposeFeature(u);try{return D.evaluate({...o,$feature:A},D.services)}catch(b){return M.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",b),null}}const B=new Map,ee=D=>{if(!D)return[0,0,0,0];const{r:s,g:o,b:c,a:d}=D;return[s,o,c,255*d]};class w{static findApplicableOverrides(s,o,c){if(s&&o){if(s.primitiveName){let d=!1;for(const u of c)if(u.primitiveName===s.primitiveName){d=!0;break}if(!d)for(const u of o)u.primitiveName===s.primitiveName&&c.push(u)}switch(s.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(s.effects)for(const d of s.effects)w.findApplicableOverrides(d,o,c);if(s.symbolLayers)for(const d of s.symbolLayers)w.findApplicableOverrides(d,o,c);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(s.effects)for(const d of s.effects)w.findApplicableOverrides(d,o,c);if(s.markerPlacement&&w.findApplicableOverrides(s.markerPlacement,o,c),"CIMVectorMarker"===s.type){if(s.markerGraphics)for(const d of s.markerGraphics)w.findApplicableOverrides(d,o,c),w.findApplicableOverrides(d.symbol,o,c)}else"CIMCharacterMarker"===s.type?w.findApplicableOverrides(s.symbol,o,c):"CIMHatchFill"===s.type?w.findApplicableOverrides(s.lineSymbol,o,c):"CIMPictureMarker"===s.type&&w.findApplicableOverrides(s.animatedSymbolProperties,o,c)}}}static findEffectOverrides(s,o){if(!s)return null;if("CIMGeometricEffectDashes"===s.type&&(0,U.K3)(s),!o||!s.primitiveName)return{type:"cim-effect-info",effect:s,overrides:[]};const c=s.primitiveName,d=[];for(const u of o)u.primitiveName===c&&d.push({...u,propertyName:(0,U.YF)(u.propertyName)});return{type:"cim-effect-info",effect:s,overrides:d}}static resolveSymbolOverrides(s,o,c,d,u,A,b){return(0,T.A)(function*(){if(null==s||!s.symbol)return null;let{symbol:P,primitiveOverrides:R}=s;const q=!!R;if(!q&&!d)return P;P=(0,j.o8)(P),R=(0,j.o8)(R);let _=!0;if(o||(o={attributes:{}},_=!1),q){if(_||(R=R.filter(Y=>{var G;return!(null!==(G=Y.valueExpressionInfo)&&void 0!==G&&G.expression.includes("$feature"))})),b||(R=R.filter(Y=>{var G;return!(null!==(G=Y.valueExpressionInfo)&&void 0!==G&&G.expression.includes("$view"))})),R.length>0){const Y={spatialReference:c,fields:(0,U.O2)(o.attributes),geometryType:u};yield w.createRenderExpressions(R,Y),w.evaluateOverrides(R,o,null!=u?u:"esriGeometryPoint",A,b)}w.applyOverrides(P,R)}return d&&w.applyDictionaryTextOverrides(P,o,d,null),P})()}static createRenderExpressions(s,o){return(0,T.A)(function*(){const c=[];for(const d of s){const u=d.valueExpressionInfo;if(!u||w._expressionToRenderExpression.has(u.expression))continue;const A=(0,k.Ad)(u.expression,o.spatialReference,o.fields);c.push(A),A.then(b=>w._expressionToRenderExpression.set(u.expression,b))}c.length>0&&(yield Promise.all(c))})()}static evaluateOverrides(s,o,c,d,u){const A={$view:{scale:null==u?void 0:u.scale}};for(const b of s){b.value&&"object"==typeof b.value&&(0,K.IB)(b.value)&&("Color"===b.propertyName||"StrokeColor"===b.propertyName)&&(b.value=ee(b.value));const P=b.valueExpressionInfo;if(!P)continue;const R=w._expressionToRenderExpression.get(P.expression);R&&(b.value=J(R,o,A,c,d))}}static applyDictionaryTextOverrides(s,o,c,d,u="Normal"){if(null!=s&&s.type)switch(s.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const A=s.symbolLayers;if(!A)return;for(const b of A)b&&"CIMVectorMarker"===b.type&&w.applyDictionaryTextOverrides(b,o,c,d,"CIMTextSymbol"===s.type?s.textCase:u)}break;case"CIMVectorMarker":{const A=s.markerGraphics;if(!A)return;for(const b of A)b&&w.applyDictionaryTextOverrides(b,o,c,d)}break;case"CIMMarkerGraphic":{const A=s.textString;if(A&&A.includes("[")){const b=(0,U.gQ)(A,c);s.textString=(0,U.FM)(o,b,d,u)}}}}static applyOverrides(s,o,c,d){if(s.primitiveName)for(const u of o)if(u.primitiveName===s.primitiveName){const A=(0,U.YF)(u.propertyName);if(d&&d.push({cim:s,nocapPropertyName:A,value:s[A]}),c){let b=!1;for(const P of c)P.primitiveName===s.primitiveName&&(b=!0);b||c.push(u)}null!=u.value&&(s[A]=u.value)}switch(s.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(s.effects)for(const u of s.effects)w.applyOverrides(u,o,c,d);if(s.symbolLayers)for(const u of s.symbolLayers)w.applyOverrides(u,o,c,d);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(s.effects)for(const u of s.effects)w.applyOverrides(u,o,c,d);if("CIMVectorMarker"===s.type&&s.markerGraphics)for(const u of s.markerGraphics)w.applyOverrides(u,o,c,d),w.applyOverrides(u.symbol,o,c,d)}}static restoreOverrides(s){for(const o of s)o.cim[o.nocapPropertyName]=o.value}static buildOverrideKey(s){let o="";for(const c of s)void 0!==c.value&&(o+=`${c.primitiveName}${c.propertyName}${JSON.stringify(c.value)}`);return o}static toValue(s,o){if("DashTemplate"===s)return o.split(" ").map(c=>Number(c));if("Color"===s){const c=new x.A(o).toRgba();return c[3]*=255,c}return o}}w._expressionToRenderExpression=new Map},3388:(le,W,l)=>{l.r(W),l.d(W,{default:()=>oe});var T=l(10467),x=l(8189),K=l(81098),j=l(31178),k=l(17715),U=l(3248),S=l(48900),M=l(85211),$=l(35150),B=(l(40707),l(76576)),F=l(27641),z=l(89063),ee=l(29459),w=l(80745),D=l(9468),s=l(98877),o=l(56492),c=l(40275),d=l(72663),u=l(88766),A=l(28399),b=l(68418);let P=class extends s.A{constructor(){super(...arguments),this.attached=!1,this.container=new u.m,this.updateRequested=!1,this.type="imagery",this._bitmapView=new d.l}destroy(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}get updating(){return!this.attached||this.isUpdating()}update(i){this.strategy.update(i).catch(a=>{(0,o.zf)(a)||$.A.getLogger(this).error(a)})}hitTest(i){return new K.A({attributes:{},geometry:i.clone(),layer:this.layer})}attach(){this.container.addChild(this._bitmapView),this.strategy=new b.A({container:this._bitmapView,imageNormalizationSupported:this.layer.version>=10,imageMaxHeight:this.layer.version>=10.1?this.layer.imageMaxHeight:2048,imageMaxWidth:this.layer.version>=10.1?this.layer.imageMaxWidth:2048,fetchSource:this._fetchImage.bind(this),requestUpdate:()=>this.requestUpdate()})}detach(){this.strategy.destroy(),this._bitmapView.removeAllChildren(),this.container.removeAllChildren(),this.updateRequested=!1}redraw(){var i=this;this.strategy.updateExports(function(){var a=(0,T.A)(function*(y){var m;const{source:g}=y;if(!g||g instanceof ImageBitmap)return;const E=yield i.layer.applyRenderer({extent:g.extent,pixelBlock:null!==(m=g.originalPixelBlock)&&void 0!==m?m:g.pixelBlock});g.filter=O=>i.layer.pixelFilter?i.layer.applyFilter(O):{...E,extent:g.extent}});return function(y){return a.apply(this,arguments)}}()).catch(a=>{(0,o.zf)(a)||$.A.getLogger(this).error(a)})}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}isUpdating(){return this.strategy.updating||this.updateRequested}getPixelData(){if(this.updating)return null;const i=this.strategy.bitmaps;if(1===i.length&&i[0].source)return{extent:i[0].source.extent,pixelBlock:i[0].source.originalPixelBlock};if(i.length>1){const a=this.view.extent,y=i.map(g=>g.source).filter(g=>g.extent&&g.extent.intersects(a)).map(g=>({extent:g.extent,pixelBlock:g.originalPixelBlock})),m=(0,c.LY)(y,a);return null!=m?{extent:m.extent,pixelBlock:m.pixelBlock}:null}return null}_fetchImage(i,a,y,m){var g=this;return(0,T.A)(function*(){var E;(m=m||{}).timeExtent=g.timeExtent,m.requestAsImageElement=!0,m.returnImageBitmap=!0;const O=yield g.layer.fetchImage(i,a,y,m);if(O.imageBitmap)return O.imageBitmap;const N=yield g.layer.applyRenderer(O.pixelData,{signal:m.signal}),V=new A.A(N.pixelBlock,null===(E=N.extent)||void 0===E?void 0:E.clone(),O.pixelData.pixelBlock);return V.filter=H=>g.layer.applyFilter(H),V})()}};(0,x._)([(0,M.MZ)()],P.prototype,"attached",void 0),(0,x._)([(0,M.MZ)()],P.prototype,"container",void 0),(0,x._)([(0,M.MZ)()],P.prototype,"layer",void 0),(0,x._)([(0,M.MZ)()],P.prototype,"strategy",void 0),(0,x._)([(0,M.MZ)()],P.prototype,"timeExtent",void 0),(0,x._)([(0,M.MZ)()],P.prototype,"view",void 0),(0,x._)([(0,M.MZ)()],P.prototype,"updateRequested",void 0),(0,x._)([(0,M.MZ)()],P.prototype,"updating",null),(0,x._)([(0,M.MZ)()],P.prototype,"type",void 0),P=(0,x._)([(0,B.$)("esri.views.2d.layers.imagery.ImageryView2D")],P);const R=P;var q=l(89563),_=l(28067),Y=l(58701),G=l(40018),ie=l(50444),se=l(21941),ce=l(69473),ue=l(54382);class de extends ue.A{constructor(){super(...arguments),this.symbolTypes=["triangle"]}prepareRenderPasses(a){const y=a.registerRenderPass({name:"imagery (vf)",brushes:[se.A],target:()=>this.children,drawPhase:ce.S5.MAP});return[...super.prepareRenderPasses(a),y]}doRender(a){this.visible&&a.drawPhase===ce.S5.MAP&&this.symbolTypes.forEach(y=>{a.renderPass=y,super.doRender(a)})}}var pe=l(74856);let Q=class extends s.A{constructor(i){super(i),this._loading=null,this.update=(0,o.sg)((a,y)=>this._update(a,y).catch(m=>{(0,o.zf)(m)||$.A.getLogger(this).error(m)}))}get updating(){return!!this._loading}redraw(i){if(!this.container.children.length)return;const a=this.container.children[0];a.symbolizerParameters=i,a.invalidateVAO(),this.container.symbolTypes="wind_speed"===i.style?["scalar","triangle"]:"simple_scalar"===i.style?["scalar"]:["triangle"],this.container.requestRender()}_update(i,a,y){var m=this;return(0,T.A)(function*(){if(!i.stationary)return;const{extent:g,spatialReference:E}=i.state,O=new _.A({xmin:g.xmin,ymin:g.ymin,xmax:g.xmax,ymax:g.ymax,spatialReference:E}),[N,V]=i.state.size;m._loading=m.fetchPixels(O,N,V,y);const H=yield m._loading;m._addToDisplay(H,a,i.state),m._loading=null})()}_addToDisplay(i,a,y){if(null==i.pixelBlock)return this.container.children.forEach(O=>O.destroy()),void this.container.removeAllChildren();const{extent:m,pixelBlock:g}=i,E=new pe.X(g);E.offset=[0,0],E.symbolizerParameters=a,E.rawPixelData=i,E.invalidateVAO(),E.x=m.xmin,E.y=m.ymax,E.pixelRatio=y.pixelRatio,E.rotation=y.rotation,E.resolution=y.resolution,E.width=g.width*a.symbolTileSize,E.height=g.height*a.symbolTileSize,this.container.children.forEach(O=>O.destroy()),this.container.removeAllChildren(),this.container.symbolTypes="wind_speed"===a.style?["scalar","triangle"]:"simple_scalar"===a.style?["scalar"]:["triangle"],this.container.addChild(E)}};(0,x._)([(0,M.MZ)()],Q.prototype,"fetchPixels",void 0),(0,x._)([(0,M.MZ)()],Q.prototype,"container",void 0),(0,x._)([(0,M.MZ)()],Q.prototype,"_loading",void 0),(0,x._)([(0,M.MZ)()],Q.prototype,"updating",null),Q=(0,x._)([(0,B.$)("esri.views.2d.layers.imagery.ImageryVFStrategy")],Q);const ye=Q;let Z=class extends s.A{constructor(){var i;super(...arguments),i=this,this.attached=!1,this.container=new de,this.type="imageryVF",this._dataParameters={exportParametersVersion:0,bbox:"",symbolTileSize:0,time:""},this._fetchpixels=function(){var a=(0,T.A)(function*(y,m,g,E){const O=yield i._projectFullExtentPromise,{symbolTileSize:N}=i.layer.renderer,{extent:V,width:H,height:te}=(0,ie.$Q)(y,m,g,N,O);if(null!=O&&!O.intersects(y))return{extent:V,pixelBlock:null};const re={bbox:`${V.xmin}, ${V.ymin}, ${V.xmax}, ${V.ymax}`,exportParametersVersion:i.layer.exportImageServiceParameters.version,symbolTileSize:N,time:JSON.stringify(i.timeExtent||"")};if(i._canReuseVectorFieldData(re)){const X=i.getPixelData();if(null!=X&&`${X.extent.xmin}, ${X.extent.ymin}, ${X.extent.xmax}, ${X.extent.ymax}`===re.bbox)return X}const{pixelData:ae}=yield i.layer.fetchImage(V,H,te,{timeExtent:i.timeExtent,requestAsImageElement:!1,signal:E});i._dataParameters=re;const ne=null==ae?void 0:ae.pixelBlock;return null==ne?{extent:V,pixelBlock:null}:{extent:V,pixelBlock:"vector-uv"===i.layer.rasterInfo.dataType?(0,ie.FI)(ne,"vector-uv"):ne}});return function(y,m,g,E){return a.apply(this,arguments)}}()}get updating(){return!this.attached||this._strategy.updating}attach(){this._projectFullExtentPromise=this._getProjectedFullExtent(this.view.spatialReference),this._strategy=new ye({container:this.container,fetchPixels:this._fetchpixels}),this.addHandles((0,S.wB)(()=>this.layer.renderer,i=>this._updateSymbolizerParams(i),S.pc),"attach")}detach(){this._strategy.destroy(),this.container.children.forEach(i=>i.destroy()),this.container.removeAllChildren(),this.removeHandles("attach"),this._strategy=this.container=this._projectFullExtentPromise=null}getPixelData(){var i;const a=null===(i=this.container.children[0])||void 0===i?void 0:i.rawPixelData;if(this.updating||!a)return null;const{extent:y,pixelBlock:m}=a;return{extent:y,pixelBlock:m}}hitTest(i){return new K.A({attributes:{},geometry:i.clone(),layer:this.layer})}update(i){this._strategy.update(i,this._symbolizerParams).catch(a=>{(0,o.zf)(a)||$.A.getLogger(this).error(a)})}redraw(){const{renderer:i}=this.layer;i&&(this._updateSymbolizerParams(i),this._strategy.redraw(this._symbolizerParams))}_canReuseVectorFieldData(i){return this._dataParameters.exportParametersVersion===i.exportParametersVersion&&this._dataParameters.time===i.time&&this._dataParameters.symbolTileSize===i.symbolTileSize&&this._dataParameters.bbox===i.bbox}_getProjectedFullExtent(i){var a=this;return(0,T.A)(function*(){try{return(0,G._l)(a.layer.fullExtent,i)}catch{try{const m=(yield(0,q.A)(a.layer.url,{query:{option:"footprints",outSR:(0,Y.YX)(i),f:"json"}})).data.featureCollection.layers[0].layerDefinition.extent;return m?_.A.fromJSON(m):null}catch{return null}}})()}_updateSymbolizerParams(i){"vector-field"===i.type&&(this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null}))}};(0,x._)([(0,M.MZ)()],Z.prototype,"attached",void 0),(0,x._)([(0,M.MZ)()],Z.prototype,"container",void 0),(0,x._)([(0,M.MZ)()],Z.prototype,"layer",void 0),(0,x._)([(0,M.MZ)()],Z.prototype,"timeExtent",void 0),(0,x._)([(0,M.MZ)()],Z.prototype,"type",void 0),(0,x._)([(0,M.MZ)()],Z.prototype,"view",void 0),(0,x._)([(0,M.MZ)()],Z.prototype,"updating",null),Z=(0,x._)([(0,B.$)("esri.views.2d.layers.imagery.VectorFieldView2D")],Z);const me=Z;var he=l(5922),e=l(13303),h=l(81687),p=l(87086),v=l(64935);const f=i=>{let a=class extends i{constructor(){super(...arguments),this.view=null}fetchPopupFeaturesAtLocation(y,m){var g=this;return(0,T.A)(function*(){const{layer:E}=g;if(!y)throw new he.A("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:E});const{popupEnabled:O}=E,N=(0,v.D8)(E,m);if(!O||null==N)throw new he.A("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:O,popupTemplate:N});const V=yield N.getRequiredFields();(0,o.Te)(m);const H=new p.A;H.timeExtent=g.timeExtent,H.geometry=y,H.outFields=V,H.outSpatialReference=y.spatialReference;const{resolution:te,spatialReference:re}=g.view,ae="2d"===g.view.type?new e.A(te,te,re):new e.A(.5*te,.5*te,re),{returnTopmostRaster:ne,showNoDataRecords:X}=N.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1};return E.queryVisibleRasters(H,{returnDomainValues:!0,returnTopmostRaster:ne,pixelSize:ae,showNoDataRecords:X,signal:null==m?void 0:m.signal}).then(fe=>fe)})()}canResume(){var y;return!(!super.canResume()||null!==(y=this.timeExtent)&&void 0!==y&&y.isEmpty)}};return(0,x._)([(0,M.MZ)()],a.prototype,"layer",void 0),(0,x._)([(0,M.MZ)()],a.prototype,"suspended",void 0),(0,x._)([(0,M.MZ)(h.ui)],a.prototype,"timeExtent",void 0),(0,x._)([(0,M.MZ)()],a.prototype,"view",void 0),a=(0,x._)([(0,B.$)("esri.views.layers.ImageryLayerView")],a),a};var C=l(41474),I=l(96081);let L=class extends(f((0,I.A)((0,ee.e)(C.A)))){constructor(){super(...arguments),this._exportImageVersion=-1,this._highlightGraphics=new F.Y,this._highlightView=void 0,this.layer=null,this.subview=null}get pixelData(){const{subview:i}=this;return this.updating||!i?null:"getPixelData"in i?i.getPixelData():null}update(i){var a;null===(a=this.subview)||void 0===a||a.update(i)}attach(){this.layer.increaseRasterJobHandlerUsage(),this._setSubView(),this.view&&(this._highlightView=new w.A({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new D.A(this.view.featuresTilingScheme)}),this.container.addChild(this._highlightView.container)),this.addAttachHandles([(0,S.wB)(()=>this.layer.exportImageServiceParameters.version,i=>{i&&this._exportImageVersion!==i&&(this._exportImageVersion=i,this.requestUpdate())},S.OH),(0,S.wB)(()=>this.timeExtent,i=>{const{subview:a}=this;a&&(a.timeExtent=i,"redraw"in a?this.requestUpdate():a.redrawOrRefetch())},S.OH),this.layer.on("redraw",()=>{const{subview:i}=this;i&&("redraw"in i?i.redraw():i.redrawOrRefetch())}),(0,S.wB)(()=>this.layer.renderer,()=>this._setSubView())])}detach(){var i,a;this.layer.decreaseRasterJobHandlerUsage(),this.container.removeAllChildren(),this._detachSubview(this.subview),null!==(i=this.subview)&&void 0!==i&&i.destroy(),this.subview=null,null!==(a=this._highlightView)&&void 0!==a&&a.destroy(),this._exportImageVersion=-1}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}highlight(i,a){if(!((Array.isArray(i)?i[0]:j.A.isCollection(i)?i.at(0):i)instanceof K.A))return(0,k.hA)();let y=[];return Array.isArray(i)||j.A.isCollection(i)?y=i.map(m=>m.clone()):i instanceof K.A&&(y=[i.clone()]),this._highlightGraphics.addMany(y),(0,k.hA)(()=>this._highlightGraphics.removeMany(y))}doRefresh(){var i=this;return(0,T.A)(function*(){i.requestUpdate()})()}isUpdating(){var i,a;const y=!this.subview||this.subview.updating||!(null===(i=this._highlightView)||void 0===i||!i.updating);return(0,U.A)("esri-2d-log-updating")&&console.log(`Updating ImageryLayerView2D (${this.layer.id}): ${y}\n-> subview ${!this.subview||this.subview.updating}\n-> higlightView ${null===(a=this._highlightView)||void 0===a?void 0:a.updating}\n`),y}_setSubView(){var i;if(!this.view)return;const a=null===(i=this.layer.renderer)||void 0===i?void 0:i.type;let y="imagery";if("vector-field"===a?y="imageryVF":"flow"===a&&(y="flow"),this.subview){var m;const{type:g}=this.subview;if(g===y)return this._attachSubview(this.subview),void("flow"===g?this.subview.redrawOrRefetch():"imagery"===g&&"lerc"===this.layer.format?this.subview.redraw():this.requestUpdate());this._detachSubview(this.subview),null===(m=this.subview)||void 0===m||m.destroy()}this.subview="imagery"===y?new R({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):"imageryVF"===y?new me({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new z.A({layer:this.layer,layerView:this}),this._attachSubview(this.subview),this.requestUpdate()}_attachSubview(i){i&&!i.attached&&(i.attach(),i.attached=!0,this.container.addChildAt(i.container,0))}_detachSubview(i){null!=i&&i.attached&&(this.container.removeChild(i.container),i.detach(),i.attached=!1)}};(0,x._)([(0,M.MZ)()],L.prototype,"pixelData",null),(0,x._)([(0,M.MZ)()],L.prototype,"subview",void 0),L=(0,x._)([(0,B.$)("esri.views.2d.layers.ImageryLayerView2D")],L);const oe=L},9468:(le,W,l)=>{l.d(W,{A:()=>B});var T=l(8189),U=(l(35150),l(3248),l(40707),l(5922),l(76576)),S=l(69473),M=l(57641),$=l(62931);let J=class extends M.f{get hasHighlight(){return this.children.some(F=>F.hasData)}renderChildren(F){this.attributeView.update(),F.drawPhase===S.S5.HIGHLIGHT&&this.children.some(z=>z.hasData)&&(super.renderChildren(F),F.context.setColorMask(!0,!0,!0,!0),(0,$.lB)(F,!0,z=>{this._renderChildren(z,S.RI.All)}))}};J=(0,T._)([(0,U.$)("esri.views.2d.layers.support.HighlightGraphicContainer")],J);const B=J}}]);