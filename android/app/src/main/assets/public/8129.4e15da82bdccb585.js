"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8129],{8897:(At,at,y)=>{y.d(at,{F:()=>R,l:()=>nt});var v=y(10467),x=y(90261),m=y(3248);const w=128e3;let q=null,H=null;function R(){return rt.apply(this,arguments)}function rt(){return rt=(0,v.A)(function*(){return q||(q=function Z(){return et.apply(this,arguments)}()),q}),rt.apply(this,arguments)}function et(){return(et=(0,v.A)(function*(){H=yield((0,m.A)("esri-csp-restrictions")?yield y.e(4049).then(y.bind(y,34049)).then(A=>A.l):yield y.e(787).then(y.bind(y,50787)).then(A=>A.l)).default({locateFile:A=>(0,x.s)(`esri/core/libs/libtess/${A}`)})})).apply(this,arguments)}function nt(k,A){const M=Math.max(k.length,w);return H.triangulate(k,A,M)}},4858:(At,at,y)=>{y.d(at,{BI:()=>M,D3:()=>k,XJ:()=>A,lc:()=>nt,mX:()=>E,rU:()=>b,tH:()=>N});var v=y(1119);const x="__begin__",m="__end__",w=new RegExp(x,"ig"),q=new RegExp(m,"ig"),H=new RegExp("^"+x,"i"),R=new RegExp(m+"$","i"),rt='"',Z=rt+" + ",et=" + "+rt;function nt(F){return F.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function k(F){return F.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function A(F){const V={expression:"",type:"none"};return F.labelExpressionInfo?F.labelExpressionInfo.value?(V.expression=F.labelExpressionInfo.value,V.type="conventional"):F.labelExpressionInfo.expression&&(V.expression=F.labelExpressionInfo.expression,V.type="arcade"):null!=F.labelExpression&&(V.expression=nt(F.labelExpression),V.type="conventional"),V}function M(F){const V=A(F);if(!V)return null;switch(V.type){case"conventional":return E(V.expression);case"arcade":return V.expression}return null}function b(F){const V=A(F);if(!V)return null;switch(V.type){case"conventional":return function U(F){const V=null==F?void 0:F.match(D);return(null==V?void 0:V[1].trim())||null}(V.expression);case"arcade":return N(V.expression)}return null}function E(F){let V;return F?(V=(0,v.HC)(F,st=>x+'$feature["'+st+'"]'+m),V=H.test(V)?V.replace(H,""):rt+V,V=R.test(V)?V.replace(R,""):V+rt,V=V.replaceAll(w,Z).replaceAll(q,et)):V='""',V}const D=/^\s*\{([^}]+)\}\s*$/i,X=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,Q=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,J=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function N(F){if(!F)return null;let V=X.exec(F)||Q.exec(F);return V?V[1]||V[3]:(V=J.exec(F),V?V[2]:null)}},84289:(At,at,y)=>{y.d(at,{$:()=>v,s:()=>x});const v=15.5,x=1024},10223:(At,at,y)=>{y.d(at,{V:()=>R});var v=y(72137),x=y(53262),m=y(47961),w=y(91486),q=y(26747);class R{static executeEffects(Z,et,nt,k){const M=(0,q.ll)(Z);let b=new m.k(et);for(const E of Z){const D=(0,w.A)(E);D&&(b=D.execute(b,E,1.3333333333333333,nt,k,M))}return b}static applyEffects(Z,et,nt){if(!Z)return et;const k=(0,q.ll)(Z);let A,M=new m.k(v.z.fromJSONCIM(et));for(const D of Z){const U=(0,w.A)(D);U&&(M=U.execute(M,D,1,null,nt,k))}const b=[];let E=null;for(;A=M.next();)b.push(...(0,x.x)(A)),E=A.geometryType;return 0===b.length||null===E?null:"esriGeometryPolygon"===E?{rings:b}:{paths:b}}}},91644:(At,at,y)=>{y.d(at,{A7:()=>rt,Cx:()=>Z,Hk:()=>et,JJ:()=>M,UK:()=>R,jM:()=>k,x3:()=>A}),y(3248);var x=y(88521),m=y(55417),w=y(46602),q=y(47705),H=y(48254);const R=w.A.fromJSON(H.Cb),rt=m.A.fromJSON(H.yM),Z=x.A.fromJSON(H.WR),et=q.A.fromJSON(H.JZ),k=w.A.fromJSON(H.nC),A=m.A.fromJSON(H.HW),M=x.A.fromJSON(H.b6)},48254:(At,at,y)=>{y.d(at,{Cb:()=>m,HW:()=>rt,JZ:()=>H,WR:()=>q,b6:()=>Z,nC:()=>R,yM:()=>w});const v=[252,146,31,255],m={type:"esriSMS",style:"esriSMSCircle",size:6,color:v,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},w={type:"esriSLS",style:"esriSLSSolid",width:.75,color:v},q={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},H={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},R={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},rt={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},Z={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},53212:(At,at,y)=>{y.d(at,{KQ:()=>v,Q4:()=>rt,Ss:()=>nt});const v=8388607,x=8388608,rt=k=>k&v;function nt(k,A){return((A?x:0)|k)>>>0}},7933:(At,at,y)=>{y.d(at,{i:()=>A});var v=y(65374),x=y(47669);function m(M,b){return M.x===b.x&&M.y===b.y}function q(M,b){return M.x=b.y,M.y=-b.x,M}function H(M,b){return M.x=-b.y,M.y=b.x,M}function R(M,b){return M.x=b.x,M.y=b.y,M}function rt(M,b){return M.x=-b.x,M.y=-b.y,M}function Z(M){return Math.sqrt(M.x*M.x+M.y*M.y)}function et(M,b){return M.x*b.y-M.y*b.x}function nt(M,b){return M.x*b.x+M.y*b.y}function k(M,b,E,D){return M.x=b.x*E+b.y*D,M.y=b.x*D-b.y*E,M}class A{constructor(b,E,D){this._writeVertex=b,this._writeTriangle=E,this._canUseThinTessellation=D,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(b,E,D=this._canUseThinTessellation){(function w(M){if(!M)return;const b=M.length;if(b<=1)return;let E=0;for(let D=1;D<b;D++)m(M[D],M[E])||++E===D||(M[E]=M[D]);M.length=E+1})(b),D&&E.halfWidth<x.Gh&&!E.offset?this._tessellateThin(b,E):this._tessellate(b,E)}_tessellateThin(b,E){if(b.length<2)return;const D=E.wrapDistance||65535;let U=E.initialDistance||0,X=!1,Q=b[0].x,J=b[0].y;const N=b.length;for(let F=1;F<N;++F){X&&(X=!1,U=0);let V=b[F].x,st=b[F].y,ot=V-Q,pt=st-J,xt=Math.sqrt(ot*ot+pt*pt);if(ot/=xt,pt/=xt,U+xt>D){X=!0;const W=(D-U)/xt;xt=D-U,V=(1-W)*Q+W*V,st=(1-W)*J+W*st,--F}const ft=this._writeVertex(Q,J,0,0,ot,pt,pt,-ot,0,-1,U),Pt=this._writeVertex(Q,J,0,0,ot,pt,-pt,ot,0,1,U);U+=xt;const mt=this._writeVertex(V,st,0,0,ot,pt,pt,-ot,0,-1,U),K=this._writeVertex(V,st,0,0,ot,pt,-pt,ot,0,1,U);this._writeTriangle(ft,Pt,mt),this._writeTriangle(Pt,mt,K),Q=V,J=st}}_tessellate(b,E){const U=b[b.length-1],X=m(b[0],U);if(b.length<(X?3:2))return;const J=E.pixelCoordRatio,N=null!=E.capType?E.capType:v.xR.BUTT,F=null!=E.joinType?E.joinType:v.JO.MITER,V=null!=E.miterLimit?Math.min(E.miterLimit,4):2,st=null!=E.roundLimit?Math.min(E.roundLimit,1.05):1.05,ot=null!=E.halfWidth?E.halfWidth:2,pt=!!E.textured;let xt,ft,Pt,mt=null;const K=this._prevNormal,W=this._nextNormal;let zt=-1,Wt=-1;const vt=this._joinNormal;let Dt,It;const Vt=this._textureNormalLeft,Jt=this._textureNormalRight,Ot=this._textureNormal;let Mt=-1,Rt=-1;const qt=E.wrapDistance||65535;let ct=E.initialDistance||0;const _=this._writeVertex,g=this._writeTriangle,I=($,lt,yt,dt,Et,gt)=>{const Lt=_(ft,Pt,Dt,It,yt,dt,$,lt,Et,gt,ct);return Mt>=0&&Rt>=0&&Lt>=0&&g(Mt,Rt,Lt),Mt=Rt,Rt=Lt,Lt};X&&(xt=b[b.length-2],W.x=U.x-xt.x,W.y=U.y-xt.y,Wt=Z(W),W.x/=Wt,W.y/=Wt);let j=!1;for(let $=0;$<b.length;++$){if(j&&(j=!1,ct=0),xt&&(K.x=-W.x,K.y=-W.y,zt=Wt,ct+zt>qt&&(j=!0)),j){const wt=(qt-ct)/zt;zt=qt-ct,xt={x:(1-wt)*xt.x+wt*b[$].x,y:(1-wt)*xt.y+wt*b[$].y},--$}else xt=b[$];ft=xt.x,Pt=xt.y;const lt=$<=0&&!j,yt=$===b.length-1;if(lt||(ct+=zt),mt=yt?X?b[1]:null:b[$+1],mt?(W.x=mt.x-ft,W.y=mt.y-Pt,Wt=Z(W),W.x/=Wt,W.y/=Wt):(W.x=void 0,W.y=void 0),!X){if(lt){H(vt,W),Dt=vt.x,It=vt.y,N===v.xR.SQUARE&&(I(-W.y-W.x,W.x-W.y,W.x,W.y,0,-1),I(W.y-W.x,-W.x-W.y,W.x,W.y,0,1)),N===v.xR.ROUND&&(I(-W.y-W.x,W.x-W.y,W.x,W.y,-1,-1),I(W.y-W.x,-W.x-W.y,W.x,W.y,-1,1)),N!==v.xR.ROUND&&N!==v.xR.BUTT||(I(-W.y,W.x,W.x,W.y,0,-1),I(W.y,-W.x,W.x,W.y,0,1));continue}if(yt){q(vt,K),Dt=vt.x,It=vt.y,N!==v.xR.ROUND&&N!==v.xR.BUTT||(I(K.y,-K.x,-K.x,-K.y,0,-1),I(-K.y,K.x,-K.x,-K.y,0,1)),N===v.xR.SQUARE&&(I(K.y-K.x,-K.x-K.y,-K.x,-K.y,0,-1),I(-K.y-K.x,K.x-K.y,-K.x,-K.y,0,1)),N===v.xR.ROUND&&(I(K.y-K.x,-K.x-K.y,-K.x,-K.y,1,-1),I(-K.y-K.x,K.x-K.y,-K.x,-K.y,1,1));continue}}let dt,Et,gt=-et(K,W);if(Math.abs(gt)<.01)nt(K,W)>0?(vt.x=K.x,vt.y=K.y,gt=1,dt=Number.MAX_VALUE,Et=!0):(H(vt,W),gt=1,dt=1,Et=!1);else{vt.x=(K.x+W.x)/gt,vt.y=(K.y+W.y)/gt,dt=Z(vt);const wt=(dt-1)*ot*J;Et=dt>4||wt>zt&&wt>Wt}Dt=vt.x,It=vt.y;let Lt=F;switch(F){case v.JO.BEVEL:dt<1.05&&(Lt=v.JO.MITER);break;case v.JO.ROUND:dt<st&&(Lt=v.JO.MITER);break;case v.JO.MITER:dt>V&&(Lt=v.JO.BEVEL)}switch(Lt){case v.JO.MITER:if(I(vt.x,vt.y,-K.x,-K.y,0,-1),I(-vt.x,-vt.y,-K.x,-K.y,0,1),yt)break;if(pt){const wt=j?0:ct;Mt=this._writeVertex(ft,Pt,Dt,It,W.x,W.y,vt.x,vt.y,0,-1,wt),Rt=this._writeVertex(ft,Pt,Dt,It,W.x,W.y,-vt.x,-vt.y,0,1,wt)}break;case v.JO.BEVEL:{const wt=gt<0;let Ft,Y,Nt,Ut;if(wt){const kt=Mt;Mt=Rt,Rt=kt,Ft=Vt,Y=Jt}else Ft=Jt,Y=Vt;if(Et)Nt=wt?H(this._innerPrev,K):q(this._innerPrev,K),Ut=wt?q(this._innerNext,W):H(this._innerNext,W);else{const kt=wt?rt(this._inner,vt):R(this._inner,vt);Nt=kt,Ut=kt}const ut=wt?q(this._bevelStart,K):H(this._bevelStart,K);I(Nt.x,Nt.y,-K.x,-K.y,Ft.x,Ft.y);const Kt=I(ut.x,ut.y,-K.x,-K.y,Y.x,Y.y);if(yt)break;const Gt=wt?H(this._bevelEnd,W):q(this._bevelEnd,W);if(Et){const kt=this._writeVertex(ft,Pt,Dt,It,-K.x,-K.y,0,0,0,0,ct);Mt=this._writeVertex(ft,Pt,Dt,It,W.x,W.y,Ut.x,Ut.y,Ft.x,Ft.y,ct),Rt=this._writeVertex(ft,Pt,Dt,It,W.x,W.y,Gt.x,Gt.y,Y.x,Y.y,ct),this._writeTriangle(Kt,kt,Rt)}else{if(pt){const kt=this._bevelMiddle;kt.x=(ut.x+Gt.x)/2,kt.y=(ut.y+Gt.y)/2,k(Ot,kt,-K.x,-K.y),I(kt.x,kt.y,-K.x,-K.y,Ot.x,Ot.y),k(Ot,kt,W.x,W.y),Mt=this._writeVertex(ft,Pt,Dt,It,W.x,W.y,kt.x,kt.y,Ot.x,Ot.y,ct),Rt=this._writeVertex(ft,Pt,Dt,It,W.x,W.y,Ut.x,Ut.y,Ft.x,Ft.y,ct)}else{const kt=Mt;Mt=Rt,Rt=kt}I(Gt.x,Gt.y,W.x,W.y,Y.x,Y.y)}if(wt){const kt=Mt;Mt=Rt,Rt=kt}break}case v.JO.ROUND:{const wt=gt<0;let Ft,Y;if(wt){const Qt=Mt;Mt=Rt,Rt=Qt,Ft=Vt,Y=Jt}else Ft=Jt,Y=Vt;const Nt=wt?rt(this._inner,vt):R(this._inner,vt);let Ut,ut;Et?(Ut=wt?H(this._innerPrev,K):q(this._innerPrev,K),ut=wt?q(this._innerNext,W):H(this._innerNext,W)):(Ut=Nt,ut=Nt);const Kt=wt?q(this._roundStart,K):H(this._roundStart,K),Gt=wt?H(this._roundEnd,W):q(this._roundEnd,W),kt=I(Ut.x,Ut.y,-K.x,-K.y,Ft.x,Ft.y),te=I(Kt.x,Kt.y,-K.x,-K.y,Y.x,Y.y);if(yt)break;const ie=this._writeVertex(ft,Pt,Dt,It,-K.x,-K.y,0,0,0,0,ct);Et||this._writeTriangle(Mt,Rt,ie);const se=rt(this._outer,Nt),ae=this._writeVertex(ft,Pt,Dt,It,W.x,W.y,Gt.x,Gt.y,Y.x,Y.y,ct);let _e,me;const bt=dt>2;if(bt){let Qt;dt!==Number.MAX_VALUE?(se.x/=dt,se.y/=dt,Qt=nt(K,se),Qt=(dt*(Qt*Qt-1)+1)/Qt):Qt=-1,_e=wt?q(this._startBreak,K):H(this._startBreak,K),_e.x+=K.x*Qt,_e.y+=K.y*Qt,me=wt?H(this._endBreak,W):q(this._endBreak,W),me.x+=W.x*Qt,me.y+=W.y*Qt}k(Ot,se,-K.x,-K.y);const ee=this._writeVertex(ft,Pt,Dt,It,-K.x,-K.y,se.x,se.y,Ot.x,Ot.y,ct);k(Ot,se,W.x,W.y);const fe=pt?this._writeVertex(ft,Pt,Dt,It,W.x,W.y,se.x,se.y,Ot.x,Ot.y,ct):ee,le=ie,ce=pt?this._writeVertex(ft,Pt,Dt,It,W.x,W.y,0,0,0,0,ct):ie;let Zt=-1,xe=-1;if(bt&&(k(Ot,_e,-K.x,-K.y),Zt=this._writeVertex(ft,Pt,Dt,It,-K.x,-K.y,_e.x,_e.y,Ot.x,Ot.y,ct),k(Ot,me,W.x,W.y),xe=this._writeVertex(ft,Pt,Dt,It,W.x,W.y,me.x,me.y,Ot.x,Ot.y,ct)),pt?bt?(this._writeTriangle(le,te,Zt),this._writeTriangle(le,Zt,ee),this._writeTriangle(ce,fe,xe),this._writeTriangle(ce,xe,ae)):(this._writeTriangle(le,te,ee),this._writeTriangle(ce,fe,ae)):bt?(this._writeTriangle(ie,te,Zt),this._writeTriangle(ie,Zt,xe),this._writeTriangle(ie,xe,ae)):(this._writeTriangle(ie,te,ee),this._writeTriangle(ie,fe,ae)),Et?(Mt=this._writeVertex(ft,Pt,Dt,It,W.x,W.y,ut.x,ut.y,Ft.x,Ft.y,ct),Rt=ae):(Mt=pt?this._writeVertex(ft,Pt,Dt,It,W.x,W.y,ut.x,ut.y,Ft.x,Ft.y,ct):kt,this._writeTriangle(Mt,ce,ae),Rt=ae),wt){const Qt=Mt;Mt=Rt,Rt=Qt}break}}}}}},24821:(At,at,y)=>{y.d(at,{Y7:()=>Jt,HS:()=>Ot,mm:()=>Mt,A:()=>qt,k2:()=>Rt,ZA:()=>Vt,E8:()=>vt,hF:()=>W,C5:()=>mt,uK:()=>Wt,Pi:()=>zt});var v=y(8189),x=y(89952),m=y(35150),w=y(1119),q=y(5922),H=y(20951),R=y(65388);const rt=()=>m.A.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class Z{constructor(){this._includedModules=new Map}include(_,g){if(this._includedModules.has(_)){const I=this._includedModules.get(_);if(I!==g){rt().error("Trying to include shader module multiple times with different sets of options.");const j=new Set;for(const $ of Object.keys(I))I[$]!==_[$]&&j.add($);for(const $ of Object.keys(_))I[$]!==_[$]&&j.add($);j.forEach($=>console.error(`  ${$}: current ${I[$]} new ${_[$]}`))}}else this._includedModules.set(_,g),_(this.builder,g)}}class et extends Z{constructor(){super(...arguments),this.vertex=new A,this.fragment=new A,this.attributes=new M,this.varyings=new b,this.extensions=new E,this.constants=new D}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(_,g=!0){const I=this.extensions.generateSource(_),j=this.attributes.generateSource(_),$=this.varyings.generateSource(_),lt="vertex"===_?this.vertex:this.fragment,yt=lt.uniforms.generateSource(),dt=lt.code.generateSource(),Et="vertex"===_?X:function U(ct=!0){return`#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif\n${ct?"out vec4 fragColor;":""}\n`}(g),gt=this.constants.generateSource().concat(lt.constants.generateSource());return`${g?"#version 300 es":""}\n${I.join("\n")}\n${Et}\n${gt.join("\n")}\n${yt.join("\n")}\n${j.join("\n")}\n${$.join("\n")}\n${dt.join("\n")}`}generateBindPass(_){const g=new Map;this.vertex.uniforms.entries.forEach($=>{const lt=$.bind[H.c.Pass];lt&&g.set($.name,lt)}),this.fragment.uniforms.entries.forEach($=>{const lt=$.bind[H.c.Pass];lt&&g.set($.name,lt)});const I=Array.from(g.values()),j=I.length;return($,lt)=>{for(let yt=0;yt<j;++yt)I[yt](_,$,lt)}}generateBindDraw(_){const g=new Map;this.vertex.uniforms.entries.forEach($=>{const lt=$.bind[H.c.Draw];lt&&g.set($.name,lt)}),this.fragment.uniforms.entries.forEach($=>{const lt=$.bind[H.c.Draw];lt&&g.set($.name,lt)});const I=Array.from(g.values()),j=I.length;return($,lt,yt)=>{for(let dt=0;dt<j;++dt)I[dt](_,$,lt,yt)}}}class nt{constructor(){this._entries=new Map}add(..._){for(const g of _)this._add(g)}get(_){return this._entries.get(_)}_add(_){if(null!=_){if(this._entries.has(_.name)&&!this._entries.get(_.name).equals(_))throw new q.A(`Duplicate uniform name ${_.name} for different uniform type`);this._entries.set(_.name,_)}else rt().error(`Trying to add null Uniform from ${(new Error).stack}.`)}generateSource(){return Array.from(this._entries.values()).map(_=>null!=_.arraySize?`uniform ${_.type} ${_.name}[${_.arraySize}];`:`uniform ${_.type} ${_.name};`)}get entries(){return Array.from(this._entries.values())}}class k{constructor(){this._entries=new Array}add(_){this._entries.push(_)}generateSource(){return this._entries}}class A extends Z{constructor(){super(...arguments),this.uniforms=new nt,this.code=new k,this.constants=new D}get builder(){return this}}class M{constructor(){this._entries=new Array}add(_,g){this._entries.push([_,g])}generateSource(_){return"fragment"===_?[]:this._entries.map(g=>`in ${g[1]} ${g[0]};`)}}class b{constructor(){this._entries=new Map}add(_,g){this._entries.has(_)&&(0,R.vA)(this._entries.get(_)===g),this._entries.set(_,g)}generateSource(_){const g=new Array;return this._entries.forEach((I,j)=>g.push("vertex"===_?`out ${I} ${j};`:`in ${I} ${j};`)),g}}class E{constructor(){this._entries=new Set}add(_){this._entries.add(_)}generateSource(_){const g="vertex"===_?E.ALLOWLIST_VERTEX:E.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(I=>g.includes(I)).map(I=>`#extension ${I} : enable`)}}E.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],E.ALLOWLIST_VERTEX=[];class D{constructor(){this._entries=new Set}add(_,g,I){let j="ERROR_CONSTRUCTOR_STRING";switch(g){case"float":j=D._numberToFloatStr(I);break;case"int":j=D._numberToIntStr(I);break;case"bool":j=I.toString();break;case"vec2":j=`vec2(${D._numberToFloatStr(I[0])},                            ${D._numberToFloatStr(I[1])})`;break;case"vec3":j=`vec3(${D._numberToFloatStr(I[0])},                            ${D._numberToFloatStr(I[1])},                            ${D._numberToFloatStr(I[2])})`;break;case"vec4":j=`vec4(${D._numberToFloatStr(I[0])},                            ${D._numberToFloatStr(I[1])},                            ${D._numberToFloatStr(I[2])},                            ${D._numberToFloatStr(I[3])})`;break;case"ivec2":j=`ivec2(${D._numberToIntStr(I[0])},                             ${D._numberToIntStr(I[1])})`;break;case"ivec3":j=`ivec3(${D._numberToIntStr(I[0])},                             ${D._numberToIntStr(I[1])},                             ${D._numberToIntStr(I[2])})`;break;case"ivec4":j=`ivec4(${D._numberToIntStr(I[0])},                             ${D._numberToIntStr(I[1])},                             ${D._numberToIntStr(I[2])},                             ${D._numberToIntStr(I[3])})`;break;case"mat2":case"mat3":case"mat4":j=`${g}(${Array.prototype.map.call(I,$=>D._numberToFloatStr($)).join(", ")})`}return this._entries.add(`const ${g} ${_} = ${j};`),this}static _numberToIntStr(_){return _.toFixed(0)}static _numberToFloatStr(_){return Number.isInteger(_)?_.toFixed(1):_.toString()}generateSource(){return Array.from(this._entries)}}const X="precision highp float;\nprecision highp sampler2D;";var Q=y(3902);function N(ct,_,g){const I=_.split("\n");for(const j of I)if(j.trim().length){{let $="";null!=g&&($+=`/*id:${null!=g?g:"000"}*/   `),ct.body+=$.padEnd(14)}ct.body+=" ".repeat(ct.indent)+j+"\n"}}class F{write(_){for(const g of _.rootOutputNodes())_.shouldPruneOutputNode(g)||(g.variableName=this._write(_,g.node));return _}_createVarName(_,g){let I="";return"boolean"!=typeof g&&"number"!=typeof g&&g.debugInfo.name&&(I=`${g.debugInfo.name}_`),`${I}v${_.varCount++}`}_write(_,g,I=!1){if("number"==typeof g||"boolean"==typeof g)return g.toString();let j=_.getEmit(g);if(j)return j;switch(g.shaderType){case"scope-node":j=this._writeScopeNode(_,g);break;case"primitive-node":j=this._writePrimitveNode(_,g,I);break;case"function-node":j=this._writeFunctionNode(_,g);break;case"property-access-node":j=this._writePropertyAccessNode(_,g);break;case"text-node":j=g.text;break;case"block-node":j=this._writeBlockNode(_,g);break;case"condition-node":j=this._writeConditionNode(_,g)}return _.setEmit(g,j),j}_writeScopeNode(_,g){const I=new g.child.constructor;I.setDebugName(g.debugInfo.name);const j=this._write(_,I,!0);return N(_,`{ /*ScopeStart: ${g.uid} ${g.debugInfo.name}*/`),_.indent+=2,N(_,`${j} = ${this._write(_,g.child)};`),_.indent-=2,N(_,`} /*ScopeEnd: ${g.uid} ${g.debugInfo.name}*/`),j}_writeConditionNode(_,g){const I=new g.ifTrue.constructor,j=this._write(_,I,!0);N(_,`if (${this._write(_,g.condition)}) {`),_.indent+=2;const $=_.createSubgraphContext(),lt=this._write($,g.ifTrue);if(_.body+=$.body,lt&&N(_,`${j} = ${lt};`),_.indent-=2,N(_,"}"),g.ifFalse){N(_,"else {"),_.indent+=2;const yt=_.createSubgraphContext(),dt=this._write(yt,g.ifFalse);_.body+=yt.body,dt&&N(_,`${j} = ${dt};`),_.indent-=2,N(_,"}")}return j}_writeBlockNode(_,g){const{captureList:I,generator:j,returnType:$}=g,lt={};for(const gt in I){if(!I[gt])continue;const Lt=this._write(_,I[gt]);lt[gt]=Lt}const yt=new $,dt=this._write(_,yt,!0);if(lt.out=dt,g.subgraph){const gt=_.createSubgraphContext(),Lt=this._write(gt,g.subgraph.child);lt.subgraph={varName:Lt,body:gt.body}}const Et=j(lt);return N(_,"{\n"),_.indent+=2,N(_,Et),_.indent-=2,N(_,"}\n"),dt}_writePropertyAccessNode(_,g){const I=this._write(_,g.target);return"string"==typeof g.property&&g.property.includes("[")?`${I}${g.property}`:"string"!=typeof g.property?`${I}[${this._write(_,g.property)}]`:`${I}.${g.property}`}_writeFunctionNode(_,g){const I=g.returnType.type;if(g.isInfix){const[lt,yt]=g.children.map(Et=>this._write(_,Et)),dt=this._createVarName(_,g);return N(_,`${I.padEnd(5)} ${dt} = ${lt} ${g.token} ${yt};`,g.uid),dt}const j=g.children.map(lt=>this._write(_,lt)).join(", "),$=this._createVarName(_,g);return N(_,`${I.padEnd(5)} ${$} = ${g.token}(${j});`,g.uid),$}_writePrimitveNode(_,g,I=!1){var j;const $=_.getInput(g);if($)return $.isUsed=!0,$.variableName;const lt=1===g.children.length&&(null===(j=g.children[0])||void 0===j?void 0:j.type)===g.type;if(g.isImplicit||lt)return this._write(_,g.children[0]);const yt=this._createVarName(_,g);if(I)return N(_,`${g.type.padEnd(5)} ${yt};`,g.uid),yt;const dt=!g.debugInfo.name&&!g.isMutable;if(dt&&"float"===g.type&&"number"==typeof g.children[0])return Number.isInteger(g.children[0])?g.children[0].toFixed(1):g.children[0].toString();if(dt&&"int"===g.type&&"number"==typeof g.children[0]&&Number.isInteger(g.children[0]))return g.children[0].toString();const Et=g.children.map(gt=>this._write(_,gt)).join(", ");return"array"===g.type?(N(_,`${g.type.padEnd(5)} ${yt} = [${Et}];`,g.uid),yt):dt?`${g.type}(${Et})`:(N(_,`${g.type.padEnd(5)} ${yt} = ${g.type}(${Et});`,g.uid),yt)}}var V=y(92779);class st{constructor(_,g,I){this.variableName=_,this.variableInputType=g,this.node=I,this.type="shader-input",this.isUsed=!1}clone(){return new st(this.variableName,this.variableInputType,(0,V.vA)(this.node))}}class ot{constructor(_,g,I){this.outVariableName=_,this.outVariableType=g,this.node=I,this.type="shader-output"}clone(){const _=new ot(this.outVariableName,this.outVariableType,(0,V.vA)(this.node));return _.variableName=this.variableName,_}}class pt{static createVertex(_,g,I,j,$,lt){const yt=[];for(const Et in _){const gt=_[Et],Lt=I.get(Et);yt.push(Lt?new st(Lt,"builtin",gt):new st("a_"+Et,"attribute",gt))}for(const Et of j)yt.push(new st(Et.uniformName,"uniform",Et.uniformHydrated));const dt=[];for(const Et in g){const gt=g[Et];dt.push("glPosition"===Et?new ot("gl_Position","builtin",gt):"glPointSize"===Et?new ot("gl_PointSize","builtin",gt):new ot("v_"+Et,"varying",gt))}return new pt(yt,dt,$,lt)}static createFragment(_,g,I,j,$,lt){const yt=[],dt=Array.from($.rootOutputNodes());for(const gt in _){const Lt=_[gt],wt=I.get(gt);if(wt){yt.push(new st(wt,"builtin",Lt));continue}const Ft=dt.find(Y=>Y.node===Lt);Ft&&yt.push(new st(Ft.outVariableName,Ft.outVariableType,Lt))}for(const gt of j)yt.push(new st(gt.uniformName,"uniform",gt.uniformHydrated));const Et=[];for(const gt in g){const Lt=g[gt],wt=I.get(gt);if("discard"===gt)Et.push(new ot(null,"discard",Lt));else{if(!wt)throw new Error(`Member ${gt} in shader fragment output shoule be tagged as builtin`);Et.push(new ot(wt,"builtin",Lt))}}return new pt(yt,Et,lt)}constructor(_,g,I,j){this.type="shader-graph-context",this.indent=0,this.body="",this.varCount=0,this._inputShaderTypesByNodeUid=new Map,this._nodeEmitMap=new Map;for(const $ of _)this._inputShaderTypesByNodeUid.set($.node.uid,$);this._outputShaderTypes=g,this._transformFeedbackBindings=I,this._transformFeedbackNames=new Set(I.map($=>"v_"+$.propertyKey)),this._usedInFragmentShader=j}shouldPruneOutputNode(_){return!!this._usedInFragmentShader&&"builtin"!==_.outVariableType&&!this._transformFeedbackNames.has(_.outVariableName)&&!this._usedInFragmentShader.has(_.node.uid)}setEmit(_,g){this._nodeEmitMap.set(_.uid,g)}getEmit(_){return this._nodeEmitMap.get(_.uid)}inputs(){return this._inputShaderTypesByNodeUid.values()}getInput(_){return this._inputShaderTypesByNodeUid.get(_.uid)}*rootOutputNodes(){for(const _ of this._outputShaderTypes)yield _}*nodes(){const _=[];for(const g of this._outputShaderTypes.values())_.push(g.node);for(;_.length;){const g=_.pop();"number"!=typeof g&&"boolean"!=typeof g&&_.push(...g.children.filter(Boolean)),yield g}}*nodesOfTypeOrFunction(){for(const _ of this.nodes())"number"!=typeof _&&"boolean"!=typeof _&&(yield _)}createSubgraphContext(){const _=this.clone();return _.body="",_.indent=this.indent+2,_._nodeEmitMap=new Map(this._nodeEmitMap),_}clone(){const _=new pt([],this._outputShaderTypes,this._transformFeedbackBindings,this._usedInFragmentShader);return _._inputShaderTypesByNodeUid=this._inputShaderTypesByNodeUid,_.indent=this.indent,_.body=this.body,_.varCount=this.varCount,_._nodeEmitMap=this._nodeEmitMap,_}insertVertexShader(_){_.vertex.code.add(""),this._insertInputs(_,"vertex"),_.vertex.code.add(""),_.vertex.code.add("// OUTPUTS: "),_.vertex.code.add("// --------------------------------------------------------- ");for(const g of this.rootOutputNodes()){const I="builtin"===g.outVariableType;this.shouldPruneOutputNode(g)||_.vertex.code.add(I?`// ${g.outVariableType.padEnd(7)} ${g.node.type.padEnd(9)} ${g.outVariableName};`:`${g.outVariableType.padEnd(10)} ${g.node.type.padEnd(9)} ${g.outVariableName};`)}_.vertex.code.add(""),_.vertex.code.add("void main() {"),_.vertex.code.add("  "+this.body.split("\n").join("\n  "));for(const g of this.rootOutputNodes())this.shouldPruneOutputNode(g)||_.vertex.code.add(`  ${g.outVariableName} = ${g.variableName};`);_.vertex.code.add("}")}insertFragmentShader(_){this._insertInputs(_,"fragment"),_.fragment.code.add(""),_.fragment.code.add("void main() {"),_.fragment.code.add("  "+this.body.split("\n").join("\n  "));for(const g of this.rootOutputNodes())"discard"===g.outVariableType?(_.fragment.code.add("  // TODO: Should ensure codegen for discard appears first in fragment shader"),_.fragment.code.add(`  if (${g.variableName}) {`),_.fragment.code.add("    discard;"),_.fragment.code.add("  }"),_.fragment.code.add("  ")):_.fragment.code.add(`  ${g.outVariableName} = ${g.variableName};`);_.fragment.code.add("}")}_insertInputs(_,g){_[g].code.add("// INPUTS: "),_[g].code.add("// --------------------------------------------------------- ");for(const I of this.inputs())I.isUsed&&"builtin"!==I.variableInputType&&_[g].code.add("array"===I.node.type?`${I.variableInputType.padEnd(10)} ${I.node.elementType.type.padEnd(9)} ${I.variableName}[${I.node.size}];`:`${I.variableInputType.padEnd(10)} ${I.node.type.padEnd(9)} ${I.variableName};`)}}var xt=y(77989);function ft(ct){return new ct}function Pt(ct,_,g){var I;const j=null!==(I=ct.constructor[_])&&void 0!==I?I:[];ct.constructor.hasOwnProperty(_)||Object.defineProperty(ct.constructor,_,{value:j.slice()}),ct.constructor[_].push(g)}function mt(ct,_){return(g,I)=>{Pt(g,"locations",{typeCtor:_,propertyKey:I,parameterIndex:null,index:ct})}}const W=ct=>(_,g,I)=>{Pt(_,"inputs",{inputCtor:ct,propertyKey:g,parameterIndex:I})},zt=ct=>(_,g)=>{Pt(_,"uniforms",{typeCtor:ct,propertyKey:g})},Wt=ct=>(_,g)=>{Pt(_,"options",{typeCtor:ct,propertyKey:g})},vt=(ct,_)=>{Pt(ct,"defines",{propertyKey:_})},It=(ct,_)=>(g,I)=>{g.constructor.builtins.push({builtin:ct,propertyKey:I,typeCtor:_})};class Vt{}Vt.builtins=[],(0,v._)([It("gl_VertexID",Q.Ai)],Vt.prototype,"glVertexID",void 0);class Jt{}class Ot{}Ot.builtins=[],(0,v._)([It("gl_FragCoord",Q.Zb)],Ot.prototype,"glFragCoord",void 0),(0,v._)([It("gl_PointCoord",Q.ZY)],Ot.prototype,"glPointCoord",void 0);class Mt{}(0,v._)([("gl_FragColor",(_,g)=>{Pt(_,"builtins",{builtin:"gl_FragColor",propertyKey:g})})],Mt.prototype,"glFragColor",void 0);class Rt{constructor(){this.type="uniform-group"}get _uniforms(){var _;return null!==(_=this.constructor.uniforms)&&void 0!==_?_:[]}}class qt{constructor(){this.logShader=!1,this.computeAttributes={}}get vertexInput(){const _=(0,x.Uk)(this._shaderModuleClass.inputs,g=>"vertex"===g.propertyKey&&0===g.parameterIndex);if(!_)throw new Error("Unable to find vertex input parameter");return _}get computeInput(){return(0,x.Uk)(this._shaderModuleClass.inputs,_=>"vertex"===_.propertyKey&&1===_.parameterIndex)}get fragmentInput(){const _=(0,x.Uk)(this._shaderModuleClass.inputs,g=>"fragment"===g.propertyKey);if(!_)throw new Error("Unable to find fragment input parameter");return _}get transformFeedbackBindings(){var _;return null!==(_=this.fragmentInput.inputCtor.transformFeedbackBindings)&&void 0!==_?_:[]}get locations(){var _,g;return[...this.vertexInput.inputCtor.locations,...null!==(_=null===(g=this.computeInput)||void 0===g?void 0:g.inputCtor.locations)&&void 0!==_?_:[]]}get locationsMap(){const _=new Map,g=new Set;for(const I of this.locations)g.has(I.index)?m.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.GraphShaderModule").warnOnce("mapview-rendering",`Unable to assigned attribute ${I.propertyKey} to ${I.index}. Index already in use`,{locationsMap:_}):(_.set(I.propertyKey,I.index),g.add(I.index));return _}get locationInfo(){if(!this._locationInfo){const _=this.locationsMap,g=Array.from(_.entries()).map(([j,$])=>`${j}.${$}`).join("."),I=(0,w.Wm)(g);this._locationInfo={hash:I,locations:_}}return this._locationInfo}get renamedLocationsMap(){const _=new Map;for(const g of this.locations)_.set("a_"+g.propertyKey,g.index);return _}get optionPropertyKeys(){if(!this._optionPropertyKeys){const _=new Set;for(const g of this._options)_.add(g.propertyKey);this._optionPropertyKeys=_}return this._optionPropertyKeys}get _shaderModuleClass(){return this.constructor}get _defines(){var _;return null!==(_=this._shaderModuleClass.defines)&&void 0!==_?_:[]}get _options(){var _;return null!==(_=this._shaderModuleClass.options)&&void 0!==_?_:[]}get _uniforms(){var _;return null!==(_=this._shaderModuleClass.uniforms)&&void 0!==_?_:[]}getProgram(_,g,I,j){try{const{vertex:$,fragment:lt,uniformBindings:yt}=this._generateShaders(_,g,I,j);return new xt.K($,lt,this.renamedLocationsMap,this.locationInfo,yt,this.transformFeedbackBindings)}catch($){return console.error("Failed to create program",{error:$}),new xt.K("","",this.renamedLocationsMap,this.locationInfo,[],this.transformFeedbackBindings)}}getDebugUniformClassInfo(_){const g=this._options.find(j=>j.propertyKey===_);if(g)return{type:"option",className:g.typeCtor};const I=this._uniforms.find(j=>j.propertyKey===_);if(!I)throw new Error(`Unable to find uniform class type for property: ${_}`);return{type:"required",className:I.typeCtor}}getShaderKey(_,g,I,j){const $=Object.keys(I).map(dt=>`${dt}.${I[dt]}`).join("."),lt=Object.keys(j).map(dt=>`${dt}.${j[dt]}`).join("."),yt=Object.keys(g).filter(dt=>this.optionPropertyKeys.has(dt)&&g[dt]).join(".");return`${this.constructor.name}.${_.hash}.${$}.${lt}.${yt}`}_generateShaders(_,g,I,j){const $=[];this._setDefines(I),this._setOptionalUniforms($,g),this._setRequiredUniforms($);const lt=this._hydrateVertexInput(j),yt=this._injectPackPrecisionFactor(lt,_),dt=this._hydrateComputeInput(),Et=dt&&this._injectPackPrecisionFactor(dt,_),gt=this.vertex(yt,Et),Lt=this._hydrateFragmentInput(gt),wt=this.fragment(Lt),Ft=new Set;for(const te in wt)(0,V.rz)(Ft,wt[te]);const Y=this._getVertexInputBuiltins(),Nt=pt.createVertex({...lt,...dt},gt,Y,$,this.transformFeedbackBindings,Ft);(new F).write(Nt);const Ut=this._getFragmentInputBuiltins(wt);Ut.set("glPointCoord","gl_PointCoord");const ut=pt.createFragment(Lt,wt,Ut,$,Nt,this.transformFeedbackBindings);(new F).write(ut);const Kt=this._createShaderBuilder(Nt,ut),Gt=Kt.generate("vertex",!1),kt=Kt.generate("fragment",!1);return this.logShader&&(console.log(Gt),console.log(kt)),{vertex:Gt,fragment:kt,uniformBindings:$}}_setDefines(_){for(const g in _)this[g]=_[g]}_setOptionalUniforms(_,g){for(const I of this._options)this[I.propertyKey]=g[I.propertyKey]?this._hydrateUniformGroup(_,I):null}_setRequiredUniforms(_){for(const g of this._uniforms)this[g.propertyKey]=this._hydrateUniformGroup(_,g)}_hydrateUniformGroup(_,g){const I=new g.typeCtor;for(const $ of null!==(j=I._uniforms)&&void 0!==j?j:[]){var j;const lt=ft($.typeCtor),yt=`u_${g.propertyKey}_${$.propertyKey}`,dt=lt.type,Et=[g.propertyKey,$.propertyKey].join(".");_.push("type"in $.typeCtor&&"array"===$.typeCtor.type?{shaderModulePath:Et,uniformName:yt,uniformType:dt,uniformArrayLength:lt.size,uniformArrayElementType:lt.elementType.type,uniformHydrated:lt}:{shaderModulePath:Et,uniformName:yt,uniformType:dt,uniformHydrated:lt}),I[$.propertyKey]=lt}return I}_hydrateVertexInput(_){const g=this.vertexInput.inputCtor,I=g.locations.reduce((j,$)=>!1===_[$.propertyKey]?j:{...j,[$.propertyKey]:ft($.typeCtor)},{});for(const{propertyKey:j,typeCtor:$}of g.builtins){const lt=ft($);I[j]=lt}return I}_hydrateComputeInput(){return null==this.computeInput?null:this.computeInput.inputCtor.locations.reduce((_,g)=>({..._,[g.propertyKey]:ft(g.typeCtor)}),{})}_injectPackPrecisionFactor(_,g){const I={};for(const j in _){const $=_[j],lt=g.attributes.find(yt=>yt.name===j);if(null!=lt&&lt.packPrecisionFactor){if("float"!==$.type&&"vec2"!==$.type&&"vec3"!==$.type&&"vec4"!==$.type)throw new Error(`InternalError: packPrecisionFactor requires GenType, but found ${$.type}`);I[j]=$.divide(new Q.nt(lt.packPrecisionFactor))}else I[j]=$}return I}_hydrateFragmentInput(_){const g={};for(const I in _)g[I]=_[I];for(const{propertyKey:I,typeCtor:j}of Ot.builtins){const $=ft(j);g[I]=$}return g}_getVertexInputBuiltins(){const _=this.vertexInput.inputCtor,g=new Map;for(const{builtin:I,propertyKey:j}of _.builtins)g.set(j,I);return g}_getFragmentInputBuiltins(_){const g=_.constructor,I=new Map;for(const $ of null!==(j=g.builtins)&&void 0!==j?j:[]){var j;I.set($.propertyKey,$.builtin)}return I}_createShaderBuilder(_,g){const I=new et;return this._insertDebugInfo(I),_.insertVertexShader(I),g.insertFragmentShader(I),I}_insertDebugInfo(_){_.vertex.code.add("// DEFINES: "),_.vertex.code.add("// --------------------------------------------------------- ");for(const g of this._defines)_.vertex.code.add(this[g.propertyKey]?`//   ${g.propertyKey}: true`:`//   ${g.propertyKey}: false`);_.vertex.code.add(""),_.vertex.code.add("// OPTIONS: "),_.vertex.code.add("// --------------------------------------------------------- ");for(const g of this._options)_.vertex.code.add(this[g.propertyKey]?`//   ${g.propertyKey}: true`:`//   ${g.propertyKey}: false`)}}},92779:(At,at,y)=>{function x(k,A){const M=[];for(M.push(A);M.length;){const b=M.pop();if("object"==typeof b&&!k.has(b.uid)){k.add(b.uid);for(const E of b.children)M.push(E)}}}y.d(at,{XL:()=>Z,aw:()=>nt,rR:()=>et,rz:()=>x,vA:()=>w,vL:()=>q,zg:()=>rt});class m{constructor(){this.uid=m.NodeCount++,this._debugName=null,this._isMutable=!1,this.isImplicit=!1}get isMutable(){return this._isMutable}setMutable(){return this._isMutable=!0,this}setDebugName(A){return A=function v(k){return k.split(" ").map((A,M)=>M>0?A.charAt(0).toUpperCase()+A.slice(1):A).join("")}(A),this._debugName=A,this.isImplicit&&this.children[0]instanceof m&&this.children[0].setDebugName(A),this}get debugInfo(){var A;return{name:null!==(A=this._debugName)&&void 0!==A?A:""}}cloneInto(A){A._debugName=this._debugName,A._isMutable=this._isMutable,A.isImplicit=this.isImplicit,A.uid=this.uid}}function w(k){return"object"==typeof k?k.clone():k}m.NodeCount=0;class q extends m{constructor(){super(...arguments),this.shaderType="primitive-node"}}class H extends m{constructor(A){super(),this.child=A,this.shaderType="scope-node"}get children(){return[this.child]}clone(){const A=new H(w(this.child));return this.cloneInto(A),A}}class rt extends m{constructor(A,M,b){super(),this.property=A,this.target=M,this.returnType=b,this.shaderType="property-access-node"}get children(){const A=[this.target];return"string"!=typeof this.property&&A.push(this.property),A}clone(){const A=new rt(this.property,w(this.target),this.returnType);return this.cloneInto(A),A}}class Z extends m{constructor(A,M,b){super(),this.condition=A,this.ifTrue=M,this.ifFalse=b,this.shaderType="condition-node"}get children(){return[this.condition,this.ifTrue,this.ifFalse]}clone(){const A=w(this.ifTrue),M=this.ifFalse?w(this.ifFalse):null,b=new Z(this.condition,A,M);return this.cloneInto(b),b}}class et extends m{constructor(A,M,b,E){super(),this.captureList=A,this.returnType=M,this.generator=E,this.shaderType="block-node",b&&(this.subgraph=new H(b))}get children(){var A;return Object.keys(this.captureList).map(M=>this.captureList[M]).concat(null!==(A=this.subgraph)&&void 0!==A?A:[])}clone(){const A={};for(const b in this.captureList)A[b]=w(this.captureList[b]);const M=new et(A,this.returnType,this.subgraph?w(this.subgraph.child):this.subgraph,this.generator);return this.cloneInto(M),M}}class nt extends m{constructor(A,M,b,E,D,U=!1){super(),this.token=A,this._children=M,this.isInfix=b,this.isPropertyAccess=E,this.returnType=D,this.isTernary=U,this.shaderType="function-node"}get children(){return this._children}clone(){const A=new nt(this.token,this._children.map(w),this.isInfix,this.isPropertyAccess,this.returnType,this.isTernary);return this.cloneInto(A),A}}},3902:(At,at,y)=>{y.d(at,{$5:()=>qe,$I:()=>$,AU:()=>vn,Ai:()=>qt,Bw:()=>pn,F8:()=>ye,Io:()=>Be,LC:()=>Ee,MM:()=>tn,My:()=>ft,Om:()=>he,PM:()=>ne,RI:()=>un,S8:()=>Te,Sj:()=>xe,T9:()=>mn,TF:()=>bn,Tk:()=>_e,U:()=>j,US:()=>Sn,Uo:()=>Ue,Wh:()=>yt,Xe:()=>Ht,ZY:()=>K,Zb:()=>zt,Zc:()=>Et,aX:()=>Le,eB:()=>W,eR:()=>gt,fV:()=>dt,gn:()=>we,j1:()=>me,jc:()=>hn,jh:()=>Xe,jk:()=>xn,ln:()=>Lt,mk:()=>on,nf:()=>Qt,nt:()=>mt,or:()=>Pe,qE:()=>an,tn:()=>Oe,w0:()=>Ft,x:()=>Vt,z7:()=>Pt,ze:()=>kt,zi:()=>Qe});var m,w,q,H,R,rt,Z,et,nt,k,A,M,b,E,v=y(8189),x=y(92779);function V(c){return new Proxy(c,{get(T,O){if("constructor"===O)return new Proxy(T.constructor,{construct:(it,Tt,Bt)=>V(new it(...Tt))});if(O in T)return T[O];if("string"==typeof O){const it=function F(c){const T=[["float","vec2","vec3","vec4"],["int","ivec2","ivec3","ivec4"],["uint","uvec2","uvec3","uvec4"],["bool","bvec2","bvec3","bvec4"]];for(const O of T)if(O.includes(c))return O.map(it=>lt[it]);throw new Error("Unable to find type family")}(c.type);return Nt(c,O,it[O.length-1])}}})}function st(c){return new Proxy(c,{construct:(T,O,it)=>V(new T(...O))})}class xt extends Error{}let ft=m=class extends x.vL{constructor(c,T){super(),this.elementType=c,this.size=T,this.children=[],this.type="array"}clone(){const c=new m(this.elementType,this.size);return super.cloneInto(c),c}get(c){if("number"==typeof c){const T=new qt(c);return T.isImplicit=!0,Nt(this,T,this.elementType.constructor)}return Nt(this,c,this.elementType.constructor)}last(){return this.get(this.size-1)}first(){return this.get(0)}findIndex(c,T,O){return function se(c,T,O=0,it=c.size){const Tt=new qt(O).setMutable().setDebugName("FindIndexIterator"),Bt=T(c.get(Tt)).setDebugName("FindIndexPredicate");return te({iter:Tt},qt,Bt,({out:a,iter:s,subgraph:o})=>`\n${a} = -1;\n\nfor (; ${s} < ${it}; ${s}++) {\n\n${o.body}\n\n  if (${o.varName}) {\n    ${a} = ${s};\n    break;\n  }\n\n}\n`).setDebugName("FindIndexBlock")}(this,c,T,O)}glslFindIndex(c,T,O){return function ae(c,T,O=0,it=c.size){return te({array:c},qt,null,({out:Bt,array:re})=>`\n${Bt} = -1;\nfor (int i = ${O}; i < ${it}; i++) {\n  bool condition;\n  ${T({array:re,i:"i",out:"condition"})}\n  if (condition) {\n    ${Bt} = i;\n    break;\n  }\n}\n`).setDebugName("GlslFindIndexBlock")}(this,c,T,O)}static ofType(c,T){const O={construct:(it,Tt)=>new m(new c,T)};return new Proxy(m,O)}};ft.type="array",ft=m=(0,v._)([function pt(c){return new Proxy(c,{construct:(T,O,it)=>function ot(c){return new Proxy(c,{get(T,O){if(O in T)return T[O];if("string"==typeof O){const it=parseInt(O,10);if(!isNaN(it))return Nt(c,`[${it}]`,c.elementType.constructor)}}})}(new T(...O))})}],ft);let Pt=(()=>{class c extends x.vL{constructor(){super(...arguments),this.type="sampler2D",this.children=[]}clone(){const O=new c;return O.children=this.children.map(x.vA),super.cloneInto(O),O}}return c.type="sampler2D",c})(),mt=(()=>{class c extends x.vL{constructor(O){super(),this.type="float",this.children=[O]}clone(){const O=new c((0,x.vA)(this.children[0]));return super.cloneInto(O),O}multiply(O){return ee(this,"number"==typeof O?Mt(O,c):O)}divide(O){return fe(this,"number"==typeof O?Mt(O,c):O)}add(O){return le(this,"number"==typeof O?Mt(O,c):O)}subtract(O){return ce(this,"number"==typeof O?Mt(O,c):O)}}return c.type="float",c})(),K=w=class extends x.vL{constructor(c,T){super(),this.type="vec2",this.children=[c,T].filter(O=>null!=O)}clone(){const c=new w((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]));return super.cloneInto(c),c}get 0(){return Nt(this,"[0]",mt)}get 1(){return Nt(this,"[1]",mt)}get 2(){throw new xt}get 3(){throw new xt}multiply(c){return ee(this,"number"==typeof c?Mt(c,mt):c)}divide(c){return fe(this,"number"==typeof c?Mt(c,mt):c)}add(c){return le(this,"number"==typeof c?Mt(c,mt):c)}subtract(c){return ce(this,"number"==typeof c?Mt(c,mt):c)}};K.type="vec2",K=w=(0,v._)([st],K);let W=q=class extends x.vL{constructor(c,T,O){super(),this.type="vec3",this.children=[c,T,O].filter(it=>null!=it)}get 0(){return Nt(this,"[0]",mt)}get 1(){return Nt(this,"[1]",mt)}get 2(){return Nt(this,"[2]",mt)}get 3(){throw new xt}clone(){const c=new q((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]));return super.cloneInto(c),c}multiply(c){return ee(this,"number"==typeof c?Mt(c,mt):c)}divide(c){return fe(this,"number"==typeof c?Mt(c,mt):c)}add(c){return le(this,"number"==typeof c?Mt(c,mt):c)}subtract(c){return ce(this,"number"==typeof c?Mt(c,mt):c)}};W.type="vec3",W=q=(0,v._)([st],W);let zt=H=class extends x.vL{constructor(c,T,O,it){super(),this.type="vec4",this.children=[c,T,O,it].filter(Tt=>null!=Tt)}clone(){const c=new H((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]),(0,x.vA)(this.children[3]));return super.cloneInto(c),c}get 0(){return Nt(this,"[0]",mt)}get 1(){return Nt(this,"[1]",mt)}get 2(){return Nt(this,"[2]",mt)}get 3(){return Nt(this,"[3]",mt)}multiply(c){return ee(this,"number"==typeof c?Mt(c,mt):c)}divide(c){return fe(this,"number"==typeof c?Mt(c,mt):c)}add(c){return le(this,"number"==typeof c?Mt(c,mt):c)}subtract(c){return ce(this,"number"==typeof c?Mt(c,mt):c)}};zt.type="vec4",zt=H=(0,v._)([st],zt);let Wt=R=class extends x.vL{constructor(c){super(),this.type="uint",this.children=[c]}clone(){const c=new R((0,x.vA)(this.children[0]));return super.cloneInto(c),c}};Wt.type="uint",Wt=R=(0,v._)([st],Wt);let vt=rt=class extends x.vL{constructor(c,T){super(),this.type="uvec2",this.children=[c,T].filter(O=>null!=O)}clone(){const c=new rt((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]));return super.cloneInto(c),c}};vt.type="uvec2",vt=rt=(0,v._)([st],vt);let Dt=Z=class extends x.vL{constructor(c,T,O){super(),this.type="uvec3",this.children=[c,T,O].filter(it=>null!=it)}clone(){const c=new Z((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]));return super.cloneInto(c),c}};Dt.type="uvec3",Dt=Z=(0,v._)([st],Dt);let It=et=class extends x.vL{constructor(c,T,O,it){super(),this.type="uvec4",this.children=[c,T,O,it].filter(Tt=>null!=Tt)}clone(){const c=new et((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]),(0,x.vA)(this.children[3]));return super.cloneInto(c),c}};It.type="uvec4",It=et=(0,v._)([st],It);let Vt=(()=>{class c extends x.vL{constructor(O){super(),this.type="bool",this.children=[O]}and(O){return Ue(this,O)}or(O){return Pe(this,O)}clone(){const O=new c((0,x.vA)(this.children[0]));return super.cloneInto(O),O}}return c.type="bool",c})(),Jt=nt=class extends x.vL{constructor(c,T){super(),this.type="bvec2",this.children=[c,T].filter(O=>null!=O)}all(){return be(this)}any(){return Ie(this)}clone(){const c=new nt((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]));return super.cloneInto(c),c}};Jt.type="bvec2",Jt=nt=(0,v._)([st],Jt);let Ot=k=class extends x.vL{constructor(c,T,O){super(),this.type="bvec3",this.children=[c,T,O].filter(it=>null!=it)}all(){return be(this)}any(){return Ie(this)}clone(){const c=new k((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]));return super.cloneInto(c),c}};function Mt(c,T){return"number"==typeof c?new T(c):c}Ot.type="bvec3",Ot=k=(0,v._)([st],Ot);let Rt=A=class extends x.vL{constructor(c,T,O,it){super(),this.type="bvec4",this.children=[c,T,O,it].filter(Tt=>null!=Tt)}all(){return be(this)}any(){return Ie(this)}clone(){const c=new A((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]),(0,x.vA)(this.children[3]));return super.cloneInto(c),c}};Rt.type="bvec4",Rt=A=(0,v._)([st],Rt);let qt=(()=>{class c extends x.vL{constructor(O){super(),this.type="int",this.children=[O]}multiply(O){return ee(this,Mt(O,c))}add(O){return le(this,Mt(O,c))}subtract(O){return ce(this,Mt(O,c))}divide(O){return fe(this,Mt(O,c))}clone(){const O=new c((0,x.vA)(this.children[0]));return super.cloneInto(O),O}}return c.type="int",c})(),ct=M=class extends x.vL{constructor(c,T){super(),this.type="ivec2",this.children=[c,T].filter(O=>null!=O)}clone(){const c=new M((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]));return super.cloneInto(c),c}};ct.type="ivec2",ct=M=(0,v._)([st],ct);let _=b=class extends x.vL{constructor(c,T,O){super(),this.type="ivec3",this.children=[c,T,O].filter(it=>null!=it)}clone(){const c=new b((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]));return super.cloneInto(c),c}};_.type="ivec3",_=b=(0,v._)([st],_);let g=E=class extends x.vL{constructor(c,T,O,it){super(),this.type="ivec4",this.children=[c,T,O,it].filter(Tt=>null!=Tt)}clone(){const c=new E((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]),(0,x.vA)(this.children[3]));return super.cloneInto(c),c}};g.type="ivec4",g=E=(0,v._)([st],g);let j=(()=>{class c extends x.vL{static identity(){return new c(1,0,0,0,1,0,0,0,1)}static fromRotation(O){const it=ye(O),Tt=we(O);return new c(Tt,it,0,kt(it),Tt,0,0,0,1)}constructor(O,it,Tt,Bt,re,a,s,o,h){super(),this.type="mat3",this.children=[O,it,Tt,Bt,re,a,s,o,h]}add(O){return le(this,O)}multiply(O){return ee(this,O)}clone(){const O=new c((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]),(0,x.vA)(this.children[3]),(0,x.vA)(this.children[4]),(0,x.vA)(this.children[5]),(0,x.vA)(this.children[6]),(0,x.vA)(this.children[7]),(0,x.vA)(this.children[8]));return super.cloneInto(O),O}}return c.type="mat3",c})(),$=(()=>{class c extends x.vL{static identity(){return new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}constructor(O,it,Tt,Bt,re,a,s,o,h,d,p,f,P,S,L,C){super(),this.type="mat4",this.children=[O,it,Tt,Bt,re,a,s,o,h,d,p,f,P,S,L,C]}static fromColumns(O,it,Tt,Bt){return new c(O.x,O.y,O.z,O.w,it.x,it.y,it.z,it.w,Tt.x,Tt.y,Tt.z,Tt.w,Bt.x,Bt.y,Bt.z,Bt.w)}multiply(O){return ee(this,O)}clone(){const O=new c((0,x.vA)(this.children[0]),(0,x.vA)(this.children[1]),(0,x.vA)(this.children[2]),(0,x.vA)(this.children[3]),(0,x.vA)(this.children[4]),(0,x.vA)(this.children[5]),(0,x.vA)(this.children[6]),(0,x.vA)(this.children[7]),(0,x.vA)(this.children[8]),(0,x.vA)(this.children[9]),(0,x.vA)(this.children[10]),(0,x.vA)(this.children[11]),(0,x.vA)(this.children[12]),(0,x.vA)(this.children[13]),(0,x.vA)(this.children[14]),(0,x.vA)(this.children[15]));return super.cloneInto(O),O}}return c.type="mat4",c})();const lt={float:mt,vec2:K,vec3:W,vec4:zt,int:qt,ivec2:ct,ivec3:_,ivec4:g,uint:Wt,uvec2:vt,uvec3:Dt,uvec4:It,bool:Vt,bvec2:Jt,bvec3:Ot,bvec4:Rt},yt=(...c)=>new qt(...c),dt=(...c)=>new mt(...c),Et=(...c)=>new K(...c),gt=(...c)=>new W(...c),Lt=(...c)=>new zt(...c),Ft=(...c)=>new j(...c);function Nt(c,T,O){const it=new O(new x.zg(T,c,O));return it.isImplicit=!0,it}function Ut(c,T,O,it=null){if(it){const Bt=new it,re=new it(new x.aw(c,[T,O],!0,!1,Bt));return re.isImplicit=!0,re}if("float"===T.type||"int"===T.type){const Bt=new O.constructor(new x.aw(c,[T,O],!0,!1,O.constructor));return Bt.isImplicit=!0,Bt}if(("mat2"===T.type||"mat3"===T.type||"mat4"===T.type)&&"float"!==O.type){const Bt=new O.constructor(new x.aw(c,[T,O],!0,!1,O.constructor));return Bt.isImplicit=!0,Bt}const Tt=new T.constructor(new x.aw(c,[T,O],!0,!1,T.constructor));return Tt.isImplicit=!0,Tt}function ut(c,T,O=T.constructor){const it=new O(new x.aw(c,[T],!1,!1,O));return it.isImplicit=!0,it}function Kt(c,T,O,it=T.constructor){const Tt=new it(new x.aw(c,[T,O],!1,!1,it));return Tt.isImplicit=!0,Tt}function Gt(c,T,O,it,Tt=T.constructor){const Bt=new Tt(new x.aw(c,[T,O,it],!1,!1,Tt));return Bt.isImplicit=!0,Bt}function kt(c){return ee(c,dt(-1))}function te(c,T,O,it){return new T(new x.rR(c,T,O,it))}function _e(c,T,O){const it="function"==typeof T?T():T,Tt="function"==typeof O?O():O,Bt=new it.constructor(new x.XL(c,it,Tt));return Bt.isImplicit=!0,Bt}function me(...c){const T=c.map(([a,s])=>"function"==typeof s?[a,s()]:[a,s]),O=T[0][1].constructor,it=T.findIndex(a=>!0===a[0]);if(-1===it)throw new Error("A cond must have a fallthrough case with `true`/; ");const re=new O(T.slice(0,it).reduceRight((a,s)=>_e(s[0],s[1],a),T[it][1]));return re.isImplicit=!0,re}function ee(c,T){return Ut("*",c,T)}function fe(c,T){return Ut("/",c,T)}function le(c,T){return Ut("+",c,T)}function ce(c,T){return Ut("-",c,T)}function xe(c,T){return Ut(">>",c,T)}function Qt(c,T){return Ut("&",c,T)}function Ee(c,T){return Ut("==",c,T,Vt)}function Ht(c,T){return Ut("<",c,T,Vt)}function qe(c,T){return Ut("<=",c,T,Vt)}function tn(c,T){return Ut(">",c,T,Vt)}function Le(c,T){return Ut(">=",c,T,Vt)}function Pe(...c){return c.length<=1?c[0]:c.slice(1).reduce((T,O)=>function Ge(c,T){return Ut("||",c,T,Vt)}(T,O),c[0])}function Ue(...c){return c.length<=1?c[0]:c.slice(1).reduce((T,O)=>function Re(c,T){return Ut("&&",c,T,Vt)}(T,O),c[0])}function Oe(c){return ut("abs",c)}function be(c){return ut("all",c,Vt)}function Ie(c){return ut("any",c,Vt)}function on(c){return ut("ceil",c)}function an(c,T,O){return Gt("clamp",c,T,O,c.constructor)}function we(c){return ut("cos",c)}function Be(c,T){return Kt("distance",c,T,mt)}function he(c,T){return Kt("dot",c,T,mt)}function un(c){return ut("floor",c)}function hn(c){return ut("fract",c)}function pn(c){return ut("length",c,mt)}function mn(c,T){return Kt("max",c,T)}function xn(c,T){return Kt("min",c,T)}function Xe(c,T,O){return Gt("mix",c,T,O)}function Qe(c,T){return Kt("mod",c,T)}function Te(c){return ut("normalize",c)}function vn(c){return ut("bool"===c.type?"!":"not",c)}function ye(c){return ut("sin",c)}function bn(c,T,O){return Gt("smoothstep",c,T,O)}function ne(c,T){return Kt("step",c,T,T.constructor)}function Sn(c,T){return Kt("texture2D",c,T,zt)}},93300:(At,at,y)=>{y.d(at,{c:()=>v});const v={bitset:{isSDF:0,isMapAligned:1,scaleSymbolsProportionally:2,overrideOutlineColor:3,colorLocked:4}}},73624:(At,at,y)=>{y.d(at,{Y:()=>Bt});var v=y(10467),x=y(3248),m=y(8897),q=(y(92405),y(91766)),H=y(13682),R=y(47669);function rt(a,s,o,h,d,p,f){Vt=0;const P=(h-o)*p,S=d&&d.length,L=S?(d[0]-o)*p:P;let C,B,G,z,tt,ht=Z(s,o,0,0,L,p,!0);if(ht&&ht.next!==ht.prev){if(S&&(ht=function D(a,s,o,h,d,p){const f=new Array;for(let P=0,S=h.length;P<S;P++){const L=Z(a,s,0,h[P]*p,P<S-1?h[P+1]*p:o*p,p,!1);L===L.next&&(L.steiner=!0),f.push(E(L))}f.sort(Pt);for(const P of f)d=U(P,d);return d}(s,o,h,d,ht,p)),P>80*p){C=G=s[0+o*p],B=z=s[1+o*p];for(let _t=p;_t<L;_t+=p){const St=s[_t+o*p],Ct=s[_t+1+o*p];C=Math.min(C,St),B=Math.min(B,Ct),G=Math.max(G,St),z=Math.max(z,Ct)}tt=Math.max(G-C,z-B),tt=0!==tt?1/tt:0}nt(ht,a,p,C,B,tt,f,0)}}function Z(a,s,o,h,d,p,f){let P;if(f===function st(a,s,o,h,d,p){let f=0;for(let P=h,S=d-p;P<d;P+=p)f+=(a[S+s*p]-a[P+s*p])*(a[P+1+s*p]+a[S+1+s*p]),S=P;return f}(a,s,0,h,d,p)>0)for(let S=h;S<d;S+=p)P=M(S+s*p,a[S+s*p],a[S+1+s*p],P);else for(let S=d-p;S>=h;S-=p)P=M(S+s*p,a[S+s*p],a[S+1+s*p],P);return P&&ft(P,P.next)&&(b(P),P=P.next),P}function et(a,s=a){if(!a)return a;let o,h=a;do{if(o=!1,h.steiner||!ft(h,h.next)&&0!==N(h.prev,h,h.next))h=h.next;else{if(b(h),h=s=h.prev,h===h.next)break;o=!0}}while(o||h!==s);return s}function nt(a,s,o,h,d,p,f,P){if(!a)return;!P&&p&&(a=Q(a,h,d,p));let S=a;for(;a.prev!==a.next;){const L=a.prev,C=a.next;if(p?A(a,h,d,p):k(a))s.push(L.index/o+f),s.push(a.index/o+f),s.push(C.index/o+f),b(a),a=C.next,S=C.next;else if((a=C)===S){P?1===P?nt(a=mt(a,s,o,f),s,o,h,d,p,f,2):2===P&&K(a,s,o,h,d,p,f):nt(et(a),s,o,h,d,p,f,1);break}}}function k(a){const s=a.prev,o=a,h=a.next;if(N(s,o,h)>=0)return!1;let d=a.next.next;const p=d;let f=0;for(;d!==a.prev&&(0===f||d!==p);){if(f++,ot(s.x,s.y,o.x,o.y,h.x,h.y,d.x,d.y)&&N(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function A(a,s,o,h){const d=a.prev,p=a,f=a.next;if(N(d,p,f)>=0)return!1;const L=d.x>p.x?d.x>f.x?d.x:f.x:p.x>f.x?p.x:f.x,C=d.y>p.y?d.y>f.y?d.y:f.y:p.y>f.y?p.y:f.y,B=xt(d.x<p.x?d.x<f.x?d.x:f.x:p.x<f.x?p.x:f.x,d.y<p.y?d.y<f.y?d.y:f.y:p.y<f.y?p.y:f.y,s,o,h),G=xt(L,C,s,o,h);let z=a.prevZ,tt=a.nextZ;for(;z&&z.z>=B&&tt&&tt.z<=G;){if(z!==a.prev&&z!==a.next&&ot(d.x,d.y,p.x,p.y,f.x,f.y,z.x,z.y)&&N(z.prev,z,z.next)>=0||(z=z.prevZ,tt!==a.prev&&tt!==a.next&&ot(d.x,d.y,p.x,p.y,f.x,f.y,tt.x,tt.y)&&N(tt.prev,tt,tt.next)>=0))return!1;tt=tt.nextZ}for(;z&&z.z>=B;){if(z!==a.prev&&z!==a.next&&ot(d.x,d.y,p.x,p.y,f.x,f.y,z.x,z.y)&&N(z.prev,z,z.next)>=0)return!1;z=z.prevZ}for(;tt&&tt.z<=G;){if(tt!==a.prev&&tt!==a.next&&ot(d.x,d.y,p.x,p.y,f.x,f.y,tt.x,tt.y)&&N(tt.prev,tt,tt.next)>=0)return!1;tt=tt.nextZ}return!0}function M(a,s,o,h){const d=vt.create(a,s,o);return h?(d.next=h.next,d.prev=h,h.next.prev=d,h.next=d):(d.prev=d,d.next=d),d}function b(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function E(a){let s=a,o=a;do{(s.x<o.x||s.x===o.x&&s.y<o.y)&&(o=s),s=s.next}while(s!==a);return o}function U(a,s){const o=function X(a,s){let o=s;const h=a.x,d=a.y;let p,f=-1/0;do{if(d<=o.y&&d>=o.next.y&&o.next.y!==o.y){const G=o.x+(d-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(G<=h&&G>f){if(f=G,G===h){if(d===o.y)return o;if(d===o.next.y)return o.next}p=o.x<o.next.x?o:o.next}}o=o.next}while(o!==s);if(!p)return null;if(h===f)return p.prev;const P=p,S=p.x,L=p.y;let C,B=1/0;for(o=p.next;o!==P;)h>=o.x&&o.x>=S&&h!==o.x&&ot(d<L?h:f,d,S,L,d<L?f:h,d,o.x,o.y)&&(C=Math.abs(d-o.y)/(h-o.x),(C<B||C===B&&o.x>p.x)&&pt(o,a)&&(p=o,B=C)),o=o.next;return p}(a,s);if(!o)return s;const h=Wt(o,a);return et(h,h.next),et(o,o.next)}function Q(a,s,o,h){let d;for(;d!==a;d=d.next){if(d=d||a,null===d.z&&(d.z=xt(d.x,d.y,s,o,h)),d.prev.next!==d||d.next.prev!==d)return d.prev.next=d,d.next.prev=d,Q(a,s,o,h);d.prevZ=d.prev,d.nextZ=d.next}return a.prevZ.nextZ=null,a.prevZ=null,function J(a){let s,o=1;for(;;){let h,d=a;a=null,s=null;let p=0;for(;d;){p++,h=d;let f=0;for(;f<o&&h;f++)h=h.nextZ;let P=o;for(;f>0||P>0&&h;){let S;0===f?(S=h,h=h.nextZ,P--):0!==P&&h?d.z<=h.z?(S=d,d=d.nextZ,f--):(S=h,h=h.nextZ,P--):(S=d,d=d.nextZ,f--),s?s.nextZ=S:a=S,S.prevZ=s,s=S}d=h}if(s.nextZ=null,o*=2,p<2)return a}}(a)}function N(a,s,o){return(s.y-a.y)*(o.x-s.x)-(s.x-a.x)*(o.y-s.y)}function F(a,s,o,h){return!!(ft(a,s)&&ft(o,h)||ft(a,h)&&ft(o,s))||N(a,s,o)>0!=N(a,s,h)>0&&N(o,h,a)>0!=N(o,h,s)>0}function ot(a,s,o,h,d,p,f,P){return(d-f)*(s-P)-(a-f)*(p-P)>=0&&(a-f)*(h-P)-(o-f)*(s-P)>=0&&(o-f)*(p-P)-(d-f)*(h-P)>=0}function pt(a,s){return N(a.prev,a,a.next)<0?N(a,s,a.next)>=0&&N(a,a.prev,s)>=0:N(a,s,a.prev)<0||N(a,a.next,s)<0}function xt(a,s,o,h,d){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-o)*d)|a<<8))|a<<4))|a<<2))|a<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(s-h)*d)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function ft(a,s){return a.x===s.x&&a.y===s.y}function Pt(a,s){return a.x-s.x}function mt(a,s,o,h){let d=a;do{const p=d.prev,f=d.next.next;!ft(p,f)&&F(p,d,d.next,f)&&pt(p,f)&&pt(f,p)&&(s.push(p.index/o+h),s.push(d.index/o+h),s.push(f.index/o+h),b(d),b(d.next),d=a=f),d=d.next}while(d!==a);return d}function K(a,s,o,h,d,p,f){let P=a;do{let S=P.next.next;for(;S!==P.prev;){if(P.index!==S.index&&W(P,S)){let L=Wt(P,S);return P=et(P,P.next),L=et(L,L.next),nt(P,s,o,h,d,p,f,0),void nt(L,s,o,h,d,p,f,0)}S=S.next}P=P.next}while(P!==a)}function W(a,s){return a.next.index!==s.index&&a.prev.index!==s.index&&!function V(a,s){let o=a;do{if(o.index!==a.index&&o.next.index!==a.index&&o.index!==s.index&&o.next.index!==s.index&&F(o,o.next,a,s))return!0;o=o.next}while(o!==a);return!1}(a,s)&&pt(a,s)&&pt(s,a)&&function zt(a,s){let o=a,h=!1;const d=(a.x+s.x)/2,p=(a.y+s.y)/2;do{o.y>p!=o.next.y>p&&o.next.y!==o.y&&d<(o.next.x-o.x)*(p-o.y)/(o.next.y-o.y)+o.x&&(h=!h),o=o.next}while(o!==a);return h}(a,s)}function Wt(a,s){const o=vt.create(a.index,a.x,a.y),h=vt.create(s.index,s.x,s.y),d=a.next,p=s.prev;return a.next=s,s.prev=a,o.next=d,d.prev=o,h.next=o,o.prev=h,p.next=h,h.prev=p,h}class vt{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(s,o,h){const d=Vt<Dt.length?Dt[Vt++]:new vt;return d.index=s,d.x=o,d.y=h,d.prev=null,d.next=null,d.z=null,d.prevZ=null,d.nextZ=null,d.steiner=!1,d}}const Dt=[];let Vt=0;for(let a=0;a<8096;a++)Dt.push(new vt);const Ot=new q.O3(0,0,0,1,0),Mt=new q.O3(0,0,0,1,0);function Rt(a,s,o){let h=0;for(let d=1;d<o;d++)h+=(a[2*(s+d)]-a[2*(s+d-1)])*(a[2*(s+d)+1]+a[2*(s+d-1)+1]);return h}function qt(a,s,o,h,d){let p=0;for(let P=o;P<h;P+=3){const S=2*(a[P]-d),L=2*(a[P+1]-d),C=2*(a[P+2]-d);p+=Math.abs((s[S]-s[C])*(s[L+1]-s[S+1])-(s[S]-s[L])*(s[C+1]-s[S+1]))}return p}function j(a,s){if(null==a)return null;if(!function I(a,s,o){let h=0;for(let d=0;d<a.lengths.length;d++){const p=a.lengths[d];for(let f=0;f<p;f++){const P=a.coords[2*(f+h)],S=a.coords[2*(f+h)+1];if(P<s||P>o||S<s||S>o)return!0}h+=p}return!1}(a,-128,R.CQ+128))return a;Ot.setPixelMargin(s),Ot.reset(q.dC.Polygon);let o=0;for(let f=0;f<a.lengths.length;f++){const P=a.lengths[f];let S=a.coords[2*(0+o)],L=a.coords[2*(0+o)+1];Ot.moveTo(S,L);for(let C=1;C<P;C++)S=a.coords[2*(C+o)],L=a.coords[2*(C+o)+1],Ot.lineTo(S,L);Ot.close(),o+=P}const h=Ot.result(!1);if(!h)return null;const d=[],p=[];for(const f of h){let P=0;for(const S of f)p.push(S.x),p.push(S.y),P++;d.push(P)}return new H.A(d,p)}Ot.setExtent(R.CQ),Mt.setExtent(R.CQ);var lt=y(72137),yt=y(10223);let dt=null;function Et(){return dt}function Lt(){return(Lt=(0,v.A)(function*(){dt=yield Promise.all([y.e(3930),y.e(2076),y.e(2296)]).then(y.bind(y,27815))})).apply(this,arguments)}var wt=y(97550),Ft=y(1416),Y=y(50915);function Nt(a){switch(a){case Y.pe.BYTE:case Y.pe.UNSIGNED_BYTE:return 1;case Y.pe.SHORT:case Y.pe.UNSIGNED_SHORT:return 2;case Y.pe.FLOAT:case Y.pe.INT:case Y.pe.UNSIGNED_INT:return 4}}class ut{static fromVertexSpec({attributes:s},o){let h,d,p;const f=[];for(const z in s){const tt=s[z];!1!==(null==o?void 0:o[z])&&("position"===tt.pack?h={...tt,name:z,offset:0}:"id"===tt.pack?d={...tt,name:z,offset:4}:"bitset"===z?p={...tt,name:z,offset:7}:f.push({...tt,name:z}))}const P=function Ut(a){const s=[],o=[],h=[];for(const d of a){const p=Nt(d.type)*d.count;switch(p%2||p%4||4){case 4:s.push(d);continue;case 2:o.push(d);continue;case 1:h.push(d);continue;default:throw new Error("Found unexpected dataType byte count")}}return s.push(...o),s.push(...h),s}(f),S=[];let L=8,C=1;for(const z of P)S.push({...z,offset:L}),L+=Nt(z.type)*z.count,z.packAlternating&&(C=Math.max(z.packAlternating.count,C));const B=Uint32Array.BYTES_PER_ELEMENT,G=L%B;return new ut(h,d,p,S,L+(G?B-G:0),C)}constructor(s,o,h,d,p,f){this.position=s,this.id=o,this.bitset=h,this.standardAttributes=d,this.stride=p,this.packVertexCount=f,d.push(h),this._attributes=[s,o,h,...d]}get attributeLayout(){if(!this._attributeLayout){const s=(0,Ft.hU)(this._attributes),o=this._attributes.map(h=>{var d;return{name:h.name,count:h.count,offset:h.offset,type:h.type,packPrecisionFactor:h.packPrecisionFactor,normalized:null!==(d=h.normalized)&&void 0!==d&&d}});this._attributeLayout={attributes:o,hash:s,stride:this.stride}}return this._attributeLayout}}var Kt=y(73991);class Gt{static fromVertexSpec(s,o){const h=ut.fromVertexSpec(s,o);return new Gt(h)}constructor(s){this._spec=s,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(s,o,h,d,p,f){for(let S=0;S<this._spec.packVertexCount;S++){const L=S*this._spec.stride;this._packPosition(h,d,L),this._packId(o,L);const C=this._spec.bitset;if(f){if(C.packTessellation){const B=C.packTessellation(f,p);this._pack(B,C,L)}for(const B of this._spec.standardAttributes){var P;if(null!=B.packTessellation){const G=B.packTessellation(f,p);this._pack(G,B,L)}else if(null!==(P=B.packAlternating)&&void 0!==P&&P.packTessellation){const G=B.packAlternating.packTessellation(f,p);for(let z=0;z<this._spec.packVertexCount;z++)this._pack(G[z],B,z*this._spec.stride)}}}}s.vertexWriteRegion(this._packedU32View)}pack(s,o){for(const d of this._spec.standardAttributes){var h;if(d.pack&&"string"!=typeof d.pack){const p=d.pack(s,o);for(let f=0;f<this._spec.packVertexCount;f++)this._pack(p,d,f*this._spec.stride)}else if(null!==(h=d.packAlternating)&&void 0!==h&&h.pack){const p=d.packAlternating.pack(s,o);for(let f=0;f<this._spec.packVertexCount;f++)this._pack(p[f],d,f*this._spec.stride)}}}_packPosition(s,o,h){var d;const{offset:p}=this._spec.position,f=null!==(d=this._spec.position.packPrecisionFactor)&&void 0!==d?d:1,P=(0,wt.M9)(s*f,o*f);this._dataView.setUint32(h+p,P,!0)}_packId(s,o){var h;const d=s*(null!==(h=this._spec.id.packPrecisionFactor)&&void 0!==h?h:1),p=4278190080&this._dataView.getUint32(o+this._spec.id.offset,!0);this._dataView.setUint32(o+this._spec.id.offset,d|p,!0)}_pack(s,o,h){(0,Kt.F)(this._dataView,s,o,h)}}class te{constructor(s,o,h,d){this._instanceId=s,this._evaluator=o,this._viewParams=h,this._optionalAttributes=d,this._evaluator.evaluator=p=>this.vertexSpec.createComputedParams(p)}get _vertexPack(){if(!this._cachedVertexPack){const s=Gt.fromVertexSpec(this.vertexSpec,this._optionalAttributes);this._evaluator.hasDynamicProperties||s.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=s}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return!!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}setReferences(s){this._references=s}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}loadDependencies(){var s=this;return(0,v.A)(function*(){var o;(function kt(a){if(!a)return!1;for(const s of a)switch(s.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1})(null===(o=s._evaluator.inputMeshParams.params.effects)||void 0===o?void 0:o.effectInfos)&&(yield function gt(){return Lt.apply(this,arguments)}())})()}enqueueRequest(s,o,h){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(s,o,h)}write(s,o,h,d,p){var f;this.ensurePacked(o,h,d);const P=this.evaluatedMeshParams.effects;if(!P||0===P.length)return void this._write(s,h,void 0,p);const S=null===(f=h.readGeometryForDisplay())||void 0===f?void 0:f.clone();if(!S)return;const L=lt.z.fromOptimizedCIM(S,h.geometryType),C=Et();L.invertY();const G=yt.V.executeEffects(P,L,s.id||"",C);let z;for(;z=G.next();)z.invertY(),this._write(s,h,z,p)}ensurePacked(s,o,h){if(!this._evaluator.hasDynamicProperties)return;const d=this._evaluator.evaluateMeshParams(s,o,h);this._vertexPack.pack(d,this._viewParams)}_writeVertex(s,o,h,d,p){this._vertexPack.writeVertex(s,o,h,d,this.evaluatedMeshParams,p)}}const se=(0,x.A)("featurelayer-fast-triangulation-enabled");class ae extends te{loadDependencies(){var s=()=>super.loadDependencies,o=this;return(0,v.A)(function*(){yield Promise.all([s().call(o),(0,m.F)()])})()}_write(s,o,h){var d;const p=null!==(d=null==h?void 0:h.asOptimized())&&void 0!==d?d:o.readGeometryForDisplay(),f=this._clip(p);f&&(s.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(s,o,f),s.recordEnd())}_clip(s){return s?j(s,this.hasEffects?256:8):null}_writeGeometry(s,o,h){const d=h.maxLength>100,p=[],f=this.createTesselationParams(o);if(!d&&se&&function ct(a,s){const{coords:o,lengths:h,hasIndeterminateRingOrder:d}=s,f=a;if(d)return!1;let P=0;for(let S=0;S<h.length;){let L=S,C=h[S],B=Rt(o,P,C);const G=[];for(;++L<h.length;){const _t=h[L],St=Rt(o,P+C,_t);if(!(St>0))break;B+=St,G.push(P+C),C+=_t}const z=f.length;rt(f,o,P,P+C,G,2,0);const tt=qt(f,o,z,f.length,0),ht=Math.abs(B);if(Math.abs((tt-ht)/Math.max(1e-7,ht))>1e-5)return f.length=0,!1;S=L,P+=C}return!0}(p,h))return void(p.length&&this._writeVertices(s,o,h.coords,f,p));const P=function g(a){const{coords:s,lengths:o}=a,{buffer:h}=(0,m.l)(s,o);return h}(h);this._writeVertices(s,o,P,f)}_writeVertices(s,o,h,d,p){const f=o.getDisplayId(),P=s.vertexCount(),S=this.hasEffects;let L=0;if(p)for(const C of p){const B=h[2*C],G=h[2*C+1];S&&s.recordBounds(B,G,0,0),this._writeVertex(s,f,B,G,d),L++}else for(let C=0;C<h.length;C+=2){const B=Math.round(h[C]),G=Math.round(h[C+1]);S&&s.recordBounds(B,G,0,0),this._writeVertex(s,f,B,G,d),L++}s.indexEnsureSize(L);for(let C=0;C<L;C++)s.indexWrite(C+P)}}const _e={createComputedParams:a=>a,attributes:{id:{type:Y.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.pe.UNSIGNED_BYTE,count:1},pos:{type:Y.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:Y.pe.FLOAT,count:1,packTessellation:({inverseArea:a})=>a}}};var bt=y(67685),ee=y(4139),fe=y(68677),le=y(5922),ce=y(35150),Zt=y(65374);function Me(a,s){return[!(null==a||!a.minScale)&&s.scaleToZoom(a.minScale)||0,!(null==a||!a.maxScale)&&s.scaleToZoom(a.maxScale)||100]}function Ee(a){return 1<<a}function De(a){let s=0;for(const[o,h]of a)h&&(s|=1<<o);return s}function Ht(a){let s;if(!a)return[0,0,0,0];if("string"==typeof a){const f=fe.A.fromString(a);if(!f)return ce.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils").errorOnce(new le.A("mapview:mesh-processing","Unable to parse string into color",{color:a})),[0,0,0,0];s=f.toArray()}else s=a;const[o,h,d,p]=s;return[o*(p/255),h*(p/255),d*(p/255),p]}function Le(a,s){return Math.round(Math.min(Math.sqrt(a*s),255))}function Pe(a,s){return Math.round(a*s)/s}function Ge(a,s){return Math.ceil(a*s)/s}const Ue={createComputedParams:a=>a,attributes:{id:{type:Y.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.pe.UNSIGNED_BYTE,count:1},pos:{type:Y.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},zoomRange:{type:Y.pe.SHORT,count:2,packPrecisionFactor:R.fq,pack:({scaleInfo:a},{tileInfo:s})=>Me(a,s)},color:{type:Y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:a})=>Ht(a)}}};class Re extends ae{constructor(){super(...arguments),this.vertexSpec=Ue}createTesselationParams(s){return null}}const Oe={createComputedParams:a=>a,attributes:{...Ue.attributes,tlbr:{count:4,type:Y.pe.UNSIGNED_SHORT,pack:({sprite:a})=>{const{rect:s,width:o,height:h}=a,d=s.x+R.hM,p=s.y+R.hM;return[d,p,d+o,p+h]}},inverseRasterizationScale:{count:1,type:Y.pe.BYTE,packPrecisionFactor:16,pack:({sprite:a})=>1/a.rasterizationScale}}};class en extends Re{constructor(){super(...arguments),this.vertexSpec=Oe}_write(s,o,h){var d,p;const f=null!==(d=null==h?void 0:h.asOptimized())&&void 0!==d?d:o.readGeometryForDisplay(),P=this._clip(f);if(!P)return;const S=null===(p=this.evaluatedMeshParams.sprite)||void 0===p?void 0:p.textureBinding;s.recordStart(this.instanceId,this.attributeLayout,S),this._writeGeometry(s,o,P),s.recordEnd()}}var ue=y(90731);function be(a){const{sprite:s,aspectRatio:o,scaleProportionally:h}=a,d=(0,bt.Lz)(a.height);let f=d*o;return f<=0?f=s.width:h&&(f*=s.width/s.height),{width:f,height:d>0?d:s.height}}function Ie(a){const{applyRandomOffset:s,sampleAlphaOnly:o}=a,{width:h,height:d}=be(a);return De([[ue.Fz,s],[ue.cn,o],[ue.A,h<R.Tv],[ue.lx,d<R.Tv]])}function nn(a){const{width:s}=be(a);return Math.round(s<R.Tv?s*R.bg:s)}function rn(a){const{height:s}=be(a);return Math.round(s<R.Tv?s*R.bg:s)}const sn={createComputedParams:a=>a,attributes:{...Oe.attributes,bitset:{count:1,type:Y.pe.UNSIGNED_BYTE,pack:Ie},width:{count:1,type:Y.pe.UNSIGNED_SHORT,pack:nn},height:{count:1,type:Y.pe.UNSIGNED_SHORT,pack:rn},offset:{count:2,type:Y.pe.SHORT,pack:({offsetX:a,offsetY:s})=>[(0,bt.Lz)(a),-(0,bt.Lz)(s)]},scale:{count:2,type:Y.pe.UNSIGNED_BYTE,packPrecisionFactor:16,pack:({scaleX:a,scaleY:s})=>[a,s]},angle:{count:1,type:Y.pe.UNSIGNED_BYTE,pack:({angle:a})=>(0,ee.wV)(a)}}};var on=y(7933);class an{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0}}const we={createComputedParams:a=>a,attributes:{id:{type:Y.pe.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:Y.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:Y.pe.UNSIGNED_BYTE,count:1},zoomRange:{type:Y.pe.SHORT,count:2,packPrecisionFactor:R.fq,pack:({scaleInfo:a},{tileInfo:s})=>Me(a,s)},color:{type:Y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:a})=>Ht(a)},offset:{type:Y.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({extrusionOffsetX:a,extrusionOffsetY:s})=>[Pe(a,16),Pe(s,16)]},normal:{type:Y.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({normalX:a,normalY:s})=>[Pe(a,16),Pe(s,16)]},halfWidth:{type:Y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:16,pack:({width:a})=>Ge((0,bt.Lz)(.5*a),16)},referenceHalfWidth:{type:Y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:16,pack:({referenceWidth:a})=>Ge((0,bt.Lz)(.5*a),16)}}};class Cn{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0}}class Ye extends te{constructor(s,o,h,d){super(s,o,h,d),this.vertexSpec=we,this._currentWrite=new Cn,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:65535,textured:!1},this._tessParams=new an,this._initializeTessellator()}writeLineVertices(s,o,h){const d=this._getLines(o);null!=d&&this._writeVertices(s,h,d)}_initializeTessellator(){this._lineTessellator=new on.i(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0)}_write(s,o,h){const d=null!=h?h:lt.z.fromFeatureSetReaderCIM(o);d&&this._writeGeometry(s,o,d)}_writeGeometry(s,o,h,d){s.recordStart(this.instanceId,this.attributeLayout,d),this.writeLineVertices(s,h,o),s.recordEnd()}_getLines(s){return function $(a,s){Mt.setPixelMargin(s);const o=Mt,h=-s,d=R.CQ+s;let p=[],f=!1;if(!a.nextPath())return null;let P=!0;for(;P;){a.seekPathStart();const S=[];if(!a.pathSize)return null;o.reset(q.dC.LineString),a.nextPoint();let L=a.x,C=a.y;if(f)o.moveTo(L,C);else{if(L<h||L>d||C<h||C>d){f=!0;continue}S.push({x:L,y:C})}let B=!1;for(;a.nextPoint();)if(L=a.x,C=a.y,f)o.lineTo(L,C);else{if(L<h||L>d||C<h||C>d){B=!0;break}S.push({x:L,y:C})}if(B)f=!0;else{if(f){const G=o.resultWithStarts();if(G)for(const z of G)p.push(z)}else p.push({line:S,start:0});P=a.nextPath(),f=!1}}return p=p.filter(S=>S.line.length>1),0===p.length?null:p}(s,(0,Ft.Z0)(this.evaluatedMeshParams))}_writeVertices(s,o,h){const{_currentWrite:d,_tessellationOptions:p,evaluatedMeshParams:f}=this,{width:P,capType:S,joinType:L,miterLimit:C,hasSizeVV:B}=f,G=(0,bt.Lz)(.5*P);p.halfWidth=G,p.capType=function qe(a){switch(a){case"butt":case Zt.uT.Butt:return Zt.xR.BUTT;case"round":case Zt.uT.Round:return Zt.xR.ROUND;case"square":case Zt.uT.Square:return Zt.xR.SQUARE}}(S),p.joinType=function tn(a){switch(a){case"bevel":case Zt.wd.Bevel:return Zt.JO.BEVEL;case"miter":case Zt.wd.Miter:return Zt.JO.MITER;case"round":case Zt.wd.Round:return Zt.JO.ROUND}}(L),p.miterLimit=C;const z=!B;d.out=s,d.id=o.getDisplayId(),d.vertexCount=0,d.indexCount=0,d.vertexFrom=s.vertexCount(),d.vertexBounds=z&&G<R.Gh?0:1;for(const{line:tt,start:ht}of h)p.initialDistance=ht%65535,this._lineTessellator.tessellate(tt,p,z)}_writeTesselatedVertex(s,o,h,d,p,f,P,S,L,C,B){const{out:G,id:z,vertexBounds:tt}=this._currentWrite;return this.hasEffects&&G.recordBounds(s,o,tt,tt),this._tessParams.extrusionOffsetX=P,this._tessParams.extrusionOffsetY=S,this._tessParams.normalX=L,this._tessParams.normalY=C,this._tessParams.directionX=p,this._tessParams.directionY=f,this._tessParams.distance=B,this._writeVertex(G,z,s,o,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(s,o,h){const{out:d}=this._currentWrite;d.indexEnsureSize(3),d.indexWrite(s),d.indexWrite(o),d.indexWrite(h),this._currentWrite.indexCount+=3}}const cn={createComputedParams:a=>a,attributes:{...we.attributes,bitset:{type:Y.pe.UNSIGNED_BYTE,count:1,pack:a=>0},color:{type:Y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:a})=>Ht(a)}}},Ze={createComputedParams:a=>a,attributes:{...we.attributes,bitset:{type:Y.pe.UNSIGNED_BYTE,count:1,pack:a=>De([[ue.Xx,!0]])},color:{type:Y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:a})=>Ht(a)}}};class He extends Ye{constructor(){super(...arguments),this.vertexSpec=Ze}}class Be extends Re{constructor(s,o,h,d){super(s,o,h,d),this.vertexSpec=cn,this._lineMeshWriter=this._createOutlineWriter(s,o,h,d)}_createOutlineWriter(s,o,h,d){return new He(s,o,h,d)}_write(s,o,h){var d;const p=null!==(d=null==h?void 0:h.asOptimized())&&void 0!==d?d:o.readGeometryForDisplay(),f=this._clip(p);f&&(s.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(s,o,f),this._lineMeshWriter.writeLineVertices(s,lt.z.fromOptimizedCIM(f,"esriGeometryPolyline"),o),s.recordEnd())}_clip(s){return s?j(s,(0,Ft.Z0)(this.evaluatedMeshParams)):null}ensurePacked(s,o,h){super.ensurePacked(s,o,h),this._lineMeshWriter.ensurePacked(s,o,h)}enqueueRequest(s,o,h){super.enqueueRequest(s,o,h),this._lineMeshWriter.enqueueRequest(s,o,h)}loadDependencies(){var s=()=>super.loadDependencies,o=this;return(0,v.A)(function*(){yield Promise.all([s().call(o),o._lineMeshWriter.loadDependencies()])})()}}var he=y(80302);const de=sn.attributes,Un={createComputedParams:a=>a,attributes:{id:de.id,pos:de.pos,zoomRange:de.zoomRange,tlbr:de.tlbr,angle:de.angle,color:de.color,bitset:{type:Y.pe.UNSIGNED_BYTE,count:1,pack:a=>Ie(a)},aux1:{count:1,type:Y.pe.UNSIGNED_SHORT,pack:a=>nn(a)},aux2:{count:1,type:Y.pe.UNSIGNED_SHORT,pack:a=>rn(a)},aux3:{count:2,type:Y.pe.SHORT,pack:({offsetX:a,offsetY:s})=>[(0,bt.Lz)(a),(0,bt.Lz)(s)]},aux4:{count:2,type:Y.pe.UNSIGNED_BYTE,pack:({scaleX:a,scaleY:s})=>[a*he.cZ,s*he.cZ]}}},Rn={createComputedParams:a=>a,attributes:{id:de.id,pos:de.pos,zoomRange:de.zoomRange,tlbr:de.tlbr,angle:de.angle,color:Ze.attributes.color,bitset:{type:Y.pe.UNSIGNED_BYTE,count:1,pack:a=>De([[ue.Xx,!0]])},aux1:{count:1,type:Y.pe.UNSIGNED_SHORT,pack:a=>(0,bt.Lz)(.5*a.width)*he.cZ},aux2:{count:1,type:Y.pe.UNSIGNED_SHORT,pack:a=>(0,bt.Lz)(.5*a.referenceWidth)*he.cZ},aux3:{count:2,type:Y.pe.SHORT,packTessellation:({extrusionOffsetX:a,extrusionOffsetY:s})=>[a*he.cZ,s*he.cZ]},aux4:{count:2,type:Y.pe.UNSIGNED_BYTE,packTessellation:({normalX:a,normalY:s})=>[a*he.cZ+he.v9,s*he.cZ+he.v9]}}};class Bn extends He{constructor(){super(...arguments),this.vertexSpec=Rn}}const zn={createComputedParams:a=>a,attributes:{...Oe.attributes,...cn.attributes}},Fn={createComputedParams:a=>a,attributes:{...Oe.attributes,...Ze.attributes}};class un extends He{constructor(){super(...arguments),this.vertexSpec=Fn}}const Nn={createComputedParams:a=>a,attributes:{pos:{type:Y.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:Y.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.pe.UNSIGNED_BYTE,count:1},offset:{type:Y.pe.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};var Vn=y(60797),Ae=y(76329),dn=y(3672),We=y(30365),ze=y(53212),pn=y(21260),Fe=y(23855),ve=y(84289);function _n(a,s,o){return a[0]=s[0]-o[0],a[1]=s[1]-o[1],a}function fn(a,s){return Math.sqrt(a*a+s*s)}function yn(a){const s=fn(a[0],a[1]);a[0]/=s,a[1]/=s}function mn(a,s){return fn(a[0]-s[0],a[1]-s[1])}function Xe(a){return a.length-1}function Kn(a,s,o=1){let[h,d]=function xn(a,s){return a[s+1]}(a,s);return[h,d]=[Math.round(h),Math.round(d)],Math.sqrt(h*h+d*d)*o}class Te{constructor(s,o,h,d,p){this._segments=s,this._index=o,this._distance=h,this._xStart=d,this._yStart=p,this._done=!1}static create(s){return new Te(s,0,0,s[0][0],s[0][1])}clone(){return new Te(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(s){return this._index===s._index||s._index===this._index-1&&(0===this._distance||1===s._distance)||s._index===this._index+1&&(1===this._distance||0===s._distance)}leq(s){return this._index<s._index||this._index===s._index&&this._distance<=s._distance}geq(s){return this._index>s._index||this._index===s._index&&this._distance>=s._distance}get _segment(){return this._segments[this._index+1]}get angle(){const s=this.dy;let h=Math.acos((0*s+-1*-this.dx)/(1*this.length));return s>0&&(h=2*Math.PI-h),h}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:s,dy:o}=this;return Math.sqrt(s*s+o*o)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<Xe(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(s,o){const h=this.backwardLength;if(s<=h)return this._distance=(h-s)/this.length,this;let d=this.backwardLength;for(;this.prev();){if(d+this.length>s)return this._seekBackwards(s-d);d+=this.length}return this._distance=0,o?this:null}seek(s,o=!1){if(s<0)return this._seekBackwards(Math.abs(s),o);if(s<=this.remainingLength)return this._distance=(this.backwardLength+s)/this.length,this;let h=this.remainingLength;for(;this.next();){if(h+this.length>s)return this.seek(s-h,o);h+=this.length}return this._distance=1,o?this:null}}function vn(a,s,o,h=!0){const d=function Qe(a){let s=0;for(let o=0;o<Xe(a);o++)s+=Kn(a,o);return s}(a),p=Te.create(a),f=d/2;if(!h)return p.seek(f),void(Math.abs(p.x)<ve.s&&Math.abs(p.y)<ve.s&&o(p.clone(),0,f+0*s,d));const P=Math.max((d-s)/2,0),S=Math.floor(P/s);p.seek(f-S*s);for(let C=-S;C<=S;C++)Math.abs(p.x)<ve.s&&Math.abs(p.y)<ve.s&&o(p.clone(),C,f+C*s,d),p.seek(s)}function jn(a,s){if(s<=0)return;const h=a.length;if(h<3)return;const d=[];let p=0;d.push(0);for(let B=1;B<h;B++)p+=mn(a[B],a[B-1]),d.push(p);s=Math.min(s,.2*p);const f=[];f.push(a[0][0]),f.push(a[0][1]);const P=a[h-1][0],S=a[h-1][1],L=_n([0,0],a[0],a[1]);yn(L),a[0][0]+=s*L[0],a[0][1]+=s*L[1],_n(L,a[h-1],a[h-2]),yn(L),a[h-1][0]+=s*L[0],a[h-1][1]+=s*L[1];for(let B=1;B<h;B++)d[B]+=s;d[h-1]+=s;const C=.5*s;for(let B=1;B<h-1;B++){let G=0,z=0,tt=0;for(let ht=B-1;ht>=0&&!(d[ht+1]<d[B]-C);ht--){const _t=C+d[ht+1]-d[B],St=d[ht+1]-d[ht],Ct=d[B]-d[ht]<C?1:_t/St;if(Math.abs(Ct)<1e-6)break;const Yt=Ct*Ct,Xt=Ct*_t-.5*Yt*St,$t=Ct*St/s,jt=a[ht+1],oe=a[ht][0]-jt[0],pe=a[ht][1]-jt[1];G+=$t/Xt*(jt[0]*Ct*_t+.5*Yt*(_t*oe-St*jt[0])-Yt*Ct*St*oe/3),z+=$t/Xt*(jt[1]*Ct*_t+.5*Yt*(_t*pe-St*jt[1])-Yt*Ct*St*pe/3),tt+=$t}for(let ht=B+1;ht<h&&!(d[ht-1]>d[B]+C);ht++){const _t=C-d[ht-1]+d[B],St=d[ht]-d[ht-1],Ct=d[ht]-d[B]<C?1:_t/St;if(Math.abs(Ct)<1e-6)break;const Yt=Ct*Ct,Xt=Ct*_t-.5*Yt*St,$t=Ct*St/s,jt=a[ht-1],oe=a[ht][0]-jt[0],pe=a[ht][1]-jt[1];G+=$t/Xt*(jt[0]*Ct*_t+.5*Yt*(_t*oe-St*jt[0])-Yt*Ct*St*oe/3),z+=$t/Xt*(jt[1]*Ct*_t+.5*Yt*(_t*pe-St*jt[1])-Yt*Ct*St*pe/3),tt+=$t}f.push(G/tt),f.push(z/tt)}f.push(P),f.push(S);for(let B=0,G=0;B<h;B++)a[B][0]=f[G++],a[B][1]=f[G++]}var gn=y(69287),Gn=y(91486);class Mn{static getPlacement(s,o,h,d,p,f){const P=(0,Gn.c)(h);return P?(-1===o&&s.invertY(),P.execute(s,h,d,p,f)):null}}var Yn=y(42058),En=y(32117);class Zn{constructor(s){const{offsetX:o,offsetY:h,postAngle:d,fontSize:p,scaleFactor:f,transforms:P}=s;if(this.offsetX=o,this.offsetY=h,this.postAngle=d,this.fontSize=Math.min(p,96),this.transforms=P,P&&P.infos.length>1){const S=(0,En.zb)(p,d,!1,o,h,P);this.fontSize=Math.min(S.size,96),this.postAngle=S.rotation,this.offsetX=S.offsetX,this.offsetY=S.offsetY}f&&(this.fontSize*=f,this.offsetX*=f,this.offsetY*=f)}}const ye=[4,4],ke=[16,4],bn={topLeft:ke,topRight:ke,bottomLeft:ke,bottomRight:ke},Ve=[4,2],ne=[4,6],wn={topLeft:Ve,topRight:Ve,bottomLeft:ne,bottomRight:ne},Tn={topLeft:Ve,topRight:ne,bottomLeft:Ve,bottomRight:ne},Hn={topLeft:ne,topRight:ne,bottomLeft:ye,bottomRight:ye},Xn={topLeft:ye,topRight:ye,bottomLeft:ne,bottomRight:ne},Qn={topLeft:ne,topRight:ye,bottomLeft:ne,bottomRight:ye},Sn={topLeft:ye,topRight:ne,bottomLeft:ye,bottomRight:ne},Jn={createComputedParams:a=>a,attributes:{pos:{type:Y.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:Y.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.pe.UNSIGNED_BYTE,count:1,packTessellation:({isBackground:a,mapAligned:s})=>De([[ue.bg,a],[ue.ti,!!s]])},zoomRange:{type:Y.pe.UNSIGNED_SHORT,count:2,packPrecisionFactor:R.fq,packTessellation:({minZoom:a,maxZoom:s})=>[a||0,s||28]},offset:{type:Y.pe.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:({offsets:a})=>{const{bottomLeft:s,bottomRight:o,topLeft:h,topRight:d}=a;return[h,d,s,o]}}},textureUV:{type:Y.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:({texcoords:a})=>{const{bottomLeft:s,bottomRight:o,topLeft:h,topRight:d}=a;return[h,d,s,o]}}},color:{type:Y.pe.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:({color:a})=>a},fontSize:{type:Y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:({fontSize:a})=>(0,bt.Lz)(a)},referenceSize:{type:Y.pe.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:({fontSize:a},{referenceSize:s})=>(0,bt.Lz)(null!=s?s:a)},haloColor:{type:Y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({haloColor:a})=>Ht(a)},haloFontSize:{type:Y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,pack:({haloFontSize:a})=>(0,bt.Lz)(a)},clipAngle:{type:Y.pe.UNSIGNED_BYTE,count:1,packTessellation:({clipAngle:a})=>qn(a||0)},referenceSymbol:{type:Y.pe.BYTE,count:4,packPrecisionFactor:1,packTessellation:(a,s)=>{if(!a.referenceBounds)return[0,0,0,0];const o=(0,We.iT)(s.horizontalAlignment),h=(0,We.Dy)(s.verticalAlignment),{offsetX:d,offsetY:p,size:f}=a.referenceBounds;return[(0,bt.Lz)(d),-(0,bt.Lz)(p),(0,bt.Lz)(f),o+1<<2|h+1]}}}};class Dn extends te{constructor(){super(...arguments),this.vertexSpec=Jn,this._textMeshParamsPropsInitialized=!1}ensurePacked(s,o,h){super.ensurePacked(s,o,h),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new Zn(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0)}_write(s,o,h){const d=this._getShaping();if(!d)return;const p=o.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(s,o,d,h);if(h&&h.nextPath())return h.nextPoint(),this._writeGlyphs(s,p,h.x,h.y,d,0);if("esriGeometryPolygon"===o.geometryType){const S=o.readCentroidForDisplay();if(!S)return;const[L,C]=S.coords;return this._writeGlyphs(s,p,L,C,d,0)}if("esriGeometryMultipoint"===o.geometryType){const S=o.readGeometryForDisplay();return void(null==S||S.forEachVertex((L,C)=>this._writeGlyphs(s,p,L,C,d,0)))}const f=o.readXForDisplay(),P=o.readYForDisplay();return this._writeGlyphs(s,p,f,P,d,0)}_writePlacedTextMarkers(s,o,h,d){const p=null!=d?d:lt.z.fromFeatureSetReaderCIM(o);if(!p)return;const P=Mn.getPlacement(p,-1,this.evaluatedMeshParams.placement,(0,bt.Lz)(1),s.id,Et());if(!P)return;const S=o.getDisplayId();let L=P.next();for(;null!=L;){const C=L.tx,B=-L.ty,G=-L.getAngle();this._writeGlyphs(s,S,C,B,h,G),L=P.next()}}_getShaping(){var s;const o=this._textMeshTransformProps,h=this.evaluatedMeshParams;if(null===(s=h.glyphs)||void 0===s||!s.glyphs.length)return null;const d=Math.round((0,bt.Lz)(o.fontSize)),p=(0,bt.Lz)(o.offsetX),f=(0,bt.Lz)(o.offsetY),P=(0,gn.qE)((0,bt.Lz)(h.lineWidth),32,512),S=R.DY*(0,gn.qE)(h.lineHeightRatio,.25,4);return(0,Yn.Tl)(h.glyphs,{scale:d/R.eG,angle:o.postAngle,xOffset:p,yOffset:f,horizontalAlignment:h.horizontalAlignment,verticalAlignment:h.verticalAlignment,maxLineWidth:P,lineHeight:S,decoration:h.decoration,borderLineSizePx:(0,bt.Lz)(h.boxBorderLineSize),hasBackground:!!h.boxBackgroundColor,useCIMAngleBehavior:h.useCIMAngleBehavior})}_writeGlyphs(s,o,h,d,p,f,P,S){const L=this.evaluatedMeshParams,C=this._textMeshTransformProps,B=C.fontSize,G=(0,bt.Lz)(C.offsetX),z=(0,bt.Lz)(C.offsetY),[tt,ht]=Me(L.scaleInfo,this.getTileInfo());0!==f&&p.setRotation(f);const _t=p.bounds,St=h+_t.x+G,Ct=d+_t.y-z,Yt=2*(L.minPixelBuffer?L.minPixelBuffer/B:1),Xt=Math.max(_t.width,_t.height)*Yt;p.textBox&&(s.recordStart(this.instanceId,this.attributeLayout,p.glyphs[0].textureBinding),s.recordBounds(St,Ct,Xt,Xt),this._writeTextBox(s,o,h,d,p.textBox,P,S),s.recordEnd());for(const $t of p.glyphs){s.recordStart(this.instanceId,this.attributeLayout,$t.textureBinding),s.recordBounds(St,Ct,Xt,Xt);const{texcoords:jt,offsets:oe}=$t;this._writeQuad(s,o,h,d,{texcoords:jt,offsets:oe,fontSize:B,color:Ht(L.color),isBackground:!1,referenceBounds:P,minZoom:tt,maxZoom:ht,...S}),s.recordEnd()}0!==f&&p.setRotation(-f)}_writeTextBox(s,o,h,d,p,f,P){const S=this.evaluatedMeshParams,{fontSize:L}=this._textMeshTransformProps,{boxBackgroundColor:C,boxBorderLineColor:B}=S,G={isBackground:!0,fontSize:L,referenceBounds:f,...P};C&&(this._writeQuad(s,o,h,d,{texcoords:bn,offsets:p.main,color:Ht(C),...G}),B||(this._writeQuad(s,o,h,d,{texcoords:Hn,offsets:p.top,color:Ht(C),...G}),this._writeQuad(s,o,h,d,{texcoords:Xn,offsets:p.bot,color:Ht(C),...G}),this._writeQuad(s,o,h,d,{texcoords:Qn,offsets:p.left,color:Ht(C),...G}),this._writeQuad(s,o,h,d,{texcoords:Sn,offsets:p.right,color:Ht(C),...G}))),B&&(this._writeQuad(s,o,h,d,{texcoords:wn,offsets:p.top,color:Ht(B),...G}),this._writeQuad(s,o,h,d,{texcoords:wn,offsets:p.bot,color:Ht(B),...G}),this._writeQuad(s,o,h,d,{texcoords:Tn,offsets:p.left,color:Ht(B),...G}),this._writeQuad(s,o,h,d,{texcoords:Tn,offsets:p.right,color:Ht(B),...G}))}_writeQuad(s,o,h,d,p){const f=s.vertexCount();this._writeVertex(s,o,h,d,p),s.indexWrite(f+0),s.indexWrite(f+1),s.indexWrite(f+2),s.indexWrite(f+1),s.indexWrite(f+3),s.indexWrite(f+2)}}const qn=a=>Math.round(a*(254/360)),er=(0,Vn.Bj)(a=>{let s=0;if(0===a)return 1/0;for(;!(a%2);)s++,a/=2;return s}),rr={createComputedParams:a=>a,attributes:{...we.attributes,bitset:{type:Y.pe.UNSIGNED_BYTE,count:1,pack:({shouldSampleAlphaOnly:a,shouldScaleDash:s,isSDF:o})=>De([[ue.cn,a],[ue.kx,s],[ue.b5,o]])},tlbr:{type:Y.pe.UNSIGNED_SHORT,count:4,pack:({sprite:a})=>{const{rect:s,width:o,height:h}=a,d=s.x+R.hM,p=s.y+R.hM;return[d,p,d+o,p+h]}},accumulatedDistance:{type:Y.pe.UNSIGNED_SHORT,count:1,packTessellation:({distance:a})=>a},segmentDirection:{type:Y.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({directionX:a,directionY:s})=>[a,s]}}};var $e=y(83953);class je{static from(s){return"width"in s?this.fromSimpleMeshParams(s):this.fromComplexMeshParams(s)}static fromSimpleMeshParams(s){const o=new je(s.sprite,s.color,s.outlineColor,s.minPixelBuffer,s.placement,s.scaleInfo,s.effects),{type:h,width:d,height:p,angle:f,alignment:P,outlineSize:S,referenceSize:L,sprite:C,overrideOutlineColor:B}=s;return o.rawWidth=(0,bt.Lz)(d),o.rawHeight=(0,bt.Lz)(p),o.angle=f,o.alignment=P,o.outlineSize=(0,bt.Lz)(S),o.referenceSize=(0,bt.Lz)(L),o.overrideOutlineColor=B,o.offsetX=(0,bt.Lz)(s.offsetX),o.offsetY=(0,bt.Lz)(s.offsetY),"simple"!==h||C.sdf||(o.rawWidth=C.width,o.rawHeight=C.height),o.sizeRatio=C.sdf?2:1,o._computeSize(s,!1),o}static fromComplexMeshParams(s){const o=new je(s.sprite,s.color,s.outlineColor,s.minPixelBuffer,s.placement,s.scaleInfo,s.effects);let{alignment:h,transforms:d,size:p,scaleX:f,anchorX:P,anchorY:S,angle:L,colorLocked:C,frameHeight:B,widthRatio:G,offsetX:z,offsetY:tt,outlineSize:ht,referenceSize:_t,scaleFactor:St,sizeRatio:Ct,isAbsoluteAnchorPoint:Yt,rotateClockwise:Xt,scaleSymbolsProportionally:$t,sprite:jt}=s;if(d&&d.infos.length>0){const ge=(0,En.zb)(p,L,Xt,z,tt,d);p=ge.size,L=ge.rotation,z=ge.offsetX,tt=ge.offsetY,Xt=!1}St&&(p*=St,z*=St,tt*=St);const oe=f*(jt.width/jt.height);o.alignment=h,o.rawHeight=(0,bt.Lz)(p),o.rawWidth=o.rawHeight*oe,o.referenceSize=(0,bt.Lz)(_t),o.sizeRatio=Ct,o.angle=L,o.rotateClockwise=Xt,o.anchorX=P,o.anchorY=S,o.offsetX=(0,bt.Lz)(z),o.offsetY=(0,bt.Lz)(tt),Yt&&p&&(o.anchorX=jt.sdf?P/(p*G):P/(p*oe),o.anchorY=S/p);const pe=$t&&B?p/B:1;return o.outlineSize=0===ht||isNaN(ht)?0:(0,bt.Lz)(ht)*pe,o.scaleSymbolsProportionally=$t,o.colorLocked=C,o._computeSize(s,!0),o}constructor(s,o,h,d,p,f,P){this.sprite=s,this.color=o,this.outlineColor=h,this.minPixelBuffer=d,this.placement=p,this.scaleInfo=f,this.effects=P,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.alignment=Zt.C1.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0}get boundsInfo(){return{size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(s,o){const{sprite:h,hasSizeVV:d}=s,p=!!h.sdf,{rawWidth:f,rawHeight:P,sizeRatio:S,outlineSize:L}=this,C=f*S,B=P*S;if(p&&!d){const Xt=P,$t=L+2;this.computedWidth=Math.min((o&&f>P?C:f)+$t,C),this.computedHeight=Math.min(Xt+$t,B)}else this.computedWidth=C,this.computedHeight=B;const G=p?R._j/Math.max(C,B):1,z=.5*(C-this.computedWidth)*G,tt=.5*(B-this.computedHeight)*G,ht=h.rect.x+R.hM+z,_t=h.rect.y+R.hM+tt,St=ht+h.width-2*z,Ct=_t+h.height-2*tt;this.texXmin=Math.floor(ht),this.texYmin=Math.floor(_t),this.texXmax=Math.ceil(St),this.texYmax=Math.ceil(Ct),this.computedWidth*=(this.texXmax-this.texXmin)/(St-ht),this.computedHeight*=(this.texYmax-this.texYmin)/(Ct-_t),this.anchorX*=C/this.computedWidth,this.anchorY*=B/this.computedHeight}}var Ce=y(93300);const On=3.14159265359/180,sr=128/Math.PI;const T={createComputedParams:a=>je.from(a),attributes:{pos:{type:Y.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:Y.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.pe.UNSIGNED_BYTE,count:1,pack:({sprite:a,alignment:s,scaleSymbolsProportionally:o,overrideOutlineColor:h,colorLocked:d})=>{let p=0;return a.sdf&&(p|=Ee(Ce.c.bitset.isSDF)),s===Zt.C1.MAP&&(p|=Ee(Ce.c.bitset.isMapAligned)),o&&(p|=Ee(Ce.c.bitset.scaleSymbolsProportionally)),h&&(p|=Ee(Ce.c.bitset.overrideOutlineColor)),d&&(p|=Ee(Ce.c.bitset.colorLocked)),p}},zoomRange:{type:Y.pe.SHORT,count:2,packPrecisionFactor:R.fq,pack:({scaleInfo:a},{tileInfo:s})=>Me(a,s)},offset:{type:Y.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({angle:a,computedWidth:s,computedHeight:o,anchorX:h,anchorY:d,offsetX:p,offsetY:f,rotateClockwise:P})=>{const S=function c(a,s,o,h,d=!1){const p=(0,dn.vt)(),f=d?1:-1;return a?(0,Ae.$0)(p,f*On*a):(0,Ae.D_)(p),(s||o)&&(0,Ae.Tl)(p,p,[s,-o]),h&&(0,Ae.e$)(p,p,f*On*-h),p}(0,p,f,-a,P),L=-(.5+h)*s,C=-(.5-d)*o,B=[L,C],G=[L+s,C],z=[L,C+o],tt=[L+s,C+o];return(0,$e.l0)(B,B,S),(0,$e.l0)(G,G,S),(0,$e.l0)(z,z,S),(0,$e.l0)(tt,tt,S),[B,G,z,tt]}}},textureUV:{type:Y.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({texXmax:a,texXmin:s,texYmax:o,texYmin:h})=>[[s,h],[a,h],[s,o],[a,o]]}},color:{type:Y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:a})=>Ht(a)},outlineColor:{type:Y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:a})=>Ht(a)},sizing:{type:Y.pe.UNSIGNED_BYTE,count:4,pack:({rawWidth:a,rawHeight:s,outlineSize:o,referenceSize:h})=>[Le(Math.max(a,s),128),Le(o,128),Le(h,128),0]},placementAngle:{type:Y.pe.UNSIGNED_BYTE,count:1,packTessellation:({placementAngle:a})=>function ar(a){return function or(a,s){return a%=s,Math.abs(a>=0?a:a+s)}(a*sr,256)}(a)},sizeRatio:{type:Y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:({sizeRatio:a})=>a}}},it={createComputedParams:a=>a,attributes:{pos:{type:Y.pe.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:Y.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Y.pe.UNSIGNED_BYTE,count:1,pack:a=>0},offset:{type:Y.pe.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:({size:a})=>{const s=(0,bt.Lz)(a),o=-s/2,h=-s/2;return[[o,h],[o+s,h],[o,h+s],[o+s,h+s]]}}},texCoords:{type:Y.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:Y.pe.UNSIGNED_BYTE,count:2,pack:({size:a})=>[a,a]},referenceSize:{type:Y.pe.UNSIGNED_BYTE,count:1,pack:({size:a})=>(0,bt.Lz)(a)},zoomRange:{type:Y.pe.UNSIGNED_BYTE,count:2,pack:({scaleInfo:a},{tileInfo:s})=>Me(a,s)}}},Bt=function re(a){const s={};for(const o in a)s[o]={name:o,constructor:a[o]};return s}({FillMeshWriter:Re,DotDensityMeshWriter:class me extends ae{constructor(){super(...arguments),this.vertexSpec=_e}createTesselationParams(s){return{inverseArea:1/s.readGeometryArea()}}},ComplexFillMeshWriter:class An extends en{constructor(){super(...arguments),this.vertexSpec=sn}},PatternFillMeshWriter:en,OutlineFillMeshWriter:Be,PatternOutlineFillMeshWriter:class hn extends Be{constructor(){super(...arguments),this.vertexSpec=zn}_createOutlineWriter(s,o,h,d){return new un(s,o,h,d)}_write(s,o,h){var d,p;const f=null!==(d=null==h?void 0:h.asOptimized())&&void 0!==d?d:o.readGeometryForDisplay(),P=this._clip(f);if(!P)return;const S=null===(p=this.evaluatedMeshParams.sprite)||void 0===p?void 0:p.textureBinding;s.recordStart(this.instanceId,this.attributeLayout,S),this._writeGeometry(s,o,P),this._lineMeshWriter.writeLineVertices(s,lt.z.fromOptimizedCIM(P,"esriGeometryPolyline"),o),s.recordEnd()}ensurePacked(s,o,h){super.ensurePacked(s,o,h),this._lineMeshWriter.ensurePacked(s,o,h)}enqueueRequest(s,o,h){super.enqueueRequest(s,o,h),this._lineMeshWriter.enqueueRequest(s,o,h)}loadDependencies(){var s=()=>super.loadDependencies,o=this;return(0,v.A)(function*(){yield Promise.all([s().call(o),o._lineMeshWriter.loadDependencies()])})()}},ComplexOutlineFillMeshWriter:class Wn extends Be{constructor(){super(...arguments),this.vertexSpec=Un}_createOutlineWriter(s,o,h,d){return new Bn(s,o,h,d)}_write(s,o,h){var d,p;const f=null!==(d=null==h?void 0:h.asOptimized())&&void 0!==d?d:o.readGeometryForDisplay(),P=this._clip(f);if(!P)return;const S=null===(p=this.evaluatedMeshParams.sprite)||void 0===p?void 0:p.textureBinding;s.recordStart(this.instanceId,this.attributeLayout,S),this._writeGeometry(s,o,P),this._lineMeshWriter.writeLineVertices(s,lt.z.fromOptimizedCIM(P,"esriGeometryPolyline"),o),s.recordEnd()}ensurePacked(s,o,h){super.ensurePacked(s,o,h),this._lineMeshWriter.ensurePacked(s,o,h)}enqueueRequest(s,o,h){super.enqueueRequest(s,o,h),this._lineMeshWriter.enqueueRequest(s,o,h)}loadDependencies(){var s=()=>super.loadDependencies,o=this;return(0,v.A)(function*(){yield Promise.all([s().call(o),o._lineMeshWriter.loadDependencies()])})()}},MarkerMeshWriter:class O extends te{constructor(){super(...arguments),this.vertexSpec=T}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(s,o,h){var d;const p=null===(d=this.evaluatedMeshParams.sprite)||void 0===d?void 0:d.textureBinding,f=o.getDisplayId();s.recordStart(this.instanceId,this.attributeLayout,p);const P=this.evaluatedMeshParams.minPixelBuffer,S=Math.max(this.evaluatedMeshParams.computedWidth,P),L=Math.max(this.evaluatedMeshParams.computedHeight,P),C=this.evaluatedMeshParams.offsetX,B=-this.evaluatedMeshParams.offsetY;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(s,o,h,S,L);else if(h&&h.nextPath()){h.nextPoint();const G=h.x,z=h.y;s.recordBounds(G+C,z+B,S,L),this._writeQuad(s,f,G,z)}else if("esriGeometryPolygon"===o.geometryType){const G=o.readCentroidForDisplay();if(!G)return;const[z,tt]=G.coords;s.recordBounds(z+C,tt+B,S,L),this._writeQuad(s,f,z,tt)}else if("esriGeometryPoint"===o.geometryType){const G=o.readXForDisplay(),z=o.readYForDisplay();s.recordBounds(G+C,z+B,S,L),this._writeQuad(s,f,G,z)}else{const G=o.readGeometryForDisplay();null==G||G.forEachVertex((z,tt)=>{s.recordBounds(z+C,tt+B,S,L),Math.abs(z)>ve.s||Math.abs(tt)>ve.s||this._writeQuad(s,f,z,tt)})}s.recordEnd()}_writePlacedMarkers(s,o,h,d,p){var f;const P=null!=h?h:null===(f=lt.z.fromFeatureSetReaderCIM(o))||void 0===f?void 0:f.clone();if(!P)return;const L=Mn.getPlacement(P,-1,this.evaluatedMeshParams.placement,(0,bt.Lz)(1),s.id,Et());if(!L)return;const C=o.getDisplayId();let B=L.next();const G=this.evaluatedMeshParams.offsetX,z=-this.evaluatedMeshParams.offsetY;for(;null!=B;){const tt=B.tx,ht=-B.ty;if(Math.abs(tt)>ve.s||Math.abs(ht)>ve.s){B=L.next();continue}const _t=-B.getAngle();s.recordBounds(tt+G,ht+z,d,p),this._writeQuad(s,C,tt,ht,_t),B=L.next()}}_writeQuad(s,o,h,d,p){const f=s.vertexCount();this._writeVertex(s,o,h,d,null==p?null:{placementAngle:p}),s.indexWrite(f+0),s.indexWrite(f+1),s.indexWrite(f+2),s.indexWrite(f+1),s.indexWrite(f+3),s.indexWrite(f+2)}},PieChartMeshWriter:class Tt extends te{constructor(){super(...arguments),this.vertexSpec=it}_write(s,o){const h=o.getDisplayId(),d=this.evaluatedMeshParams.minPixelBuffer,p=Math.max((0,bt.Lz)(this.evaluatedMeshParams.size),d);let f,P;if("esriGeometryPoint"===o.geometryType)f=o.readXForDisplay(),P=o.readYForDisplay();else{const L=o.readCentroidForDisplay();if(!L)return;f=null==L?void 0:L.coords[0],P=null==L?void 0:L.coords[1]}s.recordStart(this.instanceId,this.attributeLayout),s.recordBounds(f,P,p,p);const S=s.vertexCount();this._writeVertex(s,h,f,P),s.indexWrite(S+0),s.indexWrite(S+1),s.indexWrite(S+2),s.indexWrite(S+1),s.indexWrite(S+3),s.indexWrite(S+2),s.recordEnd()}},TextMeshWriter:Dn,LineMeshWriter:Ye,TexturedLineMeshWriter:class ir extends Ye{constructor(s,o,h,d){super(s,o,h,d),this.vertexSpec=rr,this._tessellationOptions.textured=!0}_write(s,o,h){const d=null!=h?h:lt.z.fromFeatureSetReaderCIM(o);if(!d)return;const{sprite:p}=this.evaluatedMeshParams;this._writeGeometry(s,o,d,null==p?void 0:p.textureBinding)}},HeatmapMeshWriter:class kn extends te{constructor(){super(...arguments),this.vertexSpec=Nn}_write(s,o){s.recordStart(this.instanceId,this.attributeLayout);const h=o.getDisplayId();if("esriGeometryPoint"===o.geometryType){const d=o.readXForDisplay(),p=o.readYForDisplay();this._writeQuad(s,h,d,p)}else if("esriGeometryMultipoint"===o.geometryType){const d=o.readGeometryForDisplay();null==d||d.forEachVertex((p,f)=>{p>=0&&p<=512&&f>=0&&f<=512&&this._writeQuad(s,h,p,f)})}s.recordEnd()}_writeQuad(s,o,h,d){const p=s.vertexCount();this._writeVertex(s,o,h,d),s.indexWrite(p+0),s.indexWrite(p+1),s.indexWrite(p+2),s.indexWrite(p+1),s.indexWrite(p+3),s.indexWrite(p+2)}},LabelMeshWriter:class nr extends Dn{constructor(){super(...arguments),this._zoomLevel=0}_write(s,o,h,d){if(this._zoomLevel=d||0,null!=h)throw new Error("InternalError: EffectGeometry not support for LabelMeshWriter");switch(o.geometryType){case"esriGeometryPoint":{const p=o.readXForDisplay(),f=o.readYForDisplay();return this._writePoint(s,p,f,o)}case"esriGeometryEnvelope":case"esriGeometryPolygon":case"esriGeometryMultipoint":{const p=o.readCentroidForDisplay();if(!p)return;const[f,P]=p.coords;return this._writePoint(s,f,P,o)}case"esriGeometryPolyline":{const p=o.readLegacyGeometryForDisplay();this._writeLines(s,o,p)}}}_writePoint(s,o,h,d){var p,f,P,S;const L=this._getShaping();if(!L)return;let C=this._getPointReferenceBounds();C||(C={offsetX:0,offsetY:0,size:0});const B=L.boundsT,G=(0,We.xy)(this.evaluatedMeshParams.horizontalAlignment),z=(0,We.UD)(this.evaluatedMeshParams.verticalAlignment),tt=null!==(p=null===(f=this.evaluatedMeshParams.scaleInfo)||void 0===f?void 0:f.maxScale)&&void 0!==p?p:0,ht=null!==(P=null===(S=this.evaluatedMeshParams.scaleInfo)||void 0===S?void 0:S.minScale)&&void 0!==P?P:0,_t=(0,ze.Q4)(d.getDisplayId());s.metricStart(new Fe.f(_t,o,h,G,z,tt,ht,C)),s.metricBoxWrite(B),this._writeGlyphs(s,d.getDisplayId(),o,h,L,0,C),s.metricEnd()}_getPointReferenceBounds(){if(!this._references)return null;for(const s of this._references){const o=s.getBoundsInfo();if(o)return o}return null}_writeLines(s,o,h){const{repeatLabel:d,scaleInfo:p}=this.evaluatedMeshParams,f=this.evaluatedMeshParams.repeatLabelDistance||128,P=this._getShaping();if(!P)return;this._current={out:s,id:o.getDisplayId(),shaping:P,zoomRange:Me(p,this.getTileInfo()),referenceBounds:this._getPointReferenceBounds()||{offsetX:0,offsetY:0,size:0}};const S=function $n(a,s){const o=s;for(let h=0;h<a.length;h++){let d=a[h];jn(d,o);const p=[];p.push(d[0]);for(let f=1;f<d.length;f++){const[P,S]=d[f-1],[L,C]=d[f];p.push([L-P,C-S])}a[h]=p,d=p}return a}(h.paths,P.bounds.width),L=this._placeSubdivGlyphs.bind(this),C=(P.bounds.width+f)/2;for(const B of S)vn(B,C,L,!!d)}_placeSubdivGlyphs(s,o,h,d){const{allowOverrun:p,labelPosition:f,repeatLabelDistance:P}=this.evaluatedMeshParams,S=this._current.zoomRange[0],L=er(o),C=this._current.shaping.bounds.width/2,B=Math.sqrt(P||128)/2,G=Math.min(h,d-h),z=this._current.shaping.isMultiline?28:Math.log2(G/(B+C/2)),tt=0===o?z:Math.min(L,z),ht=Math.max(S,this._zoomLevel+1-tt),_t=this._zoomLevel-ht,St=this._current.shaping.bounds.width/2*2**_t;this._current.shaping.isMultiline?0===o&&this._placeStraight(s,ht):p&&_t<0?this._placeStraightAlong(s,S):"parallel"===f?this._placeStraightAlong(s,ht):"curved"===f&&this._placeCurved(s,ht,St)}_placeStraight(s,o){var h,d,p,f;const{out:P,id:S,shaping:L,referenceBounds:C}=this._current,{x:B,y:G}=s,z=(0,ze.Q4)(S),tt=null!==(h=null===(d=this.evaluatedMeshParams.scaleInfo)||void 0===d?void 0:d.maxScale)&&void 0!==h?h:0,ht=null!==(p=null===(f=this.evaluatedMeshParams.scaleInfo)||void 0===f?void 0:f.minScale)&&void 0!==p?p:0;P.metricStart(new Fe.f(z,s.x,s.y,0,0,tt,ht,null)),P.metricBoxWrite(L.boundsT);const _t=s.angle*(180/Math.PI)%360,St=(s.angle*(180/Math.PI)+180)%360;this._writeGlyphs(P,S,B,G,L,0,C,{clipAngle:_t,mapAligned:!0,isLineLabel:!0,minZoom:o}),this._writeGlyphs(P,S,B,G,L,0,C,{clipAngle:St,mapAligned:!0,isLineLabel:!0,minZoom:o}),P.metricEnd()}_placeCurved(s,o,h){var d,p,f,P;const{out:S,id:L}=this._current,C=s.clone(),B=s.angle*(180/Math.PI)%360,G=(s.angle*(180/Math.PI)+180)%360,z=(0,ze.Q4)(L),tt=null!==(d=null===(p=this.evaluatedMeshParams.scaleInfo)||void 0===p?void 0:p.maxScale)&&void 0!==d?d:0,ht=null!==(f=null===(P=this.evaluatedMeshParams.scaleInfo)||void 0===P?void 0:P.minScale)&&void 0!==f?f:0;S.metricStart(new Fe.f(z,s.x,s.y,0,0,tt,ht,null)),this._placeFirst(C,o,1,B),this._placeBack(s,C,o,h,1,B),this._placeForward(s,C,o,h,1,B),this._placeFirst(C,o,0,G),this._placeBack(s,C,o,h,0,G),this._placeForward(s,C,o,h,0,G),S.metricEnd()}_placeStraightAlong(s,o){var h,d,p,f;const{out:P,id:S,shaping:L,zoomRange:C,referenceBounds:B}=this._current,{boxBorderLineColor:G,boxBackgroundColor:z}=this.evaluatedMeshParams,tt=s.clone(),ht=s.angle*(180/Math.PI)%360,_t=(s.angle*(180/Math.PI)+180)%360;if(L.glyphs.length>0&&(G||z)){const Xt=Math.max(o,C[0],0),$t=Math.min(28,C[1]),jt=(0,Ae.$0)((0,dn.vt)(),-s.angle),[oe,pe]=L.shapeBackground(jt),ge={minZoom:Xt,maxZoom:$t,clipAngle:ht,mapAligned:!0,isLineLabel:!0};P.recordStart(this.instanceId,this.attributeLayout,L.glyphs[0].textureBinding),this._writeTextBox(P,S,s.x,s.y,pe,B,ge),P.recordEnd(),ge.clipAngle=_t,P.recordStart(this.instanceId,this.attributeLayout,L.glyphs[0].textureBinding),this._writeTextBox(P,S,s.x,s.y,pe,B,ge),P.recordEnd()}const St=(0,ze.Q4)(S),Ct=null!==(h=null===(d=this.evaluatedMeshParams.scaleInfo)||void 0===d?void 0:d.maxScale)&&void 0!==h?h:0,Yt=null!==(p=null===(f=this.evaluatedMeshParams.scaleInfo)||void 0===f?void 0:f.minScale)&&void 0!==p?p:0;P.metricStart(new Fe.f(St,s.x,s.y,0,0,Ct,Yt,null)),this._placeFirst(tt,o,1,ht,!0),this._placeFirst(tt,o,0,_t,!0),P.metricEnd()}_placeBack(s,o,h,d,p,f){const P=s.clone();let S=s.backwardLength+0;for(;P.prev()&&!(S>=d);)this._placeOnSegment(P,o,S,h,-1,p,f),S+=P.length+0}_placeForward(s,o,h,d,p,f){const P=s.clone();let S=s.remainingLength+0;for(;P.next()&&!(S>=d);)this._placeOnSegment(P,o,S,h,1,p,f),S+=P.length+0}_placeFirst(s,o,h,d,p=!1){const f=s,{out:P,id:S,shaping:L,zoomRange:C,referenceBounds:B}=this._current,G=L.glyphs;for(const z of G){const tt=z.x>L.bounds.x?h:1-h,ht=tt*s.remainingLength+(1-tt)*s.backwardLength,_t=Math.abs(z.x+z.width/2-L.bounds.x),St=Math.max(0,this._zoomLevel+Math.log2(_t/(ht+0))),Ct=Math.max(o,p?0:St);z.maxZoom=Math.min(C[1],28),z.angle=s.angle+(1-h)*Math.PI,z.minZoom=Math.max(C[0],Ct),this._writeLineGlyph(P,S,f.x,f.y,L.bounds,z,d,B,!0),h&&this._isVisible(z.minZoom,z.maxZoom)&&P.metricBoxWrite(z.bounds)}}_placeOnSegment(s,o,h,d,p,f,P){const{out:S,id:L,shaping:C,referenceBounds:B}=this._current,G=C.glyphs,ht={x:s.x+h*-p*(s.dx/s.length),y:s.y+h*-p*(s.dy/s.length)};for(const _t of G){const St=_t.x>C.bounds.x?f:1-f;if(!(St&&1===p||!St&&-1===p))continue;const Ct=Math.abs(_t.x+_t.width/2-C.bounds.x),Yt=Math.max(0,this._zoomLevel+Math.log2(Ct/h)-.1),Xt=Math.max(d,this._zoomLevel+Math.log2(Ct/(h+s.length+0)));if(0!==Yt&&(_t.angle=s.angle+(1-f)*Math.PI,_t.minZoom=Xt,_t.maxZoom=Yt,this._writeLineGlyph(S,L,ht.x,ht.y,C.bounds,_t,P,B,!0),f&&this._isVisible(_t.minZoom,_t.maxZoom))){const $t=_t.bounds,pe=new pn.A($t.center[0]+(s.x-o.x),$t.center[1]+(s.y-o.y),$t.width,$t.height);S.metricBoxWrite(pe)}}}_writeLineGlyph(s,o,h,d,p,f,P,S,L){const C=h+p.x,B=d+p.y,G=2*(this.evaluatedMeshParams.minPixelBuffer?this.evaluatedMeshParams.minPixelBuffer/this._textMeshTransformProps.fontSize:1),z=Math.max(p.width,p.height)*G;s.recordStart(this.instanceId,this.attributeLayout,f.textureBinding),s.recordBounds(C,B,z,z);const{texcoords:tt,offsets:ht}=f;this._writeQuad(s,o,h,d,{texcoords:tt,offsets:ht,fontSize:this._textMeshTransformProps.fontSize,color:Ht(this.evaluatedMeshParams.color),isBackground:!1,referenceBounds:S,minZoom:Math.max(this._current.zoomRange[0],f.minZoom),maxZoom:Math.min(this._current.zoomRange[1],f.maxZoom),clipAngle:P,mapAligned:L,isLineLabel:!0}),s.recordEnd()}_isVisible(s,o){const h=this._zoomLevel;return s<=h&&h<=o}}})},69522:(At,at,y)=>{function v(m){return m}function x(m){return m}y.d(at,{P:()=>v,U:()=>x})},4196:(At,at,y)=>{y.d(at,{f_:()=>M,$Z:()=>k,DM:()=>A,rz:()=>nt});var v=y(8189),x=y(25735),m=y(24821),w=y(3902),q=y(3248),H=y(875);class R extends m.k2{getVisualVariableData(E){if(!this._vvData){const D=this.getAttributeDataCoords(E);this._vvData=(0,w.US)(this.visualVariableData,D).setDebugName("storage2")}return this._vvData}getAttributeDataCoords(E){if(!this._uv){const D=(0,H.Kt)(E),U=this.size,X=(0,w.Wh)(D.x),Q=(0,w.Wh)(D.y).multiply((0,w.Wh)(256)),J=(0,w.Wh)(D.z).multiply((0,w.Wh)(256)).multiply((0,w.Wh)(256)),N=(0,w.fV)(X.add(Q).add(J)),F=(0,w.zi)(N,U),V=N.subtract(F).divide(U);this._uv=new w.ZY(F,V).add(.5).divide(U)}return this._uv}getFilterData(E){const D=this.getAttributeDataCoords(E);return(0,w.US)(this.filterFlags,D).setDebugName("storage0")}getAnimationData(E){const D=this.getAttributeDataCoords(E);return(0,w.US)(this.animation,D).setDebugName("storage1")}getVVData(E){return this.getVisualVariableData(E)}getDataDrivenData0(E){const D=this.getAttributeDataCoords(E);return(0,w.US)(this.dataDriven0,D).setDebugName("storage30")}getDataDrivenData1(E){const D=this.getAttributeDataCoords(E);return(0,w.US)(this.dataDriven1,D).setDebugName("storage31")}getDataDrivenData2(E){const D=this.getAttributeDataCoords(E);return(0,w.US)(this.dataDriven2,D).setDebugName("storage32")}getGPGPUData(E){const D=this.getAttributeDataCoords(E);return(0,w.US)(this.gpgpu,D).setDebugName("storage4")}getFilterFlags(E){return(0,q.A)("webgl-ignores-sampler-precision")?(0,w.mk)(this.getFilterData(E).x.multiply((0,w.fV)(255))):this.getFilterData(E).x.multiply((0,w.fV)(255))}getAnimationValue(E){return this.getAnimationData(E).x}getSizeValue(E){return this.getVisualVariableData(E).x}getColorValue(E){return this.getVisualVariableData(E).y}getOpacityValue(E){return this.getVisualVariableData(E).z}getRotationValue(E){return this.getVisualVariableData(E).w}}(0,v._)([(0,m.Pi)(w.z7)],R.prototype,"filterFlags",void 0),(0,v._)([(0,m.Pi)(w.z7)],R.prototype,"animation",void 0),(0,v._)([(0,m.Pi)(w.z7)],R.prototype,"gpgpu",void 0),(0,v._)([(0,m.Pi)(w.z7)],R.prototype,"visualVariableData",void 0),(0,v._)([(0,m.Pi)(w.z7)],R.prototype,"dataDriven0",void 0),(0,v._)([(0,m.Pi)(w.z7)],R.prototype,"dataDriven1",void 0),(0,v._)([(0,m.Pi)(w.z7)],R.prototype,"dataDriven2",void 0),(0,v._)([(0,m.Pi)(w.nt)],R.prototype,"size",void 0);class rt extends m.k2{}(0,v._)([(0,m.Pi)(w.nt)],rt.prototype,"activeReasons",void 0),(0,v._)([(0,m.Pi)(w.nt)],rt.prototype,"highlightAll",void 0);class Z extends m.k2{}(0,v._)([(0,m.Pi)(w.ZY)],Z.prototype,"position",void 0),(0,v._)([(0,m.Pi)(w.nt)],Z.prototype,"distance",void 0),(0,v._)([(0,m.Pi)(w.nt)],Z.prototype,"smallSymbolDistance",void 0),(0,v._)([(0,m.Pi)(w.nt)],Z.prototype,"smallSymbolSizeThreshold",void 0);var et=y(16585);class nt extends m.ZA{}(0,v._)([(0,m.C5)(0,w.eB)],nt.prototype,"id",void 0),(0,v._)([(0,m.C5)(1,w.nt)],nt.prototype,"bitset",void 0),(0,v._)([(0,m.C5)(2,w.ZY)],nt.prototype,"pos",void 0);class k extends m.Y7{}(0,v._)([(0,m.C5)(14,w.ZY)],k.prototype,"nextPos1",void 0),(0,v._)([(0,m.C5)(15,w.ZY)],k.prototype,"nextPos2",void 0);class A extends m.HS{}class M extends m.A{clip(E,D){let U=new w.nt(0);const X=this.storage.getFilterFlags(E);if(U=U.add((0,w.fV)(2).multiply((0,w.fV)(1).subtract((0,H.i6)(X,0)))),this.inside?U=U.add((0,w.fV)(2).multiply((0,w.fV)(1).subtract((0,H.i6)(X,1)))):this.outside?U=U.add((0,w.fV)(2).multiply((0,H.i6)(X,1))):this.highlight&&(U=U.add((0,w.fV)(2).multiply((0,w.fV)(1).subtract(this._checkHighlight(X))))),null!=D){const Q=new w.nt(1).subtract((0,w.PM)(D.x,this.view.currentZoom)),J=(0,w.PM)(D.y,this.view.currentZoom);U=U.add(new w.nt(2).multiply(Q.add(J)))}return U}getFragmentOutput(E,D,U=new w.nt(1/255)){var X,Q;const J=new m.mm;return J.glFragColor=null!==(X=null!==(Q=this._maybeWriteHittest(D))&&void 0!==Q?Q:this._maybeHighlight(E,U))&&void 0!==X?X:E,J}_maybeHighlight(E,D){return this.highlight?new w.Zb(E.rgb,(0,w.PM)(D,E.a)):null}_checkHighlight(E){let D=this._checkHighlightBit(E,0);for(let U=1;U<x.M$.length;U++)D=D.add(this._checkHighlightBit(E,U));return(0,w.PM)(new w.nt(.1),D.add(this.highlight.highlightAll))}_checkHighlightBit(E,D){return(0,H.yS)(E,D).multiply((0,H.mh)(this.highlight.activeReasons,D))}maybeRunHittest(E,D,U){if(null==this.hittestRequest)return null;const X=this.hittest(E,D,U);let Q=(0,w.Tk)((0,w.MM)(X,this.hittestRequest.distance),new w.nt(2),new w.nt(0));const J=this.storage.getAttributeDataCoords(E.id),N=(0,H.nb)(J);Q=Q.add(this.clip(E.id,E.zoomRange));const F=new w.Zb(new w.nt(1/255),0,0,0);return{glPointSize:new w.nt(1),glPosition:new w.Zb(N,Q,1),color:F}}_maybeWriteHittest(E){return null!=this.hittestRequest?E.color:null}}(0,v._)([m.E8],M.prototype,"inside",void 0),(0,v._)([m.E8],M.prototype,"outside",void 0),(0,v._)([(0,m.uK)(rt)],M.prototype,"highlight",void 0),(0,v._)([(0,m.Pi)(R)],M.prototype,"storage",void 0),(0,v._)([(0,m.Pi)(et.o)],M.prototype,"view",void 0),(0,v._)([(0,m.uK)(Z)],M.prototype,"hittestRequest",void 0)},61254:(At,at,y)=>{y.d(at,{Bh:()=>b,KP:()=>M,Ps:()=>E});var v=y(8189),x=y(47669),m=y(24821),w=y(3902),q=y(4196),H=y(90731),R=y(35891),rt=y(83090),Z=y(28580),et=y(875);class nt extends R._{}function M(D,U){const X=(0,w.jh)(new w.ZY(1),new w.ZY(1/x.bg),new w.ZY((0,et.mh)(U.bitset,H.A),(0,et.mh)(U.bitset,H.lx))),Q=D.view.requiredZoomFactor,J=new w.ZY(U.width,U.height).multiply(X),N=J.multiply(U.scale).multiply(Q),F=U.angle.multiply(H.rp),V=(0,w.F8)(F),st=(0,w.gn)(F),ot=function A(D,U,X,Q,J){const N=(0,w.LC)((0,et.mh)(J,H.Fz),(0,w.fV)(1)),F=(0,et.Rj)(new w.Zb(D,0));return(0,w.Tk)(N,(0,w.w0)(Q.divide(U.x),X.divide(U.y),0,(0,w.ze)(X.divide(U.x)),Q.divide(U.y),0,(0,et._9)((0,w.Zc)(F,0)),(0,et._9)((0,w.Zc)(0,F)),1),(0,w.w0)(Q.divide(U.x),X.divide(U.y),0,(0,w.ze)(X.divide(U.x)),Q.divide(U.y),0,0,0,1))}(U.id,N,V,st,U.bitset),pt=D.localTileOffset.getPatternOffsetAtTileOrigin(J,V,st),xt=Q.multiply(U.scale).multiply(U.offset.subtract(pt)).divide(N),ft=new w.eB(U.pos,1),Pt=ot.multiply(ft).xy.subtract(xt),mt=U.tlbr.divide(D.mosaicInfo.size.xyxy);let K=(0,et.mh)(U.bitset,H.cn);return null!=D.visualVariableColor&&(K=(0,w.Tk)((0,et.M8)(D.storage.getColorValue(U.id)),new w.nt(0),K)),{tileTextureCoord:Pt,tlbr:mt,sampleAlphaOnly:K}}function b(D,U){const X=(0,w.zi)(U.tileTextureCoord,new w.nt(1)),Q=(0,w.jh)(U.tlbr.xy,U.tlbr.zw,X);let J=(0,w.US)(D.mosaicInfo.texture,Q);return J=(0,w.Tk)((0,w.MM)(U.sampleAlphaOnly,new w.nt(.5)),J.aaaa,J),U.color.multiply(J)}(0,v._)([(0,m.C5)(5,w.Zb)],nt.prototype,"tlbr",void 0),(0,v._)([(0,m.C5)(6,w.nt)],nt.prototype,"width",void 0),(0,v._)([(0,m.C5)(7,w.nt)],nt.prototype,"height",void 0),(0,v._)([(0,m.C5)(8,w.ZY)],nt.prototype,"offset",void 0),(0,v._)([(0,m.C5)(9,w.ZY)],nt.prototype,"scale",void 0),(0,v._)([(0,m.C5)(10,w.nt)],nt.prototype,"angle",void 0);class E extends R.z{vertex(U,X){return{...super.vertex(U,X),...M(this,U)}}fragment(U){const X=b(this,U);return this.getFragmentOutput(X,U,new w.nt(0))}}(0,v._)([(0,m.Pi)(Z.b)],E.prototype,"mosaicInfo",void 0),(0,v._)([(0,m.Pi)(rt.P)],E.prototype,"localTileOffset",void 0),(0,v._)([(0,v.a)(0,(0,m.hF)(nt)),(0,v.a)(1,(0,m.hF)(q.$Z))],E.prototype,"vertex",null),(0,v._)([(0,v.a)(0,(0,m.hF)(class k extends q.DM{}))],E.prototype,"fragment",null)},80302:(At,at,y)=>{y.d(at,{RH:()=>D,cZ:()=>k,v9:()=>M});var v=y(8189),x=y(24821),m=y(3902),w=y(4196),q=y(61254),H=y(6702),R=y(95827),rt=y(83090),Z=y(28580),et=y(3772),nt=y(89148);const k=16,A=1/k,M=128;class b extends w.rz{}(0,v._)([(0,x.C5)(3,m.Zb)],b.prototype,"color",void 0),(0,v._)([(0,x.C5)(4,m.Zb)],b.prototype,"tlbr",void 0),(0,v._)([(0,x.C5)(5,m.nt)],b.prototype,"angle",void 0),(0,v._)([(0,x.C5)(6,m.nt)],b.prototype,"aux1",void 0),(0,v._)([(0,x.C5)(7,m.nt)],b.prototype,"aux2",void 0),(0,v._)([(0,x.C5)(8,m.ZY)],b.prototype,"aux3",void 0),(0,v._)([(0,x.C5)(9,m.ZY)],b.prototype,"aux4",void 0),(0,v._)([(0,x.C5)(10,m.ZY)],b.prototype,"zoomRange",void 0);class D extends et.My{vertex(X,Q){const{aux1:J,aux2:N,aux3:F,aux4:V}=X,st={...X,width:J,height:N,offset:F,scale:V.multiply(A)},ot={...X,halfWidth:J.multiply(A),referenceHalfWidth:N.multiply(A),offset:F.multiply(A),normal:V.subtract(M).multiply(A)},pt=(0,et.Yb)(this,ot),xt=(0,q.KP)(this,st),ft=(0,m.MM)(pt.isOutline,new m.nt(.5));return{...pt,...xt,...this.maybeRunHittest(X,Q,ft)}}fragment(X){const{isOutline:Q}=X,J=(0,m.MM)(Q,new m.nt(.5)),N=(0,R.o7)(X,this.antialiasingControls.blur),F=(0,q.Bh)(this,X),V=(0,m.Tk)(J,N,F),st=(0,m.Tk)(J,new m.nt(1/255),new m.nt(0));return this.getFragmentOutput(V,X,st)}hittest(X,Q,J){return(0,m.Tk)(J,(0,H.My)(this.hittestRequest),(0,H.Lq)(this,X,Q))}}(0,v._)([(0,x.Pi)(Z.b)],D.prototype,"mosaicInfo",void 0),(0,v._)([(0,x.Pi)(rt.P)],D.prototype,"localTileOffset",void 0),(0,v._)([(0,v.a)(0,(0,x.hF)(b)),(0,v.a)(1,(0,x.hF)(w.$Z))],D.prototype,"vertex",null),(0,v._)([(0,v.a)(0,(0,x.hF)(class E extends nt.A1{}))],D.prototype,"fragment",null)},35891:(At,at,y)=>{y.d(at,{_:()=>Z,z:()=>et});var v=y(8189),x=y(24821),m=y(3902),w=y(4196),q=y(6702),H=y(79677),R=y(35255),rt=y(95171);class Z extends w.rz{}(0,v._)([(0,x.C5)(3,m.Zb)],Z.prototype,"color",void 0),(0,v._)([(0,x.C5)(4,m.ZY)],Z.prototype,"zoomRange",void 0);class et extends w.f_{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(k,A){const M=(0,rt.cF)(this,k.id),b=(0,rt.G7)(this,k.id,k.color).multiply(M),E=this.view.displayViewScreenMat3.multiply(new m.eB(k.pos.xy,1)),D=this.clip(k.id,k.zoomRange);return{glPosition:new m.Zb(E.xy,D,1),color:b,...this.maybeRunHittest(k,A,null)}}fragment(k){return this.getFragmentOutput(k.color,k,new m.nt(0))}hittest(k,A){return(0,q.Lq)(this,k,A)}}(0,v._)([(0,x.uK)(H._)],et.prototype,"visualVariableColor",void 0),(0,v._)([(0,x.uK)(R.i)],et.prototype,"visualVariableOpacity",void 0),(0,v._)([(0,v.a)(0,(0,x.hF)(Z)),(0,v.a)(1,(0,x.hF)(w.$Z))],et.prototype,"vertex",null),(0,v._)([(0,v.a)(0,(0,x.hF)(w.DM))],et.prototype,"fragment",null)},95827:(At,at,y)=>{y.d(at,{$0:()=>Q,Xc:()=>M,cM:()=>N,fF:()=>b,fg:()=>E,o7:()=>J,xw:()=>U});var v=y(8189),x=y(24821),m=y(3902),w=y(4196),q=y(90731),H=y(6702),R=y(79677),rt=y(35255),Z=y(2098),et=y(14082),nt=y(25688),k=y(47150),A=y(95171);class M extends w.rz{}(0,v._)([(0,x.C5)(3,m.Zb)],M.prototype,"color",void 0),(0,v._)([(0,x.C5)(4,m.ZY)],M.prototype,"offset",void 0),(0,v._)([(0,x.C5)(5,m.ZY)],M.prototype,"normal",void 0),(0,v._)([(0,x.C5)(6,m.nt)],M.prototype,"halfWidth",void 0),(0,v._)([(0,x.C5)(7,m.nt)],M.prototype,"referenceHalfWidth",void 0),(0,v._)([(0,x.C5)(8,m.ZY)],M.prototype,"zoomRange",void 0);class b extends w.DM{}class E extends x.k2{}function D(F){return(0,m.T9)(new m.nt(q.Fb).multiply((0,m.PM)(F,new m.nt(q.J5))),new m.nt(1))}function U(F,V){const{halfWidth:st,normal:ot}=F,pt=D(st),xt=(0,m.Bw)(ot).multiply(st);return(0,m.qE)(pt.multiply(st.subtract(xt)).divide(V.add(pt).subtract(new m.nt(1))),new m.nt(0),new m.nt(1))}function Q(F,V){const{id:st,offset:ot,pos:pt,normal:xt,zoomRange:ft}=V,{displayViewScreenMat3:Pt,displayViewMat3:mt}=F.view,K=(0,A.G7)(F,st,V.color),W=(0,A.cF)(F,st),zt=function X(F,V){const{id:st,halfWidth:ot,referenceHalfWidth:pt}=V;if((0,A.G5)(F)){const xt=new m.nt(2).multiply(pt),ft=(0,A.Mg)(F,st,xt);return new m.nt(.5).multiply(ot.divide((0,m.T9)(pt,new m.nt(q.Ni)))).multiply(ft)}return ot}(F,V),Wt=new m.nt(.5).multiply(F.antialiasingControls.antialiasing),vt=(0,m.T9)(zt.add(Wt),new m.nt(.45)).add(new m.nt(.1).multiply(Wt)),Dt=D(vt).multiply(vt).multiply(ot),It=mt.multiply(new m.eB(Dt,new m.nt(0))),Vt=Pt.multiply(new m.eB(pt,new m.nt(1))).add(It),Jt=new m.nt(2).multiply((0,m.PM)(zt,new m.nt(0))).add(F.clip(st,ft)),Ot=new m.Zb(Vt.xy,Jt,1);return{color:K,opacity:W,halfWidth:vt,normal:xt,scaledOffset:Dt,scaledHalfWidth:zt,glPosition:new m.Zb(Ot.xy,Jt,1)}}function J(F,V){const{opacity:st,color:ot}=F,pt=U(F,V);return st.multiply(ot).multiply(pt)}(0,v._)([(0,x.Pi)(m.nt)],E.prototype,"antialiasing",void 0),(0,v._)([(0,x.Pi)(m.nt)],E.prototype,"blur",void 0);class N extends w.f_{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(V,st){const ot=Q(this,V);return{...ot,...this.maybeRunHittest(V,st,ot.halfWidth)}}fragment(V){const st=J(V,this.antialiasingControls.blur);return this.getFragmentOutput(st,V)}hittest(V,st,ot){const{viewMat3:pt,tileMat3:xt}=this.view,ft=pt.multiply(xt),Pt=ft.multiply(new m.eB(V.pos,1)),mt=ft.multiply(new m.eB(st.nextPos1,1)),K=ft.multiply(new m.eB(st.nextPos2,1)),{distance:W,smallSymbolDistance:zt,smallSymbolSizeThreshold:Wt}=this.hittestRequest,vt=(0,m.PM)(ot,Wt.multiply(.5)).multiply(W.subtract(zt)),Dt=this.hittestRequest.position;return(0,m.jk)((0,H.E2)(Dt,Pt.xy,mt.xy),(0,H.E2)(Dt,Pt.xy,K.xy)).subtract(ot).add(vt)}}(0,v._)([(0,x.Pi)(E)],N.prototype,"antialiasingControls",void 0),(0,v._)([(0,x.uK)(R._)],N.prototype,"visualVariableColor",void 0),(0,v._)([(0,x.uK)(rt.i)],N.prototype,"visualVariableOpacity",void 0),(0,v._)([(0,x.uK)(Z.n)],N.prototype,"visualVariableSizeMinMaxValue",void 0),(0,v._)([(0,x.uK)(et.F)],N.prototype,"visualVariableSizeScaleStops",void 0),(0,v._)([(0,x.uK)(nt.N)],N.prototype,"visualVariableSizeStops",void 0),(0,v._)([(0,x.uK)(k.d)],N.prototype,"visualVariableSizeUnitValue",void 0),(0,v._)([(0,v.a)(0,(0,x.hF)(M)),(0,v.a)(1,(0,x.hF)(w.$Z))],N.prototype,"vertex",null),(0,v._)([(0,v.a)(0,(0,x.hF)(b))],N.prototype,"fragment",null)},83090:(At,at,y)=>{y.d(at,{P:()=>q});var v=y(8189),x=y(24821),m=y(3902),w=y(90731);class q extends x.k2{getPatternOffsetAtTileOrigin(R,rt=new m.nt(0),Z=new m.nt(1)){const et=new m.ZY(w.YV).divide(R);let nt=R.multiply((0,m.jc)(this.maxIntsToLocalOrigin.multiply(et))).add(this.tileOffsetFromLocalOrigin).subtract(new m.nt(.5).multiply(R));return nt=new m.ZY(nt.x.multiply(Z).subtract(nt.y.multiply(rt)),nt.x.multiply(rt).add(nt.y.multiply(Z))),(0,m.zi)(nt,R)}}(0,v._)([(0,x.Pi)(m.ZY)],q.prototype,"tileOffsetFromLocalOrigin",void 0),(0,v._)([(0,x.Pi)(m.ZY)],q.prototype,"maxIntsToLocalOrigin",void 0)},28580:(At,at,y)=>{y.d(at,{b:()=>w});var v=y(8189),x=y(24821),m=y(3902);class w extends x.k2{}(0,v._)([(0,x.Pi)(m.ZY)],w.prototype,"size",void 0),(0,v._)([(0,x.Pi)(m.z7)],w.prototype,"texture",void 0)},3772:(At,at,y)=>{y.d(at,{A7:()=>D,My:()=>X,Yb:()=>U,nj:()=>Q,wG:()=>E});var v=y(8189),x=y(24821),m=y(3902),w=y(4196),q=y(90731),H=y(6702),R=y(95827),rt=y(875),Z=y(79677),et=y(35255),nt=y(2098),k=y(14082),A=y(25688),M=y(47150),b=y(95171);class E extends w.rz{}(0,v._)([(0,x.C5)(3,m.ZY)],E.prototype,"offset",void 0),(0,v._)([(0,x.C5)(4,m.Zb)],E.prototype,"color",void 0),(0,v._)([(0,x.C5)(5,m.ZY)],E.prototype,"normal",void 0),(0,v._)([(0,x.C5)(6,m.nt)],E.prototype,"halfWidth",void 0),(0,v._)([(0,x.C5)(7,m.nt)],E.prototype,"referenceHalfWidth",void 0),(0,v._)([(0,x.C5)(8,m.ZY)],E.prototype,"zoomRange",void 0);class D extends R.fF{}function U(J,N,F){const{id:V,bitset:st}=N,ot=(0,rt.mh)(st,q.Xx),pt=(0,m.MM)(ot,new m.nt(.5)),xt=(0,R.$0)(J,N),ft=(0,m.Tk)(pt,xt.halfWidth,new m.nt(0)),Pt=(0,b.cF)(J,V),mt=(0,b.G7)(J,V,N.color),K=(0,m.Tk)(pt,N.color,mt.multiply(Pt)),W=J.view.displayViewScreenMat3.multiply(new m.eB(N.pos.xy,1)),zt=J.clip(N.id),Wt=new m.Zb(W.xy,zt,1),vt=(0,m.Tk)(pt,xt.glPosition,Wt),Dt=F&&J.maybeRunHittest(N,F,pt);return{isOutline:ot,color:K,opacity:new m.nt(1),halfWidth:ft,normal:xt.normal,glPosition:vt,...Dt}}class X extends w.f_{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}}(0,v._)([(0,x.Pi)(R.fg)],X.prototype,"antialiasingControls",void 0),(0,v._)([(0,x.uK)(Z._)],X.prototype,"visualVariableColor",void 0),(0,v._)([(0,x.uK)(et.i)],X.prototype,"visualVariableOpacity",void 0),(0,v._)([(0,x.uK)(nt.n)],X.prototype,"visualVariableSizeMinMaxValue",void 0),(0,v._)([(0,x.uK)(k.F)],X.prototype,"visualVariableSizeScaleStops",void 0),(0,v._)([(0,x.uK)(A.N)],X.prototype,"visualVariableSizeStops",void 0),(0,v._)([(0,x.uK)(M.d)],X.prototype,"visualVariableSizeUnitValue",void 0);class Q extends X{vertex(N,F){return U(this,N,F)}fragment(N){const{color:F,isOutline:V}=N,st=(0,m.MM)(V,new m.nt(.5)),ot=(0,R.o7)(N,this.antialiasingControls.blur),pt=(0,m.Tk)(st,ot,F),xt=(0,m.Tk)(st,new m.nt(1/255),new m.nt(0));return this.getFragmentOutput(pt,N,xt)}hittest(N,F,V){return(0,m.Tk)(V,(0,H.My)(this.hittestRequest),(0,H.Lq)(this,N,F))}}(0,v._)([(0,v.a)(0,(0,x.hF)(E)),(0,v.a)(1,(0,x.hF)(w.$Z))],Q.prototype,"vertex",null),(0,v._)([(0,v.a)(0,(0,x.hF)(D))],Q.prototype,"fragment",null)},61312:(At,at,y)=>{y.d(at,{_u:()=>nt,dW:()=>k,vx:()=>A});var v=y(8189),x=y(24821),m=y(3902),w=y(4196),q=y(35891),H=y(83090),R=y(28580);class rt extends q._{}function nt(M,b){const E=b.tlbr.xy,D=b.tlbr.zw,U=D.x.subtract(E.x),X=E.y.subtract(D.y),Q=new m.ZY(U,X).multiply(b.inverseRasterizationScale),J=Q.multiply(M.view.requiredZoomFactor),N=function et(M){const b=new m.nt(1),E=new m.nt(0);return new m.U(b.divide(M.x),E.divide(M.y),0,(0,m.ze)(E.divide(M.x)),b.divide(M.y),0,0,0,1)}(J),F=M.localTileOffset.getPatternOffsetAtTileOrigin(Q).divide(J),V=new m.eB(b.pos,1);return{tileTextureCoord:N.multiply(V).xy.subtract(F),tlbr:b.tlbr.divide(M.mosaicInfo.size.xyxy)}}function k(M,b){const E=(0,m.zi)(M.tileTextureCoord,new m.nt(1)),D=(0,m.jh)(M.tlbr.xy,M.tlbr.zw,E),U=(0,m.US)(b.texture,D);return M.color.multiply(U)}(0,v._)([(0,x.C5)(5,m.Zb)],rt.prototype,"tlbr",void 0),(0,v._)([(0,x.C5)(6,m.nt)],rt.prototype,"inverseRasterizationScale",void 0);class A extends q.z{vertex(b,E){return{...super.vertex(b,E),...nt(this,b)}}fragment(b){const E=k(b,this.mosaicInfo);return this.getFragmentOutput(E,b,new m.nt(0))}}(0,v._)([(0,x.Pi)(R.b)],A.prototype,"mosaicInfo",void 0),(0,v._)([(0,x.Pi)(H.P)],A.prototype,"localTileOffset",void 0),(0,v._)([(0,v.a)(0,(0,x.hF)(rt)),(0,v.a)(1,(0,x.hF)(w.$Z))],A.prototype,"vertex",null),(0,v._)([(0,v.a)(0,(0,x.hF)(class Z extends w.DM{}))],A.prototype,"fragment",null)},89148:(At,at,y)=>{y.d(at,{A1:()=>nt,tA:()=>k});var v=y(8189),x=y(24821),m=y(3902),w=y(4196),q=y(95827),H=y(83090),R=y(28580),rt=y(3772),Z=y(61312);class et extends rt.wG{}(0,v._)([(0,x.C5)(9,m.Zb)],et.prototype,"tlbr",void 0),(0,v._)([(0,x.C5)(10,m.nt)],et.prototype,"inverseRasterizationScale",void 0);class nt extends rt.A7{}class k extends rt.nj{vertex(M,b){return{...(0,rt.Yb)(this,M,b),...(0,Z._u)(this,M)}}fragment(M){const{isOutline:b}=M,E=(0,m.MM)(b,new m.nt(.5)),D=(0,q.o7)(M,this.antialiasingControls.blur),U=(0,Z.dW)(M,this.mosaicInfo),X=(0,m.Tk)(E,D,U),Q=(0,m.Tk)(E,new m.nt(1/255),new m.nt(0));return this.getFragmentOutput(X,M,Q)}}(0,v._)([(0,x.Pi)(R.b)],k.prototype,"mosaicInfo",void 0),(0,v._)([(0,x.Pi)(H.P)],k.prototype,"localTileOffset",void 0),(0,v._)([(0,v.a)(0,(0,x.hF)(et)),(0,v.a)(1,(0,x.hF)(w.$Z))],k.prototype,"vertex",null),(0,v._)([(0,v.a)(0,(0,x.hF)(nt))],k.prototype,"fragment",null)},16585:(At,at,y)=>{y.d(at,{o:()=>w});var v=y(8189),x=y(24821),m=y(3902);class w extends x.k2{}(0,v._)([(0,x.Pi)(m.U)],w.prototype,"displayViewScreenMat3",void 0),(0,v._)([(0,x.Pi)(m.U)],w.prototype,"displayViewMat3",void 0),(0,v._)([(0,x.Pi)(m.U)],w.prototype,"displayMat3",void 0),(0,v._)([(0,x.Pi)(m.U)],w.prototype,"viewMat3",void 0),(0,v._)([(0,x.Pi)(m.U)],w.prototype,"tileMat3",void 0),(0,v._)([(0,x.Pi)(m.nt)],w.prototype,"displayZoomFactor",void 0),(0,v._)([(0,x.Pi)(m.nt)],w.prototype,"requiredZoomFactor",void 0),(0,v._)([(0,x.Pi)(m.ZY)],w.prototype,"tileOffset",void 0),(0,v._)([(0,x.Pi)(m.nt)],w.prototype,"currentScale",void 0),(0,v._)([(0,x.Pi)(m.nt)],w.prototype,"currentZoom",void 0),(0,v._)([(0,x.Pi)(m.nt)],w.prototype,"metersPerSRUnit",void 0),(0,v._)([(0,x.Pi)(m.nt)],w.prototype,"rotation",void 0),(0,v._)([(0,x.Pi)(m.nt)],w.prototype,"pixelRatio",void 0)},79677:(At,at,y)=>{y.d(at,{_:()=>q});var v=y(8189),x=y(24821),m=y(3902),w=y(875);class q extends x.k2{getColor(R,rt,Z){return(0,m.j1)([(0,m.or)((0,w.M8)(R),Z),rt],[(0,m.$5)(R,this.values.first()),this.colors.first()],[(0,m.aX)(R,this.values.last()),this.colors.last()],[!0,()=>{const et=this.values.findIndex(b=>(0,m.MM)(b,R)),nt=this.values.get(et),k=et.subtract(1),A=this.values.get(k),M=R.subtract(A).divide(nt.subtract(A));return(0,m.jh)(this.colors.get(k),this.colors.get(et),M)}])}}(0,v._)([(0,x.Pi)(m.My.ofType(m.Zb,8))],q.prototype,"colors",void 0),(0,v._)([(0,x.Pi)(m.My.ofType(m.nt,8))],q.prototype,"values",void 0)},35255:(At,at,y)=>{y.d(at,{i:()=>q});var v=y(8189),x=y(24821),m=y(3902),w=y(875);class q extends x.k2{getOpacity(R){return(0,m.j1)([(0,w.M8)(R),new m.nt(1)],[(0,m.$5)(R,this.opacityValues.first()),this.opacities.first()],[(0,m.aX)(R,this.opacityValues.last()),this.opacities.last()],[!0,()=>{const rt=this.opacityValues.findIndex(A=>(0,m.MM)(A,R)),Z=this.opacityValues.get(rt),et=rt.subtract(1),nt=this.opacityValues.get(et),k=R.subtract(nt).divide(Z.subtract(nt));return(0,m.jh)(this.opacities.get(et),this.opacities.get(rt),k)}])}}(0,v._)([(0,x.Pi)(m.My.ofType(m.nt,8))],q.prototype,"opacities",void 0),(0,v._)([(0,x.Pi)(m.My.ofType(m.nt,8))],q.prototype,"opacityValues",void 0)},2098:(At,at,y)=>{y.d(at,{n:()=>q});var v=y(8189),x=y(24821),m=y(3902),w=y(875);class q extends x.k2{getSize(R,rt){const Z=this.minMaxValueAndSize.xy,et=this.minMaxValueAndSize.zw;return(0,m.Tk)((0,w.M8)(R),rt,()=>{const nt=R.subtract(Z.x).divide(Z.y.subtract(Z.x)),k=(0,m.qE)(nt,new m.nt(0),new m.nt(1));return et.x.add(k.multiply(et.y.subtract(et.x)))})}}(0,v._)([(0,x.Pi)(m.Zb)],q.prototype,"minMaxValueAndSize",void 0)},14082:(At,at,y)=>{y.d(at,{F:()=>w});var v=y(8189),x=y(24821),m=y(3902);class w extends x.k2{getSizeForViewScale(H){return(0,m.j1)([(0,m.$5)(H,this.values.first()),this.sizes.first()],[(0,m.aX)(H,this.values.last()),this.sizes.last()],[!0,()=>{const R=this.values.findIndex(k=>(0,m.MM)(k,H)),rt=this.values.get(R),Z=R.subtract(1),et=this.values.get(Z),nt=H.subtract(et).divide(rt.subtract(et));return(0,m.jh)(this.sizes.get(Z),this.sizes.get(R),nt)}])}}(0,v._)([(0,x.Pi)(m.My.ofType(m.nt,8))],w.prototype,"sizes",void 0),(0,v._)([(0,x.Pi)(m.My.ofType(m.nt,8))],w.prototype,"values",void 0)},25688:(At,at,y)=>{y.d(at,{N:()=>q});var v=y(8189),x=y(24821),m=y(3902),w=y(875);class q extends x.k2{getSize(R,rt){const Z=(0,m.j1)([(0,w.M8)(R),rt],[(0,m.$5)(R,this.values.first()),this.sizes.first()],[(0,m.aX)(R,this.values.last()),this.sizes.last()],[!0,()=>{const et=this.values.findIndex(b=>(0,m.MM)(b,R)),nt=this.values.get(et),k=et.subtract(1),A=this.values.get(k),M=R.subtract(A).divide(nt.subtract(A));return(0,m.jh)(this.sizes.get(k),this.sizes.get(et),M)}]);return(0,m.Tk)((0,w.M8)(Z),rt,Z)}}(0,v._)([(0,x.Pi)(m.My.ofType(m.nt,8))],q.prototype,"sizes",void 0),(0,v._)([(0,x.Pi)(m.My.ofType(m.nt,8))],q.prototype,"values",void 0)},47150:(At,at,y)=>{y.d(at,{d:()=>q});var v=y(8189),x=y(24821),m=y(3902),w=y(875);class q extends x.k2{getSize(R,rt){return(0,m.Tk)((0,w.M8)(R),rt,R.multiply(this.unitValueToPixelsRatio))}}(0,v._)([(0,x.Pi)(m.nt)],q.prototype,"unitValueToPixelsRatio",void 0)},90731:(At,at,y)=>{var v,It;y.d(at,{$w:()=>M,A:()=>K,Fb:()=>rt,Fz:()=>Pt,H_:()=>v,J5:()=>Z,M:()=>D,Ni:()=>E,V5:()=>R,Xx:()=>ft,YV:()=>Dt,au:()=>A,b5:()=>zt,bg:()=>Wt,cn:()=>st,kx:()=>W,lx:()=>mt,os:()=>x,qM:()=>F,rp:()=>m,ti:()=>vt}),(It=v||(v={}))[It.Geographic=0]="Geographic",It[It.Arithmatic=1]="Arithmatic";const x=3.14159265359/180,m=3.14159265359/128,R=1,rt=1.1,Z=1,A=24,M=8,E=1e-5,D=.05,F=1e-30,st=4,ft=0,Pt=2,mt=5,K=6,W=2,zt=3,Wt=0,vt=3,Dt=16777216},6702:(At,at,y)=>{y.d(at,{Bo:()=>Z,Bs:()=>R,E2:()=>q,Lq:()=>nt,My:()=>et,g$:()=>k,kW:()=>H});var v=y(3902),x=y(90731),m=y(875);function q(A,M,b){const E=b.subtract(M),D=function w(A,M){return(0,v.Om)(A,(0,v.S8)(M))}(A.subtract(M),E),U=(0,v.qE)(D.divide((0,v.Bw)(E)),new v.nt(0),new v.nt(1));return(0,v.Io)(A,M.add(U.multiply(b.subtract(M))))}function H(A){const M=(0,v.tn)(A);return(0,v.PM)(M.x.add(M.y).add(M.z),new v.nt(1.05))}function R(A,M,b,E){const D=new v.U(b.x.multiply(E.y).subtract(E.x.multiply(b.y)),E.x.multiply(M.y).subtract(M.x.multiply(E.y)),M.x.multiply(b.y).subtract(b.x.multiply(M.y)),b.y.subtract(E.y),E.y.subtract(M.y),M.y.subtract(b.y),E.x.subtract(b.x),M.x.subtract(E.x),b.x.subtract(M.x)),U=M.x.multiply(b.y.subtract(E.y)),X=b.x.multiply(E.y.subtract(M.y)),Q=E.x.multiply(M.y.subtract(b.y)),J=U.add(X).add(Q);return new v.nt(1).divide(J).multiply(D.multiply(new v.eB(1,A)))}function rt(A,M,b,E){return(0,v.LC)(H(R(A,M,b,E)),new v.nt(1))}function Z(A,M,b,E){const D=b.subtract(M),U=E.subtract(M),X=(0,m.tL)(D,U),Q=(0,v.Uo)((0,v.Xe)(X,new v.nt(x.M)),(0,v.MM)(X,new v.nt(-x.M)));return(0,v.j1)([(0,v.Uo)((0,v.AU)(Q),rt(A.xy,M,b,E)),new v.nt(-1)],[!0,()=>{const J=q(A,M,b),N=q(A,b,E),F=q(A,E,M);return(0,v.jk)((0,v.jk)(J,N),F)}])}function et(A){return A.distance.add(1)}function nt(A,M,b){const{viewMat3:E,tileMat3:D}=A.view,U=E.multiply(D),X=U.multiply(new v.eB(M.pos,1)),Q=U.multiply(new v.eB(b.nextPos1,1)),J=U.multiply(new v.eB(b.nextPos2,1));return Z(A.hittestRequest.position,X.xy,Q.xy,J.xy)}function k(A,M,b){return(0,v.Io)(A,b).subtract(M)}},875:(At,at,y)=>{y.d(at,{K5:()=>et,Kt:()=>A,M8:()=>q,Rj:()=>M,_9:()=>w,i6:()=>nt,mh:()=>Z,nb:()=>rt,tL:()=>R,xf:()=>b,yS:()=>k});var v=y(25735),x=y(3902),m=y(90731);function w(E){const D=(0,x.fV)(12.9898),U=(0,x.fV)(78.233),X=(0,x.fV)(43758.5453),Q=(0,x.Om)(E,(0,x.Zc)(D,U)),J=(0,x.zi)(Q,(0,x.fV)(3.14));return(0,x.jc)((0,x.F8)(J).multiply(X))}function q(E){return(0,x.LC)(E,(0,x.fV)(m.qM))}function R(E,D){return E.x.multiply(D.y).subtract(D.x.multiply(E.y))}function rt(E){return E.multiply(2).subtract(1)}function Z(E,D){const U=(0,x.fV)(2**D);return(0,x.zi)((0,x.RI)(E.divide(U)),(0,x.fV)(2))}function et(E,D){return(0,x.MM)(Z(E,D),(0,x.fV)(.5))}function nt(E,D){return Z(E,D+v.M$.length)}function k(E,D){return Z(E,D)}function A(E){const D=Z(E.z,7),U=(0,x.fV)(1).subtract(D),X=E.xyz.subtract((0,x.eR)(0,0,(0,x.fV)(128)));return U.multiply(E).add(D.multiply(X))}function M(E){const D=(0,x.ln)(.99609375,.0038909912109375,1519918441772461e-20,5.9371814131736755e-8);return(0,x.Om)(E,D)}function b(E){return(0,x.T9)((0,x.T9)((0,x.T9)(E.x,E.y),E.z),E.w)}},95171:(At,at,y)=>{y.d(at,{G5:()=>x,G7:()=>w,Mg:()=>m,TL:()=>H,cF:()=>q});var v=y(3902);function x(R){return null!=R.visualVariableSizeMinMaxValue||null!=R.visualVariableSizeScaleStops||null!=R.visualVariableSizeStops||null!=R.visualVariableSizeUnitValue}function m(R,rt,Z){if(x(R)){var et,nt,k,A,M,b,E;const D=R.storage.getSizeValue(rt);return null!==(et=null!==(nt=null!==(k=null===(A=R.visualVariableSizeMinMaxValue)||void 0===A?void 0:A.getSize(D,Z))&&void 0!==k?k:null===(M=R.visualVariableSizeScaleStops)||void 0===M?void 0:M.getSizeForViewScale(R.view.currentScale))&&void 0!==nt?nt:null===(b=R.visualVariableSizeStops)||void 0===b?void 0:b.getSize(D,Z))&&void 0!==et?et:null===(E=R.visualVariableSizeUnitValue)||void 0===E?void 0:E.getSize(D,Z)}return Z}function w(R,rt,Z,et=new v.x(!1)){if(null==R.visualVariableColor)return Z;const nt=R.storage.getColorValue(rt);return R.visualVariableColor.getColor(nt,Z,et)}function q(R,rt){if(null==R.visualVariableOpacity)return new v.nt(1);const Z=R.storage.getOpacityValue(rt);return R.visualVariableOpacity.getOpacity(Z)}function H(R,rt){if(null==R.visualVariableRotation)return v.U.identity();const Z=R.storage.getRotationValue(rt);return R.visualVariableRotation.getVVRotationMat3(Z)}},77989:(At,at,y)=>{y.d(at,{K:()=>b});var v=y(5922),x=y(35150),m=y(89221),Z=(y(40707),y(3248),y(77440),y(50915),y(79061),y(23063)),k=(y(68165),y(26136),y(24370));function M(E,D,U){const X=D.length;if(X!==U){const Q=new v.A("Invalid Uniform",`Invalid length, expected ${U} but got ${X}`,{uniformName:E,values:D});x.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.typed.TypedShaderProgram").errorOnce(Q)}}class b{constructor(D,U,X,Q,J,N){this._program=null,this._vao=null,this._temporaryTextures=[],this.vertexShader=D,this.fragmentShader=U,this._locations=X,this._locationInfo=Q,this._uniformBindings=J,this._transformFeedbackBindings=N}destroy(){this._program&&this._program.dispose(),this.cleanupTemporaryTextures()}get locations(){return this._locations}get locationInfo(){return this._locationInfo}setUniforms(D){this._uniforms=D}cleanupTemporaryTextures(){for(const D of this._temporaryTextures)D.dispose();this._temporaryTextures=[]}bind(D){const U=this._uniforms;if(!this._program){const J=new Map;for(const[F,V]of this._locations)J.set(F,V);const N=[];for(const F of null!==(X=this._transformFeedbackBindings)&&void 0!==X?X:[]){var X;const{index:V,propertyKey:st}=F;N[V]=`v_${st}`}this._program=new Z.B(D,this.vertexShader,this.fragmentShader,J,new Map,N)}const Q=this._program;D.useProgram(Q);for(const J of this._uniformBindings){const{shaderModulePath:N,uniformName:F,uniformType:V,uniformArrayLength:st}=J,ot=(0,m.wc)(N,U);if(null==ot){if("sampler2D"===V)continue;throw new Error(`Failed to find uniform value for ${N}`)}switch("array"===V?J.uniformArrayElementType:V){case"sampler2D":{const{unit:pt,texture:xt}=ot;if(Q.setUniform1i(F,pt),"type"in xt)D.bindTexture(xt,pt);else{const ft=(0,k.sZ)(D,xt.descriptor,xt.data);D.bindTexture(ft,pt)}break}case"int":if(!st){Q.setUniform1i(F,ot);break}M(J.uniformName,ot,st),Q.setUniform1iv(F,ot);break;case"float":if(!st){Q.setUniform1f(F,ot);break}M(J.uniformName,ot,st),Q.setUniform1fv(F,ot);break;case"vec2":if(!st){Q.setUniform2f(F,ot[0],ot[1]);break}M(J.uniformName,ot,st),Q.setUniform2fv(F,ot.flat());break;case"vec3":if(!st){Q.setUniform3f(F,ot[0],ot[1],ot[2]);break}M(J.uniformName,ot,st),Q.setUniform3fv(F,ot.flat());break;case"vec4":if(!st){Q.setUniform4f(F,ot[0],ot[1],ot[2],ot[3]);break}M(J.uniformName,ot,st),Q.setUniform4fv(F,ot.flat());break;case"mat3":Q.setUniformMatrix3fv(F,ot.flat());break;case"mat4":Q.setUniformMatrix4fv(F,ot.flat());break;default:throw new Error(`Unable to set uniform for type ${V}`)}}}}},35547:(At,at,y)=>{y.d(at,{F:()=>nt});var v=y(8189),x=y(98877),m=y(3248),w=y(12619),q=y(48900),H=y(85211),Z=(y(35150),y(40707),y(76576)),et=y(56985);let nt=class extends x.A{constructor(k){super(k),this.debugName="",this._updatingHandles=new et.U,this._idToUpdatingState=new w.A}get updating(){const k=this._updatingHandles.updating||Array.from(this._idToUpdatingState.values()).some(A=>A);if((0,m.A)("esri-2d-log-updating")){const A=Array.from(this._idToUpdatingState.entries()).map(([M,b])=>`-> ${M}: ${b}`).join("\n");console.log(`${this.debugName}: Updating: ${k}\n-> Handles: ${this._updatingHandles.updating}\n${A}`)}return k}addUpdateTracking(k,A){const M=(0,q.wB)(()=>A.updating,b=>this._idToUpdatingState.set(k,b),{sync:!0});this.addHandles(M)}addPromise(k){return this._updatingHandles.addPromise(k)}};(0,v._)([(0,H.MZ)({constructOnly:!0})],nt.prototype,"debugName",void 0),(0,v._)([(0,H.MZ)({readOnly:!0})],nt.prototype,"updating",null),nt=(0,v._)([(0,Z.$)("esri.view.2d.layers.support.UpdateTracking2D")],nt)},20951:(At,at,y)=>{var v,x;y.d(at,{c:()=>v}),(x=v||(v={}))[x.Pass=0]="Pass",x[x.Draw=1]="Draw"},65388:(At,at,y)=>{y.d(at,{O_:()=>rt,vA:()=>H}),y(45475),y(53781),(0,y(89141).vt)();class q{constructor(b){this.message=b}toString(){return`AssertException: ${this.message}`}}function H(M,b){if(!M){b=b||"Assertion";const E=new Error(b).stack;throw new q(`${b} at ${E}`)}}function rt(M,b,E,D){let U,X=(E[0]-M[0])/b[0],Q=(D[0]-M[0])/b[0];X>Q&&(U=X,X=Q,Q=U);let J=(E[1]-M[1])/b[1],N=(D[1]-M[1])/b[1];if(J>N&&(U=J,J=N,N=U),X>N||J>Q)return!1;J>X&&(X=J),N<Q&&(Q=N);let F=(E[2]-M[2])/b[2],V=(D[2]-M[2])/b[2];return F>V&&(U=F,F=V,V=U),!(X>V||F>Q||(V<Q&&(Q=V),Q<0))}}}]);