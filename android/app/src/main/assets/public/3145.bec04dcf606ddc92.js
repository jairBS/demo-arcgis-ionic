"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3145,7340],{23506:(C,v,r)=>{r.d(v,{v:()=>d});var l=r(99305);function d(y){null!=y&&y.writtenProperties&&y.writtenProperties.forEach(({target:i,propName:m,newOrigin:p})=>{(0,l.H)(i)&&p&&i.originOf(m)!==p&&i.updateOrigin(m,p)})}},99305:(C,v,r)=>{function l(d){return d&&"getAtOrigin"in d&&"originOf"in d}r.d(v,{H:()=>l})},44905:(C,v,r)=>{r.r(v),r.d(v,{save:()=>a,saveAs:()=>c});var l=r(10467),d=r(17994),y=r(15764),i=r(69927),m=r(3458);const p="Media Layer",f="media-layer-save",D="media-layer-save-as",E=["media-layer:unsupported-source"];function P(u){return{isValid:"media"===u.type,errorMessage:"Layer.type should be 'media'"}}function O(u){return(0,y.m)(u,"portal-item",!0)}function g(u){return u.layerJSON}function M(u,e){return s.apply(this,arguments)}function s(){return(s=(0,l.A)(function*(u,e){const{title:t,fullExtent:o}=u;e.title||(e.title=t),e.extent=o?yield(0,i.sQ)(o):null,(0,i.OM)(e,i.mm.METADATA)})).apply(this,arguments)}function a(u,e){return h.apply(this,arguments)}function h(){return(h=(0,l.A)(function*(u,e){return(0,d.UN)({layer:u,itemType:p,validateLayer:P,createJSONContext:t=>O(t),createItemData:g,errorNamePrefix:f,supplementalUnsupportedErrors:E,saveResources:(t,o)=>(0,m.r)(u.resourceReferences,o)},e)})).apply(this,arguments)}function c(u,e,t){return U.apply(this,arguments)}function U(){return(U=(0,l.A)(function*(u,e,t){return(0,d.Uh)({layer:u,itemType:p,validateLayer:P,createJSONContext:o=>O(o),createItemData:g,errorNamePrefix:D,supplementalUnsupportedErrors:E,newItem:e,setItemProperties:M,saveResources:(o,_)=>(0,m.r)(u.resourceReferences,_)},t)})).apply(this,arguments)}},15764:(C,v,r)=>{r.d(v,{m:()=>i,v:()=>y});var l=r(45272),d=r(73874);function y(p,f){return{...m(p,f),readResourcePaths:[]}}function i(p,f,D){const E=(0,l.An)(p.itemUrl);return{...m(p,f),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:E?{rootPath:E.path,writtenUrls:[]}:null,resources:D?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function m(p,f){return{origin:f,url:(0,l.An)(p.itemUrl),portal:p.portal||d.A.getDefault(),portalItem:p}}},57340:(C,v,r)=>{r.r(v),r.d(v,{addOrUpdateResources:()=>f,contentToBlob:()=>h,fetchResources:()=>m,getSiblingOfSameType:()=>U,getSiblingOfSameTypeI:()=>u,removeAllResources:()=>O,removeResource:()=>E,splitPrefixFileNameAndExtension:()=>s});var l=r(10467),d=r(89563),y=r(5922),i=r(45272);function m(e){return p.apply(this,arguments)}function p(){return(p=(0,l.A)(function*(e,t={},o){yield e.load(o);const _=(0,i.fj)(e.itemUrl,"resources"),{start:x=1,num:n=10,sortOrder:A="asc",sortField:j="resource"}=t,R={query:{start:x,num:n,sortOrder:A,sortField:j,token:e.apiKey},signal:null==o?void 0:o.signal},I=yield e.portal.request(_,R);return{total:I.total,nextStart:I.nextStart,resources:I.resources.map(({created:K,size:T,resource:L})=>({created:new Date(K),size:T,resource:e.resourceFromPath(L)}))}})).apply(this,arguments)}function f(e,t,o,_){return D.apply(this,arguments)}function D(){return(D=(0,l.A)(function*(e,t,o,_){const x=new Map;for(const{resource:A,content:j,compress:R,access:I}of t){if(!A.hasPath())throw new y.A(`portal-item-resource-${o}:invalid-path`,"Resource does not have a valid path");const[K,T]=M(A.path),L=`${K}/${null!=R?R:""}/${null!=I?I:""}`;x.has(L)||x.set(L,{prefix:K,compress:R,access:I,files:[]}),x.get(L).files.push({fileName:T,content:j})}yield e.load(_);const n=(0,i.fj)(e.userItemUrl,"add"===o?"addResources":"updateResources");for(const{prefix:A,compress:j,access:R,files:I}of x.values())for(let T=0;T<I.length;T+=25){const L=I.slice(T,T+25),B=new FormData;A&&"."!==A&&B.append("resourcesPrefix",A),j&&B.append("compress","true"),R&&B.append("access",R);let b=0;for(const{fileName:S,content:w}of L)B.append("file"+ ++b,w,S);B.append("f","json"),yield e.portal.request(n,{method:"post",body:B,signal:null==_?void 0:_.signal})}})).apply(this,arguments)}function E(e,t,o){return P.apply(this,arguments)}function P(){return(P=(0,l.A)(function*(e,t,o){if(!t.hasPath())throw new y.A("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield e.load(o);const _=(0,i.fj)(e.userItemUrl,"removeResources");yield e.portal.request(_,{method:"post",query:{resource:t.path},signal:null==o?void 0:o.signal}),t.portalItem=null})).apply(this,arguments)}function O(e,t){return g.apply(this,arguments)}function g(){return(g=(0,l.A)(function*(e,t){yield e.load(t);const o=(0,i.fj)(e.userItemUrl,"removeResources");return e.portal.request(o,{method:"post",query:{deleteAll:!0},signal:null==t?void 0:t.signal})})).apply(this,arguments)}function M(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function s(e){const[t,o]=function a(e){const t=(0,i.Zo)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[_,x]=M(t);return[_,x,o]}function h(e){return c.apply(this,arguments)}function c(){return(c=(0,l.A)(function*(e){return"blob"===e.type?e.blob:"json"===e.type?new Blob([e.jsonString],{type:"application/json"}):(yield(0,d.A)(e.url,{responseType:"blob"})).data})).apply(this,arguments)}function U(e,t){if(!e.hasPath())return null;const[o,,_]=s(e.path);return e.portalItem.resourceFromPath((0,i.fj)(o,t+_))}function u(e,t){if(!e.hasPath())return null;const[o,,_]=s(e.path);return e.portalItem.resourceFromPath((0,i.fj)(o,t+_))}},3458:(C,v,r)=>{r.d(v,{S:()=>D,r:()=>p});var l=r(10467),d=r(5922),y=r(56492),i=r(43085),m=r(57340);function p(s,a,h){return f.apply(this,arguments)}function f(){return(f=(0,l.A)(function*(s,a,h){const c=yield P(s,a,h);yield g(c,a,h)})).apply(this,arguments)}function D(s,a,h,c,U){return E.apply(this,arguments)}function E(){return(E=(0,l.A)(function*(s,a,h,c,U){const u=yield P(h,c,U);yield s.update({data:a}),yield g(u,c,U)})).apply(this,arguments)}function P(s,a,h){return O.apply(this,arguments)}function O(){return(O=(0,l.A)(function*(s,a,h){if(null==a||!a.resources)return;const c=a.portalItem===s.portalItem?new Set(s.paths):new Set;s.paths.length=0,s.portalItem=a.portalItem;const U=new Set(a.resources.toKeep.map(n=>n.resource.path)),u=new Set,e=[];U.forEach(n=>{c.delete(n),s.paths.push(n)});const t=[],o=[],_=[];for(const n of a.resources.toUpdate)if(c.delete(n.resource.path),U.has(n.resource.path)||u.has(n.resource.path)){const{resource:A,content:j,finish:R}=n,I=(0,m.getSiblingOfSameTypeI)(A,(0,i.lk)());s.paths.push(I.path),t.push({resource:I,content:yield(0,m.contentToBlob)(j),compress:n.compress}),R&&_.push(()=>R(I))}else{s.paths.push(n.resource.path),o.push({resource:n.resource,content:yield(0,m.contentToBlob)(n.content),compress:n.compress});const A=n.finish;A&&_.push(()=>A(n.resource)),u.add(n.resource.path)}for(const n of a.resources.toAdd)if(s.paths.push(n.resource.path),c.has(n.resource.path))c.delete(n.resource.path);else{t.push({resource:n.resource,content:yield(0,m.contentToBlob)(n.content),compress:n.compress});const A=n.finish;A&&_.push(()=>A(n.resource))}if(t.length||o.length){const{addOrUpdateResources:n}=yield Promise.resolve().then(r.bind(r,57340));yield n(a.portalItem,t,"add",h),yield n(a.portalItem,o,"update",h)}if(_.forEach(n=>n()),0===e.length)return c;const x=yield(0,y.Ol)(e);if((0,y.Te)(h),x.length>0)throw new d.A("save:resources","Failed to save one or more resources",{errors:x});return c})).apply(this,arguments)}function g(s,a,h){return M.apply(this,arguments)}function M(){return(M=(0,l.A)(function*(s,a,h){if(!s||!a.portalItem)return;const c=[];for(const U of s){const u=a.portalItem.resourceFromPath(U);c.push(u.portalItem.removeResource(u,h))}yield(0,y.Lx)(c)})).apply(this,arguments)}},96904:(C,v,r)=>{r.d(v,{X:()=>i});var l=r(23098),d=r(5922),y=r(2174);function i(m){if(l.A.apiKey&&(0,y.Q)(m.portal.url))throw new d.A("save-api-key-utils:api-key-not-supported",`Saving is not supported on ${m.portal.url} when using an api key`)}},95945:(C,v,r)=>{r.d(v,{c:()=>p,d:()=>y});var l=r(10467),d=r(5922);function y(f){return i.apply(this,arguments)}function i(){return(i=(0,l.A)(function*(f){const D=[];for(const E of f.allLayers)if("beforeSave"in E&&"function"==typeof E.beforeSave){const P=E.beforeSave();P&&D.push(P)}yield Promise.allSettled(D)})).apply(this,arguments)}const m=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function p(f,D,E){var P;let O=(null!==(P=f.messages)&&void 0!==P?P:[]).filter(({type:g})=>"error"===g).map(({name:g,message:M,details:s})=>new d.A(g,M,s));if(f.blockedRelativeUrls&&(O=O.concat(f.blockedRelativeUrls.map(g=>new d.A("url:unsupported",`Relative url '${g}' is not supported`)))),E){const{ignoreUnsupported:g,supplementalUnsupportedErrors:M=[],requiredPropertyChecksDisabled:s}=E;g&&(O=O.filter(({name:a})=>!(m.has(a)||M.includes(a)))),s&&(O=O.filter(a=>"web-document-write:property-required"!==a.name))}if(O.length>0)throw new d.A(D.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:O})}}}]);