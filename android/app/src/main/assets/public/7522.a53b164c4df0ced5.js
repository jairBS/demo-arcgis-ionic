"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7522],{64765:(I,E,g)=>{var _,x,o;function C(o){return o&&"esri.renderers.visualVariables.SizeVariable"===o.declaredClass}function M(o){return null!=o&&!isNaN(o)&&isFinite(o)}function y(o){return o.valueExpression?_.Expression:o.field&&"string"==typeof o.field?_.Field:_.Unknown}function b(o,D){return(D||y(o))===_.Unknown?x.Constant:o.stops?x.Stops:null!=o.minSize&&null!=o.maxSize&&null!=o.minDataValue&&null!=o.maxDataValue?x.ClampedLinear:"unknown"===(o.valueUnit||"unknown")?null!=o.minSize&&null!=o.minDataValue?o.minSize&&o.minDataValue?x.Proportional:x.Additive:x.Identity:x.RealWorldSize}g.d(E,{KZ:()=>b,Yf:()=>_,_w:()=>x,eh:()=>y,gf:()=>M,of:()=>C}),(o=_||(_={})).Unknown="unknown",o.Expression="expression",o.Field="field",function(o){o.Unknown="unknown",o.Stops="stops",o.ClampedLinear="clamped-linear",o.Proportional="proportional",o.Additive="additive",o.Constant="constant",o.Identity="identity",o.RealWorldSize="real-world-size"}(x||(x={}))},77522:(I,E,g)=>{g.r(E),g.d(E,{getAllSizes:()=>H,getColor:()=>T,getOpacity:()=>A,getRotationAngle:()=>N,getSize:()=>F,getSizeForValue:()=>P,getSizeFromNumberOrVariable:()=>V,getSizeRangeAtScale:()=>G,getVisualVariableValues:()=>X,viewScaleRE:()=>U});var _=g(68677),x=g(81098),C=g(69690),M=g(35150),y=g(48716),b=g(64765);const o=()=>M.A.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),D=new x.A,S=Math.PI,U=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function T(a,i,n){const e="visualVariables"in a&&a.visualVariables?a.visualVariables.find(c=>"color"===c.type):a;if(!e)return;if("esri.renderers.visualVariables.ColorVariable"!==e.declaredClass)return void o().warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const t="number"==typeof i,r=t?null:i,l=null==r?void 0:r.attributes;let u=t?i:null;const s=e.field,{ipData:d,hasExpression:p}=e.cache;let f=e.cache.compiledFunc;if(!s&&!p){const c=e.stops;return c&&c[0]&&c[0].color}if("number"!=typeof u)if(p){if(null==(null==n?void 0:n.arcade))return void o().error("Use of arcade expressions requires an arcade context");const v=n.arcade.arcadeUtils,w=v.getViewInfo({viewingMode:n.viewingMode,scale:n.scale,spatialReference:n.spatialReference}),z=v.createExecContext(r,w,n.timeZone);if(!f){const k=v.createSyntaxTree(e.valueExpression);f=v.createFunction(k),e.cache.compiledFunc=f}u=v.executeFunction(f,z)}else l&&(u=l[s]);const h=e.normalizationField,m=null!=l&&null!=h?parseFloat(l[h]):void 0;if(null!=u&&(!h||t||!isNaN(m)&&0!==m)){isNaN(m)||t||(u/=m);const c=R(u,d);if(c){const v=c[0],w=c[1],z=v===w?e.stops[v].color:_.A.blendColors(e.stops[v].color,e.stops[w].color,c[2],null!=n?n.color:void 0);return new _.A(z)}}}function A(a,i,n){const e="visualVariables"in a&&a.visualVariables?a.visualVariables.find(c=>"opacity"===c.type):a;if(!e)return;if("esri.renderers.visualVariables.OpacityVariable"!==e.declaredClass)return void o().warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const t="number"==typeof i,r=t?null:i,l=null==r?void 0:r.attributes;let u=t?i:null;const s=e.field,{ipData:d,hasExpression:p}=e.cache;let f=e.cache.compiledFunc;if(!s&&!p){const c=e.stops;return c&&c[0]&&c[0].opacity}if("number"!=typeof u)if(p){if(null==(null==n?void 0:n.arcade))return void o().error("Use of arcade expressions requires an arcade context");const v=n.arcade.arcadeUtils,w=v.getViewInfo({viewingMode:n.viewingMode,scale:n.scale,spatialReference:n.spatialReference}),z=v.createExecContext(r,w,n.timeZone);if(!f){const k=v.createSyntaxTree(e.valueExpression);f=v.createFunction(k),e.cache.compiledFunc=f}u=v.executeFunction(f,z)}else l&&(u=l[s]);const h=e.normalizationField,m=null!=l&&null!=h?parseFloat(l[h]):void 0;if(null!=u&&(!h||t||!isNaN(m)&&0!==m)){isNaN(m)||t||(u/=m);const c=R(u,d);if(c){const v=c[0],w=c[1];if(v===w)return e.stops[v].opacity;{const z=e.stops[v].opacity;return z+(e.stops[w].opacity-z)*c[2]}}}}function N(a,i,n){const e="visualVariables"in a&&a.visualVariables?a.visualVariables.find(m=>"rotation"===m.type):a;if(!e)return;if("esri.renderers.visualVariables.RotationVariable"!==e.declaredClass)return void o().warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const t=e.axis||"heading",r="heading"===t&&"arithmetic"===e.rotationType?90:0,l="heading"===t&&"arithmetic"===e.rotationType?-1:1,u="number"==typeof i?null:i,s=null==u?void 0:u.attributes,d=e.field,{hasExpression:p}=e.cache;let f=e.cache.compiledFunc,h=0;if(!d&&!p)return h;if(p){if(null==(null==n?void 0:n.arcade))return void o().error("Use of arcade expressions requires an arcade context");const c=n.arcade.arcadeUtils,v=c.getViewInfo({viewingMode:n.viewingMode,scale:n.scale,spatialReference:n.spatialReference}),w=c.createExecContext(u,v,n.timeZone);if(!f){const z=c.createSyntaxTree(e.valueExpression);f=c.createFunction(z),e.cache.compiledFunc=f}h=c.executeFunction(f,w)}else s&&(h=s[d]||0);return h="number"!=typeof h||isNaN(h)?null:r+l*h,h}function F(a,i,n){const e="visualVariables"in a&&a.visualVariables?a.visualVariables.find(r=>"size"===r.type):a;if(!e)return;if("esri.renderers.visualVariables.SizeVariable"!==e.declaredClass)return void o().warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const t=P(function L(a,i,n){const e="number"==typeof i,t=e?null:i,r=null==t?void 0:t.attributes;let l=e?i:null;const{isScaleDriven:u}=a.cache;let s=a.cache.compiledFunc;if(u){const p=null!=n?n.scale:void 0;l=null==p||"3d"===(null!=n?n.view:void 0)?function W(a){let i=null,n=null;const e=a.stops;return e?(i=e[0].value,n=e[e.length-1].value):(i=a.minDataValue||0,n=a.maxDataValue||0),(i+n)/2}(a):p}else if(!e)switch(a.inputValueType){case b.Yf.Expression:{if(null==(null==n?void 0:n.arcade))return void o().error("Use of arcade expressions requires an arcade context");const f=n.arcade.arcadeUtils,h=f.getViewInfo({viewingMode:n.viewingMode,scale:n.scale,spatialReference:n.spatialReference}),m=f.createExecContext(t,h,n.timeZone);if(!s){const c=f.createSyntaxTree(a.valueExpression);s=f.createFunction(c),a.cache.compiledFunc=s}l=f.executeFunction(s,m);break}case b.Yf.Field:r&&(l=r[a.field]);break;case b.Yf.Unknown:l=null}if(!(0,b.gf)(l))return null;if(e||!a.normalizationField)return l;const d=r?parseFloat(r[a.normalizationField]):null;return(0,b.gf)(d)&&0!==d?l/d:null}(e,i,n),e,i,n,e.cache.ipData);return null==t||isNaN(t)?0:t}function V(a,i,n){return null==a?null:(0,b.of)(a)?F(a,i,n):(0,b.gf)(a)?a:null}function O(a,i,n){return(0,b.gf)(n)&&a>n?n:(0,b.gf)(i)&&a<i?i:a}function P(a,i,n,e,t){switch(i.transformationType){case b._w.Additive:return function j(a,i,n,e){var t;return a+(null!==(t=V(i.minSize,n,e)||i.minDataValue)&&void 0!==t?t:0)}(a,i,n,e);case b._w.Constant:return function B(a,i,n){const e=a.stops;let t=(null==e?void 0:e.length)&&e[0].size;return null==t&&(t=a.minSize),V(t,i,n)}(i,n,e);case b._w.ClampedLinear:return function K(a,i,n,e){const t=(a-i.minDataValue)/(i.maxDataValue-i.minDataValue),r=V(i.minSize,n,e),l=V(i.maxSize,n,e),u=null!=e?e.shape:void 0;if(a<=i.minDataValue)return r;if(a>=i.maxDataValue)return l;if(null==r||null==l)return null;if("area"===i.scaleBy&&u){const s="circle"===u,d=s?S*(r/2)**2:r*r,p=d+t*((s?S*(l/2)**2:l*l)-d);return s?2*Math.sqrt(p/S):Math.sqrt(p)}return r+t*(l-r)}(a,i,n,e);case b._w.Proportional:return function Z(a,i,n,e){const t=null!=e?e.shape:void 0,r=a/i.minDataValue,l=V(i.minSize,n,e),u=V(i.maxSize,n,e);let s=null;return s="circle"===t?2*Math.sqrt(r*(l/2)**2):"square"===t||"diamond"===t||"image"===t?Math.sqrt(r*l**2):r*l,O(s,l,u)}(a,i,n,e);case b._w.Stops:return function Y(a,i,n,e,t){var r;const[l,u,s]=R(a,t);if(l===u)return V(null===(r=i.stops)||void 0===r?void 0:r[l].size,n,e);{var d,p;const f=V(null===(d=i.stops)||void 0===d?void 0:d[l].size,n,e);return f+(V(null===(p=i.stops)||void 0===p?void 0:p[u].size,n,e)-f)*s}}(a,i,n,e,t);case b._w.RealWorldSize:return function q(a,i,n,e){var t;const r=(null!==(t=null==e?void 0:e.resolution)&&void 0!==t?t:1)*y.j[i.valueUnit],l=V(i.minSize,n,e),u=V(i.maxSize,n,e),{valueRepresentation:s}=i;let d=null;return d="area"===s?2*Math.sqrt(a/S)/r:"radius"===s||"distance"===s?2*a/r:a/r,O(d,l,u)}(a,i,n,e);case b._w.Identity:return a;case b._w.Unknown:return null}}function G(a,i,n){const{isScaleDriven:e}=a.cache;if(!(e&&"3d"===n||i))return null;const t={scale:i,view:n};let r=V(a.minSize,D,t),l=V(a.maxSize,D,t);if(null!=r||null!=l){if(r>l){const u=l;l=r,r=u}return{minSize:r,maxSize:l}}}function X(a,i,n){if(!a.visualVariables)return;const e=[],t=[],r=[],l=[],u=[];for(const s of a.visualVariables)switch(s.type){case"color":t.push(s);break;case"opacity":r.push(s);break;case"rotation":u.push(s);break;case"size":l.push(s)}return t.forEach(s=>{const d=T(s,i,n);e.push({variable:s,value:d})}),r.forEach(s=>{const d=A(s,i,n);e.push({variable:s,value:d})}),u.forEach(s=>{const d=N(s,i,n);e.push({variable:s,value:d})}),l.forEach(s=>{const d=F(s,i,n);e.push({variable:s,value:d})}),e.filter(s=>null!=s.value)}function R(a,i){if(!i)return;let n=0,e=i.length-1;return i.some((t,r)=>a<t?(e=r,!0):(n=r,!1)),[n,e,(a-i[n])/(i[e]-i[n])]}function H(a,i,n){const e=["proportional","proportional","proportional"];for(const t of a){const r=t.useSymbolValue?"symbol-value":F(t,i,n);switch(t.axis){case"width":e[0]=r;break;case"depth":e[1]=r;break;case"height":e[2]=r;break;case"width-and-depth":e[0]=r,e[1]=r;break;case"all":case void 0:case null:e[0]=r,e[1]=r,e[2]=r;break;default:(0,C.Xb)(t.axis)}}return e}}}]);