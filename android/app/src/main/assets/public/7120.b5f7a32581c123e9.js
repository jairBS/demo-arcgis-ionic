"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7120,6773],{57120:(X,j,E)=>{E.d(j,{A:()=>P});var f=E(10467),S=E(62138),g=E(31033),C=E(85922),B=E(71505),x=E(7981),O=E(16773);class P extends C.A{constructor(m){super(m),this._relation="",this._relationGeom=null,this._relationString="",this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._relationString=m.relationString,this._parent=m.parentfeatureset,this._maxProcessing=40,this._relation=m.relation,this._relationGeom=m.relationGeom}_getSet(m){var _=this;return(0,f.A)(function*(){if(null===_._wset){yield _._ensureLoaded();const L=yield _._parent._getFilteredSet("esriSpatialRelRelation"!==_._relation?_._relation:_._relation+":"+_._relationString,_._relationGeom,null,null,m);return _._checkCancelled(m),_._wset=new B.A(L._candidates.slice(0),L._known.slice(0),L._ordered,_._clonePageDefinition(L.pagesDefinition)),_._wset}return _._wset})()}_isInFeatureSet(m){let _=this._parent._isInFeatureSet(m);return _===x.J6.NotInFeatureSet?_:(_=this._idstates[m],void 0===_?x.J6.Unknown:_)}_getFeature(m,_,L){return this._parent._getFeature(m,_,L)}_getFeatures(m,_,L,T){return this._parent._getFeatures(m,_,L,T)}_featureFromCache(m){return this._parent._featureFromCache(m)}executeSpatialRelationTest(m){var _=this;return(0,f.A)(function*(){var L;if(null===m.geometry)return!1;switch(_._relation){case"esriSpatialRelEnvelopeIntersects":return(0,O.intersects)((0,x.Yc)(_._relationGeom),(0,x.Yc)(m.geometry));case"esriSpatialRelIntersects":return(0,O.intersects)(_._relationGeom,m.geometry);case"esriSpatialRelContains":return(0,O.contains)(_._relationGeom,m.geometry);case"esriSpatialRelOverlaps":return(0,O.overlaps)(_._relationGeom,m.geometry);case"esriSpatialRelWithin":return(0,O.within)(_._relationGeom,m.geometry);case"esriSpatialRelTouches":return(0,O.touches)(_._relationGeom,m.geometry);case"esriSpatialRelCrosses":return(0,O.crosses)(_._relationGeom,m.geometry);case"esriSpatialRelRelation":return(0,O.relate)(_._relationGeom,m.geometry,null!==(L=_._relationString)&&void 0!==L?L:"")}})()}_fetchAndRefineFeatures(m,_,L){var T=this;return(0,f.A)(function*(){var U;const A=new B.A([],m,!1,null),v=Math.min(_,m.length);yield null===(U=T._parent)||void 0===U?void 0:U._getFeatures(A,-1,v,L),T._checkCancelled(L);const e=[];for(let t=0;t<v;t++){const r=T._parent._featureFromCache(m[t]);e.push(yield T.executeSpatialRelationTest(r))}for(let t=0;t<_;t++)T._idstates[m[t]]=!0===e[t]?x.J6.InFeatureSet:x.J6.NotInFeatureSet;return"success"})()}_getFilteredSet(m,_,L,T,U){var A=this;return(0,f.A)(function*(){yield A._ensureLoaded();const v=yield A._parent._getFilteredSet("esriSpatialRelRelation"!==A._relation?A._relation:A._relation+":"+A._relationString,A._relationGeom,L,T,U);let e;return A._checkCancelled(U),e=null!==_?new B.A(v._candidates.slice(0).concat(v._known.slice(0)),[],v._ordered,A._clonePageDefinition(v.pagesDefinition)):new B.A(v._candidates.slice(0),v._known.slice(0),v._ordered,A._clonePageDefinition(v.pagesDefinition)),e})()}_stat(m,_,L,T,U,A,v){var e=this;return(0,f.A)(function*(){if(""!==L)return{calculated:!1};const t=yield e._parent._stat(m,_,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,U,A,v);return!1===t.calculated?null===U&&""===L&&null===T?e._manualStat(m,_,A,v):{calculated:!1}:t})()}_canDoAggregates(m,_,L,T,U){var A=this;return(0,f.A)(function*(){return""===L&&null===T&&null!==A._parent&&A._parent._canDoAggregates(m,_,"esriSpatialRelRelation"!==A._relation?A._relation:A._relation+":"+A._relationString,A._relationGeom,U)})()}_getAggregatePagesDataSourceDefinition(m,_,L,T,U,A,v){var e=this;return(0,f.A)(function*(){if(null===e._parent)throw new g.dr(g.D_.NeverReach);return e._parent._getAggregatePagesDataSourceDefinition(m,_,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,U,A,v)})()}static registerAction(){C.A._featuresetFunctions.intersects=function(m){return null==m?new S.A({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:m})},C.A._featuresetFunctions.envelopeIntersects=function(m){return null==m?new S.A({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:m})},C.A._featuresetFunctions.contains=function(m){return null==m?new S.A({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:m})},C.A._featuresetFunctions.overlaps=function(m){return null==m?new S.A({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:m})},C.A._featuresetFunctions.within=function(m){return null==m?new S.A({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:m})},C.A._featuresetFunctions.touches=function(m){return null==m?new S.A({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:m})},C.A._featuresetFunctions.crosses=function(m){return null==m?new S.A({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:m})},C.A._featuresetFunctions.relate=function(m,_){return null==m?new S.A({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:m,relationString:_})}}getFieldsIndex(){return this._parent.getFieldsIndex()}}},62138:(X,j,E)=>{E.d(j,{A:()=>x});var f=E(10467),S=E(31033),g=E(85922),C=E(71505),B=E(7981);class x extends g.A{constructor(P){super(P),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._wset=new C.A([],[],!1,null),this._parent=P.parentfeatureset,this._databaseType=B.zl.Standardised}_getSet(){var P=this;return(0,f.A)(function*(){return P._wset})()}optimisePagingFeatureQueries(){}_isInFeatureSet(){return B.J6.NotInFeatureSet}_getFeature(){return(0,f.A)(function*(){throw new S.dr(S.D_.NeverReach)})()}queryAttachments(){return(0,f.A)(function*(){return[]})()}_getFeatures(){return(0,f.A)(function*(){return"success"})()}_featureFromCache(){return null}_fetchAndRefineFeatures(){return(0,f.A)(function*(){throw new S.dr(S.D_.NeverReach)})()}_getFilteredSet(){return(0,f.A)(function*(){return new C.A([],[],!1,null)})()}_stat(P,Y,m,_,L,T,U){return this._manualStat(P,Y,T,U)}_canDoAggregates(){return(0,f.A)(function*(){return!1})()}}},85922:(X,j,E)=>{E.d(j,{A:()=>U});var f=E(10467),S=E(89812),g=E(31033),C=E(63145);class B{constructor(v,e){this._lastId=-1,this._progress=e,this._parent=v}reset(){this._lastId=-1}nextBatchAsArcadeFeatures(v,e){var t=this;return(0,f.A)(function*(){const r=yield t.nextBatch(v);return null===r?r:r.map(n=>C.A.createFromGraphicLikeObject(n.geometry,n.attributes,t._parent,e))})()}nextBatch(v){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(r=>this.nextBatch(v),r=>this.nextBatch(v));const e={returnpromise:null,hasset:!1},t=[];return e.returnpromise=new Promise((r,n)=>{this._parent._getSet(this._progress).then(l=>{const u=l._known;let D=u.length-1;if("GETPAGES"===u[u.length-1]&&(D-=1),this._lastId+v>D&&u.length>0&&"GETPAGES"===u[u.length-1])this._parent._expandPagedSet(l,this._parent._maxQueryRate(),0,0,this._progress).then(R=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(v).then(r,n)},R=>{e.hasset=!0,this._parent._mainSetInUse=null,n(R)});else{if(D>=this._lastId+v||0===l._candidates.length){for(let R=0;R<v;R++){const H=R+this._lastId+1;if(H>=u.length)break;t[R]=u[H]}return this._lastId+=t.length,0===t.length&&(e.hasset=!0,this._parent._mainSetInUse=null,r([])),void this._parent._getFeatureBatch(t,this._progress).then(R=>{e.hasset=!0,this._parent._mainSetInUse=null,r(R)},R=>{e.hasset=!0,this._parent._mainSetInUse=null,n(R)})}this._parent._refineSetBlock(l,this._parent._maxProcessingRate(),this._progress).then(()=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(v).then(r,n)},R=>{e.hasset=!0,this._parent._mainSetInUse=null,n(R)})}},l=>{e.hasset=!0,this._parent._mainSetInUse=null,n(l)})}),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise}next(){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(e=>this.next(),e=>this.next());const v={returnpromise:null,hasset:!1};return v.returnpromise=new Promise((e,t)=>{this._parent._getSet(this._progress).then(r=>{const n=r._known;this._lastId<n.length-1?"GETPAGES"===n[this._lastId+1]?this._parent._expandPagedSet(r,this._parent._maxQueryRate(),0,0,this._progress).then(l=>(v.hasset=!0,this._parent._mainSetInUse=null,this.next())).then(e,t):(this._lastId+=1,this._parent._getFeature(r,n[this._lastId],this._progress).then(l=>{v.hasset=!0,this._parent._mainSetInUse=null,e(l)},l=>{v.hasset=!0,this._parent._mainSetInUse=null,t(l)})):r._candidates.length>0?this._parent._refineSetBlock(r,this._parent._maxProcessingRate(),this._progress).then(()=>{v.hasset=!0,this._parent._mainSetInUse=null,this.next().then(e,t)},l=>{v.hasset=!0,this._parent._mainSetInUse=null,t(l)}):(v.hasset=!0,this._parent._mainSetInUse=null,e(null))},r=>{v.hasset=!0,this._parent._mainSetInUse=null,t(r)})}),!1===v.hasset&&(this._parent._mainSetInUse=v.returnpromise,v.hasset=!0),v.returnpromise}count(){var v=this;return(0,f.A)(function*(){if(-1!==v._parent._totalCount)return v._parent._totalCount;const e=yield v._parent._getSet(v._progress),t=yield v._refineAllSets(e);return v._parent._totalCount=t._known.length,v._parent._totalCount})()}_refineAllSets(v){var e=this;return(0,f.A)(function*(){if(v._known.length>0&&"GETPAGES"===v._known[v._known.length-1])return yield e._parent._expandPagedSet(v,e._parent._maxQueryRate(),0,1,e._progress),e._refineAllSets(v);if(v._candidates.length>0){if("GETPAGES"===v._known[v._candidates.length-1])return yield e._parent._expandPagedSet(v,e._parent._maxQueryRate(),0,2,e._progress),e._refineAllSets(v);const t=yield e._parent._refineSetBlock(v,e._parent._maxProcessingRate(),e._progress);return t._candidates.length>0?e._refineAllSets(t):t}return v})()}}var x=E(71505),O=E(7981),P=E(7425),Y=E(56492),m=E(40013),_=E(16773),L=E(32034),T=E(73258);let U=(()=>{class A{constructor(e){this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=O.zl.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.typeIdField=null,this.types=null,this.subtypeField=null,this.subtypes=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,this.fsetInfo=null,null!=e&&e.lrucache&&(this.recentlyUsedQueries=e.lrucache),null!=e&&e.interceptor&&(this.featureSetQueryInterceptor=e.interceptor)}optimisePagingFeatureQueries(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}_hasMemorySource(){return!0}prop(e,t){return void 0===t?this[e]:(void 0!==this[e]&&(this[e]=t),this)}end(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}_ensureLoaded(){return this.load()}load(){return null===this._loadPromise&&(this._loadPromise=this.loadImpl()),this._loadPromise}loadImpl(){var e=this;return(0,f.A)(function*(){var t,r;return!0===(null===(t=e._parent)||void 0===t?void 0:t.loaded)?(e._initialiseFeatureSet(),e):(yield null===(r=e._parent)||void 0===r?void 0:r.load(),e._initialiseFeatureSet(),e)})()}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types,this.subtypeField=this._parent.subtypeField,this.subtypes=this._parent.subtypes):(this.fields=[],this.typeIdField="",this.subtypeField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new L.A({wkid:4326}),this.geometryType=O.ik.point)}getField(e,t){let r;return(t=t||this.fields)&&(e=e.toLowerCase(),t.some(n=>(n&&n.name.toLowerCase()===e&&(r=n),!!r))),r}getFieldsIndex(){return null===this._fieldsIndex&&(this._fieldsIndex=T.A.fromLayer({timeInfo:this.timeInfo,editFieldsInfo:this.editFieldsInfo,dateFieldsTimeZone:this.dateFieldsTimeZone,datesInUnknownTimezone:this.datesInUnknownTimezone,fields:this.fields})),this._fieldsIndex}_maxProcessingRate(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}_maxQueryRate(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}_checkCancelled(e){if(null!=e&&e.aborted)throw new g.dr(g.D_.Cancelled)}nativeCapabilities(){return this._parent.nativeCapabilities()}_canDoAggregates(e,t,r,n,l){var u=this;return(0,f.A)(function*(){return null!==u._parent&&u._parent._canDoAggregates(e,t,r,n,l)})()}_getAggregatePagesDataSourceDefinition(e,t,r,n,l,u,D){var F=this;return(0,f.A)(function*(){if(null===F._parent)throw new g.dr(g.D_.NeverReach);return F._parent._getAggregatePagesDataSourceDefinition(e,t,r,n,l,u,D)})()}_getAgregagtePhysicalPage(e,t,r){var n=this;return(0,f.A)(function*(){if(null===n._parent)throw new g.dr(g.D_.NeverReach);return n._parent._getAgregagtePhysicalPage(e,t,r)})()}databaseType(){var e=this;return(0,f.A)(function*(){if(e._databaseType===O.zl.NotEvaluated){if(null!==S.A.applicationCache){const t=S.A.applicationCache.getDatabaseType(e._cacheableFeatureSetSourceKey());if(null!==t)return t}if(null!==e._databaseTypeProbed)return e._databaseTypeProbed;try{e._databaseTypeProbed=e._getDatabaseTypeImpl(),null!==S.A.applicationCache&&S.A.applicationCache.setDatabaseType(e._cacheableFeatureSetSourceKey(),e._databaseTypeProbed)}catch(t){throw null!==S.A.applicationCache&&S.A.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),t}return e._databaseTypeProbed}return e._databaseType})()}_getDatabaseTypeImpl(){var e=this;return(0,f.A)(function*(){const t=[{thetype:O.zl.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:O.zl.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:O.zl.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}];for(const r of t)if(!0===(yield e._runDatabaseProbe(r.testwhere)))return r.thetype;return O.zl.StandardisedNoInterval})()}_cacheableFeatureSetSourceKey(){return"MUSTBESET"}_runDatabaseProbe(e){var t=this;return(0,f.A)(function*(){if(null!==t._parent)return t._parent._runDatabaseProbe(e);throw new g.dr(g.D_.NotImplemented)})()}isTable(){var e,t;return null!==(e=null===(t=this._parent)||void 0===t?void 0:t.isTable())&&void 0!==e&&e}_featureFromCache(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}_isInFeatureSet(e){return O.J6.Unknown}_getSet(e){throw new g.dr(g.D_.NotImplemented)}_getFeature(e,t,r){var n=this;return(0,f.A)(function*(){if(n._checkCancelled(r),void 0!==n._featureFromCache(t)||(yield n._getFeatures(e,t,n._maxProcessingRate(),r),n._checkCancelled(r),void 0!==n._featureFromCache(t)))return n._featureFromCache(t);throw new g.dr(g.D_.MissingFeatures)})()}_getFeatureBatch(e,t){var r=this;return(0,f.A)(function*(){r._checkCancelled(t);const n=new x.A([],e,!1,null),l=[];yield r._getFeatures(n,-1,e.length,t),r._checkCancelled(t);for(const u of e)void 0!==r._featureFromCache(u)&&l.push(r._featureFromCache(u));return l})()}_getFeatures(e,t,r,n){return(0,f.A)(function*(){return"success"})()}_getFilteredSet(e,t,r,n,l){throw new g.dr(g.D_.NotImplemented)}_refineSetBlock(e,t,r){var n=this;return(0,f.A)(function*(){if(!0===n._checkIfNeedToExpandCandidatePage(e,n._maxQueryRate()))return yield n._expandPagedSet(e,n._maxQueryRate(),0,0,r),n._refineSetBlock(e,t,r);n._checkCancelled(r);const l=e._candidates.length;n._refineKnowns(e,t);let u=l-e._candidates.length;if(0===e._candidates.length||u>=t)return e;if(yield n._refineIfParentKnown(e,t-u,r),n._checkCancelled(r),n._refineKnowns(e,t-u),u=l-e._candidates.length,u<t&&e._candidates.length>0){const D=t-u,F=n._prepareFetchAndRefineSet(e._candidates);return yield n._fetchAndRefineFeatures(F,F.length>D?D:e._candidates.length,r),n._checkCancelled(r),n._refineKnowns(e,t-u),e}return e})()}_fetchAndRefineFeatures(e,t,r){return null}_prepareFetchAndRefineSet(e){const t=[];for(let r=0;r<e.length;r++)this._isPhysicalFeature(e[r])&&t.push(e[r]);return t}_isPhysicalFeature(e){return null===this._parent||this._parent._isPhysicalFeature(e)}_refineKnowns(e,t){let r=0,n=null;const l=[];t=this._maxQueryRate();for(let u=0;u<e._candidates.length&&"GETPAGES"!==e._candidates[u];u++){let D=!1;const F=this._candidateIdTransform(e._candidates[u]);F!==e._candidates[u]&&(D=!0);const R=this._isInFeatureSet(F);if(R===O.J6.InFeatureSet)!0===D?e._known.includes(F)||(e._known.push(F),r+=1):(e._known.push(e._candidates[u]),r+=1),null===n?n={start:u,end:u}:n.end===u-1?n.end=u:(l.push(n),n={start:u,end:u});else if(R===O.J6.NotInFeatureSet)null===n?n={start:u,end:u}:n.end===u-1?n.end=u:(l.push(n),n={start:u,end:u}),r+=1;else if(R===O.J6.Unknown&&(r+=1,!0===e._ordered))break;if(r>=t)break}null!==n&&l.push(n);for(let u=l.length-1;u>=0;u--)e._candidates.splice(l[u].start,l[u].end-l[u].start+1)}_refineIfParentKnown(e,t,r){const n=new x.A([],[],e._ordered,null);return n._candidates=e._candidates.slice(0),this._parent._refineSetBlock(n,t,r)}_candidateIdTransform(e){return this._parent._candidateIdTransform(e)}_checkIfNeedToExpandKnownPage(e,t){if(null===e.pagesDefinition)return!1;let r=0;for(let n=e._lastFetchedIndex;n<e._known.length;n++){if("GETPAGES"===e._known[n])return!0;if(void 0===this._featureCache[e._known[n]]&&(r+=1,r>=t))break}return!1}_checkIfNeedToExpandCandidatePage(e,t){if(null===e.pagesDefinition)return!1;let r=0;for(let n=0;n<e._candidates.length;n++){if("GETPAGES"===e._candidates[n])return!0;if(r+=1,r>=t)break}return!1}_expandPagedSet(e,t,r,n,l){var u=this;return(0,f.A)(function*(){if(null===u._parent)throw new g.dr(g.D_.NotImplemented);return u._parent._expandPagedSet(e,t,r,n,l)})()}_expandPagedSetFeatureSet(e,t,r,n,l){var u=this;return(0,f.A)(function*(){if(e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(n=1),0===n&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(n=2),0===n)return"finished";const D=yield u._getPage(e,n,l);return r+D<t?u._expandPagedSet(e,t,r+D,0,l):"success"})()}_getPage(e,t,r){var n=this;return(0,f.A)(function*(){const l=1===t?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){l.length=l.length-1;let u=0;for(let F=0;F<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+F>=e.pagesDefinition.internal.set.length);F++)l[l.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+F],u++;e.pagesDefinition.resultOffset+=u;let D=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(D=!0),!1===D&&l.push("GETPAGES"),u}return yield n._getPhysicalPage(e,t,r),n._getPage(e,t,r)})()}_getPhysicalPage(e,t,r){return null}_clonePageDefinition(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}_first(e){return this.iterator(e).next()}first(e){return this._first(e)}calculateStatistic(e,t,r,n){var l=this;return(0,f.A)(function*(){yield l._ensureLoaded();let u=yield l._stat(e,t,"",null,null,r,n);return!1===u.calculated&&(u=yield l._manualStat(e,t,r,n)),u.result})()}_manualStat(e,t,r,n){var l=this;return(0,f.A)(function*(){let u=null;switch(e.toLowerCase()){case"count":return u=yield(0,P.U9)(l,n),{calculated:!0,result:u};case"distinct":return u=yield(0,P.dM)(l,t,r,n),{calculated:!0,result:u};case"avg":case"mean":return u=yield(0,P.i2)(l,t,n),{calculated:!0,result:u};case"stdev":return u=yield(0,P.b$)(l,t,n),{calculated:!0,result:u};case"variance":return u=yield(0,P.GV)(l,t,n),{calculated:!0,result:u};case"sum":return u=yield(0,P.cz)(l,t,n),{calculated:!0,result:u};case"min":return u=yield(0,P.jk)(l,t,n),{calculated:!0,result:u};case"max":return u=yield(0,P.T9)(l,t,n),{calculated:!0,result:u};default:return{calculated:!0,result:0}}})()}_stat(e,t,r,n,l,u,D){var F=this;return(0,f.A)(function*(){const R=yield F._parent._stat(e,t,r,n,l,u,D);return!1===R.calculated?null===l&&""===r&&null===n?F._manualStat(e,t,u,D):{calculated:!1}:R})()}_unionAllGeomSelf(e){const t=this.iterator(this._defaultTracker(e)),r=[];return new Promise((n,l)=>{this._unionShapeInBatches(r,t,n,l)})}_unionAllGeom(e){return new Promise((t,r)=>{const n=this.iterator(this._defaultTracker(e));this._unionShapeInBatches([],n,t,r)})}_unionShapeInBatches(e,t,r,n){t.next().then(l=>{try{null!==l&&null!==l.geometry&&e.push(l.geometry),e.length>30||null===l&&e.length>1?(0,_.union)(e).then(u=>{try{null===l?r(u):this._unionShapeInBatches(e=[u],t,r,n)}catch(D){n(D)}},n):null===l?r(1===e.length?e[0]:null):this._unionShapeInBatches(e,t,r,n)}catch(u){n(u)}},n)}iterator(e){return new B(this,e)}intersection(e,t=!1){return A._featuresetFunctions.intersection.bind(this)(e,t)}difference(e,t=!1,r=!0){return A._featuresetFunctions.difference.bind(this)(e,t,r)}symmetricDifference(e,t=!1,r=!0){return A._featuresetFunctions.symmetricDifference.bind(this)(e,t,r)}morphShape(e,t,r="unknown",n=null){return A._featuresetFunctions.morphShape.bind(this)(e,t,r,n)}morphShapeAndAttributes(e,t,r="unknown"){return A._featuresetFunctions.morphShapeAndAttributes.bind(this)(e,t,r)}union(e,t=!1){return A._featuresetFunctions.union.bind(this)(e,t)}intersects(e){return A._featuresetFunctions.intersects.bind(this)(e)}envelopeIntersects(e){return A._featuresetFunctions.envelopeIntersects.bind(this)(e)}contains(e){return A._featuresetFunctions.contains.bind(this)(e)}overlaps(e){return A._featuresetFunctions.overlaps.bind(this)(e)}relate(e,t){return A._featuresetFunctions.relate.bind(this)(e,t)}within(e){return A._featuresetFunctions.within.bind(this)(e)}touches(e){return A._featuresetFunctions.touches.bind(this)(e)}top(e){return A._featuresetFunctions.top.bind(this)(e)}crosses(e){return A._featuresetFunctions.crosses.bind(this)(e)}buffer(e,t,r,n=!0){return A._featuresetFunctions.buffer.bind(this)(e,t,r,n)}filter(e,t=null){return A._featuresetFunctions.filter.bind(this)(e,t)}orderBy(e){return A._featuresetFunctions.orderBy.bind(this)(e)}dissolve(e,t){return A._featuresetFunctions.dissolve.bind(this)(e,t)}groupby(e,t){return A._featuresetFunctions.groupby.bind(this)(e,t)}reduce(e,t=null,r){return new Promise((n,l)=>{this._reduceImpl(this.iterator(this._defaultTracker(r)),e,t,0,n,l,0)})}_reduceImpl(e,t,r,n,l,u,D){try{if(++D>1e3)return void setTimeout(()=>{this._reduceImpl(e,t,r,n,l,u,D=0)});e.next().then(F=>{try{if(null===F)l(r);else{const R=t(r,F,n,this);(0,Y.$X)(R)?R.then(H=>{this._reduceImpl(e,t,H,n+1,l,u,D)},u):this._reduceImpl(e,t,R,n+1,l,u,D)}}catch(R){u(R)}},u)}catch(F){u(F)}}removeField(e){return A._featuresetFunctions.removeField.bind(this)(e)}addField(e,t,r=null){return A._featuresetFunctions.addField.bind(this)(e,t,r)}sumArea(e,t=!1,r){const n=(0,O.uf)(e);return this.reduce((l,u)=>null===u.geometry?0:t?(0,_.geodesicArea)(u.geometry,n).then(D=>l+D):(0,_.planarArea)(u.geometry,n).then(D=>l+D),0,r)}sumLength(e,t=!1,r){const n=(0,O.SQ)(e);return this.reduce((l,u)=>null===u.geometry?0:t?(0,_.geodesicLength)(u.geometry,n).then(D=>l+D):(0,_.planarLength)(u.geometry,n).then(D=>l+D),0,r)}_substituteVars(e,t){if(null!==t){const r={};for(const n in t)r[n.toLowerCase()]=t[n];e.parameters=r}}distinct(e,t=1e3,r=null,n){var l=this;return(0,f.A)(function*(){yield l.load();const u=m.WhereClause.create(e,l.getFieldsIndex(),l.dateFieldsTimeZoneDefaultUTC);return l._substituteVars(u,r),l.calculateStatistic("distinct",u,t,l._defaultTracker(n))})()}min(e,t=null,r){var n=this;return(0,f.A)(function*(){yield n.load();const l=m.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(l,t),n.calculateStatistic("min",l,-1,n._defaultTracker(r))})()}max(e,t=null,r){var n=this;return(0,f.A)(function*(){yield n.load();const l=m.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(l,t),n.calculateStatistic("max",l,-1,n._defaultTracker(r))})()}avg(e,t=null,r){var n=this;return(0,f.A)(function*(){yield n.load();const l=m.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(l,t),n.calculateStatistic("avg",l,-1,n._defaultTracker(r))})()}sum(e,t=null,r){var n=this;return(0,f.A)(function*(){yield n.load();const l=m.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(l,t),n.calculateStatistic("sum",l,-1,n._defaultTracker(r))})()}stdev(e,t=null,r){var n=this;return(0,f.A)(function*(){yield n.load();const l=m.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(l,t),n.calculateStatistic("stdev",l,-1,n._defaultTracker(r))})()}variance(e,t=null,r){var n=this;return(0,f.A)(function*(){yield n.load();const l=m.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return n._substituteVars(l,t),n.calculateStatistic("variance",l,-1,n._defaultTracker(r))})()}count(e){var t=this;return(0,f.A)(function*(){return yield t.load(),t.calculateStatistic("count",m.WhereClause.create("1",t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC),-1,t._defaultTracker(e))})()}_defaultTracker(e){return null!=e?e:{aborted:!1}}forEach(e,t){return new Promise((r,n)=>{this._forEachImpl(this.iterator(this._defaultTracker(t)),e,this,r,n,0)})}_forEachImpl(e,t,r,n,l,u){try{if(++u>1e3)return void setTimeout(()=>{this._forEachImpl(e,t,r,n,l,u=0)},0);e.next().then(D=>{try{if(null===D)n(r);else{const F=t(D);null==F?this._forEachImpl(e,t,r,n,l,u):(0,Y.$X)(F)?F.then(()=>{try{this._forEachImpl(e,t,r,n,l,u)}catch(R){l(R)}},l):this._forEachImpl(e,t,r,n,l,u)}}catch(F){l(F)}},l)}catch(D){l(D)}}convertToJSON(e){const t={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}};for(let r=0;r<this.fields.length;r++)t.layerDefinition.fields.push((0,O.nE)(this.fields[r]));return this.reduce((r,n)=>{var l;const u={geometry:null===(l=n.geometry)||void 0===l?void 0:l.toJSON(),attributes:{}};for(const D in n.attributes)u.attributes[D]=n.attributes[D];return t.featureSet.features.push(u),1},0,e).then(()=>t)}castToText(e=!1){return"object, FeatureSet"}queryAttachments(e,t,r,n,l){return this._parent.queryAttachments(e,t,r,n,l)}serviceUrl(){return this._parent.serviceUrl()}subtypeMetaData(){return this.subtypeField&&this.subtypes?{subtypeField:this.subtypeField,subtypes:this.subtypes?this.subtypes.map(e=>({name:e.name,code:e.code})):[]}:this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map(e=>({name:e.name,code:e.id})):[]}:null}relationshipMetaData(){return this._parent.relationshipMetaData()}get gdbVersion(){return this._parent?this._parent.gdbVersion:""}schema(){const e=[];for(const t of this.fields)e.push((0,O.nE)(t));return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===O.yT[this.geometryType]?"esriGeometryNull":O.yT[this.geometryType],fields:e}}convertToText(e,t){var r=this;return(0,f.A)(function*(){if("schema"===e)return yield r._ensureLoaded(),JSON.stringify(r.schema());if("featureset"===e){yield r._ensureLoaded();const n=[];yield r.reduce((u,D)=>{const F={geometry:D.geometry?D.geometry.toJSON():null,attributes:D.attributes};return null!==F.geometry&&F.geometry.spatialReference&&delete F.geometry.spatialReference,n.push(F),1},0,t);const l=r.schema();return l.features=n,l.spatialReference=r.spatialReference.toJSON(),JSON.stringify(l)}return r.castToText()})()}getFeatureByObjectId(e,t){return this._parent.getFeatureByObjectId(e,t)}getOwningSystemUrl(){return this._parent.getOwningSystemUrl()}getIdentityUser(){return this._parent.getIdentityUser()}getRootFeatureSet(){return null!==this._parent?this._parent.getRootFeatureSet():this}getDataSourceFeatureSet(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}castAsJson(e=null){return"keeptype"===(null==e?void 0:e.featureset)?this:"none"===(null==e?void 0:e.featureset)?null:{type:"FeatureSet"}}castAsJsonAsync(e=null,t=null){var r=this;return(0,f.A)(function*(){var n;if("keeptype"===(null==t?void 0:t.featureset))return r;if("schema"===(null==t?void 0:t.featureset))return yield r._ensureLoaded(),JSON.parse(JSON.stringify(r.schema()));if("none"===(null==t?void 0:t.featureset))return null;yield r._ensureLoaded();const l=[];yield r.reduce((D,F)=>{const R={geometry:F.geometry?!0===(null==t?void 0:t.keepGeometryType)?F.geometry:F.geometry.toJSON():null,attributes:F.attributes};return null!==R.geometry&&R.geometry.spatialReference&&!0!==(null==t?void 0:t.keepGeometryType)&&delete R.geometry.spatialReference,l.push(R),1},0,e);const u=r.schema();return u.features=l,u.spatialReference=!0===(null==t?void 0:t.keepGeometryType)?r.spatialReference:null===(n=r.spatialReference)||void 0===n?void 0:n.toJSON(),u})()}fieldTimeZone(e){return this.getFieldsIndex().getTimeZone(e)}get preferredTimeZone(){var e,t;return null!==(e=null===(t=this._parent)||void 0===t?void 0:t.preferredTimeZone)&&void 0!==e?e:null}get dateFieldsTimeZone(){var e,t;return null!==(e=null===(t=this._parent)||void 0===t?void 0:t.dateFieldsTimeZone)&&void 0!==e?e:null}get dateFieldsTimeZoneDefaultUTC(){var e;if(this.datesInUnknownTimezone)return"unknown";const t=null!==(e=this.dateFieldsTimeZone)&&void 0!==e?e:"UTC";return""===t?"UTC":t}get datesInUnknownTimezone(){return this._parent.datesInUnknownTimezone}get editFieldsInfo(){var e,t;return null!==(e=null===(t=this._parent)||void 0===t?void 0:t.editFieldsInfo)&&void 0!==e?e:null}get timeInfo(){var e,t;return null!==(e=null===(t=this._parent)||void 0===t?void 0:t.timeInfo)&&void 0!==e?e:null}set featureSetInfo(e){this.fsetInfo=e}getFeatureSetInfo(){var e=this;return(0,f.A)(function*(){var t,r,n;return null!==(t=null!==(r=e.fsetInfo)&&void 0!==r?r:yield null===(n=e._parent)||void 0===n?void 0:n.getFeatureSetInfo())&&void 0!==t?t:null})()}}return A._featuresetFunctions={},A})()},71505:(X,j,E)=>{E.d(j,{A:()=>f});class f{constructor(g,C,B,x){this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=g,this._known=C,this._ordered=B,this.pagesDefinition=x}}},89812:(X,j,E)=>{E.d(j,{A:()=>f});let f=(()=>{class S{constructor(){this._databaseTypeMetaData={},this._layerInfo={}}clearDatabaseType(C){void 0===this._databaseTypeMetaData[C]&&delete this._databaseTypeMetaData[C]}getDatabaseType(C){return"MUSTBESET"===C||void 0===this._databaseTypeMetaData[C]?null:this._databaseTypeMetaData[C]}setDatabaseType(C,B){this._databaseTypeMetaData[C]=B}getLayerInfo(C){return void 0===this._layerInfo[C]?null:this._layerInfo[C]}setLayerInfo(C,B){this._layerInfo[C]=B}clearLayerInfo(C){void 0!==this._layerInfo[C]&&delete this._layerInfo[C]}}return S.applicationCache=null,S})()},97089:(X,j,E)=>{E.d(j,{C6:()=>e,DA:()=>D,F1:()=>A,F6:()=>L,IY:()=>t,Ju:()=>u,Mi:()=>P,Nf:()=>U,R8:()=>T,YY:()=>O,bD:()=>Y,bm:()=>v,kg:()=>m,oj:()=>H});var f=E(61299),S=E(31033),g=E(7981),C=E(29752),B=E(40013),x=E(44549);function O(i,a){return _(null==i?void 0:i.parseTree,a,null==i?void 0:i.parameters)}function P(i,a,d){return _(i,a,d)}function Y(i,a,d,o){return B.WhereClause.create(_(i.parseTree,g.zl.Standardised,i.parameters,a,d),o,i.timeZone)}function m(i,a,d="AND"){return B.WhereClause.create("(("+O(i,g.zl.Standardised)+")"+d+"("+O(a,g.zl.Standardised)+"))",i.fieldsIndex,i.timeZone)}function _(i,a,d,o=null,I=null){let $,k,p,y;switch(i.type){case"interval":return H(_(i.value,a,d,o,I),i.qualifier,i.op);case"case-expression":{let h=" CASE ";"simple"===i.format&&(h+=_(i.operand,a,d,o,I));for(let b=0;b<i.clauses.length;b++)h+=" WHEN "+_(i.clauses[b].operand,a,d,o,I)+" THEN "+_(i.clauses[b].value,a,d,o,I);return null!==i.else&&(h+=" ELSE "+_(i.else,a,d,o,I)),h+=" END ",h}case"parameter":{const h=d[i.value.toLowerCase()];if("string"==typeof h)return"'"+d[i.value.toLowerCase()].toString().replaceAll("'","''")+"'";if((0,g.$P)(h)||(0,g.Lk)(h))return v(h,a);if((0,g.eg)(h))return A(h,a);if((0,g.rX)(h))return T(h,a);if((0,g.f0)(h))return U(h,a);if(h instanceof Array){const b=[];for(let M=0;M<h.length;M++)"string"==typeof h[M]?b.push("'"+h[M].toString().replaceAll("'","''")+"'"):(0,g.$P)(h[M])||(0,g.Lk)(h[M])?b.push(v(h[M],a)):(0,g.eg)(h[M])?b.push(A(h[M],a)):(0,g.rX)(h[M])?b.push(T(h[M],a)):(0,g.f0)(h[M])?b.push(U(h[M],a)):b.push(h[M].toString());return b}return h.toString()}case"expression-list":k=[];for(const h of i.value)k.push(_(h,a,d,o,I));return k;case"unary-expression":return" ( NOT "+_(i.expr,a,d,o,I)+" ) ";case"binary-expression":switch(i.operator){case"AND":return" ("+_(i.left,a,d,o,I)+" AND "+_(i.right,a,d,o,I)+") ";case"OR":return" ("+_(i.left,a,d,o,I)+" OR "+_(i.right,a,d,o,I)+") ";case"IS":if("null"!==i.right.type)throw new S.L8(S.Z7.UnsupportedIsRhs);return" ("+_(i.left,a,d,o,I)+" IS NULL )";case"ISNOT":if("null"!==i.right.type)throw new S.L8(S.Z7.UnsupportedIsRhs);return" ("+_(i.left,a,d,o,I)+" IS NOT NULL )";case"IN":return $=[],"expression-list"===i.right.type?($=_(i.right,a,d,o,I)," ("+_(i.left,a,d,o,I)+" IN ("+$.join(",")+")) "):(y=_(i.right,a,d,o,I),y instanceof Array?" ("+_(i.left,a,d,o,I)+" IN ("+y.join(",")+")) ":" ("+_(i.left,a,d,o,I)+" IN ("+y+")) ");case"NOT IN":return $=[],"expression-list"===i.right.type?($=_(i.right,a,d,o,I)," ("+_(i.left,a,d,o,I)+" NOT IN ("+$.join(",")+")) "):(y=_(i.right,a,d,o,I),y instanceof Array?" ("+_(i.left,a,d,o,I)+" NOT IN ("+y.join(",")+")) ":" ("+_(i.left,a,d,o,I)+" NOT IN ("+y+")) ");case"BETWEEN":return p=_(i.right,a,d,o,I)," ("+_(i.left,a,d,o,I)+" BETWEEN "+p[0]+" AND "+p[1]+" ) ";case"NOTBETWEEN":return p=_(i.right,a,d,o,I)," ("+_(i.left,a,d,o,I)+" NOT BETWEEN "+p[0]+" AND "+p[1]+" ) ";case"LIKE":return""!==i.escape?" ("+_(i.left,a,d,o,I)+" LIKE "+_(i.right,a,d,o,I)+" ESCAPE '"+i.escape+"') ":" ("+_(i.left,a,d,o,I)+" LIKE "+_(i.right,a,d,o,I)+") ";case"NOT LIKE":return""!==i.escape?" ("+_(i.left,a,d,o,I)+" NOT LIKE "+_(i.right,a,d,o,I)+" ESCAPE '"+i.escape+"') ":" ("+_(i.left,a,d,o,I)+" NOT LIKE "+_(i.right,a,d,o,I)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+_(i.left,a,d,o,I)+" "+i.operator+" "+_(i.right,a,d,o,I)+") ";case"||":return" ("+_(i.left,a,d,o,I)+" "+(a===g.zl.SqlServer?"+":i.operator)+" "+_(i.right,a,d,o,I)+") "}throw new S.L8(S.Z7.UnsupportedOperator,{operator:i.operator});case"null":return"null";case"boolean":return!0===i.value?"1":"0";case"string":return"'"+i.value.toString().replaceAll("'","''")+"'";case"timestamp":return`timestamp '${i.value}'`;case"date":return`date '${i.value}'`;case"time":return`time '${i.value}'`;case"number":return i.value.toString();case"current-time":return e("date"===i.mode,a);case"column-reference":return o?o.toLowerCase()===i.column.toLowerCase()?"("+I+")":!0===i.delimited?`"${i.column.split('"').join('""')}"`:i.column:i.column;case"data-type":return i.value;case"function":{const h=_(i.args,a,d,o,I);return L(i.name,h,a)}}throw new S.L8(S.Z7.UnsupportedSyntax,{node:i.type})}function L(i,a,d){switch(i.toLowerCase().trim()){case"cos":case"sin":case"tan":case"cosh":case"tanh":case"sinh":case"acos":case"asin":case"atan":case"floor":case"log10":case"log":case"abs":if(1!==a.length)throw new S.L8(S.Z7.InvalidFunctionParameters,{function:i.toLowerCase().trim()});return`${i.toUpperCase().trim()}(${a[0]})`;case"ceiling":case"ceil":if(1!==a.length)throw new S.L8(S.Z7.InvalidFunctionParameters,{function:"ceiling"});return"CEILING("+a[0]+")";case"mod":case"power":case"nullif":if(2!==a.length)throw new S.L8(S.Z7.InvalidFunctionParameters,{function:i.toLowerCase().trim()});return`${i.toUpperCase().trim()}(${a[0]},${a[1]})`;case"round":if(2===a.length)return"ROUND("+a[0]+","+a[1]+")";if(1===a.length)return"ROUND("+a[0]+")";throw new S.L8(S.Z7.InvalidFunctionParameters,{function:"round"});case"truncate":if(a.length<1||a.length>2)throw new S.L8(S.Z7.InvalidFunctionParameters,{function:"truncate"});return d===g.zl.SqlServer?"ROUND("+a[0]+(1===a.length?"0":","+a[1])+",1)":"TRUNCATE("+a[0]+(1===a.length?")":","+a[1]+")");case"char_length":case"len":if(1!==a.length)throw new S.L8(S.Z7.InvalidFunctionParameters,{function:"char_length"});switch(d){case g.zl.SqlServer:return"LEN("+a[0]+")";case g.zl.Oracle:return"LENGTH("+a[0]+")";default:return"CHAR_LENGTH("+a[0]+")"}case"coalesce":case"concat":{if(a.length<1)throw new S.L8(S.Z7.InvalidFunctionParameters,{function:i.toLowerCase()});let o=i.toUpperCase().trim()+"(";for(let I=0;I<a.length;I++)0!==I&&(o+=","),o+=a[I];return o+=")",o}case"lower":case"lcase":if(1!==a.length)throw new S.L8(S.Z7.InvalidFunctionParameters,{function:"lower"});return"LOWER("+a[0]+")";case"upper":case"ucase":if(1!==a.length)throw new S.L8(S.Z7.InvalidFunctionParameters,{function:"upper"});return"UPPER("+a[0]+")";case"substring":{let o="";switch(d){case g.zl.Oracle:return o="SUBSTR("+a[0]+","+a[1],3===a.length&&(o+=","+a[2]),o+=")",o;case g.zl.SqlServer:return o=3===a.length?"SUBSTRING("+a[0]+","+a[1]+","+a[2]+")":"SUBSTRING("+a[0]+",  "+a[1]+", LEN("+a[0]+") - "+a[1]+")",o;default:return o="SUBSTRING("+a[0]+" FROM "+a[1],3===a.length&&(o+=" FOR "+a[2]),o+=")",o}}case"extract":return"EXTRACT("+a[0].replaceAll("'","")+" FROM "+a[1]+")";case"cast":{let o="";switch(d){case g.zl.Oracle:switch(a[1].type){case"date":o="DATE";break;case"float":o="DOUBLE";break;case"integer":o="INTEGER";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="TIMESTAMP";break;case"varchar":o="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${o})`;case g.zl.Postgres:switch(a[1].type){case"date":o="DATE";break;case"float":o="DOUBLE PRECISION";break;case"integer":o="INT";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="TIMESTAMP";break;case"varchar":o="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${o})`;case g.zl.SqlServer:switch(a[1].type){case"date":o="DATE";break;case"float":o="FLOAT";break;case"integer":o="INT";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="DATETIME";break;case"varchar":o="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${o})`;default:switch(a[1].type){case"date":o="DATE";break;case"float":o="FLOAT";break;case"integer":o="INTEGER";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="TIMESTAMP";break;case"varchar":o="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${o})`}}}throw new S.L8(S.Z7.InvalidFunctionParameters,{function:i})}function T(i,a){const d=i.toDateTime(),o=0===d.hour&&0===d.minute&&0===d.second&&0===d.millisecond;switch(a){case g.zl.FILEGDB:case g.zl.Standardised:case g.zl.StandardisedNoInterval:return o?`date '${d.toFormat("yyyy-LL-dd")}'`:`timestamp '${d.toFormat("yyyy-LL-dd HH:mm:ss")}'`;case g.zl.Oracle:return o?`TO_DATE('${d.toFormat("yyyy-LL-dd")}','YYYY-MM-DD')`:`TO_DATE('${d.toFormat("yyyy-LL-dd HH:mm:ss")}','YYYY-MM-DD HH24:MI:SS')`;case g.zl.SqlServer:return`'${d.toFormat(o?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;case g.zl.PGDB:return`#${d.toFormat(o?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss")}#`;case g.zl.Postgres:return`TIMESTAMP '${d.toFormat(o?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;default:return`timestamp '${d.toFormat("yyyy-LL-dd HH:mm:ss")}'`}}function U(i,a){switch(a){case g.zl.FILEGDB:case g.zl.Standardised:case g.zl.StandardisedNoInterval:return i.toSQLWithKeyword();case g.zl.Oracle:return`TO_DATE('${i.toFormat("Y-MM-DD")}'`;case g.zl.SqlServer:return`'${i.toFormat("Y-MM-DD")}'`;case g.zl.PGDB:return`#${i.toFormat("Y-MM-DD")}#`;case g.zl.Postgres:return`TIMESTAMP '${i.toFormat("Y-MM-DD")}'`;default:return i.toSQLWithKeyword()}}function A(i,a){switch(i instanceof C.k&&(i=i.toStorageString()),a){case g.zl.Oracle:return`TO_DATE('${i}', 'HH24:MI:SS')`;case g.zl.SqlServer:return`'${i}'`;default:return`time '${i}'`}}function v(i,a){return T(f.lY.dateTimeToArcadeDate((0,g.Lk)(i)?i:x.c9.fromJSDate(i)),a)}function e(i,a){switch(a){case g.zl.FILEGDB:case g.zl.Standardised:case g.zl.StandardisedNoInterval:case g.zl.Oracle:return i?"CURRENT_DATE":"CURRENT_TIMESTAMP";case g.zl.SqlServer:return i?"CAST(GETDATE() AS DATE)":"GETDATE()";default:return i?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}function t(i,a,d={}){const o={},I={},$={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeBigInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeTimeOnly:"time-only",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimestampOffset:"timestamp-offset",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"guid",oid:"integer",long:"integer","small-integer":"integer",integer:"integer","big-integer":"integer",single:"double","time-only":"time-only","date-only":"date-only","timestamp-offset":"timestemp-offset",double:"double",date:"date",guid:"guid","global-id":"guid",string:"string"};for(const k of a){const p=k.type?$[k.type]:void 0;o[k.name.toLowerCase()]=void 0===p?"":p}for(const k in d){const p=$[d[k]];I[k.toLowerCase()]=void 0===p?"":p}switch(r(o,i.parseTree,i.parameters,I)){case"double":return"double";case"integer":return"integer";case"date":return"date";case"date-only":return"date-only";case"time-only":return"time-only";case"timestamp-offset":return"timestamp-offset";case"string":return"string";case"global-id":case"guid":return"guid"}return""}function r(i,a,d,o){var I,$,k;let p;switch(a.type){case"interval":return"integer";case"case-expression":{const y=[];if("simple"===a.format){for(let h=0;h<a.clauses.length;h++)y.push(r(i,a.clauses[h].value,d,o));null!==a.else&&y.push(r(i,a.else,d,o))}else{for(let h=0;h<a.clauses.length;h++)y.push(r(i,a.else,d,o));null!==a.else&&y.push(r(i,a.else,d,o))}return l(y)}case"parameter":{const y=o[a.value.toLowerCase()];if(void 0===y&&d){const h=d[a.value.toLowerCase()];if(null==h)return"";if("string"==typeof h||h instanceof String)return"string";if("boolean"==typeof h)return"boolean";if((0,g.$P)(h)||(0,g.rX)(h))return"date";if((0,g.f0)(h))return"date-only";if((0,g.eg)(h))return"time-only";if("number"==typeof h)return h%1==0?"integer":"double"}return void 0===y?"":y}case"expression-list":{const y=[];for(const h of a.value)y.push(r(i,h,d,o));return y}case"unary-expression":return"boolean";case"binary-expression":switch(a.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==a.right.type)throw new S.L8(S.Z7.UnsupportedIsRhs);return"boolean";case"*":case"-":case"+":case"/":return l([r(i,a.left,d,o),r(i,a.right,d,o)]);case"||":return"string";default:throw new S.L8(S.Z7.UnsupportedOperator,{operator:a.operator})}case"null":return"";case"boolean":return"boolean";case"string":return"string";case"number":return null===a.value?"":a.value%1==0?"integer":"double";case"date":return"date";case"timestamp":return a.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"current-time":return"date";case"column-reference":{const y=i[a.column.toLowerCase()];return void 0===y?"":y}case"function":switch(a.name.toLowerCase()){case"cast":switch(null!==(I=null===($=a.args)||void 0===$||null===($=$.value[1])||void 0===$?void 0:$.value.type)&&void 0!==I?I:""){case"integer":case"smallint":return"integer";case"real":case"float":return"double";case"date":case"timestamp":return!0===(null===(k=a.args)||void 0===k||null===(k=k.value[1])||void 0===k||null===(k=k.value)||void 0===k?void 0:k.withtimezone)?"timestamp-offset":"date";case"time":return"time-only";case"varchar":return"string";default:return""}case"position":case"extract":case"char_length":case"mod":return"integer";case"round":if(p=r(i,a.args,d,o),p instanceof Array){if(p.length<=0)return"double";p=p[0]}return p;case"sign":return"integer";case"ceiling":case"floor":case"abs":return p=r(i,a.args,d,o),p instanceof Array&&(p=l(p)),"integer"===p||"double"===p?p:"double";case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"cosh":case"sinh":case"tanh":case"power":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string";case"truncate":return"double";case"nullif":case"coalesce":return p=r(i,a.args,d,o),p instanceof Array?p.length>0?p[0]:"":p}return""}throw new S.L8(S.Z7.UnsupportedSyntax,{node:a.type})}const n={boolean:1,string:2,integer:3,double:4,date:5};function l(i){if(i){let a="";for(const d of i)""!==d&&(a=""===a||n[a]<n[d]?d:a);return a}return""}function u(i,a){return F(i.parseTree,a)}function D(i){return"column-reference"===(null==i?void 0:i.parseTree.type)}function F(i,a){if(null==i)return!1;switch(i.type){case"when-clause":return F(i.operand,a)||F(i.value,a);case"case-expression":for(const d of i.clauses)if(F(d,a))return!0;return!("simple"!==i.format||!F(i.operand,a))||!(null===i.else||!F(i.else,a));case"parameter":case"null":case"boolean":case"date":case"timestamp":case"time":case"string":case"number":return!1;case"expression-list":for(const d of i.value)if(F(d,a))return!0;return!1;case"unary-expression":return F(i.expr,a);case"binary-expression":return F(i.left,a)||F(i.right,a);case"column-reference":return a.toLowerCase()===i.column.toLowerCase();case"function":return F(i.args,a)}return!1}function R(i){let a="";return a+=i.period.toUpperCase(),a}function H(i,a,d){let o="";return o="interval-period"===a.type?R(a):R(a.start)+" TO "+R(a.end),"INTERVAL "+d+" "+i+" "+o}},7425:(X,j,E)=>{E.d(j,{Dp:()=>U,GV:()=>u,T9:()=>t,U9:()=>a,b$:()=>F,cz:()=>H,dM:()=>$,i2:()=>n,jk:()=>v,tQ:()=>A});var f=E(10467),S=E(31033),g=E(7981),C=E(97089),B=E(87257),x=E(16924),O=E(29752);function Y(p){let y=0;for(let h=0;h<p.length;h++)y+=p[h];return y/p.length}function m(p){const y=Y(p);let h=0;for(let b=0;b<p.length;b++)h+=(y-p[b])**2;return h/p.length}function _(p){const y=Y(p);let h=0;for(let b=0;b<p.length;b++)h+=(y-p[b])**2;return h/(p.length-1)}function L(p){let y=0;for(let h=0;h<p.length;h++)y+=p[h];return y}function U(p){switch(p.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function A(p,y,h=1e3){switch(p.toLowerCase()){case"distinct":return function T(p,y){const h=[],b={},M=[];for(let G=0;G<p.length;G++){if(null!=p[G]){const W=p[G];if((0,g.Et)(W)||(0,g.Kg)(W))void 0===b[W]&&(h.push(W),b[W]=1);else{let J=!1;for(let z=0;z<M.length;z++)!0===(0,g.Tf)(M[z],W)&&(J=!0);!1===J&&(M.push(W),h.push(W))}}if(h.length>=y&&-1!==y)return h}return h}(y,h);case"avg":case"mean":return Y(y);case"min":return Math.min.apply(Math,y);case"sum":return L(y);case"max":return Math.max.apply(Math,y);case"stdev":case"stddev":return Math.sqrt(m(y));case"var":case"variance":return m(y);case"count":return y.length}return 0}function v(p,y,h){return e.apply(this,arguments)}function e(){return(e=(0,f.A)(function*(p,y,h){const b=yield o(p,y,h,!0);return 0===b.length?null:Math.min.apply(Math,b)})).apply(this,arguments)}function t(p,y,h){return r.apply(this,arguments)}function r(){return(r=(0,f.A)(function*(p,y,h){const b=yield o(p,y,h,!0);return 0===b.length?null:Math.max.apply(Math,b)})).apply(this,arguments)}function n(p,y,h){return l.apply(this,arguments)}function l(){return(l=(0,f.A)(function*(p,y,h){let b="";y&&!(0,C.DA)(y)&&(b=(0,C.IY)(y,p.fields));const M=yield o(p,y,h,!0);if(0===M.length)return null;const G=Y(M);return null===G?G:"integer"===b?function P(p){return p=+p,isFinite(p)?p-p%1||(p<0?-0:0===p?p:0):p}(G):G})).apply(this,arguments)}function u(p,y,h){return D.apply(this,arguments)}function D(){return(D=(0,f.A)(function*(p,y,h){const b=yield o(p,y,h,!0);return 0===b.length?null:_(b)})).apply(this,arguments)}function F(p,y,h){return R.apply(this,arguments)}function R(){return(R=(0,f.A)(function*(p,y,h){const b=yield o(p,y,h,!0);return 0===b.length?null:Math.sqrt(_(b))})).apply(this,arguments)}function H(p,y,h){return i.apply(this,arguments)}function i(){return(i=(0,f.A)(function*(p,y,h){const b=yield o(p,y,h,!0);return 0===b.length?null:L(b)})).apply(this,arguments)}function a(p,y){return d.apply(this,arguments)}function d(){return(d=(0,f.A)(function*(p,y){return p.iterator(y).count()})).apply(this,arguments)}function o(p,y,h){return I.apply(this,arguments)}function I(){return(I=(0,f.A)(function*(p,y,h,b=!1){const M=p.iterator(h),G=[],W={ticker:0};let J=yield M.next();for(;null!==J;){if(W.ticker++,h.aborted)throw new S.dr(S.D_.Cancelled);W.ticker%100==0&&(W.ticker=0,yield new Promise(Z=>{setTimeout(Z,0)}));const z=null==y?void 0:y.calculateValue(J);null===z?!1===b&&(G[G.length]=z):G[G.length]=z instanceof B.n||z instanceof O.k?z.toNumber():z instanceof x.g?z.toMilliseconds():z,J=yield M.next()}return G})).apply(this,arguments)}function $(p,y){return k.apply(this,arguments)}function k(){return(k=(0,f.A)(function*(p,y,h=1e3,b=null){const M=p.iterator(b),G=[],W={},J={ticker:0};let z=yield M.next();for(;null!==z;){if(J.ticker++,b&&b.aborted)throw new S.dr(S.D_.Cancelled);J.ticker%100==0&&(J.ticker=0,yield new Promise(ee=>{setTimeout(ee,0)}));const Z=null==y?void 0:y.calculateValue(z);let V=Z;if(Z instanceof B.n?V="!!DATEONLY!!-"+Z.toString():Z instanceof x.g?V="!!TSOFFSETONLY!!-"+Z.toString():Z instanceof O.k?V="!!TIMEONLY!!-"+Z.toString():Z instanceof Date&&(V="!!DATE!!-"+Z.toString()),null!=Z&&void 0===W[V]&&(G.push(Z),W[V]=1),G.length>=h&&-1!==h)return G;z=yield M.next()}return G})).apply(this,arguments)}},16773:(X,j,E)=>{E.r(j),E.d(j,{buffer:()=>me,changeDefaultSpatialReferenceTolerance:()=>Oe,clearDefaultSpatialReferenceTolerance:()=>Le,clip:()=>t,contains:()=>u,convexHull:()=>y,crosses:()=>D,cut:()=>n,densify:()=>Fe,difference:()=>b,disjoint:()=>d,distance:()=>F,equals:()=>R,extendedSpatialReferenceInfo:()=>e,flipHorizontal:()=>Ie,flipVertical:()=>Ee,generalize:()=>De,geodesicArea:()=>Pe,geodesicBuffer:()=>ye,geodesicDensify:()=>we,geodesicLength:()=>Re,intersect:()=>J,intersectLinesToPoints:()=>Ce,intersects:()=>H,isSimple:()=>$,nearestCoordinate:()=>ve,nearestVertex:()=>Se,nearestVertices:()=>Te,offset:()=>ee,overlaps:()=>o,planarArea:()=>xe,planarLength:()=>be,relate:()=>I,rotate:()=>Ae,simplify:()=>k,symmetricDifference:()=>G,touches:()=>i,union:()=>Z,within:()=>a});var f=E(10467),g=(E(21152),E(19284)),C=E(13303),B=E(61320);function x(s){var c;return Array.isArray(s)?null===(c=s[0])||void 0===c?void 0:c.spatialReference:null==s?void 0:s.spatialReference}function O(s){return s&&(Array.isArray(s)?s.map(O):s.toJSON?s.toJSON():s)}function P(s){return Array.isArray(s)?s.map(c=>(0,B.rS)(c)):(0,B.rS)(s)}let m;function _(){return L.apply(this,arguments)}function L(){return(L=(0,f.A)(function*(){return m||(m=(0,g.ho)("geometryEngineWorker",{strategy:"distributed"})),m})).apply(this,arguments)}function T(s,c){return U.apply(this,arguments)}function U(){return(U=(0,f.A)(function*(s,c){return(yield _()).invoke("executeGEOperation",{operation:s,parameters:O(c)})})).apply(this,arguments)}function A(s,c){return v.apply(this,arguments)}function v(){return(v=(0,f.A)(function*(s,c){const w=yield _();return Promise.all(w.broadcast("executeGEOperation",{operation:s,parameters:O(c)}))})).apply(this,arguments)}function e(s){return T("extendedSpatialReferenceInfo",[s])}function t(s,c){return r.apply(this,arguments)}function r(){return(r=(0,f.A)(function*(s,c){return P(yield T("clip",[x(s),s,c]))})).apply(this,arguments)}function n(s,c){return l.apply(this,arguments)}function l(){return(l=(0,f.A)(function*(s,c){return P(yield T("cut",[x(s),s,c]))})).apply(this,arguments)}function u(s,c){return T("contains",[x(s),s,c])}function D(s,c){return T("crosses",[x(s),s,c])}function F(s,c,w){return T("distance",[x(s),s,c,w])}function R(s,c){return T("equals",[x(s),s,c])}function H(s,c){return T("intersects",[x(s),s,c])}function i(s,c){return T("touches",[x(s),s,c])}function a(s,c){return T("within",[x(s),s,c])}function d(s,c){return T("disjoint",[x(s),s,c])}function o(s,c){return T("overlaps",[x(s),s,c])}function I(s,c,w){return T("relate",[x(s),s,c,w])}function $(s){return T("isSimple",[x(s),s])}function k(s){return p.apply(this,arguments)}function p(){return(p=(0,f.A)(function*(s){return P(yield T("simplify",[x(s),s]))})).apply(this,arguments)}function y(s){return h.apply(this,arguments)}function h(){return(h=(0,f.A)(function*(s,c=!1){return P(yield T("convexHull",[x(s),s,c]))})).apply(this,arguments)}function b(s,c){return M.apply(this,arguments)}function M(){return(M=(0,f.A)(function*(s,c){return P(yield T("difference",[x(s),s,c]))})).apply(this,arguments)}function G(s,c){return W.apply(this,arguments)}function W(){return(W=(0,f.A)(function*(s,c){return P(yield T("symmetricDifference",[x(s),s,c]))})).apply(this,arguments)}function J(s,c){return z.apply(this,arguments)}function z(){return(z=(0,f.A)(function*(s,c){return P(yield T("intersect",[x(s),s,c]))})).apply(this,arguments)}function Z(s){return V.apply(this,arguments)}function V(){return(V=(0,f.A)(function*(s,c=null){const w=function Y(s,c){let w;return Array.isArray(s)?w=s:(w=[],w.push(s),null!=c&&w.push(c)),w}(s,c);return P(yield T("union",[x(w),w]))})).apply(this,arguments)}function ee(s,c,w,N,K,Q){return te.apply(this,arguments)}function te(){return(te=(0,f.A)(function*(s,c,w,N,K,Q){return P(yield T("offset",[x(s),s,c,w,N,K,Q]))})).apply(this,arguments)}function me(s,c,w){return ne.apply(this,arguments)}function ne(){return(ne=(0,f.A)(function*(s,c,w,N=!1){const K=[x(s),s,c,w,N];return P(yield T("buffer",K))})).apply(this,arguments)}function ye(s,c,w,N,K,Q){return re.apply(this,arguments)}function re(){return(re=(0,f.A)(function*(s,c,w,N,K,Q){const Me=[x(s),s,c,w,N,K,Q];return P(yield T("geodesicBuffer",Me))})).apply(this,arguments)}function ve(s,c){return ae.apply(this,arguments)}function ae(){return(ae=(0,f.A)(function*(s,c,w=!0){const N=yield T("nearestCoordinate",[x(s),s,c,w]);return{...N,coordinate:C.A.fromJSON(N.coordinate)}})).apply(this,arguments)}function Se(s,c){return se.apply(this,arguments)}function se(){return(se=(0,f.A)(function*(s,c){const w=yield T("nearestVertex",[x(s),s,c]);return{...w,coordinate:C.A.fromJSON(w.coordinate)}})).apply(this,arguments)}function Te(s,c,w,N){return ie.apply(this,arguments)}function ie(){return(ie=(0,f.A)(function*(s,c,w,N){return(yield T("nearestVertices",[x(s),s,c,w,N])).map(K=>({...K,coordinate:C.A.fromJSON(K.coordinate)}))})).apply(this,arguments)}function le(s){var c;return"xmin"in s?s.center:"x"in s?s:null===(c=s.extent)||void 0===c?void 0:c.center}function Ae(s,c,w){return ue.apply(this,arguments)}function ue(){return(ue=(0,f.A)(function*(s,c,w){var N;if(null==s)throw new q;const K=s.spatialReference;if(null==(w=null!==(N=w)&&void 0!==N?N:le(s)))throw new q;const Q=s.constructor.fromJSON(yield T("rotate",[K,s,c,w]));return Q.spatialReference=K,Q})).apply(this,arguments)}function Ie(s,c){return oe.apply(this,arguments)}function oe(){return(oe=(0,f.A)(function*(s,c){var w;if(null==s)throw new q;const N=s.spatialReference;if(null==(c=null!==(w=c)&&void 0!==w?w:le(s)))throw new q;const K=s.constructor.fromJSON(yield T("flipHorizontal",[N,s,c]));return K.spatialReference=N,K})).apply(this,arguments)}function Ee(s,c){return ce.apply(this,arguments)}function ce(){return(ce=(0,f.A)(function*(s,c){var w;if(null==s)throw new q;const N=s.spatialReference;if(null==(c=null!==(w=c)&&void 0!==w?w:le(s)))throw new q;const K=s.constructor.fromJSON(yield T("flipVertical",[N,s,c]));return K.spatialReference=N,K})).apply(this,arguments)}function De(s,c,w,N){return he.apply(this,arguments)}function he(){return(he=(0,f.A)(function*(s,c,w,N){return P(yield T("generalize",[x(s),s,c,w,N]))})).apply(this,arguments)}function Fe(s,c,w){return _e.apply(this,arguments)}function _e(){return(_e=(0,f.A)(function*(s,c,w){return P(yield T("densify",[x(s),s,c,w]))})).apply(this,arguments)}function we(s,c,w){return de.apply(this,arguments)}function de(){return(de=(0,f.A)(function*(s,c,w,N=0){return P(yield T("geodesicDensify",[x(s),s,c,w,N]))})).apply(this,arguments)}function xe(s,c){return T("planarArea",[x(s),s,c])}function be(s,c){return T("planarLength",[x(s),s,c])}function Pe(s,c,w){return T("geodesicArea",[x(s),s,c,w])}function Re(s,c,w){return T("geodesicLength",[x(s),s,c,w])}function Ce(s,c){return pe.apply(this,arguments)}function pe(){return(pe=(0,f.A)(function*(s,c){return P(yield T("intersectLinesToPoints",[x(s),s,c]))})).apply(this,arguments)}function Oe(s,c){return fe.apply(this,arguments)}function fe(){return(fe=(0,f.A)(function*(s,c){yield A("changeDefaultSpatialReferenceTolerance",[s,c])})).apply(this,arguments)}function Le(s){return ge.apply(this,arguments)}function ge(){return(ge=(0,f.A)(function*(s){yield A("clearDefaultSpatialReferenceTolerance",[s])})).apply(this,arguments)}class q extends Error{constructor(){super("Illegal Argument Exception")}}}}]);