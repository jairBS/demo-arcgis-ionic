"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[152,7340],{23506:(F,M,t)=>{t.d(M,{v:()=>i});var a=t(99305);function i(A){null!=A&&A.writtenProperties&&A.writtenProperties.forEach(({target:h,propName:O,newOrigin:g})=>{(0,a.H)(h)&&g&&h.originOf(O)!==g&&h.updateOrigin(O,g)})}},99305:(F,M,t)=>{function a(i){return i&&"getAtOrigin"in i&&"originOf"in i}t.d(M,{H:()=>a})},94376:(F,M,t)=>{t.d(M,{p:()=>u});var a=t(8189),i=t(85211),g=(t(3248),t(35150),t(40707),t(76576));const u=x=>{let E=class extends x{get apiKey(){var d;return this._isOverridden("apiKey")?this._get("apiKey"):function f(x){return"portalItem"in x}(this)?null===(d=this.portalItem)||void 0===d?void 0:d.apiKey:null}set apiKey(d){null!=d?this._override("apiKey",d):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return(0,a._)([(0,i.MZ)({type:String})],E.prototype,"apiKey",null),E=(0,a._)([(0,g.$)("esri.layers.mixins.APIKeyMixin")],E),E}},25936:(F,M,t)=>{t.d(M,{b:()=>u});var a=t(8189),i=t(35150),A=t(85211),g=(t(3248),t(40707),t(76576)),f=t(68438);const u=x=>{let E=class extends x{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const d=(0,f.qg)(this.url);if(null!=d&&d.title)return d.title}return this._get("title")||""}set title(d){this._set("title",d)}set url(d){this._set("url",(0,f.Jf)(d,i.A.getLogger(this)))}};return(0,a._)([(0,A.MZ)()],E.prototype,"title",null),(0,a._)([(0,A.MZ)({type:String})],E.prototype,"url",null),E=(0,a._)([(0,g.$)("esri.layers.mixins.ArcGISService")],E),E}},46406:(F,M,t)=>{t.d(M,{Xh:()=>J,w6:()=>G});var a=t(10467),i=t(8189),A=t(89563),h=t(5922),O=t(35150),g=t(56492),f=t(45272),u=t(85211),d=(t(3248),t(40707),t(17221)),T=t(76576),L=t(50305),m=t(23506),_=t(28067),U=t(33119),I=t(32034),D=t(68438),C=t(81687),n=t(27834);var W=t(73874),c=t(46577),K=t(15764),V=t(3458),w=t(96904),j=t(95945);const G=B=>{let P=class extends B{constructor(){var r;super(...arguments),r=this,this.spatialReference=null,this.fullExtent=null,this.heightModelInfo=null,this.minScale=0,this.maxScale=0,this.version={major:Number.NaN,minor:Number.NaN,versionString:""},this.copyright=null,this.sublayerTitleMode="item-title",this.title=null,this.layerId=null,this.indexInfo=null,this._debouncedSaveOperations=(0,g.sg)(function(){var e=(0,a.A)(function*(o,l,s){switch(o){case J.SAVE:return r._save(l);case J.SAVE_AS:return r._saveAs(s,l)}});return function(o,l,s){return e.apply(this,arguments)}}())}readSpatialReference(r,e){return this._readSpatialReference(e)}_readSpatialReference(r){if(null!=r.spatialReference)return I.A.fromJSON(r.spatialReference);const e=r.store,o=e.indexCRS||e.geographicCRS,l=o&&parseInt(o.substring(o.lastIndexOf("/")+1,o.length),10);return null!=l?new I.A(l):null}readFullExtent(r,e,o){if(null!=r&&"object"==typeof r){const v=null==r.spatialReference?{...r,spatialReference:this._readSpatialReference(e)}:r;return _.A.fromJSON(v,o)}const l=e.store,s=this._readSpatialReference(e);return null==s||null==(null==l?void 0:l.extent)||!Array.isArray(l.extent)||l.extent.some(v=>v<Z)?null:new _.A({xmin:l.extent[0],ymin:l.extent[1],xmax:l.extent[2],ymax:l.extent[3],spatialReference:s})}parseVersionString(r){const e={major:Number.NaN,minor:Number.NaN,versionString:r},o=r.split(".");return o.length>=2&&(e.major=parseInt(o[0],10),e.minor=parseInt(o[1],10)),e}readVersion(r,e){const o=e.store,l=null!=o.version?o.version.toString():"";return this.parseVersionString(l)}readTitlePortalItem(r){return"item-title"!==this.sublayerTitleMode?void 0:r}readTitleService(r,e){var o;const l=null===(o=this.portalItem)||void 0===o?void 0:o.title;if("item-title"===this.sublayerTitleMode)return(0,D.yG)(this.url,e.name);let s=e.name;if(!s&&this.url){const v=(0,D.qg)(this.url);null!=v&&(s=v.title)}return"item-title-and-service-name"===this.sublayerTitleMode&&l&&(s=l+" - "+s),(0,D.cr)(s)}set url(r){const e=(0,D.HZ)({layer:this,url:r,nonStandardUrlAllowed:!1,logger:O.A.getLogger(this)});this._set("url",e.url),null!=e.layerId&&this._set("layerId",e.layerId)}writeUrl(r,e,o,l){(0,D.LS)(this,r,"layers",e,l)}get parsedUrl(){const r=this._get("url"),e=(0,f.An)(r);return null!=this.layerId&&(e.path=`${e.path}/layers/${this.layerId}`),e}_fetchIndexAndUpdateExtent(r,e){var o=this;return(0,a.A)(function*(){o.indexInfo=(0,n.F)(o.parsedUrl.path,o.rootNode,r,o.customParameters,o.apiKey,O.A.getLogger(o),e),null==o.fullExtent||o.fullExtent.hasZ||o._updateExtent(yield o.indexInfo)})()}_updateExtent(r){if("page"===(null==r?void 0:r.type)){var e,o;const v=null===(e=r.rootPage)||void 0===e||null===(e=e.nodes)||void 0===e?void 0:e[r.rootIndex%r.pageSize];if(null==(null==v||null===(o=v.obb)||void 0===o?void 0:o.center)||null==v.obb.halfSize)throw new h.A("sceneservice:invalid-node-page","Invalid node page.");if(v.obb.center[0]<Z||null==this.fullExtent||this.fullExtent.hasZ)return;const y=v.obb.halfSize,N=v.obb.center[2],$=Math.sqrt(y[0]*y[0]+y[1]*y[1]+y[2]*y[2]);this.fullExtent.zmin=N-$,this.fullExtent.zmax=N+$}else if("node"===(null==r?void 0:r.type)){var l;const s=null===(l=r.rootNode)||void 0===l?void 0:l.mbs;if(!Array.isArray(s)||4!==s.length||s[0]<Z)return;const v=s[2],y=s[3],{fullExtent:N}=this;N&&(N.zmin=v-y,N.zmax=v+y)}}_fetchService(r){var e=this;return(0,a.A)(function*(){if(null==e.url)throw new h.A("sceneservice:url-not-set","Scene service can not be loaded without valid portal item or url");if(null==e.layerId&&/SceneServer\/*$/i.test(e.url)){const o=yield e._fetchFirstLayerId(r);null!=o&&(e.layerId=o)}return e._fetchServiceLayer(r)})()}_fetchFirstLayerId(r){var e=this;return(0,a.A)(function*(){const o=yield(0,A.A)(e.url,{query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:r});if(o.data&&Array.isArray(o.data.layers)&&o.data.layers.length>0)return o.data.layers[0].id})()}_fetchServiceLayer(r){var e=this;return(0,a.A)(function*(){var o,l;const s=yield(0,A.A)(null!==(o=null===(l=e.parsedUrl)||void 0===l?void 0:l.path)&&void 0!==o?o:"",{query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:r});s.ssl&&(e.url=e.url.replace(/^http:/i,"https:"));let v=!1;if(s.data.layerType&&"Voxel"===s.data.layerType&&(v=!0),v)return e._fetchVoxelServiceLayer();const y=s.data;e.read(y,e._getServiceContext()),e.validateLayer(y)})()}_fetchVoxelServiceLayer(r){var e=this;return(0,a.A)(function*(){var o;const l=(yield(0,A.A)((null===(o=e.parsedUrl)||void 0===o?void 0:o.path)+"/layer",{query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:r})).data;e.read(l,e._getServiceContext()),e.validateLayer(l)})()}_getServiceContext(){var r;return{origin:"service",portalItem:this.portalItem,portal:null===(r=this.portalItem)||void 0===r?void 0:r.portal,url:this.parsedUrl}}_ensureLoadBeforeSave(){var r=this;return(0,a.A)(function*(){yield r.load(),"beforeSave"in r&&"function"==typeof r.beforeSave&&(yield r.beforeSave())})()}validateLayer(r){}_updateTypeKeywords(r,e,o){r.typeKeywords||(r.typeKeywords=[]);const l=e.getTypeKeywords();for(const s of l)r.typeKeywords.push(s);r.typeKeywords&&(r.typeKeywords=r.typeKeywords.filter((s,v,y)=>y.indexOf(s)===v),o===b.newItem&&(r.typeKeywords=r.typeKeywords.filter(s=>"Hosted Service"!==s)))}_saveAs(r,e){var o=this;return(0,a.A)(function*(){var l,s;const v={...H,...e};let y=c.default.from(r);if(!y)throw new h.A("sceneservice:portal-item-required","_saveAs() requires a portal item to save to");(0,w.X)(y),y.id&&(y=y.clone(),y.id=null);const N=y.portal||W.A.getDefault();yield o._ensureLoadBeforeSave(),y.type=z,y.portal=N;const $=(0,K.m)(y,"portal-item",!0),X={layers:[o.write({},$)]};return yield Promise.all(null!==(l=$.resources.pendingOperations)&&void 0!==l?l:[]),yield o._validateAgainstJSONSchema(X,$,v),y.url=o.url,y.title||(y.title=o.title),o._updateTypeKeywords(y,v,b.newItem),yield N.signIn(),yield null===(s=N.user)||void 0===s?void 0:s.addItem({item:y,folder:null==v?void 0:v.folder,data:X}),yield(0,V.r)(o.resourceReferences,$),o.portalItem=y,(0,m.v)($),$.portalItem=y,y})()}_save(r){var e=this;return(0,a.A)(function*(){var o;const l={...H,...r};if(!e.portalItem)throw new h.A("sceneservice:portal-item-not-set","Portal item to save to has not been set on this SceneService");if((0,w.X)(e.portalItem),e.portalItem.type!==z)throw new h.A("sceneservice:portal-item-wrong-type",`Portal item needs to have type "${z}"`);yield e._ensureLoadBeforeSave();const s=(0,K.m)(e.portalItem,"portal-item",!0),v={layers:[e.write({},s)]};return yield Promise.all(null!==(o=s.resources.pendingOperations)&&void 0!==o?o:[]),yield e._validateAgainstJSONSchema(v,s,l),e.portalItem.url=e.url,e.portalItem.title||(e.portalItem.title=e.title),e._updateTypeKeywords(e.portalItem,l,b.existingItem),yield(0,V.S)(e.portalItem,v,e.resourceReferences,s),(0,m.v)(s),e.portalItem})()}_validateAgainstJSONSchema(r,e,o){var l=this;return(0,a.A)(function*(){const s=null==o?void 0:o.validationOptions;(0,j.c)(e,{errorName:"sceneservice:save"},{ignoreUnsupported:null==s?void 0:s.ignoreUnsupported,supplementalUnsupportedErrors:["scenemodification:unsupported"]});const y=null;if((null==s?void 0:s.enabled)&&y){const N=(yield y()).validate(r,o.portalItemLayerType);if(!N.length)return;const $=`Layer item did not validate:\n${N.join("\n")}`;if(O.A.getLogger(l).error(`_validateAgainstJSONSchema(): ${$}`),"throw"===s.failPolicy){const X=N.map(Y=>new h.A("sceneservice:schema-validation",Y));throw new h.A("sceneservice-validate:error","Failed to save layer item due to schema validation, see `details.errors`.",{validationErrors:X})}}})()}};return(0,i._)([(0,u.MZ)(C.id)],P.prototype,"id",void 0),(0,i._)([(0,u.MZ)({type:I.A})],P.prototype,"spatialReference",void 0),(0,i._)([(0,d.w)("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],P.prototype,"readSpatialReference",null),(0,i._)([(0,u.MZ)({type:_.A})],P.prototype,"fullExtent",void 0),(0,i._)([(0,d.w)("fullExtent",["fullExtent","store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],P.prototype,"readFullExtent",null),(0,i._)([(0,u.MZ)({readOnly:!0,type:U.A})],P.prototype,"heightModelInfo",void 0),(0,i._)([(0,u.MZ)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:{source:"minScale"},write:!1}}}})],P.prototype,"minScale",void 0),(0,i._)([(0,u.MZ)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:{source:"maxScale"},write:!1}}}})],P.prototype,"maxScale",void 0),(0,i._)([(0,u.MZ)({readOnly:!0})],P.prototype,"version",void 0),(0,i._)([(0,d.w)("version",["store.version"])],P.prototype,"readVersion",null),(0,i._)([(0,u.MZ)({type:String,json:{read:{source:"copyrightText"}}})],P.prototype,"copyright",void 0),(0,i._)([(0,u.MZ)({type:String,json:{read:!1}})],P.prototype,"sublayerTitleMode",void 0),(0,i._)([(0,u.MZ)({type:String})],P.prototype,"title",void 0),(0,i._)([(0,d.w)("portal-item","title")],P.prototype,"readTitlePortalItem",null),(0,i._)([(0,d.w)("service","title",["name"])],P.prototype,"readTitleService",null),(0,i._)([(0,u.MZ)({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{write:{target:"id",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],P.prototype,"layerId",void 0),(0,i._)([(0,u.MZ)(C.OZ)],P.prototype,"url",null),(0,i._)([(0,L.K)("url")],P.prototype,"writeUrl",null),(0,i._)([(0,u.MZ)()],P.prototype,"parsedUrl",null),(0,i._)([(0,u.MZ)({readOnly:!0})],P.prototype,"store",void 0),(0,i._)([(0,u.MZ)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],P.prototype,"rootNode",void 0),P=(0,i._)([(0,T.$)("esri.layers.mixins.SceneService")],P),P},Z=-1e38;var b,B;(B=b||(b={}))[B.existingItem=0]="existingItem",B[B.newItem=1]="newItem";const z="Scene Service",H={getTypeKeywords:()=>[],portalItemLayerType:"unknown",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:"throw"}};var J;!function(B){B[B.SAVE=0]="SAVE",B[B.SAVE_AS=1]="SAVE_AS"}(J||(J={}))},27834:(F,M,t)=>{t.d(M,{F:()=>h});var a=t(10467),i=t(89563),A=t(5922);function h(g,f,u,x,E,d,T){return O.apply(this,arguments)}function O(){return(O=(0,a.A)(function*(g,f,u,x,E,d,T){let L=null;if(null!=u){const I=`${g}/nodepages/`,D=I+Math.floor(u.rootIndex/u.nodesPerPage);try{return{type:"page",rootPage:(yield(0,i.A)(D,{query:{f:"json",...x,token:E},responseType:"json",signal:T})).data,rootIndex:u.rootIndex,pageSize:u.nodesPerPage,lodMetric:u.lodSelectionMetricType,urlPrefix:I}}catch(C){null!=d&&d.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",D,C),L=C}}if(!f)return null;const _=`${g}/nodes/`,U=_+(null==f?void 0:f.split("/").pop());try{return{type:"node",rootNode:(yield(0,i.A)(U,{query:{f:"json",...x,token:E},responseType:"json",signal:T})).data,urlPrefix:_}}catch(I){throw new A.A("sceneservice:root-node-missing","Root node missing.",{pageError:L,nodeError:I,url:U})}})).apply(this,arguments)}},15764:(F,M,t)=>{t.d(M,{m:()=>h,v:()=>A});var a=t(45272),i=t(73874);function A(g,f){return{...O(g,f),readResourcePaths:[]}}function h(g,f,u){const x=(0,a.An)(g.itemUrl);return{...O(g,f),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:x?{rootPath:x.path,writtenUrls:[]}:null,resources:u?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function O(g,f){return{origin:f,url:(0,a.An)(g.itemUrl),portal:g.portal||i.A.getDefault(),portalItem:g}}},57340:(F,M,t)=>{t.r(M),t.d(M,{addOrUpdateResources:()=>f,contentToBlob:()=>U,fetchResources:()=>O,getSiblingOfSameType:()=>D,getSiblingOfSameTypeI:()=>C,removeAllResources:()=>d,removeResource:()=>x,splitPrefixFileNameAndExtension:()=>m});var a=t(10467),i=t(89563),A=t(5922),h=t(45272);function O(n){return g.apply(this,arguments)}function g(){return(g=(0,a.A)(function*(n,p={},S){yield n.load(S);const R=(0,h.fj)(n.itemUrl,"resources"),{start:W=1,num:c=10,sortOrder:K="asc",sortField:V="resource"}=p,w={query:{start:W,num:c,sortOrder:K,sortField:V,token:n.apiKey},signal:null==S?void 0:S.signal},j=yield n.portal.request(R,w);return{total:j.total,nextStart:j.nextStart,resources:j.resources.map(({created:G,size:Z,resource:b})=>({created:new Date(G),size:Z,resource:n.resourceFromPath(b)}))}})).apply(this,arguments)}function f(n,p,S,R){return u.apply(this,arguments)}function u(){return(u=(0,a.A)(function*(n,p,S,R){const W=new Map;for(const{resource:K,content:V,compress:w,access:j}of p){if(!K.hasPath())throw new A.A(`portal-item-resource-${S}:invalid-path`,"Resource does not have a valid path");const[G,Z]=L(K.path),b=`${G}/${null!=w?w:""}/${null!=j?j:""}`;W.has(b)||W.set(b,{prefix:G,compress:w,access:j,files:[]}),W.get(b).files.push({fileName:Z,content:V})}yield n.load(R);const c=(0,h.fj)(n.userItemUrl,"add"===S?"addResources":"updateResources");for(const{prefix:K,compress:V,access:w,files:j}of W.values())for(let Z=0;Z<j.length;Z+=25){const b=j.slice(Z,Z+25),z=new FormData;K&&"."!==K&&z.append("resourcesPrefix",K),V&&z.append("compress","true"),w&&z.append("access",w);let H=0;for(const{fileName:J,content:B}of b)z.append("file"+ ++H,B,J);z.append("f","json"),yield n.portal.request(c,{method:"post",body:z,signal:null==R?void 0:R.signal})}})).apply(this,arguments)}function x(n,p,S){return E.apply(this,arguments)}function E(){return(E=(0,a.A)(function*(n,p,S){if(!p.hasPath())throw new A.A("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield n.load(S);const R=(0,h.fj)(n.userItemUrl,"removeResources");yield n.portal.request(R,{method:"post",query:{resource:p.path},signal:null==S?void 0:S.signal}),p.portalItem=null})).apply(this,arguments)}function d(n,p){return T.apply(this,arguments)}function T(){return(T=(0,a.A)(function*(n,p){yield n.load(p);const S=(0,h.fj)(n.userItemUrl,"removeResources");return n.portal.request(S,{method:"post",query:{deleteAll:!0},signal:null==p?void 0:p.signal})})).apply(this,arguments)}function L(n){const p=n.lastIndexOf("/");return-1===p?[".",n]:[n.slice(0,p),n.slice(p+1)]}function m(n){const[p,S]=function _(n){const p=(0,h.Zo)(n);return null==p?[n,""]:[n.slice(0,n.length-p.length-1),`.${p}`]}(n),[R,W]=L(p);return[R,W,S]}function U(n){return I.apply(this,arguments)}function I(){return(I=(0,a.A)(function*(n){return"blob"===n.type?n.blob:"json"===n.type?new Blob([n.jsonString],{type:"application/json"}):(yield(0,i.A)(n.url,{responseType:"blob"})).data})).apply(this,arguments)}function D(n,p){if(!n.hasPath())return null;const[S,,R]=m(n.path);return n.portalItem.resourceFromPath((0,h.fj)(S,p+R))}function C(n,p){if(!n.hasPath())return null;const[S,,R]=m(n.path);return n.portalItem.resourceFromPath((0,h.fj)(S,p+R))}},3458:(F,M,t)=>{t.d(M,{S:()=>u,r:()=>g});var a=t(10467),i=t(5922),A=t(56492),h=t(43085),O=t(57340);function g(m,_,U){return f.apply(this,arguments)}function f(){return(f=(0,a.A)(function*(m,_,U){const I=yield E(m,_,U);yield T(I,_,U)})).apply(this,arguments)}function u(m,_,U,I,D){return x.apply(this,arguments)}function x(){return(x=(0,a.A)(function*(m,_,U,I,D){const C=yield E(U,I,D);yield m.update({data:_}),yield T(C,I,D)})).apply(this,arguments)}function E(m,_,U){return d.apply(this,arguments)}function d(){return(d=(0,a.A)(function*(m,_,U){if(null==_||!_.resources)return;const I=_.portalItem===m.portalItem?new Set(m.paths):new Set;m.paths.length=0,m.portalItem=_.portalItem;const D=new Set(_.resources.toKeep.map(c=>c.resource.path)),C=new Set,n=[];D.forEach(c=>{I.delete(c),m.paths.push(c)});const p=[],S=[],R=[];for(const c of _.resources.toUpdate)if(I.delete(c.resource.path),D.has(c.resource.path)||C.has(c.resource.path)){const{resource:K,content:V,finish:w}=c,j=(0,O.getSiblingOfSameTypeI)(K,(0,h.lk)());m.paths.push(j.path),p.push({resource:j,content:yield(0,O.contentToBlob)(V),compress:c.compress}),w&&R.push(()=>w(j))}else{m.paths.push(c.resource.path),S.push({resource:c.resource,content:yield(0,O.contentToBlob)(c.content),compress:c.compress});const K=c.finish;K&&R.push(()=>K(c.resource)),C.add(c.resource.path)}for(const c of _.resources.toAdd)if(m.paths.push(c.resource.path),I.has(c.resource.path))I.delete(c.resource.path);else{p.push({resource:c.resource,content:yield(0,O.contentToBlob)(c.content),compress:c.compress});const K=c.finish;K&&R.push(()=>K(c.resource))}if(p.length||S.length){const{addOrUpdateResources:c}=yield Promise.resolve().then(t.bind(t,57340));yield c(_.portalItem,p,"add",U),yield c(_.portalItem,S,"update",U)}if(R.forEach(c=>c()),0===n.length)return I;const W=yield(0,A.Ol)(n);if((0,A.Te)(U),W.length>0)throw new i.A("save:resources","Failed to save one or more resources",{errors:W});return I})).apply(this,arguments)}function T(m,_,U){return L.apply(this,arguments)}function L(){return(L=(0,a.A)(function*(m,_,U){if(!m||!_.portalItem)return;const I=[];for(const D of m){const C=_.portalItem.resourceFromPath(D);I.push(C.portalItem.removeResource(C,U))}yield(0,A.Lx)(I)})).apply(this,arguments)}},96904:(F,M,t)=>{t.d(M,{X:()=>h});var a=t(23098),i=t(5922),A=t(2174);function h(O){if(a.A.apiKey&&(0,A.Q)(O.portal.url))throw new i.A("save-api-key-utils:api-key-not-supported",`Saving is not supported on ${O.portal.url} when using an api key`)}},95945:(F,M,t)=>{t.d(M,{c:()=>g,d:()=>A});var a=t(10467),i=t(5922);function A(f){return h.apply(this,arguments)}function h(){return(h=(0,a.A)(function*(f){const u=[];for(const x of f.allLayers)if("beforeSave"in x&&"function"==typeof x.beforeSave){const E=x.beforeSave();E&&u.push(E)}yield Promise.allSettled(u)})).apply(this,arguments)}const O=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function g(f,u,x){var E;let d=(null!==(E=f.messages)&&void 0!==E?E:[]).filter(({type:T})=>"error"===T).map(({name:T,message:L,details:m})=>new i.A(T,L,m));if(f.blockedRelativeUrls&&(d=d.concat(f.blockedRelativeUrls.map(T=>new i.A("url:unsupported",`Relative url '${T}' is not supported`)))),x){const{ignoreUnsupported:T,supplementalUnsupportedErrors:L=[],requiredPropertyChecksDisabled:m}=x;T&&(d=d.filter(({name:_})=>!(O.has(_)||L.includes(_)))),m&&(d=d.filter(_=>"web-document-write:property-required"!==_.name))}if(d.length>0)throw new i.A(u.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:d})}}}]);