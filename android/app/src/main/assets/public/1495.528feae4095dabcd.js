"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1495],{55144:(K,w,u)=>{u.d(w,{T:()=>d,d:()=>F});const d={Base64:0,Hex:1,String:2,Raw:3},S=8,T=(1<<S)-1;function I(s,v){const t=(65535&s)+(65535&v);return(s>>16)+(v>>16)+(t>>16)<<16|65535&t}function A(s,v,t,e,r,i){return I(function C(s,v){return s<<v|s>>>32-v}(I(I(v,s),I(e,i)),r),t)}function m(s,v,t,e,r,i,o){return A(v&t|~v&e,s,v,r,i,o)}function b(s,v,t,e,r,i,o){return A(v&e|t&~e,s,v,r,i,o)}function y(s,v,t,e,r,i,o){return A(v^t^e,s,v,r,i,o)}function E(s,v,t,e,r,i,o){return A(t^(v|~e),s,v,r,i,o)}function F(s,v=d.Hex){const t=v||d.Base64,e=function k(s,v){s[v>>5]|=128<<v%32,s[14+(v+64>>>9<<4)]=v;let t=1732584193,e=-271733879,r=-1732584194,i=271733878;for(let o=0;o<s.length;o+=16){const x=t,W=e,D=r,z=i;t=m(t,e,r,i,s[o],7,-680876936),i=m(i,t,e,r,s[o+1],12,-389564586),r=m(r,i,t,e,s[o+2],17,606105819),e=m(e,r,i,t,s[o+3],22,-1044525330),t=m(t,e,r,i,s[o+4],7,-176418897),i=m(i,t,e,r,s[o+5],12,1200080426),r=m(r,i,t,e,s[o+6],17,-1473231341),e=m(e,r,i,t,s[o+7],22,-45705983),t=m(t,e,r,i,s[o+8],7,1770035416),i=m(i,t,e,r,s[o+9],12,-1958414417),r=m(r,i,t,e,s[o+10],17,-42063),e=m(e,r,i,t,s[o+11],22,-1990404162),t=m(t,e,r,i,s[o+12],7,1804603682),i=m(i,t,e,r,s[o+13],12,-40341101),r=m(r,i,t,e,s[o+14],17,-1502002290),e=m(e,r,i,t,s[o+15],22,1236535329),t=b(t,e,r,i,s[o+1],5,-165796510),i=b(i,t,e,r,s[o+6],9,-1069501632),r=b(r,i,t,e,s[o+11],14,643717713),e=b(e,r,i,t,s[o],20,-373897302),t=b(t,e,r,i,s[o+5],5,-701558691),i=b(i,t,e,r,s[o+10],9,38016083),r=b(r,i,t,e,s[o+15],14,-660478335),e=b(e,r,i,t,s[o+4],20,-405537848),t=b(t,e,r,i,s[o+9],5,568446438),i=b(i,t,e,r,s[o+14],9,-1019803690),r=b(r,i,t,e,s[o+3],14,-187363961),e=b(e,r,i,t,s[o+8],20,1163531501),t=b(t,e,r,i,s[o+13],5,-1444681467),i=b(i,t,e,r,s[o+2],9,-51403784),r=b(r,i,t,e,s[o+7],14,1735328473),e=b(e,r,i,t,s[o+12],20,-1926607734),t=y(t,e,r,i,s[o+5],4,-378558),i=y(i,t,e,r,s[o+8],11,-2022574463),r=y(r,i,t,e,s[o+11],16,1839030562),e=y(e,r,i,t,s[o+14],23,-35309556),t=y(t,e,r,i,s[o+1],4,-1530992060),i=y(i,t,e,r,s[o+4],11,1272893353),r=y(r,i,t,e,s[o+7],16,-155497632),e=y(e,r,i,t,s[o+10],23,-1094730640),t=y(t,e,r,i,s[o+13],4,681279174),i=y(i,t,e,r,s[o],11,-358537222),r=y(r,i,t,e,s[o+3],16,-722521979),e=y(e,r,i,t,s[o+6],23,76029189),t=y(t,e,r,i,s[o+9],4,-640364487),i=y(i,t,e,r,s[o+12],11,-421815835),r=y(r,i,t,e,s[o+15],16,530742520),e=y(e,r,i,t,s[o+2],23,-995338651),t=E(t,e,r,i,s[o],6,-198630844),i=E(i,t,e,r,s[o+7],10,1126891415),r=E(r,i,t,e,s[o+14],15,-1416354905),e=E(e,r,i,t,s[o+5],21,-57434055),t=E(t,e,r,i,s[o+12],6,1700485571),i=E(i,t,e,r,s[o+3],10,-1894986606),r=E(r,i,t,e,s[o+10],15,-1051523),e=E(e,r,i,t,s[o+1],21,-2054922799),t=E(t,e,r,i,s[o+8],6,1873313359),i=E(i,t,e,r,s[o+15],10,-30611744),r=E(r,i,t,e,s[o+6],15,-1560198380),e=E(e,r,i,t,s[o+13],21,1309151649),t=E(t,e,r,i,s[o+4],6,-145523070),i=E(i,t,e,r,s[o+11],10,-1120210379),r=E(r,i,t,e,s[o+2],15,718787259),e=E(e,r,i,t,s[o+9],21,-343485551),t=I(t,x),e=I(e,W),r=I(r,D),i=I(i,z)}return[t,e,r,i]}(function $(s){const v=[];for(let t=0,e=s.length*S;t<e;t+=S)v[t>>5]|=(s.charCodeAt(t/S)&T)<<t%32;return v}(s),s.length*S);switch(t){case d.Raw:return e;case d.Hex:return function O(s){const v="0123456789abcdef",t=[];for(let e=0,r=4*s.length;e<r;e++)t.push(v.charAt(s[e>>2]>>e%4*8+4&15)+v.charAt(s[e>>2]>>e%4*8&15));return t.join("")}(e);case d.String:return function P(s){const v=[];for(let t=0,e=32*s.length;t<e;t+=S)v.push(String.fromCharCode(s[t>>5]>>>t%32&T));return v.join("")}(e);case d.Base64:return function R(s){const e=[];for(let r=0,i=4*s.length;r<i;r+=3){const o=(s[r>>2]>>r%4*8&255)<<16|(s[r+1>>2]>>(r+1)%4*8&255)<<8|s[r+2>>2]>>(r+2)%4*8&255;for(let x=0;x<4;x++)e.push(8*r+6*x>32*s.length?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>6*(3-x)&63))}return e.join("")}(e)}}},61495:(K,w,u)=>{u.d(w,{J:()=>Ae});var d=u(8189),R=(u(79122),u(70176),u(92089),u(9826),u(15317),u(38582),u(73747)),A=(u(13318),u(85718)),m=u(35150),b=u(48900),y=u(85211),E=u(3248),F=(u(40707),u(76576)),s=u(71065),v=u(77806),t=u(90660);let e=class extends((0,t.O)(s.oY)){constructor(l){super(l),this.expression=null,this.title=null,this.returnType=null}};(0,d._)([(0,y.MZ)({type:String,json:{write:!0}})],e.prototype,"expression",void 0),(0,d._)([(0,y.MZ)({type:String,json:{write:!0}})],e.prototype,"title",void 0),(0,d._)([(0,y.MZ)({type:String,json:{write:!0}})],e.prototype,"returnType",void 0),e=(0,d._)([(0,F.$)("esri.layers.support.ExpressionInfo")],e);const r=e;var i;let o=i=class extends s.oY{constructor(l){super(l),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new i({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:(0,v.o8)(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};(0,d._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],o.prototype,"isAutoGenerated",void 0),(0,d._)([(0,y.MZ)({type:String,json:{write:!0}})],o.prototype,"name",void 0),(0,d._)([(0,y.MZ)({type:String,json:{write:!0}})],o.prototype,"alias",void 0),(0,d._)([(0,y.MZ)({type:String,json:{write:!0}})],o.prototype,"onStatisticField",void 0),(0,d._)([(0,y.MZ)({type:r,json:{write:!0}})],o.prototype,"onStatisticExpression",void 0),(0,d._)([(0,y.MZ)({type:String,json:{write:!0}})],o.prototype,"statisticType",void 0),o=i=(0,d._)([(0,F.$)("esri.layers.support.AggregateField")],o);const x=o;var H,W=u(50501),D=u(27378),z=u(92165),q=u(36156),ee=u(89221),te=u(15463),U=u(17221),N=u(50305),B=u(81687),re=u(47516),se=u(20329);let M=H=class extends D.c{constructor(l){super(l),this.type="binning",this.binType="geohash",this.fixedBinLevel=3,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.fields=[],this.renderer=null}writeFields(l,p,n){const f=l.filter(a=>"avg_angle"!==a.statisticType).map(a=>a.toJSON());(0,ee.sM)(n,f,p)}readRenderer(l,p,n){var f,a;const c=null===(f=p.drawingInfo)||void 0===f?void 0:f.renderer;return c?null!==(a=(0,A.L)(c,p,n))&&void 0!==a?a:void 0:(0,re.PD)(p,n)}clone(){return new H({fields:(0,v.o8)(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:(0,v.o8)(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:(0,v.o8)(this.popupTemplate),renderer:(0,v.o8)(this.renderer)})}};(0,d._)([(0,te.e)({binning:"binning"})],M.prototype,"type",void 0),(0,d._)([(0,te.e)({geohash:"geohash"})],M.prototype,"binType",void 0),(0,d._)([(0,y.MZ)({type:Number,range:{min:1,max:9},json:{write:!0}})],M.prototype,"fixedBinLevel",void 0),(0,d._)([(0,y.MZ)({type:[se.A],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],M.prototype,"labelingInfo",void 0),(0,d._)([(0,y.MZ)(B.kF)],M.prototype,"labelsVisible",void 0),(0,d._)([(0,y.MZ)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],M.prototype,"maxScale",void 0),(0,d._)([(0,y.MZ)(B.M6)],M.prototype,"popupEnabled",void 0),(0,d._)([(0,y.MZ)({type:z.A,json:{name:"popupInfo",write:!0}})],M.prototype,"popupTemplate",void 0),(0,d._)([(0,y.MZ)({type:[x],json:{write:!0}})],M.prototype,"fields",void 0),(0,d._)([(0,N.K)("fields")],M.prototype,"writeFields",null),(0,d._)([(0,y.MZ)({types:q.H,json:{write:{target:"drawingInfo.renderer"}}})],M.prototype,"renderer",void 0),(0,d._)([(0,U.w)("renderer",["drawingInfo.renderer"])],M.prototype,"readRenderer",null),M=H=(0,d._)([(0,F.$)("esri.layers.support.FeatureReductionBinning")],M);const ie=M;var J,ve=u(47280),L=u(67685);function oe(l){var p;return"simple"===l.type&&!(null!==(p=l.visualVariables)&&void 0!==p&&p.length)}let g=J=class extends s.oY{constructor(l){super(l),this.type="cluster",this.clusterRadius=(0,L.cr)("80px"),this.clusterMinSize=(0,L.cr)("12px"),this.clusterMaxSize=(0,L.cr)("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(l,p,n){var f,a,c;const h=null===(f=p.drawingInfo)||void 0===f?void 0:f.renderer;return null!=h&&null!==(a=h.authoringInfo)&&void 0!==a&&a.isAutoGenerated?null:h?oe(h)?null:null!==(c=(0,A.L)(h,p,n))&&void 0!==c?c:void 0:(0,re.PD)(p,n)}readSymbol(l,p,n){var f,a;const c=null===(f=p.drawingInfo)||void 0===f?void 0:f.renderer;if(null!=c&&null!==(a=c.authoringInfo)&&void 0!==a&&a.isAutoGenerated)return null;if(c&&oe(c)){const h=(0,A.L)(c,p,n);return null==h?void 0:h.symbol}return null}writeSymbol(l,p,n,f){var a;const c=null===(a=this.renderer)||void 0===a||null===(a=a.authoringInfo)||void 0===a?void 0:a.isAutoGenerated;if(!this.renderer||c){const h=new R.A({symbol:l});p.drawingInfo={renderer:h.write({},f)}}}writeFields(l,p,n){const f=l.filter(a=>"avg_angle"!==a.statisticType).map(a=>a.toJSON());(0,ee.sM)(n,f,p)}readFields(l,p,n){return l.filter(f=>!f.isAutoGenerated).map(f=>x.fromJSON(f))}clone(){return new J({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:(0,v.o8)(this.labelingInfo),labelsVisible:this.labelsVisible,fields:(0,v.o8)(this.fields),maxScale:this.maxScale,renderer:(0,v.o8)(this.renderer),symbol:(0,v.o8)(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:(0,v.o8)(this.popupTemplate)})}};(0,d._)([(0,y.MZ)({type:["cluster"],readOnly:!0,json:{write:!0}})],g.prototype,"type",void 0),(0,d._)([(0,y.MZ)({type:Number,cast:l=>"auto"===l?l:(0,L.cr)(l),json:{write:!0}})],g.prototype,"clusterRadius",void 0),(0,d._)([(0,y.MZ)({type:Number,cast:L.cr,json:{write:!0}})],g.prototype,"clusterMinSize",void 0),(0,d._)([(0,y.MZ)({type:Number,cast:L.cr,json:{write:!0}})],g.prototype,"clusterMaxSize",void 0),(0,d._)([(0,y.MZ)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],g.prototype,"maxScale",void 0),(0,d._)([(0,y.MZ)(B.M6)],g.prototype,"popupEnabled",void 0),(0,d._)([(0,y.MZ)({type:z.A,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],g.prototype,"popupTemplate",void 0),(0,d._)([(0,y.MZ)({types:q.H,json:{write:{target:"drawingInfo.renderer"}}})],g.prototype,"renderer",void 0),(0,d._)([(0,U.w)("renderer",["drawingInfo.renderer"])],g.prototype,"readRenderer",null),(0,d._)([(0,y.MZ)({types:ve.q8})],g.prototype,"symbol",void 0),(0,d._)([(0,U.w)("symbol",["drawingInfo.renderer"])],g.prototype,"readSymbol",null),(0,d._)([(0,N.K)("symbol")],g.prototype,"writeSymbol",null),(0,d._)([(0,y.MZ)({type:[se.A],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],g.prototype,"labelingInfo",void 0),(0,d._)([(0,y.MZ)(B.kF)],g.prototype,"labelsVisible",void 0),(0,d._)([(0,y.MZ)({type:[x],json:{write:!0}})],g.prototype,"fields",void 0),(0,d._)([(0,N.K)("fields")],g.prototype,"writeFields",null),(0,d._)([(0,U.w)("fields")],g.prototype,"readFields",null),g=J=(0,d._)([(0,F.$)("esri.layers.support.FeatureReductionCluster")],g);const ne=g;var le=u(71906);const ae={key:"type",base:D.c,typeMap:{cluster:ne,binning:ie}},he={types:{key:"type",base:D.c,typeMap:{selection:le.A,cluster:ne,binning:ie}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:ae},"portal-item":{types:ae},"web-scene":{types:{key:"type",base:D.c,typeMap:{selection:le.A}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:W.K}}}}};var me=u(83699),Y=u(8042),ge=u(5922),ue=u(55144),be=u(13306),Ee=u(46602);E.A.add("esri-cluster-arcade-enabled",!0);const Re=(0,E.A)("esri-cluster-arcade-enabled"),xe=new Set(["simple-line","simple-fill","picture-fill"]);function de(l,p){let n=p.clone();if(!Se(n))return n;if(p.getSymbols().some(f=>xe.has(f.type))&&(n=new R.A({symbol:new Ee.A})),n.authoringInfo||(n.authoringInfo=new be.A),n.authoringInfo.isAutoGenerated=!0,"visualVariables"in n){const f=(n.visualVariables||[]).filter(a=>"$view.scale"!==a.valueExpression);f.forEach(a=>{"rotation"===a.type?a.field?a.field=j(l,a.field,"avg_angle","number"):a.valueExpression&&(a.field=Z(l,a.valueExpression,"avg_angle","number"),a.valueExpression=null):a.normalizationField?(a.field=j(l,a.field,"avg_norm","number",a.normalizationField),a.normalizationField=null):a.field?a.field=j(l,a.field,"avg","number"):a.valueExpression&&(a.field=Z(l,a.valueExpression,"avg","number"),a.valueExpression=null)}),n.visualVariables=f}switch(n.type){case"simple":break;case"pie-chart":for(const f of n.attributes)f.field?f.field=j(l,f.field,"sum","number"):f.valueExpression&&(f.field=Z(l,f.valueExpression,"sum","number"),f.valueExpression=null);break;case"unique-value":n.field?n.field=j(l,n.field,"mode","string"):n.valueExpression&&(n.field=Z(l,n.valueExpression,"mode","string"),n.valueExpression=null);break;case"class-breaks":n.normalizationField?(n.field=j(l,n.field,"avg_norm","number",n.normalizationField),n.normalizationField=null):n.field?n.field=j(l,n.field,"avg","number"):n.valueExpression&&(n.field=Z(l,n.valueExpression,"avg","number"),n.valueExpression=null)}return n}const Se=l=>{const p=n=>m.A.getLogger("esri.views.2d.layers.support.clusterUtils").error(new ge.A("Unsupported-renderer",n,{renderer:l}));if(!l)return!1;switch(l.type){case"unique-value":if(l.field2||l.field3)return p("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(l.normalizationField){const n=l.normalizationType;if("field"!==n)return p(`FeatureReductionCluster does not support a normalizationType of ${n}`),!1}break;case"simple":case"pie-chart":break;default:return p(`FeatureReductionCluster does not support renderers of type ${l.type}`),!1}if(!Re){if("valueExpression"in l&&l.valueExpression)return p("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in l&&l.visualVariables||[]).some(n=>!(!("valueExpression"in n)||!n.valueExpression)))return p("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function Z(l,p,n,f){const a=(0,ue.d)(p),c="mode"===n?`cluster_type_${a}`:"sum"===n?`cluster_sum_${a}`:`cluster_avg_${a}`;return l.some(h=>h.name===c)||l.push(new x({name:c,isAutoGenerated:!0,onStatisticExpression:new r({expression:p,returnType:f}),statisticType:n})),c}function j(l,p,n,f,a){if("cluster_count"===p||l.some(h=>h.name===p))return p;const c=function Ie(l,p,n){switch(l){case"sum":return`cluster_sum_${p}`;case"avg":case"avg_angle":return`cluster_avg_${p}`;case"mode":return`cluster_type_${p}`;case"avg_norm":{const f=n,a="field",c=p.toLowerCase()+",norm:"+a+","+f.toLowerCase();return"cluster_avg_"+(0,ue.d)(c)}}}(n,p,a);return l.some(h=>h.name===c)||l.push(new x("avg_norm"===n?{name:c,isAutoGenerated:!0,onStatisticExpression:new r({expression:`$feature.${p} / $feature.${a}`,returnType:f}),statisticType:"avg"}:{name:c,isAutoGenerated:!0,onStatisticField:p,statisticType:n})),c}const Ae=l=>{let p=class extends l{constructor(...n){super(...n),this.addHandles((0,b.wB)(()=>this.renderer,()=>{if(this.featureReduction){const f=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",f)}},b.OH))}set featureReduction(n){const f=this._normalizeFeatureReduction(n);this._set("featureReduction",f)}set renderer(n){}_withClusterVariable(n,f,a){const c=n.clone();return"visualVariables"in c&&(c.visualVariables||(c.visualVariables=[]),c.visualVariables.some(h=>"size"===h.type)||c.visualVariables.push(new me.A({field:"cluster_count",stops:[new Y.A({value:1}),new Y.A({useMinValue:!0,size:f}),new Y.A({useMaxValue:!0,size:a})]}))),c}_normalizeFeatureReduction(n){var f,a;if("cluster"!==(null==n?void 0:n.type))return n;const c=n.clone(),h=[new x({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],_=(null!==(f=c.fields)&&void 0!==f?f:[]).filter(V=>!V.isAutoGenerated),we=n.renderer&&!(null!==(a=n.renderer.authoringInfo)&&void 0!==a&&a.isAutoGenerated),{clusterMinSize:Q,clusterMaxSize:X}=c;if(we){c.fields=[...h,..._];const V=this._withClusterVariable(c.renderer,Q,X);return c.effectiveFeatureRenderer=V,c.effectiveClusterRenderer=V,c}if(n.symbol){if(c.fields=[...h,..._],c.renderer=null,!this.renderer)return c.effectiveFeatureRenderer=null,c.effectiveClusterRenderer=null,c;const V=de(h,this.renderer),G=this._withClusterVariable(V,Q,X),Fe=new R.A({symbol:n.symbol,visualVariables:"visualVariables"in G&&G.visualVariables?G.visualVariables:[]});return c.fields=[...h,..._],c.effectiveFeatureRenderer=G,c.effectiveClusterRenderer=Fe,c}if(!this.renderer)return n;const pe=de(h,this.renderer);c.fields=[...h,..._],c.renderer=pe;const ce=this._withClusterVariable(pe,Q,X);return c.effectiveFeatureRenderer=ce,c.effectiveClusterRenderer=ce,c}};return(0,d._)([(0,y.MZ)(he)],p.prototype,"featureReduction",null),p=(0,d._)([(0,F.$)("esri.layers.mixins.FeatureReductionLayer")],p),p}},27378:(K,w,u)=>{u.d(w,{c:()=>R});var d=u(8189),S=u(71065),T=u(85211),O=(u(3248),u(35150),u(40707),u(76576));let R=class extends S.oY{constructor(){super(...arguments),this.type=null}};(0,d._)([(0,T.MZ)({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],R.prototype,"type",void 0),R=(0,d._)([(0,O.$)("esri.layers.support.FeatureReduction")],R)},71906:(K,w,u)=>{u.d(w,{A:()=>A});var R,d=u(8189),S=u(85211),P=(u(3248),u(35150),u(40707),u(76576)),O=u(27378);let C=R=class extends O.c{constructor(m){super(m),this.type="selection"}clone(){return new R}};(0,d._)([(0,S.MZ)({type:["selection"]})],C.prototype,"type",void 0),C=R=(0,d._)([(0,P.$)("esri.layers.support.FeatureReductionSelection")],C);const A=C}}]);