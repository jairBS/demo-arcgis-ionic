"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[451],{13305:(ie,Q,i)=>{i.r(Q),i.d(Q,{default:()=>ft});var M=i(10467),s=i(8189),u=i(31178),Z=i(2993),I=i(5922),L=i(77806),x=i(4879),C=i(35150),H=i(39693),W=i(56492),V=i(45272),l=i(85211),D=(i(3248),i(17221)),O=i(76576),_=i(32034),U=i(95478),P=i(81098),G=i(92165),y=(i(79122),i(70176),i(92089),i(9826),i(15317),i(38582),i(73747),i(13318),i(85718),i(36156)),S=i(89563),g=i(49976),R=i(55098),b=i(64261),q=(i(40707),i(15463)),Y=i(28067),Be=i(35940),Ke=i(3046),Ne=i(55739),X=i(81687);let w=class extends((0,Ke.sA)(H.L)){constructor(t){super(t),this.title="",this.id=-1,this.modelName=null,this.isEmpty=null,this.legendEnabled=!0,this.visible=!0,this.opacity=1}readTitle(t,o){return"string"==typeof o.alias?o.alias:"string"==typeof o.name?o.name:""}readIdOnlyOnce(t){return-1!==this.id?this.id:"number"==typeof t?t:-1}};(0,s._)([(0,l.MZ)({type:String,json:{origins:{"web-scene":{write:!0},"portal-item":{write:!0}}}})],w.prototype,"title",void 0),(0,s._)([(0,D.w)("service","title",["alias","name"])],w.prototype,"readTitle",null),(0,s._)([(0,l.MZ)()],w.prototype,"layer",void 0),(0,s._)([(0,l.MZ)({type:Ne.jz,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],w.prototype,"id",void 0),(0,s._)([(0,D.w)("service","id")],w.prototype,"readIdOnlyOnce",null),(0,s._)([(0,l.MZ)((0,X.Qo)(String))],w.prototype,"modelName",void 0),(0,s._)([(0,l.MZ)((0,X.Qo)(Boolean))],w.prototype,"isEmpty",void 0),(0,s._)([(0,l.MZ)({type:Boolean,nonNullable:!0})],w.prototype,"legendEnabled",void 0),(0,s._)([(0,l.MZ)({type:Boolean,json:{name:"visibility",write:!0}})],w.prototype,"visible",void 0),(0,s._)([(0,l.MZ)({type:Number,json:{write:!0}})],w.prototype,"opacity",void 0),w=(0,s._)([(0,O.$)("esri.layers.buildingSublayers.BuildingSublayer")],w);const Ie=w;var We=i(91297),Ge=i(75783),ze=i(3404),$e=i(73258),Je=i(86300),He=i(27834),ne=i(10581),Ve=i(87086),Ye=i(41843),Xe=i(88485),qe=i(99550),xe=i(64935);const Le=(0,ze.p)();let f=class extends((0,We.M)(R.A.LoadableMixin((0,b.g)(Ie)))){constructor(t){super(t),this.type="building-component",this.nodePages=null,this.materialDefinitions=[],this.textureSetDefinitions=[],this.geometryDefinitions=[],this.indexInfo=null,this.serviceUpdateTimeStamp=null,this.store=null,this.attributeStorageInfo=[],this.fields=[],this.associatedLayer=null,this.outFields=null,this.listMode="show",this.renderer=null,this.definitionExpression=null,this.popupEnabled=!0,this.popupTemplate=null,this.layerType="3d-object"}get parsedUrl(){var t,o;return this.layer?{path:`${null===(t=this.layer.parsedUrl)||void 0===t?void 0:t.path}/sublayers/${this.id}`,query:null===(o=this.layer.parsedUrl)||void 0===o?void 0:o.query}:{path:""}}get fieldsIndex(){return new $e.A(this.fields)}readAssociatedLayer(t,o){const a=this.layer.associatedFeatureServiceItem,m=o.associatedLayerID;return null!=a&&"number"==typeof m?new Be.default({portalItem:a,customParameters:this.customParameters,layerId:m}):null}get objectIdField(){if(null!=this.fields)for(const t of this.fields)if("oid"===t.type)return t.name;return null}get displayField(){return null!=this.associatedLayer?this.associatedLayer.displayField:void 0}get apiKey(){return this.layer.apiKey}get customParameters(){return this.layer.customParameters}get fullExtent(){return this.layer.fullExtent}get spatialReference(){return this.layer.spatialReference}get version(){return this.layer.version}get elevationInfo(){return this.layer.elevationInfo}get minScale(){return this.layer.minScale}get maxScale(){return this.layer.maxScale}get effectiveScaleRange(){return this.layer.effectiveScaleRange}get defaultPopupTemplate(){return this.createPopupTemplate()}load(t){const o=null!=t?t.signal:null,a=this._fetchService(o).then(()=>{this.indexInfo=(0,He.F)(this.parsedUrl.path,this.rootNode,this.nodePages,this.customParameters,this.apiKey,C.A.getLogger(this),o)});return this.addResolvingPromise(a),Promise.resolve(this)}createPopupTemplate(t){return(0,Ye.tn)(this,t)}_fetchService(t){var o=this;return(0,M.A)(function*(){const a=(yield(0,S.A)(o.parsedUrl.path,{query:{f:"json",...o.customParameters,token:o.apiKey},responseType:"json",signal:t})).data;o.read(a,{origin:"service",url:o.parsedUrl})})()}getField(t){return this.fieldsIndex.get(t)}getFieldDomain(t,o){var a,m,T;const N=null===(a=this.getFeatureType(null==o?void 0:o.feature))||void 0===a||null===(a=a.domains)||void 0===a?void 0:a[t];return N&&"inherited"!==N.type?N:null!==(m=null===(T=this.getField(t))||void 0===T?void 0:T.domain)&&void 0!==m?m:null}getFeatureType(t){return t&&null!=this.associatedLayer?this.associatedLayer.getFeatureType(t):null}get types(){var t;return null!=this.associatedLayer&&null!==(t=this.associatedLayer.types)&&void 0!==t?t:[]}get typeIdField(){return null!=this.associatedLayer?this.associatedLayer.typeIdField:null}get geometryType(){return"3d-object"===this.layerType?"mesh":"point"}get profile(){return"3d-object"===this.layerType?"mesh-pyramids":"points"}get capabilities(){const t=null!=this.associatedLayer&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:Ge.P,{query:o,data:{supportsZ:a,supportsM:m,isVersioned:T}}=t;return{query:o,data:{supportsZ:a,supportsM:m,isVersioned:T}}}createQuery(){const t=new Ve.A;return"mesh"!==this.geometryType&&(t.returnGeometry=!0,t.returnZ=!0),t.where=this.definitionExpression||"1=1",t.sqlFormat="standard",t}queryExtent(t,o){return this._getAssociatedLayerForQuery().then(a=>a.queryExtent(t||this.createQuery(),o))}queryFeatureCount(t,o){return this._getAssociatedLayerForQuery().then(a=>a.queryFeatureCount(t||this.createQuery(),o))}queryFeatures(t,o){return this._getAssociatedLayerForQuery().then(a=>a.queryFeatures(t||this.createQuery(),o)).then(a=>{if(null!=a&&a.features)for(const m of a.features)m.layer=this.layer,m.sourceLayer=this;return a})}queryObjectIds(t,o){return this._getAssociatedLayerForQuery().then(a=>a.queryObjectIds(t||this.createQuery(),o))}queryCachedAttributes(t,o){var a=this;return(0,M.A)(function*(){const m=(0,Je.hL)(a.fieldsIndex,yield(0,xe.TO)(a,(0,xe.D8)(a)));return(0,qe.s1)(a.parsedUrl.path,a.attributeStorageInfo,t,o,m,a.apiKey,a.customParameters)})()}queryCachedFeature(t,o){var a=this;return(0,M.A)(function*(){const m=yield a.queryCachedAttributes(t,[o]);if(!m||0===m.length)throw new I.A("scenelayer:feature-not-in-cached-data","Feature not found in cached data");const T=new P.A;return T.attributes=m[0],T.layer=a,T.sourceLayer=a,T})()}getFieldUsageInfo(t){return this.fieldsIndex.has(t)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:null!=this.associatedLayer}}_getAssociatedLayerForQuery(){const t=this.associatedLayer;return null!=t&&t.loaded?Promise.resolve(t):this._loadAssociatedLayerForQuery()}_loadAssociatedLayerForQuery(){var t=this;return(0,M.A)(function*(){if(yield t.load(),null==t.associatedLayer)throw new I.A("buildingscenelayer:query-not-available","BuildingSceneLayer component layer queries are not available without an associated feature layer",{layer:t});try{yield t.associatedLayer.load()}catch(o){throw new I.A("buildingscenelayer:query-not-available","BuildingSceneLayer associated feature layer could not be loaded",{layer:t,error:o})}return t.associatedLayer})()}};(0,s._)([(0,l.MZ)({readOnly:!0})],f.prototype,"parsedUrl",null),(0,s._)([(0,l.MZ)({type:ne.W4,readOnly:!0})],f.prototype,"nodePages",void 0),(0,s._)([(0,l.MZ)({type:[ne.uV],readOnly:!0})],f.prototype,"materialDefinitions",void 0),(0,s._)([(0,l.MZ)({type:[ne.Ot],readOnly:!0})],f.prototype,"textureSetDefinitions",void 0),(0,s._)([(0,l.MZ)({type:[ne.L0],readOnly:!0})],f.prototype,"geometryDefinitions",void 0),(0,s._)([(0,l.MZ)({readOnly:!0})],f.prototype,"serviceUpdateTimeStamp",void 0),(0,s._)([(0,l.MZ)({readOnly:!0})],f.prototype,"store",void 0),(0,s._)([(0,l.MZ)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],f.prototype,"rootNode",void 0),(0,s._)([(0,l.MZ)({readOnly:!0})],f.prototype,"attributeStorageInfo",void 0),(0,s._)([(0,l.MZ)(Le.fields)],f.prototype,"fields",void 0),(0,s._)([(0,l.MZ)({readOnly:!0})],f.prototype,"fieldsIndex",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:Be.default})],f.prototype,"associatedLayer",void 0),(0,s._)([(0,D.w)("service","associatedLayer",["associatedLayerID"])],f.prototype,"readAssociatedLayer",null),(0,s._)([(0,l.MZ)(Le.outFields)],f.prototype,"outFields",void 0),(0,s._)([(0,l.MZ)({type:String,readOnly:!0})],f.prototype,"objectIdField",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:String,json:{read:!1}})],f.prototype,"displayField",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:String})],f.prototype,"apiKey",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:String})],f.prototype,"customParameters",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:Y.A})],f.prototype,"fullExtent",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:_.A})],f.prototype,"spatialReference",null),(0,s._)([(0,l.MZ)({readOnly:!0})],f.prototype,"version",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:Xe.A})],f.prototype,"elevationInfo",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:Number})],f.prototype,"minScale",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:Number})],f.prototype,"maxScale",null),(0,s._)([(0,l.MZ)({readOnly:!0,type:Number})],f.prototype,"effectiveScaleRange",null),(0,s._)([(0,l.MZ)({type:["hide","show"],json:{write:!0}})],f.prototype,"listMode",void 0),(0,s._)([(0,l.MZ)({types:y.X,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],f.prototype,"renderer",void 0),(0,s._)([(0,l.MZ)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],f.prototype,"definitionExpression",void 0),(0,s._)([(0,l.MZ)(X.M6)],f.prototype,"popupEnabled",void 0),(0,s._)([(0,l.MZ)({type:G.A,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],f.prototype,"popupTemplate",void 0),(0,s._)([(0,l.MZ)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],f.prototype,"normalReferenceFrame",void 0),(0,s._)([(0,l.MZ)({readOnly:!0,json:{read:!1}})],f.prototype,"defaultPopupTemplate",null),(0,s._)([(0,l.MZ)()],f.prototype,"types",null),(0,s._)([(0,l.MZ)()],f.prototype,"typeIdField",null),(0,s._)([(0,l.MZ)({json:{write:!1}}),(0,q.e)(new g.J({"3DObject":"3d-object",Point:"point"}))],f.prototype,"layerType",void 0),(0,s._)([(0,l.MZ)()],f.prototype,"geometryType",null),(0,s._)([(0,l.MZ)()],f.prototype,"profile",null),(0,s._)([(0,l.MZ)({readOnly:!0,json:{read:!1}})],f.prototype,"capabilities",null),f=(0,s._)([(0,O.$)("esri.layers.buildingSublayers.BuildingComponentSublayer")],f);const he=f;var ve,ke=i(96996);const be={type:u.A,readOnly:!0,json:{origins:{service:{read:{source:"sublayers",reader:Ze}}},read:!1}};function Ze(t,o,a){if(t&&Array.isArray(t))return new u.A(t.map(m=>{const T=function et(t){return"group"===t.layerType?z:he}(m);if(T){const N=new T;return N.read(m,a),N}return null!=a&&a.messages&&m&&a.messages.push(new ke.A("building-scene-layer:unsupported-sublayer-type","Building scene sublayer of type '"+(m.type||"unknown")+"' are not supported",{definition:m,context:a})),null}))}let z=ve=class extends Ie{constructor(t){super(t),this.type="building-group",this.listMode="show",this.sublayers=null}loadAll(){return(0,x.L)(this,t=>ve.forEachSublayer(this.sublayers,o=>{"building-group"!==o.type&&t(o)}))}};var t;(0,s._)([(0,l.MZ)({type:["hide","show","hide-children"],json:{write:!0}})],z.prototype,"listMode",void 0),(0,s._)([(0,l.MZ)(be)],z.prototype,"sublayers",void 0),z=ve=(0,s._)([(0,O.$)("esri.layers.buildingSublayers.BuildingGroupSublayer")],z),(t=z||(z={})).sublayersProperty=be,t.readSublayers=Ze,t.forEachSublayer=function o(a,m){a.forEach(T=>{m(T),"building-group"===T.type&&o(T.sublayers,m)})};const k=z;var tt=i(94376),rt=i(25936),st=i(23e3),ot=i(17049),it=i(85551),nt=i(33036),ge=i(46406),lt=i(86537),$=i(71065),at=i(43085);let le=class extends $.oY{constructor(){super(...arguments),this.type=null}};(0,s._)([(0,l.MZ)({type:String,readOnly:!0,json:{write:!0}})],le.prototype,"type",void 0),le=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilterAuthoringInfo")],le);const je=le;var me;let te=me=class extends $.oY{constructor(){super(...arguments),this.filterType=null,this.filterValues=null}clone(){return new me({filterType:this.filterType,filterValues:(0,L.o8)(this.filterValues)})}};var fe;(0,s._)([(0,l.MZ)({type:String,json:{write:!0}})],te.prototype,"filterType",void 0),(0,s._)([(0,l.MZ)({type:[String],json:{write:!0}})],te.prototype,"filterValues",void 0),te=me=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilterAuthoringInfoType")],te);const ut=u.A.ofType(te);let ae=fe=class extends $.oY{clone(){return new fe({filterTypes:(0,L.o8)(this.filterTypes)})}};var Me;(0,s._)([(0,l.MZ)({type:ut,json:{write:!0}})],ae.prototype,"filterTypes",void 0),ae=fe=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilterAuthoringInfoBlock")],ae);const yt=u.A.ofType(ae);let re=Me=class extends je{constructor(){super(...arguments),this.type="checkbox"}clone(){return new Me({filterBlocks:(0,L.o8)(this.filterBlocks)})}};(0,s._)([(0,l.MZ)({type:["checkbox"]})],re.prototype,"type",void 0),(0,s._)([(0,l.MZ)({type:yt,json:{write:!0}})],re.prototype,"filterBlocks",void 0),re=Me=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],re);const Ce=re;let pe=class extends $.oY{};(0,s._)([(0,l.MZ)({readOnly:!0,json:{read:!1}})],pe.prototype,"type",void 0),pe=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilterMode")],pe);const ue=pe;var Se;let de=Se=class extends ue{constructor(){super(...arguments),this.type="solid"}clone(){return new Se}};(0,s._)([(0,l.MZ)({type:["solid"],readOnly:!0,json:{write:!0}})],de.prototype,"type",void 0),de=Se=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilterModeSolid")],de);const Ae=de;var Oe,ct=i(98767);let se=Oe=class extends ue{constructor(){super(...arguments),this.type="wire-frame",this.edges=null}clone(){return new Oe({edges:(0,L.o8)(this.edges)})}};(0,s._)([(0,q.e)({wireFrame:"wire-frame"})],se.prototype,"type",void 0),(0,s._)([(0,l.MZ)(ct.J)],se.prototype,"edges",void 0),se=Oe=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilterModeWireFrame")],se);const De=se;var Ee;let ye=Ee=class extends ue{constructor(){super(...arguments),this.type="x-ray"}clone(){return new Ee}};(0,s._)([(0,l.MZ)({type:["x-ray"],readOnly:!0,json:{write:!0}})],ye.prototype,"type",void 0),ye=Ee=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilterModeXRay")],ye);const _e=ye;var Fe;const ht={nonNullable:!0,types:{key:"type",base:ue,typeMap:{solid:Ae,"wire-frame":De,"x-ray":_e}},json:{read:t=>{switch(null==t?void 0:t.type){case"solid":return Ae.fromJSON(t);case"wireFrame":return De.fromJSON(t);case"x-ray":return _e.fromJSON(t);default:return}},write:{enabled:!0,isRequired:!0}}};let ee=Fe=class extends $.oY{constructor(){super(...arguments),this.filterExpression=null,this.filterMode=new Ae,this.title=""}clone(){return new Fe({filterExpression:this.filterExpression,filterMode:(0,L.o8)(this.filterMode),title:this.title})}};var Te;(0,s._)([(0,l.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],ee.prototype,"filterExpression",void 0),(0,s._)([(0,l.MZ)(ht)],ee.prototype,"filterMode",void 0),(0,s._)([(0,l.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],ee.prototype,"title",void 0),ee=Fe=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilterBlock")],ee);const gt=u.A.ofType(ee);let J=Te=class extends $.oY{constructor(){super(...arguments),this.description=null,this.filterBlocks=null,this.id=(0,at.lk)(),this.name=null}clone(){return new Te({description:this.description,filterBlocks:(0,L.o8)(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:(0,L.o8)(this.filterAuthoringInfo)})}};(0,s._)([(0,l.MZ)({type:String,json:{write:!0}})],J.prototype,"description",void 0),(0,s._)([(0,l.MZ)({type:gt,json:{write:{enabled:!0,isRequired:!0}}})],J.prototype,"filterBlocks",void 0),(0,s._)([(0,l.MZ)({types:{key:"type",base:je,typeMap:{checkbox:Ce}},json:{read:t=>"checkbox"===(null==t?void 0:t.type)?Ce.fromJSON(t):null,write:!0}})],J.prototype,"filterAuthoringInfo",void 0),(0,s._)([(0,l.MZ)({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],J.prototype,"id",void 0),(0,s._)([(0,l.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],J.prototype,"name",void 0),J=Te=(0,s._)([(0,O.$)("esri.layers.support.BuildingFilter")],J);const mt=J;let K=class extends $.oY{constructor(){super(...arguments),this.fieldName=null,this.modelName=null,this.label=null,this.min=null,this.max=null,this.mostFrequentValues=null,this.subLayerIds=null}};(0,s._)([(0,l.MZ)({type:String})],K.prototype,"fieldName",void 0),(0,s._)([(0,l.MZ)({type:String})],K.prototype,"modelName",void 0),(0,s._)([(0,l.MZ)({type:String})],K.prototype,"label",void 0),(0,s._)([(0,l.MZ)({type:Number})],K.prototype,"min",void 0),(0,s._)([(0,l.MZ)({type:Number})],K.prototype,"max",void 0),(0,s._)([(0,l.MZ)({json:{read:t=>Array.isArray(t)&&(t.every(o=>"string"==typeof o)||t.every(o=>"number"==typeof o))?t.slice():null}})],K.prototype,"mostFrequentValues",void 0),(0,s._)([(0,l.MZ)({type:[Number]})],K.prototype,"subLayerIds",void 0),K=(0,s._)([(0,O.$)("esri.layers.support.BuildingFieldStatistics")],K);let oe=class extends(R.A.LoadableMixin((0,b.g)($.oY))){constructor(){super(...arguments),this.url=null}get fields(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):(C.A.getLogger(this).error("building summary statistics are not loaded"),null)}load(t){return this.addResolvingPromise(this._fetchService(null!=t?t.signal:null)),Promise.resolve(this)}_fetchService(t){var o=this;return(0,M.A)(function*(){const a=(yield(0,S.A)(o.url,{query:{f:"json"},responseType:"json",signal:t})).data;o.read(a,{origin:"service"})})()}};(0,s._)([(0,l.MZ)({constructOnly:!0,type:String})],oe.prototype,"url",void 0),(0,s._)([(0,l.MZ)({readOnly:!0,type:[K],json:{read:{source:"summary"}}})],oe.prototype,"fields",null),oe=(0,s._)([(0,O.$)("esri.layers.support.BuildingSummaryStatistics")],oe);const Ue=oe;var Re,ce=i(73812);const we=u.A.ofType(mt),Qe=(0,L.o8)(k.sublayersProperty),Pe=null===(Re=Qe.json)||void 0===Re?void 0:Re.origins;Pe&&(Pe["web-scene"]={type:[he],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}},Pe["portal-item"]={type:[he],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}});let B=class extends((0,ge.w6)((0,rt.b)((0,ot.q)((0,it.A)((0,nt.j)((0,H.P)((0,st.d)((0,tt.p)(U.A))))))))){constructor(t){super(t),this.operationalLayerType="BuildingSceneLayer",this.allSublayers=new Z.A({getCollections:()=>[this.sublayers],getChildrenFunction:o=>"building-group"===o.type?o.sublayers:null}),this.sublayers=null,this._sublayerOverrides=null,this.filters=new we,this.activeFilterId=null,this.summaryStatistics=null,this.outFields=null,this.legendEnabled=!0,this.type="building-scene"}normalizeCtorArgs(t){return"string"==typeof t?{url:t}:null!=t?t:{}}destroy(){this.allSublayers.destroy()}readSublayers(t,o,a){const m=k.readSublayers(t,o,a);return k.forEachSublayer(m,T=>T.layer=this),this._sublayerOverrides&&(this.applySublayerOverrides(m,this._sublayerOverrides),this._sublayerOverrides=null),m}applySublayerOverrides(t,{overrides:o,context:a}){k.forEachSublayer(t,m=>m.read(o.get(m.id),a))}readSublayerOverrides(t,o){const a=new Map;for(const T of t){var m;null!=T&&"object"==typeof T&&"number"==typeof T.id?a.set(T.id,T):null===(m=o.messages)||void 0===m||m.push(new I.A("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:T}))}return{overrides:a,context:o}}writeSublayerOverrides(t,o,a){const m=[];k.forEachSublayer(this.sublayers,T=>{const N=T.write({},a);Object.keys(N).length>1&&m.push(N)}),m.length>0&&(o.sublayers=m)}writeUnappliedOverrides(t,o){o.sublayers=[],t.overrides.forEach(a=>{o.sublayers.push((0,L.o8)(a))})}write(t,o){return t=super.write(t,o),!o||"web-scene"!==o.origin&&"portal-item"!==o.origin||(this.sublayers?this.writeSublayerOverrides(this.sublayers,t,o):this._sublayerOverrides&&this.writeUnappliedOverrides(this._sublayerOverrides,t)),t}read(t,o){if(super.read(t,o),o&&("web-scene"===o.origin||"portal-item"===o.origin)&&null!=t&&Array.isArray(t.sublayers)){const a=this.readSublayerOverrides(t.sublayers,o);this.sublayers?this.applySublayerOverrides(this.sublayers,a):this._sublayerOverrides=a}}readSummaryStatistics(t,o){if("string"==typeof o.statisticsHRef){var a;const m=(0,V.fj)(null===(a=this.parsedUrl)||void 0===a?void 0:a.path,o.statisticsHRef);return new Ue({url:m})}return null}set elevationInfo(t){this._set("elevationInfo",t),this._validateElevationInfo()}load(t){const o=null!=t?t.signal:null,a=this.loadFromPortal({supportedTypes:["Scene Service"]},t).catch(W.QP).then(()=>this._fetchService(o)).then(()=>this._fetchAssociatedFeatureService(o));return this.addResolvingPromise(a),Promise.resolve(this)}loadAll(){return(0,x.g)(this,t=>{k.forEachSublayer(this.sublayers,o=>{"building-group"!==o.type&&t(o)}),this.summaryStatistics&&t(this.summaryStatistics)})}saveAs(t,o){var a=this;return(0,M.A)(function*(){return a._debouncedSaveOperations(ge.Xh.SAVE_AS,{...o,getTypeKeywords:()=>a._getTypeKeywords(),portalItemLayerType:"building-scene"},t)})()}save(){var t=this;return(0,M.A)(function*(){const o={getTypeKeywords:()=>t._getTypeKeywords(),portalItemLayerType:"building-scene"};return t._debouncedSaveOperations(ge.Xh.SAVE,o)})()}validateLayer(t){if(!t.layerType||"Building"!==t.layerType)throw new I.A("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:t.layerType})}_getTypeKeywords(){return["Building"]}_fetchAssociatedFeatureService(t){var o=this;return(0,M.A)(function*(){try{const{portalItem:a}=yield(0,lt.L)(`${o.url}/layers/${o.layerId}`,{sceneLayerItem:o.portalItem,customParameters:o.customParameters,apiKey:o.apiKey,signal:t});o.associatedFeatureServiceItem=a}catch(a){C.A.getLogger(o).warn("Associated feature service item could not be loaded",a)}})()}_validateElevationInfo(){const t=this.elevationInfo,o="Building scene layers";(0,ce.XF)(C.A.getLogger(this),(0,ce.B)(o,"absolute-height",t)),(0,ce.XF)(C.A.getLogger(this),(0,ce.tW)(o,t))}};(0,s._)([(0,l.MZ)({type:["BuildingSceneLayer"]})],B.prototype,"operationalLayerType",void 0),(0,s._)([(0,l.MZ)({readOnly:!0})],B.prototype,"allSublayers",void 0),(0,s._)([(0,l.MZ)(Qe)],B.prototype,"sublayers",void 0),(0,s._)([(0,D.w)("service","sublayers")],B.prototype,"readSublayers",null),(0,s._)([(0,l.MZ)({type:we,nonNullable:!0,json:{write:!0}})],B.prototype,"filters",void 0),(0,s._)([(0,l.MZ)({type:String,json:{write:!0}})],B.prototype,"activeFilterId",void 0),(0,s._)([(0,l.MZ)({readOnly:!0,type:Ue})],B.prototype,"summaryStatistics",void 0),(0,s._)([(0,D.w)("summaryStatistics",["statisticsHRef"])],B.prototype,"readSummaryStatistics",null),(0,s._)([(0,l.MZ)({type:[String],json:{read:!1}})],B.prototype,"outFields",void 0),(0,s._)([(0,l.MZ)(X.Fm)],B.prototype,"fullExtent",void 0),(0,s._)([(0,l.MZ)(X.fV)],B.prototype,"legendEnabled",void 0),(0,s._)([(0,l.MZ)({type:["show","hide","hide-children"]})],B.prototype,"listMode",void 0),(0,s._)([(0,l.MZ)((0,X.Qo)(_.A))],B.prototype,"spatialReference",void 0),(0,s._)([(0,l.MZ)(X.Yj)],B.prototype,"elevationInfo",null),(0,s._)([(0,l.MZ)({json:{read:!1},readOnly:!0})],B.prototype,"type",void 0),(0,s._)([(0,l.MZ)()],B.prototype,"associatedFeatureServiceItem",void 0),B=(0,s._)([(0,O.$)("esri.layers.BuildingSceneLayer")],B);const ft=B},47063:(ie,Q,i)=>{i.d(Q,{A:()=>D});var M=i(8189),s=i(90660),u=i(71065),Z=i(85211),C=(i(3248),i(35150),i(40707),i(17221)),H=i(76576),W=i(50305),V=i(84546),l=i(69741);let j=class extends((0,s.O)(u.oY)){constructor(O){super(O),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(O){const _={};for(const U of Object.keys(O))_[U]=(0,V.rS)(O[U]);return _}writeDomains(O,_){const U={};for(const G of Object.keys(O)){var P;O[G]&&(U[G]=null===(P=O[G])||void 0===P?void 0:P.toJSON())}_.domains=U}};(0,M._)([(0,Z.MZ)({json:{write:!0}})],j.prototype,"id",void 0),(0,M._)([(0,Z.MZ)({json:{write:!0}})],j.prototype,"name",void 0),(0,M._)([(0,Z.MZ)({json:{write:!0}})],j.prototype,"domains",void 0),(0,M._)([(0,C.w)("domains")],j.prototype,"readDomains",null),(0,M._)([(0,W.K)("domains")],j.prototype,"writeDomains",null),(0,M._)([(0,Z.MZ)({type:[l.A],json:{write:!0}})],j.prototype,"templates",void 0),j=(0,M._)([(0,H.$)("esri.layers.support.FeatureType")],j);const D=j},90543:(ie,Q,i)=>{i.d(Q,{S:()=>H});var M=i(3248),s=i(68438);function u(r,p,d){return!!I(r,p,d)}function Z(r,p,d){return I(r,p,d)}function I(r,p,d){return r&&r.hasOwnProperty(p)?r[p]:d}const L={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function x(r){var p;const d=null==r||null===(p=r.supportedSpatialAggregationStatistics)||void 0===p?void 0:p.map(n=>n.toLowerCase());return{envelope:!(null==d||!d.includes("envelopeaggregate")),centroid:!(null==d||!d.includes("centroidaggregate")),convexHull:!(null==d||!d.includes("convexhullaggregate"))}}function C(r,p){var d;const n=null==r||null===(d=r.supportedOperationsWithCacheHint)||void 0===d?void 0:d.map(h=>h.toLowerCase());return!(null==n||!n.includes(p.toLowerCase()))}function H(r,p){return{analytics:W(r),attachment:V(r),data:l(r),metadata:j(r),operations:D(r.capabilities,r,p),query:O(r,p),queryRelated:_(r),queryTopFeatures:U(r),editing:P(r)}}function W(r){return{supportsCacheHint:C(r.advancedQueryCapabilities,"queryAnalytics")}}function V(r){const p=r.attachmentProperties,d={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:C(r.advancedQueryCapabilities,"queryAttachments"),supportsResize:u(r,"supportsAttachmentsResizing",!1)};return p&&Array.isArray(p)&&p.forEach(n=>{const h=L[n.name];h&&(d[h]=!!n.isEnabled)}),d}function l(r){return{isVersioned:u(r,"isDataVersioned",!1),supportsAttachment:u(r,"hasAttachments",!1),supportsM:u(r,"hasM",!1),supportsZ:u(r,"hasZ",!1)}}function j(r){return{supportsAdvancedFieldProperties:u(r,"supportsFieldDescriptionProperty",!1)}}function D(r,p,d){const n=r?r.toLowerCase().split(",").map(R=>R.trim()):[],h=d?(0,s.qg)(d):null,c=n.includes(null!=h&&"MapServer"===h.serverType?"data":"query"),v=n.includes("editing")&&!p.datesInUnknownTimezone;let E=v&&n.includes("create"),F=v&&n.includes("delete"),y=v&&n.includes("update");const S=n.includes("changetracking"),g=p.advancedQueryCapabilities;return v&&!(E||F||y)&&(E=F=y=!0),{supportsCalculate:u(p,"supportsCalculate",!1),supportsTruncate:u(p,"supportsTruncate",!1),supportsValidateSql:u(p,"supportsValidateSql",!1),supportsAdd:E,supportsDelete:F,supportsEditing:v,supportsChangeTracking:S,supportsQuery:c,supportsQueryAnalytics:u(g,"supportsQueryAnalytic",!1),supportsQueryAttachments:u(g,"supportsQueryAttachments",!1),supportsQueryTopFeatures:u(g,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:u(p,"supportsAttachmentsResizing",!1),supportsSync:n.includes("sync"),supportsUpdate:y,supportsExceedsLimitStatistics:u(p,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:u(p,"supportsAsyncConvert3D",!1)}}function O(r,p){var d;const n=r.advancedQueryCapabilities,h=r.ownershipBasedAccessControlForFeatures,c=r.archivingInfo,v=r.currentVersion,F=!(null==p?void 0:p.includes("MapServer"))||v>=(0,M.A)("mapserver-pbf-version-support"),y=(0,s.Wo)(p),S=new Set((null!==(d=r.supportedQueryFormats)&&void 0!==d?d:"").split(",").map(g=>g.toLowerCase().trim()));return{supportsStatistics:u(n,"supportsStatistics",r.supportsStatistics),supportsPercentileStatistics:u(n,"supportsPercentileStatistics",!1),supportsSpatialAggregationStatistics:u(n,"supportsSpatialAggregationStatistics",!1),supportedSpatialAggregationStatistics:x(n),supportsCentroid:u(n,"supportsReturningGeometryCentroid",!1),supportsDistance:u(n,"supportsQueryWithDistance",!1),supportsDistinct:u(n,"supportsDistinct",r.supportsAdvancedQueries),supportsExtent:u(n,"supportsReturningQueryExtent",!1),supportsGeometryProperties:u(n,"supportsReturningGeometryProperties",!1),supportsHavingClause:u(n,"supportsHavingClause",!1),supportsOrderBy:u(n,"supportsOrderBy",r.supportsAdvancedQueries),supportsPagination:u(n,"supportsPagination",!1),supportsQuantization:u(r,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:u(r,"supportsQuantizationEditMode",!1),supportsQueryGeometry:u(r,"supportsReturningQueryGeometry",!1),supportsResultType:u(n,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:u(n,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:u(n,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:u(r,"useStandardizedQueries",!1),supportsTopFeaturesQuery:u(n,"supportsTopFeaturesQuery",!1),supportsQueryByAnonymous:u(h,"allowAnonymousToQuery",!0),supportsQueryByOthers:u(h,"allowOthersToQuery",!0),supportsHistoricMoment:u(c,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:F&&S.has("pbf"),supportsDisjointSpatialRelationship:u(n,"supportsDisjointSpatialRel",!1),supportsCacheHint:u(n,"supportsQueryWithCacheHint",!1)||C(n,"query"),supportsDefaultSpatialReference:u(n,"supportsDefaultSR",!1),supportsCompactGeometry:y,supportsFullTextSearch:u(n,"supportsFullTextSearch",!1),maxRecordCountFactor:Z(r,"maxRecordCountFactor",void 0),maxRecordCount:Z(r,"maxRecordCount",void 0),standardMaxRecordCount:Z(r,"standardMaxRecordCount",void 0),tileMaxRecordCount:Z(r,"tileMaxRecordCount",void 0)}}function _(r){const p=r.advancedQueryCapabilities,d=u(p,"supportsAdvancedQueryRelated",!1);return{supportsPagination:u(p,"supportsQueryRelatedPagination",!1),supportsCount:d,supportsOrderBy:d,supportsCacheHint:C(p,"queryRelated")}}function U(r){return{supportsCacheHint:C(r.advancedQueryCapabilities,"queryTopFilter")}}function P(r){const p=r.ownershipBasedAccessControlForFeatures,d=r?r.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:u(r,"allowGeometryUpdates",!0),supportsGlobalId:u(r,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:u(r,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:u(r,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:u(r,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:u(r,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:u(p,"allowAnonymousToDelete",!0),supportsDeleteByOthers:u(p,"allowOthersToDelete",!0),supportsUpdateByAnonymous:u(p,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:u(p,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:u(d,"supportsAsyncApplyEdits",!1),zDefault:Z(r,"zDefault",void 0)}}},98789:(ie,Q,i)=>{i.d(Q,{q:()=>s});var M=i(23743);function s(u,Z,I){if(null==I||!I.features||!I.hasZ)return;const L=(0,M.N)(I.geometryType,Z,u.outSpatialReference);if(null!=L)for(const x of I.features)L(x.geometry)}},93327:(ie,Q,i)=>{i.d(Q,{A:()=>G});var _,M=i(8189),s=i(21152),u=i(81098),Z=i(49976),I=i(71065),L=i(77806),x=i(85211),W=(i(3248),i(35150),i(17221)),V=i(76576),l=i(50305),j=i(32034),D=i(61320),O=i(29141);const U=new Z.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let P=_=class extends I.oY{constructor(r){super(r),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(r,p){const d=j.A.fromJSON(p.spatialReference),n=[];for(let c=0;c<r.length;c++){var h;const v=r[c],E=u.A.fromJSON(v),F=null===(h=v.geometry)||void 0===h?void 0:h.spatialReference;null==E.geometry||F||(E.geometry.spatialReference=d);const y=v.aggregateGeometries,S=E.aggregateGeometries;if(y&&null!=S)for(const g in S){const R=S[g],b=y[g];null==R||(null==b?void 0:b.spatialReference)||(R.spatialReference=d)}n.push(E)}return n}writeGeometryType(r,p,d,n){if(r)return void U.write(r,p,d,n);const{features:h}=this;if(h)for(const c of h)if(null!=(null==c?void 0:c.geometry))return void U.write(c.geometry.type,p,d,n)}readQueryGeometry(r,p){if(!r)return null;const d=!!r.spatialReference,n=(0,D.rS)(r);return n&&!d&&p.spatialReference&&(n.spatialReference=j.A.fromJSON(p.spatialReference)),n}writeSpatialReference(r,p){if(r)return void(p.spatialReference=r.toJSON());const{features:d}=this;if(d)for(const n of d)if(n&&null!=n.geometry&&n.geometry.spatialReference)return void(p.spatialReference=n.geometry.spatialReference.toJSON())}clone(){return new _(this.cloneProperties())}cloneProperties(){return(0,L.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(r){const p=this.write();if(p.features&&Array.isArray(r)&&r.length>0)for(let d=0;d<p.features.length;d++){const n=p.features[d];if(n.geometry){const h=null==r?void 0:r[d];n.geometry=(null==h?void 0:h.toJSON())||n.geometry}}return p}quantize(r){const{scale:[p,d],translate:[n,h]}=r,E=this.features,F=this._getQuantizationFunction(this.geometryType,y=>Math.round((y-n)/p),y=>Math.round((h-y)/d));for(let y=0,S=E.length;y<S;y++)null!=F&&F(E[y].geometry)||(E.splice(y,1),y--,S--);return this.transform=r,this}unquantize(){var r,p;const{geometryType:d,features:n,transform:h}=this;if(!h)return this;const{translate:[c,v],scale:[E,F]}=h;let g=null,R=null;if(this.hasZ&&null!=(null==h||null===(r=h.scale)||void 0===r?void 0:r[2])){const{translate:[,,A],scale:[,,q]}=h;g=Y=>Y*q+A}if(this.hasM&&null!=(null==h||null===(p=h.scale)||void 0===p?void 0:p[3])){const{translate:[,,,A],scale:[,,,q]}=h;R=Y=>null==Y?Y:Y*q+A}const b=this._getHydrationFunction(d,A=>A*E+c,A=>v-A*F,g,R);for(const{geometry:A}of n)null!=A&&b&&b(A);return this.transform=null,this}_quantizePoints(r,p,d){let n,h;const c=[];for(let v=0,E=r.length;v<E;v++){const F=r[v];if(v>0){const y=p(F[0]),S=d(F[1]);y===n&&S===h||(c.push([y-n,S-h]),n=y,h=S)}else n=p(F[0]),h=d(F[1]),c.push([n,h])}return c.length>0?c:null}_getQuantizationFunction(r,p,d){return"point"===r?n=>(n.x=p(n.x),n.y=d(n.y),n):"polyline"===r||"polygon"===r?n=>{const h=(0,D.Bi)(n)?n.rings:n.paths,c=[];for(let v=0,E=h.length;v<E;v++){const y=this._quantizePoints(h[v],p,d);y&&c.push(y)}return c.length>0?((0,D.Bi)(n)?n.rings=c:n.paths=c,n):null}:"multipoint"===r?n=>{const h=this._quantizePoints(n.points,p,d);return h&&h.length>0?(n.points=h,n):null}:"extent"===r?n=>n:null}_getHydrationFunction(r,p,d,n,h){return"point"===r?c=>{c.x=p(c.x),c.y=d(c.y),n&&(c.z=n(c.z))}:"polyline"===r||"polygon"===r?c=>{const v=(0,D.Bi)(c)?c.rings:c.paths;let E,F;for(let y=0,S=v.length;y<S;y++){const g=v[y];for(let R=0,b=g.length;R<b;R++){const A=g[R];R>0?(E+=A[0],F+=A[1]):(E=A[0],F=A[1]),A[0]=p(E),A[1]=d(F)}}if(n&&h)for(let y=0,S=v.length;y<S;y++){const g=v[y];for(let R=0,b=g.length;R<b;R++){const A=g[R];A[2]=n(A[2]),A[3]=h(A[3])}}else if(n)for(let y=0,S=v.length;y<S;y++){const g=v[y];for(let R=0,b=g.length;R<b;R++){const A=g[R];A[2]=n(A[2])}}else if(h)for(let y=0,S=v.length;y<S;y++){const g=v[y];for(let R=0,b=g.length;R<b;R++){const A=g[R];A[2]=h(A[2])}}}:"extent"===r?c=>{c.xmin=p(c.xmin),c.ymin=d(c.ymin),c.xmax=p(c.xmax),c.ymax=d(c.ymax),n&&null!=c.zmax&&null!=c.zmin&&(c.zmax=n(c.zmax),c.zmin=n(c.zmin)),h&&null!=c.mmax&&null!=c.mmin&&(c.mmax=h(c.mmax),c.mmin=h(c.mmin))}:"multipoint"===r?c=>{const v=c.points;let E,F;for(let y=0,S=v.length;y<S;y++){const g=v[y];y>0?(E+=g[0],F+=g[1]):(E=g[0],F=g[1]),g[0]=p(E),g[1]=d(F)}if(n&&h)for(let y=0,S=v.length;y<S;y++){const g=v[y];g[2]=n(g[2]),g[3]=h(g[3])}else if(n)for(let y=0,S=v.length;y<S;y++){const g=v[y];g[2]=n(g[2])}else if(h)for(let y=0,S=v.length;y<S;y++){const g=v[y];g[2]=h(g[2])}}:null}};(0,M._)([(0,x.MZ)({type:String,json:{write:!0}})],P.prototype,"displayFieldName",void 0),(0,M._)([(0,x.MZ)({type:Boolean,json:{write:{overridePolicy:r=>({enabled:r})}}})],P.prototype,"exceededTransferLimit",void 0),(0,M._)([(0,x.MZ)({type:[u.A],json:{write:!0}})],P.prototype,"features",void 0),(0,M._)([(0,W.w)("features")],P.prototype,"readFeatures",null),(0,M._)([(0,x.MZ)({type:[O.A],json:{write:!0}})],P.prototype,"fields",void 0),(0,M._)([(0,x.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:U.read}}})],P.prototype,"geometryType",void 0),(0,M._)([(0,l.K)("geometryType")],P.prototype,"writeGeometryType",null),(0,M._)([(0,x.MZ)({type:Boolean,json:{write:{overridePolicy:r=>({enabled:r})}}})],P.prototype,"hasM",void 0),(0,M._)([(0,x.MZ)({type:Boolean,json:{write:{overridePolicy:r=>({enabled:r})}}})],P.prototype,"hasZ",void 0),(0,M._)([(0,x.MZ)({types:s.yR,json:{write:!0}})],P.prototype,"queryGeometry",void 0),(0,M._)([(0,W.w)("queryGeometry")],P.prototype,"readQueryGeometry",null),(0,M._)([(0,x.MZ)({type:j.A,json:{write:!0}})],P.prototype,"spatialReference",void 0),(0,M._)([(0,l.K)("spatialReference")],P.prototype,"writeSpatialReference",null),(0,M._)([(0,x.MZ)({json:{write:!0}})],P.prototype,"transform",void 0),P=_=(0,M._)([(0,V.$)("esri.rest.support.FeatureSet")],P),P.prototype.toJSON.isDefaultToJSON=!0;const G=P}}]);