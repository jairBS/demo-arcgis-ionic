"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5042,4098,3258,9487,8846],{33087:(ae,$,d)=>{d.d($,{q:()=>a});var m=d(60611);class a{constructor(y,o){this._storage=new m.F,this.id="",this.name="",this.size=0,this._storage.maxSize=y,this._storage.register(this),o&&this._storage.registerRemoveFunc("",o)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(y,o,x=1){this._storage.put(this,y,o,x,1)}pop(y){return this._storage.pop(this,y)}get(y){return this._storage.get(this,y)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(y){this._storage.maxSize=y}resetHitRate(){}}},60611:(ae,$,d)=>{d.d($,{F:()=>x,Mn:()=>o});var y,b,m=d(12438);(b=y||(y={}))[b.ALL=0]="ALL",b[b.SOME=1]="SOME";class o{constructor(v,_,h){this.name=v,this._storage=_,this.id=A+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),h&&(this._storage.registerRemoveFunc(this.id,h),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(v){return this._storage.getSize(this,v)}resetHitRate(){this._hit=this._miss=0}put(v,_,h,I=0){this._storage.put(this,v,_,h,I)}pop(v){const _=this._storage.pop(this,v);return void 0===_?++this._miss:++this._hit,_}get(v){const _=this._storage.get(this,v);return void 0===_?++this._miss:++this._hit,_}peek(v){return this._storage.peek(this,v)}updateSize(v,_,h){this._storage.updateSize(this,v,_,h)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class x{get size(){return this._size}constructor(v=10485760){this._maxSize=v,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new m.A,this._users=new m.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(v){this._users.push(v)}deregister(v){this._users.removeUnordered(v)}registerRemoveFunc(v,_){this._removeFuncs.push([v,_])}deregisterRemoveFunc(v){this._removeFuncs.filterInPlace(_=>_[0]!==v)}get maxSize(){return this._maxSize}set maxSize(v){this._maxSize=Math.max(v,-1),this._checkSize()}getSize(v,_){var h;const I=this._db.get(v.id+_);return null!==(h=null==I?void 0:I.size)&&void 0!==h?h:0}put(v,_,h,I,L){const F=this._db.get(_=v.id+_);if(F&&(this._size-=F.size,v.size-=F.size,this._db.delete(_),F.entry!==h&&this._notifyRemove(_,F.entry,F.size,y.ALL)),I>this._maxSize)return void this._notifyRemove(_,h,I,y.ALL);if(void 0===h)return void console.warn("Refusing to cache undefined entry ");if(!I||I<0)return console.warn(`Refusing to cache entry with size ${I} for key ${_}`),void this._notifyRemove(_,h,0,y.ALL);const Q=1+Math.max(L,-4)- -3;this._db.set(_,new l(h,I,Q)),this._size+=I,v.size+=I,this._checkSize()}updateSize(v,_,h,I){const L=this._db.get(_=v.id+_);if(L&&L.entry===h){for(this._size-=L.size,v.size-=L.size;I>this._maxSize;){const F=this._notifyRemove(_,h,I,y.SOME);if(!(null!=F&&F>0))return void this._db.delete(_);I=F}L.size=I,this._size+=I,v.size+=I,this._checkSize()}}pop(v,_){const h=this._db.get(_=v.id+_);if(h)return this._size-=h.size,v.size-=h.size,this._db.delete(_),++this._hit,h.entry;++this._miss}get(v,_){const h=this._db.get(_=v.id+_);if(void 0!==h)return this._db.delete(_),h.lives=h.lifetime,this._db.set(_,h),++this._hit,h.entry;++this._miss}peek(v,_){const h=this._db.get(v.id+_);return h?++this._hit:++this._miss,null==h?void 0:h.entry}get performanceInfo(){const v={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},_={},h=new Array;this._db.forEach((F,Q)=>{const ne=F.lifetime;h[ne]=(h[ne]||0)+F.size,this._users.forAll(C=>{const{id:P,name:Z}=C;Q.startsWith(P)&&(_[Z]=(_[Z]||0)+F.size)})});const I={};this._users.forAll(F=>{const Q=F.name;"hitRate"in F&&"number"==typeof F.hitRate&&!isNaN(F.hitRate)&&F.hitRate>0?(_[Q]=_[Q]||0,I[Q]=Math.round(100*F.hitRate)+"%"):I[Q]="0%"});const L=Object.keys(_);L.sort((F,Q)=>_[Q]-_[F]),L.forEach(F=>v[F]=Math.round(_[F]/2**20)+"MB / "+I[F]);for(let F=h.length-1;F>=0;--F){const Q=h[F];Q&&(v["Priority "+(F+-3-1)]=Math.round(Q/this._size*100)+"%")}return v}resetStats(){this._hit=this._miss=0,this._users.forAll(v=>v.resetHitRate())}clear(v){const _=v.id;this._db.forEach((h,I)=>{I.startsWith(_)&&(this._size-=h.size,this._db.delete(I),this._notifyRemove(I,h.entry,h.size,y.ALL))}),v.size=0}clearAll(){this._db.forEach((v,_)=>this._notifyRemove(_,v.entry,v.size,y.ALL)),this._users.forAll(v=>v.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(v,_,h,I){let L;return this._removeFuncs.some(F=>{if(v.startsWith(F[0])){const Q=F[1](_,I,h);return"number"==typeof Q&&(L=Q),!0}return!1}),L}_checkSize(){this._users.forAll(v=>this._checkSizeLimits(v)),this._checkSizeLimits()}_checkSizeLimits(v){const _=null!=v?v:this;if(_.maxSize<0||_.size<=_.maxSize)return;const h=null==v?void 0:v.id;let I=!0;for(;I;){I=!1;for(const[L,F]of this._db)if(0===F.lifetime&&(!h||L.startsWith(h))){if(this._purgeItem(L,F,v),_.size<=.9*_.maxSize)return;I||(I=this._db.has(L))}}for(const[L,F]of this._db)if((!h||L.startsWith(h))&&(this._purgeItem(L,F,v),_.size<=.9*_.maxSize))return}_purgeItem(v,_,h=this._users.find(I=>v.startsWith(I.id))){if(this._db.delete(v),_.lives<=1){this._size-=_.size,h&&(h.size-=_.size);const I=this._notifyRemove(v,_.entry,_.size,y.SOME);null!=I&&I>0&&(this._size+=I,h&&(h.size+=I),_.lives=_.lifetime,_.size=I,this._db.set(v,_))}else--_.lives,this._db.set(v,_)}}let A=0;class l{constructor(v,_,h){this.entry=v,this.size=_,this.lifetime=h,this.lives=h}}},24098:(ae,$,d)=>{d.d($,{GB:()=>a,Qo:()=>y,Y4:()=>D});var m=d(44549);class a{}function D(x){return x instanceof m.bo?x===a.instance:"unknown"===(null==x?void 0:x.toString().toLowerCase())}function y(x){return D(x)?a.instance:x}a.instance=new m.oh("Etc/UTC")},64123:(ae,$,d)=>{d.r($),d.d($,{default:()=>hn});var m=d(10467),a=d(8189),D=d(92165),y=d(90660),o=d(5922),x=d(39693),A=d(56492),l=d(85211),v=(d(3248),d(35150)),h=(d(40707),d(76576)),I=d(50305),L=d(95478),F=d(21152),Q=d(81098),ne=d(75257),C=d(89563),P=d(23159),Z=d(77806),k=d(48900),W=d(45272),N=d(55739),K=d(17221),z=d(58701),j=d(81687),X=d(52593),T=d(71065),M=d(49343),Y=d(96115);const Ae={StretchFunction:{arguments:{ComputeGamma:{isDataset:!1,isPublic:!1,name:"ComputeGamma",type:"RasterFunctionVariable",value:!1},DRA:{isDataset:!1,isPublic:!1,name:"DRA",type:"RasterFunctionVariable",value:!1},EstimateStatsHistogram:{isDataset:!1,isPublic:!1,name:"EstimateStatsHistogram",type:"RasterFunctionVariable",value:!1},Gamma:{displayName:"Gamma",isDataset:!1,isPublic:!1,name:"Gamma",type:"RasterFunctionVariable"},Histograms:{isDataset:!1,isPublic:!1,name:"Histograms",type:"RasterFunctionVariable"},Max:{isDataset:!1,isPublic:!1,name:"Max",type:"RasterFunctionVariable",value:255},MaxPercent:{isDataset:!1,isPublic:!1,name:"MaxPercent",type:"RasterFunctionVariable",value:.5},Min:{isDataset:!1,isPublic:!1,name:"Min",type:"RasterFunctionVariable",value:0},MinPercent:{isDataset:!1,isPublic:!1,name:"MinPercent",type:"RasterFunctionVariable",value:.25},NumberOfStandardDeviations:{isDataset:!1,isPublic:!1,name:"NumberOfStandardDeviation",type:"RasterFunctionVariable",value:2},Raster:{isDataset:!0,isPublic:!1,name:"Raster",type:"RasterFunctionVariable"},SigmoidStrengthLevel:{isDataset:!1,isPublic:!1,name:"SigmoidStrengthLevel",type:"RasterFunctionVariable",value:2},Statistics:{isDataset:!1,isPublic:!1,name:"Statistics",type:"RasterFunctionVariable"},StretchType:{isDataset:!1,isPublic:!1,name:"StretchType",type:"RasterFunctionVariable",value:0},type:"StretchFunctionArguments",UseGamma:{isDataset:!1,isPublic:!1,name:"UseGamma",type:"RasterFunctionVariable",value:!1}},description:"Enhances an image by adjusting the range of values displayed. This does not alter the underlying pixel values. If a pixel has a value outside of the specified range, it will appear as either the minimum or maximum value.",function:{description:"Enhances an image by adjusting the range of values displayed. This does not alter the underlying pixel values. If a pixel has a value outside of the specified range, it will appear as either the minimum or maximum value.",name:"Stretch",pixelType:"UNKNOWN",type:"StretchFunction"},functionType:0,name:"Stretch",thumbnail:""},RemapFunction:{name:"Remap",description:"Changes pixel values by assigning new values to ranges of pixel values or using an external table.",function:{type:"RemapFunction",pixelType:"UNKNOWN",name:"Remap",description:"Changes pixel values by assigning new values to ranges of pixel values or using an external table."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},UseTable:{name:"UseTable",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},InputRanges:{name:"InputRanges",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"Input Ranges"},OutputValues:{name:"OutputValues",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"Output Values"},NoDataRanges:{name:"NoDataRanges",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"NoData Ranges"},Table:{name:"Table",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},InputField:{name:"InputField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},OutputField:{name:"OutputField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},InputMaxField:{name:"InputMaxField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},RemapTableType:{name:"RemapTableType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},AllowUnmatched:{name:"AllowUnmatched",isPublic:!1,isDataset:!1,value:!0,type:"RasterFunctionVariable"},type:"RemapFunctionArguments"},functionType:0,thumbnail:""},ColormapFunction:{name:"Colormap",description:"Changes pixel values to display the raster data as either a grayscale or a red, green, blue (RGB) image, based on a colormap or a color ramp.",function:{type:"ColormapFunction",pixelType:"UNKNOWN",name:"Colormap",description:"Changes pixel values to display the raster data as either a grayscale or a red, green, blue (RGB) image, based on a colormap or a color ramp."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ColorSchemeType:{name:"ColorSchemeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},Colormap:{name:"Colormap",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},ColormapName:{name:"ColormapName",isPublic:!1,isDataset:!1,value:"Gray",type:"RasterFunctionVariable"},ColorRamp:{name:"ColorRamp",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},type:"ColormapFunctionArguments"},functionType:0,thumbnail:""},ShadedReliefFunction:{name:"Shaded Relief",description:"Creates a multiband, color coded, 3D representation of the surface, with the sun's relative position taken into account for shading the image.",function:{type:"ShadedReliefFunction",pixelType:"UNKNOWN",name:"Shaded Relief",description:"Creates a multiband, color coded, 3D representation of the surface, with the sun's relative position taken into account for shading the image."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ColorSchemeType:{name:"ColorSchemeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ColorRamp:{name:"ColorRamp",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},HillshadeType:{name:"HillshadeType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},Colormap:{name:"Colormap",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},Azimuth:{name:"Azimuth",isPublic:!1,isDataset:!1,value:315,type:"RasterFunctionVariable"},Altitude:{name:"Altitude",isPublic:!1,isDataset:!1,value:45,type:"RasterFunctionVariable"},SlopeType:{name:"SlopeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ZFactor:{name:"ZFactor",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},PSPower:{name:"PSPower",isPublic:!1,isDataset:!1,value:.664,type:"RasterFunctionVariable"},PSZFactor:{name:"PSZFactor",isPublic:!1,isDataset:!1,value:.024,type:"RasterFunctionVariable"},RemoveEdgeEffect:{name:"RemoveEdgeEffect",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},type:"ShadedReliefFunctionArguments"},functionType:0,thumbnail:""},HillshadeFunction:{name:"Hillshade",description:"Creates a 3D representation of the surface, with the sun's relative position taken into account for shading the image",function:{type:"HillshadeFunction",pixelType:"UNKNOWN",name:"Hillshade",description:"Creates a 3D representation of the surface, with the sun's relative position taken into account for shading the image"},arguments:{DEM:{name:"DEM",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},HillshadeType:{name:"HillshadeType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},Azimuth:{name:"Azimuth",isPublic:!1,isDataset:!1,value:315,type:"RasterFunctionVariable"},Altitude:{name:"Altitude",isPublic:!1,isDataset:!1,value:45,type:"RasterFunctionVariable"},SlopeType:{name:"SlopeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ZFactor:{name:"ZFactor",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},PSPower:{name:"PSPower",isPublic:!1,isDataset:!1,value:.664,type:"RasterFunctionVariable"},PSZFactor:{name:"PSZFactor",isPublic:!1,isDataset:!1,value:.024,type:"RasterFunctionVariable"},RemoveEdgeEffect:{name:"RemoveEdgeEffect",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},type:"HillshadeFunctionArguments"},functionType:0,thumbnail:""},ResampleFunction:{name:"Resample",description:"Changes the cell size of a raster.",function:{type:"ResampleFunction",pixelType:"UNKNOWN",name:"Resample",description:"Changes the cell size of a raster."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ResamplingType:{name:"ResamplingType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},InputCellSize:{name:"InputCellsize",isPublic:!1,isDataset:!1,value:{x:0,y:0},type:"RasterFunctionVariable"},OutputCellSize:{name:"OutputCellsize",isPublic:!1,isDataset:!1,value:{x:0,y:0},type:"RasterFunctionVariable"},type:"ResampleFunctionArguments"},functionType:0,thumbnail:""}};var ee=d(32681),we=d(97890),Je=d(83699);const Fe=new Set(["u1","u2","u4","u8","s8","u16","s16"]),Re={simple_scalar:"Simple Scalar",wind_barb:"Wind Barb",single_arrow:"Single Arrow",beaufort_kn:"Beaufort Wind (Knots)",beaufort_m:"Beaufort Wind (MetersPerSecond)",ocean_current_m:"Ocean Current (MetersPerSecond)",ocean_current_kn:"Ocean Current (Knots)"},Ce=new Set(["raster-stretch","unique-value","class-breaks","raster-shaded-relief","vector-field","raster-colormap"]);function nt(s){return Ce.has(s.type)}function ct(s,n){var u;if(!s||!n)return(0,Z.o8)(s||n);const t=(0,Z.o8)(s);if(t.functionDefinition&&n.rasterFunctionDefinition){const r=n.rasterFunctionDefinition;(r.thumbnail||r.thumbnailEx)&&(r.thumbnail=r.thumbnailEx=void 0),Mr(t.functionDefinition.arguments,n),t.rasterFunctionDefinition=t.functionDefinition.toJSON()}else"none"!==(null===(u=n.functionName)||void 0===u?void 0:u.toLowerCase())&&(Ir(t.functionArguments).Raster=n);return t}function Mr(s,n){for(const u in s)"raster"===u.toLowerCase()&&("RasterFunctionVariable"===s[u].type?(s[u]=n.rasterFunctionDefinition,s[u].type="RasterFunctionTemplate"):"RasterFunctionTemplate"===s[u].type&&Mr(s[u].arguments,n))}function be(s){const n=(0,Z.o8)(Ae[s.functionName+"Function"]),u=s.functionArguments;for(const t in u)"raster"===t.toLowerCase()?(n.arguments[t]=be(u[t]),n.arguments[t].type="RasterFunctionTemplate"):"colormap"===t.toLowerCase()?(n.arguments[t].value=Br(u[t]),n.arguments.ColorSchemeType.value=0):n.arguments[t].value=u[t];return n}function Ir(s){var n;const u=null!==(n=null==s?void 0:s.Raster)&&void 0!==n?n:null==s?void 0:s.raster;return u&&"esri.layers.support.RasterFunction"===u.declaredClass?Ir(u.functionArguments):s}const mt={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};function St(s,n){const u=Fe.has(n)?(0,Y.hP)(n):null;return u&&s.push([Math.floor(u[0]-1),0,0,0],[Math.ceil(u[1]+1),0,0,0]),s}function xr(s){if(null==s)return;const{fields:n}=s,u=null==n?void 0:n.find(t=>(null==t?void 0:t.name)&&"value"===t.name.toLowerCase());return null==u?void 0:u.name}function Ur(s){const n=[];return null!=s&&s.forEach(u=>{const t=u;if(Array.isArray(t))n.push(t);else{if(null==t.min||null==t.max)return;n.push([t.min,t.max,t.avg||0,t.stddev||0])}}),n}function Br(s){const n=[],u=[];return s.forEach(t=>{n.push(t[0]),u.push((0,ee.vL)([...t.slice(1),255]))}),{type:"RasterColormap",values:n,colors:u}}var ve=d(3147),de=d(9932);let se=class extends T.oY{constructor(){super(...arguments),this.layer=null,this.compression=void 0,this.pixelType=void 0,this.lercVersion=2}get adjustAspectRatio(){return this.layer.adjustAspectRatio}writeAdjustAspectRatio(s,n,u){this.layer.version<10.3||(n[u]=s)}get bandIds(){return this.layer.bandIds}get compressionQuality(){return this.layer.compressionQuality}writeCompressionQuality(s,n,u){this.format&&this.format.toLowerCase().includes("jpg")&&null!=s&&(n[u]=s)}get compressionTolerance(){return this.layer.compressionTolerance}writeCompressionTolerance(s,n,u){"lerc"===this.format&&null!=s&&(n[u]=s)}get format(){var s;return"vector-field"===(null===(s=this.layer.renderer)||void 0===s?void 0:s.type)?"lerc":this.layer.format}get interpolation(){return this.layer.interpolation}get noData(){return this.layer.noData}get noDataInterpretation(){return this.layer.noDataInterpretation}writeLercVersion(s,n,u){"lerc"===this.format&&this.layer.version>=10.5&&(n[u]=s)}get version(){const s=this.layer;return s.commitProperty("bandIds"),s.commitProperty("format"),s.commitProperty("compressionQuality"),s.commitProperty("compressionTolerance"),s.commitProperty("interpolation"),s.commitProperty("noData"),s.commitProperty("noDataInterpretation"),s.commitProperty("mosaicRule"),s.commitProperty("rasterFunction"),s.commitProperty("adjustAspectRatio"),s.commitProperty("pixelFilter"),s.commitProperty("definitionExpression"),s.commitProperty("multidimensionalSubset"),(this._get("version")||0)+1}set version(s){this._set("version",s)}get mosaicRule(){const s=this.layer;let n=s.mosaicRule;const u=s.definitionExpression;return n?u&&u!==n.where&&(n=n.clone(),n.where=u):u&&(n=new ve.A({where:u})),n}get rasterFunction(){var s,n;const u=this.layer;let{rasterFunction:t}=u;const r=u.pixelFilter,i=!u.format||u.format.includes("jpg")||u.format.includes("png");t=this._addResampleRasterFunction(t);const p=null===(s=u.multidimensionalSubset)||void 0===s?void 0:s.areaOfInterest;return p&&(t=this._addClipFunction(t,p)),i&&!r&&"vector-field"!==(null===(n=u.renderer)||void 0===n?void 0:n.type)&&(t=this.combineRendererWithRenderingRule(t)),t}combineRendererWithRenderingRule(s){var n;const u=this.layer,{rasterInfo:t,renderer:r}=u;return s=s||u.rasterFunction,r&&nt(r)?ct(function Er(s,n){switch(n=n||{},s.type){case"raster-stretch":return function Nr(s,n){var u;const t=n.convertToRFT,r=new M.A;r.functionName="Stretch";const i=mt[we.u.toJSON(s.stretchType)],p="u8",c={StretchType:i,Statistics:Ur(null!==(u=s.statistics)&&void 0!==u?u:[]),DRA:s.dynamicRangeAdjustment,UseGamma:s.useGamma,Gamma:s.gamma,ComputeGamma:s.computeGamma};if(null!=s.outputMin&&(c.Min=s.outputMin),null!=s.outputMax&&(c.Max=s.outputMax),i===mt.standardDeviation?(c.NumberOfStandardDeviations=s.numberOfStandardDeviations,r.outputPixelType=p):i===mt.percentClip?(c.MinPercent=s.minPercent,c.MaxPercent=s.maxPercent,r.outputPixelType=p):i===mt.minMax?r.outputPixelType=p:i===mt.sigmoid&&(c.SigmoidStrengthLevel=s.sigmoidStrengthLevel),r.functionArguments=c,r.variableName="Raster",s.colorRamp){const g=s.colorRamp,R=new M.A;if(t)R.functionArguments={ColorRamp:(0,ee.hf)(g)};else{const E=(0,ee.hs)(g,!0);if(E)R.functionArguments={colorRampName:E};else if(!n.convertColorRampToColormap||"algorithmic"!==g.type&&"multipart"!==g.type){var f;const S=s.colorRamp.toJSON();"algorithmic"===S.type?S.algorithm=S.algorithm||"esriCIELabAlgorithm":"multipart"===S.type&&!(null===(f=S.colorRamps)||void 0===f)&&f.length&&S.colorRamps.forEach(w=>w.algorithm=w.algorithm||"esriCIELabAlgorithm"),R.functionArguments={colorRamp:S}}else R.functionArguments={Colormap:(0,ee.R8)(g)}}return R.variableName="Raster",R.functionName="Colormap",R.functionArguments.Raster=r,t?new M.A({rasterFunctionDefinition:be(R)}):R}return t?new M.A({rasterFunctionDefinition:be(r)}):r}(s,n);case"class-breaks":return function Lr(s,n){const u=[],t=[],r=[],i=[],{pixelType:c,rasterAttributeTable:f}=n,g=null==f?null:f.features,R=xr(f);if(R&&g&&Array.isArray(g)&&s.classBreakInfos){s.classBreakInfos.forEach((O,U)=>{var B;const q=null===(B=O.symbol)||void 0===B?void 0:B.color;let ge;null!=q&&q.a&&null!=O.minValue&&null!=O.maxValue&&g.forEach(te=>{null!=O.minValue&&null!=O.maxValue&&(ge=te.attributes[s.field],(ge>=O.minValue&&ge<O.maxValue||U===s.classBreakInfos.length-1&&ge>=O.minValue)&&i.push([te.attributes[R],q.r,q.g,q.b]))})});const V=c?St(i,c):i,J=new M.A;return J.functionName="Colormap",J.functionArguments={},J.functionArguments.Colormap=V,J.variableName="Raster",n.convertToRFT?new M.A({rasterFunctionDefinition:be(J)}):J}s.classBreakInfos.forEach((V,J)=>{if(null==V.minValue||null==V.maxValue)return;const O=V.symbol&&V.symbol.color;null!=O&&O.a?(u.push(0===J?V.minValue:V.minValue+1e-4,V.maxValue+1e-4),t.push(J),i.push([J,O.r,O.g,O.b])):r.push(V.minValue,V.maxValue)});const E=c?St(i,c):i,S=new M.A;S.functionName="Remap",S.functionArguments={InputRanges:u,OutputValues:t,NoDataRanges:r},S.variableName="Raster";const w=new M.A;return w.functionName="Colormap",w.functionArguments={Colormap:E,Raster:S},n.convertToRFT?new M.A({rasterFunctionDefinition:be(w)}):w}(s,n);case"unique-value":return function Vr(s,n){var u;const t=[],{pixelType:r,rasterAttributeTable:i}=n,p=null==i?null:i.features,c=xr(i),f=null===(u=s.defaultSymbol)||void 0===u||null===(u=u.color)||void 0===u?void 0:u.toRgb(),g=s.uniqueValueInfos;if(g)if(p){if(c){const w=new Map;g.forEach(J=>{var O;const U=J.value,B=null===(O=J.symbol)||void 0===O?void 0:O.color;null!=U&&null!=B&&B.a&&w.set(String(U),B.toRgb())});const V=s.field;p.forEach(({attributes:J})=>{const O=String(J[V]),U=J[c],B=w.get(O);B?t.push([U,...B]):f&&t.push([U,...f])})}}else for(let w=0;w<g.length;w++){var R;const V=g[w],J=null===(R=V.symbol)||void 0===R?void 0:R.color,O=+V.value;if(null!=J&&J.a){if(isNaN(O))return null;t.push([O,J.r,J.g,J.b])}}const E=r?St(t,r):t,S=new M.A;return S.functionName="Colormap",S.functionArguments={},S.functionArguments.Colormap=E,S.variableName="Raster",n.convertToRFT?new M.A({rasterFunctionDefinition:be(S)}):S}(s,n);case"raster-colormap":return function zr(s,n){const u=s.extractColormap();if(!u||0===u.length)return null;const{pixelType:t}=n,r=t?St(u,t):u,i=new M.A;return i.functionName="Colormap",i.functionArguments={},i.functionArguments.Colormap=r,n.convertToRFT?new M.A({rasterFunctionDefinition:be(i)}):i}(s,n);case"vector-field":return function Zr(s,n){const u=new M.A;u.functionName="VectorFieldRenderer";const{dataType:t,bandNames:r}=n,i="vector-uv"===t;let p,c;if(r&&2===r.length){const w=r.map(V=>V.toLowerCase());p=w.indexOf("magnitude"),c=w.indexOf("direction")}-1!==p&&null!==p||(p=0,c=1);const f="arithmetic"===s.rotationType?1:2,g="flow-from"===s.flowRepresentation?0:1,R=s.visualVariables?s.visualVariables.find(w=>"Magnitude"===w.field):new Je.A,E={magnitudeBandID:p,directionBandID:c,isUVComponents:i,referenceSystem:f,massFlowAngleRepresentation:g,symbolTileSize:50,symbolTileSizeUnits:100,calculationMethod:"Vector Average",symbologyName:Re[s.style.toLowerCase().replace("-","_")],minimumMagnitude:R.minDataValue,maximumMagnitude:R.maxDataValue,minimumSymbolSize:R.minSize,maximumSymbolSize:R.maxSize};u.functionArguments=E;const S=be(u);return n.convertToRFT?M.A.fromJSON({rasterFunctionDefinition:S}):u}(s,n);case"raster-shaded-relief":return function Cr(s,n){const u=n.convertToRFT;if("elevation"!==n.dataType&&("generic"!==n.dataType||1!==n.bandCount||"s16"!==n.pixelType&&"s32"!==n.pixelType&&"f32"!==n.pixelType&&"f64"!==n.pixelType))return new M.A;const t=new M.A;t.functionName="Hillshade";const r="traditional"===s.hillshadeType?0:1,i="none"===s.scalingType?1:3,p={HillshadeType:r,SlopeType:i,ZFactor:s.zFactor};return 0===r&&(p.Azimuth=s.azimuth,p.Altitude=s.altitude),3===i&&(p.PSPower=s.pixelSizePower,p.PSZFactor=s.pixelSizeFactor),t.functionArguments=p,t.variableName="Raster",s.colorRamp&&(t.functionName="ShadedRelief",u?p.ColorRamp=(0,ee.hf)(s.colorRamp):p.Colormap=(0,ee.R8)(s.colorRamp)),u?new M.A({rasterFunctionDefinition:be(t)}):t}(s,n);case"flow":throw new Error("Unsupported rendering rule.")}}(r,{rasterAttributeTable:t.attributeTable,pixelType:t.pixelType,dataType:t.dataType,bandNames:t.bandInfos.map(({name:i})=>i),convertColorRampToColormap:u.version<10.6,convertToRFT:!(null===(n=s)||void 0===n||!n.rasterFunctionDefinition),bandCount:t.bandCount}),s):s}_addResampleRasterFunction(s){var n;if("vector-field"!==(null===(n=this.layer.renderer)||void 0===n?void 0:n.type)||"Resample"===(null==s?void 0:s.functionName))return s;let r=new M.A({functionName:"Resample",functionArguments:{ResamplingType:"esriImageServiceDataTypeVector-UV"===this.layer.serviceDataType?7:10,InputCellSize:this.layer.serviceRasterInfo.pixelSize}});return r=null!=s&&s.rasterFunctionDefinition?new M.A({rasterFunctionDefinition:be(r)}):r,ct(r,s)}_addClipFunction(s,n){return ct(new M.A({functionName:"Clip",functionArguments:{ClippingGeometry:n.toJSON(),ClippingType:1}}),s)}};(0,a._)([(0,l.MZ)()],se.prototype,"layer",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"adjustAspectRatio",null),(0,a._)([(0,I.K)("adjustAspectRatio")],se.prototype,"writeAdjustAspectRatio",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"bandIds",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"compression",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"compressionQuality",null),(0,a._)([(0,I.K)("compressionQuality")],se.prototype,"writeCompressionQuality",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"compressionTolerance",null),(0,a._)([(0,I.K)("compressionTolerance")],se.prototype,"writeCompressionTolerance",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"format",null),(0,a._)([(0,l.MZ)({type:String,json:{read:{reader:de.SZ.read},write:{writer:de.SZ.write}}})],se.prototype,"interpolation",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"noData",null),(0,a._)([(0,l.MZ)({type:String,json:{read:{reader:de.hm.read},write:{writer:de.hm.write}}})],se.prototype,"noDataInterpretation",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"pixelType",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"lercVersion",void 0),(0,a._)([(0,I.K)("lercVersion")],se.prototype,"writeLercVersion",null),(0,a._)([(0,l.MZ)({type:Number})],se.prototype,"version",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],se.prototype,"mosaicRule",null),(0,a._)([(0,l.MZ)({json:{write:!0,name:"renderingRule"}})],se.prototype,"rasterFunction",null),se=(0,a._)([(0,h.$)("esri.layers.mixins.ExportImageServiceParameters")],se);var Qe=d(29141),Jr=d(73258),Ar=d(63014),Gr=d(70489),Nt=d(66234),wr=d(83179),$r=d(85889),yt=d(20053),Lt=d(99263),Wr=d(50444),Mt=d(22151),Kr=d(54636),Ye=d(77098),G=d(68800),ue=d(13303);const Fr=s=>{let n=class extends s{constructor(){super(...arguments),this.make=null,this.model=null,this.focalLength=null,this.pixelSize=null,this.rows=null,this.cols=null}};return(0,a._)([(0,l.MZ)({json:{write:!0}})],n.prototype,"make",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],n.prototype,"model",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],n.prototype,"focalLength",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],n.prototype,"pixelSize",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],n.prototype,"rows",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],n.prototype,"cols",void 0),n=(0,a._)([(0,h.$)("esri.rest.support.CameraInfoMixin")],n),n};let Se=class extends(Fr(T.oY)){constructor(){super(...arguments),this.id=null,this.referenceUri=null,this.acquisitionDate=null,this.cameraID=null,this.center=null,this.perspectiveCenter=null,this.orientation=null}writeAcquisitionDate(s,n){n.acquisitionDate=null==s?void 0:s.getTime()}};(0,a._)([(0,l.MZ)({json:{write:!0}})],Se.prototype,"id",void 0),(0,a._)([(0,l.MZ)({json:{name:"uri",write:!0}})],Se.prototype,"referenceUri",void 0),(0,a._)([(0,l.MZ)({type:Date,json:{write:!0}})],Se.prototype,"acquisitionDate",void 0),(0,a._)([(0,I.K)("acquisitionDate")],Se.prototype,"writeAcquisitionDate",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],Se.prototype,"cameraID",void 0),(0,a._)([(0,l.MZ)({type:ue.A,json:{write:!0}})],Se.prototype,"center",void 0),(0,a._)([(0,l.MZ)({type:ue.A,json:{write:!0}})],Se.prototype,"perspectiveCenter",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Se.prototype,"orientation",void 0),Se=(0,a._)([(0,h.$)("esri.rest.support.ImageInspectionInfo")],Se);const Hr=Se;let It=class extends T.oY{constructor(){super(...arguments),this.images=null}};(0,a._)([(0,l.MZ)({type:[Hr],json:{write:!0}})],It.prototype,"images",void 0),It=(0,a._)([(0,h.$)("esri.rest.support.FindImagesResult")],It);const Qr=It;var Pe=d(32034);let st=class extends T.oY{constructor(s){super(s),this.north=null,this.up=null,this.spatialReference=null}};(0,a._)([(0,l.MZ)({type:Number,json:{write:!0}})],st.prototype,"north",void 0),(0,a._)([(0,l.MZ)({type:Number,json:{write:!0}})],st.prototype,"up",void 0),(0,a._)([(0,l.MZ)({type:Pe.A,json:{write:!0}})],st.prototype,"spatialReference",void 0),st=(0,a._)([(0,h.$)("esri.rest.support.ImageAngleResult")],st);const Yr=st;var ce=d(82663);let Ge=class extends T.oY{constructor(){super(...arguments),this.value=null,this.displayValue=null,this.uncertainty=null}};(0,a._)([(0,l.MZ)({type:Number,json:{read:!0,write:!0}})],Ge.prototype,"value",void 0),(0,a._)([(0,l.MZ)({type:String,json:{read:!0,write:!0}})],Ge.prototype,"displayValue",void 0),(0,a._)([(0,l.MZ)({type:Number,json:{read:!0,write:!0}})],Ge.prototype,"uncertainty",void 0),Ge=(0,a._)([(0,h.$)("esri.rest.support.ImageMeasureResultValue")],Ge);let ot=class extends Ge{constructor(){super(...arguments),this.unit=null}};(0,a._)([(0,l.MZ)({type:String,json:{read:ce.Sk.read,write:ce.Sk.write}})],ot.prototype,"unit",void 0),ot=(0,a._)([(0,h.$)("esri.rest.support.ImageMeasureResultLengthValue")],ot);let xt=class extends Ge{constructor(){super(...arguments),this.unit=null}};(0,a._)([(0,l.MZ)({type:String,json:{read:ce.dk.read,write:ce.dk.write}})],xt.prototype,"unit",void 0),xt=(0,a._)([(0,h.$)("esri.rest.support.ImageMeasureResultAreaValue")],xt);let ht=class extends Ge{constructor(){super(...arguments),this.unit=null}};(0,a._)([(0,l.MZ)({type:String,json:{read:ce.b$.read,write:ce.b$.write}})],ht.prototype,"unit",void 0),ht=(0,a._)([(0,h.$)("esri.rest.support.ImageMeasureResultAngleValue")],ht);let $e=class extends T.oY{constructor(){super(...arguments),this.name=null,this.sensorName=null}};(0,a._)([(0,l.MZ)({type:String,json:{read:!0,write:!0}})],$e.prototype,"name",void 0),(0,a._)([(0,l.MZ)({type:String,json:{read:!0,write:!0}})],$e.prototype,"sensorName",void 0),$e=(0,a._)([(0,h.$)("esri.rest.support.BaseImageMeasureResult")],$e);let gt=class extends $e{constructor(){super(...arguments),this.area=null,this.perimeter=null}};(0,a._)([(0,l.MZ)({type:xt,json:{read:!0,write:!0}})],gt.prototype,"area",void 0),(0,a._)([(0,l.MZ)({type:ot,json:{read:!0,write:!0}})],gt.prototype,"perimeter",void 0),gt=(0,a._)([(0,h.$)("esri.rest.support.ImageAreaResult")],gt);const Xr=gt;var ft=d(28067),At=d(55861);let at=class extends T.oY{constructor(){super(...arguments),this.area=null,this.geometry=null}readGeometry(s,n){return null==s?null:s.rings?At.A.fromJSON(s):ft.A.fromJSON(s)}};(0,a._)([(0,l.MZ)({type:Number,json:{write:!0}})],at.prototype,"area",void 0),(0,a._)([(0,l.MZ)({json:{name:"shape",write:!0}})],at.prototype,"geometry",void 0),(0,a._)([(0,K.w)("geometry")],at.prototype,"readGeometry",null),at=(0,a._)([(0,h.$)("esri.rest.support.ImageBoundaryResult")],at);const qr=at;let lt=class extends $e{constructor(){super(...arguments),this.distance=null,this.azimuthAngle=null,this.elevationAngle=null}};(0,a._)([(0,l.MZ)({type:ot,json:{read:!0,write:!0}})],lt.prototype,"distance",void 0),(0,a._)([(0,l.MZ)({type:ht,json:{read:!0,write:!0}})],lt.prototype,"azimuthAngle",void 0),(0,a._)([(0,l.MZ)({type:ht,json:{read:!0,write:!0}})],lt.prototype,"elevationAngle",void 0),lt=(0,a._)([(0,h.$)("esri.rest.support.ImageDistanceResult")],lt);const kr=lt;let wt=class extends(Fr(T.oY)){constructor(){super(...arguments),this.id=null}};(0,a._)([(0,l.MZ)({json:{write:!0}})],wt.prototype,"id",void 0),wt=(0,a._)([(0,h.$)("esri.rest.support.CameraInfo")],wt);const ei=wt;let Me=class extends T.oY{constructor(){super(...arguments),this.id=null,this.name=null,this.acquisitionDate=null,this.cameraID=null,this.center=null,this.gps=null,this.orientation=null}writeAcquisitionDate(s,n){n.acquisitionDate=null==s?void 0:s.getTime()}};(0,a._)([(0,l.MZ)({json:{write:!0}})],Me.prototype,"id",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Me.prototype,"name",void 0),(0,a._)([(0,l.MZ)({type:Date,json:{write:!0}})],Me.prototype,"acquisitionDate",void 0),(0,a._)([(0,I.K)("acquisitionDate")],Me.prototype,"writeAcquisitionDate",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],Me.prototype,"cameraID",void 0),(0,a._)([(0,l.MZ)({type:ue.A,json:{write:!0}})],Me.prototype,"center",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Me.prototype,"gps",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Me.prototype,"orientation",void 0),Me=(0,a._)([(0,h.$)("esri.rest.support.ImageGPSInfo")],Me);const ti=Me;let vt=class extends T.oY{constructor(){super(...arguments),this.images=null,this.cameras=null}};(0,a._)([(0,l.MZ)({type:[ti],json:{write:!0}})],vt.prototype,"images",void 0),(0,a._)([(0,l.MZ)({type:[ei],json:{write:!0}})],vt.prototype,"cameras",void 0),vt=(0,a._)([(0,h.$)("esri.rest.support.ImageGPSInfoResult")],vt);const ri=vt;let Ft=class extends $e{constructor(){super(...arguments),this.height=null}};(0,a._)([(0,l.MZ)({type:ot,json:{read:!0,write:!0}})],Ft.prototype,"height",void 0),Ft=(0,a._)([(0,h.$)("esri.rest.support.ImageHeightResult")],Ft);const ii=Ft;var br=d(93327);let Ie=class extends T.oY{constructor(){super(...arguments),this.catalogItemVisibilities=null,this.catalogItems=null,this.location=null,this.name=null,this.objectId=null,this.processedValues=null,this.properties=null,this.value=null}};(0,a._)([(0,l.MZ)({json:{write:!0}})],Ie.prototype,"catalogItemVisibilities",void 0),(0,a._)([(0,l.MZ)({type:br.A,json:{write:!0}})],Ie.prototype,"catalogItems",void 0),(0,a._)([(0,l.MZ)({type:ue.A,json:{write:!0}})],Ie.prototype,"location",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ie.prototype,"name",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ie.prototype,"objectId",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ie.prototype,"processedValues",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ie.prototype,"properties",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ie.prototype,"value",void 0),Ie=(0,a._)([(0,h.$)("esri.rest.support.ImageIdentifyResult")],Ie);const ni=Ie;let bt=class extends T.oY{constructor(){super(...arguments),this.geometries=null}};(0,a._)([(0,l.MZ)({json:{write:!0}})],bt.prototype,"geometries",void 0),bt=(0,a._)([(0,h.$)("esri.rest.support.ImagePixelLocationResult")],bt);const si=bt;let Pt=class extends $e{constructor(){super(...arguments),this.point=null}};(0,a._)([(0,l.MZ)({type:ue.A,json:{name:"point.value",read:!0,write:!0}})],Pt.prototype,"point",void 0),Pt=(0,a._)([(0,h.$)("esri.rest.support.ImagePointResult")],Pt);const oi=Pt;let Ne=class extends T.oY{constructor(){super(...arguments),this.attributes=null,this.location=null,this.locationId=null,this.rasterId=null,this.resolution=null,this.pixelValue=null}};(0,a._)([(0,l.MZ)({json:{write:!0}})],Ne.prototype,"attributes",void 0),(0,a._)([(0,l.MZ)({type:ue.A,json:{write:!0}})],Ne.prototype,"location",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ne.prototype,"locationId",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ne.prototype,"rasterId",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ne.prototype,"resolution",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ne.prototype,"pixelValue",void 0),Ne=(0,a._)([(0,h.$)("esri.rest.support.ImageSample")],Ne);const ai=Ne;let Dt=class extends T.oY{constructor(){super(...arguments),this.samples=null}};(0,a._)([(0,l.MZ)({type:[ai],json:{write:!0}})],Dt.prototype,"samples",void 0),Dt=(0,a._)([(0,h.$)("esri.rest.support.ImageSampleResult")],Dt);const li=Dt;let Ot=class extends T.oY{constructor(){super(...arguments),this.url=null}};(0,a._)([(0,l.MZ)({json:{name:"imageURL",write:!0}})],Ot.prototype,"url",void 0),Ot=(0,a._)([(0,h.$)("esri.rest.support.ImageUrlResult")],Ot);const ui=Ot;var oe=d(61320);let We=class extends T.oY{constructor(){super(...arguments),this.geometry=null,this.length=null,this.area=null,this.center=null}readCenter(s,n){return s.spatialReference||(s={...s,spatialReference:n.Shape.spatialReference}),ue.A.fromJSON(s)}};(0,a._)([(0,l.MZ)({types:F.yR,json:{name:"Shape",read:oe.rS,write:!0}})],We.prototype,"geometry",void 0),(0,a._)([(0,l.MZ)({json:{name:"Length",write:!0}})],We.prototype,"length",void 0),(0,a._)([(0,l.MZ)({json:{name:"Area",write:!0}})],We.prototype,"area",void 0),(0,a._)([(0,l.MZ)({json:{name:"Center",write:!0}})],We.prototype,"center",void 0),(0,a._)([(0,K.w)("center")],We.prototype,"readCenter",null),We=(0,a._)([(0,h.$)("esri.rest.support.MeasureAreaFromImageResult")],We);const pi=We;let _t=class extends T.oY{constructor(){super(...arguments),this.geometry=null,this.length=null}};(0,a._)([(0,l.MZ)({types:F.yR,json:{name:"Shape",read:oe.rS,write:!0}})],_t.prototype,"geometry",void 0),(0,a._)([(0,l.MZ)({json:{name:"Length",write:!0}})],_t.prototype,"length",void 0),_t=(0,a._)([(0,h.$)("esri.rest.support.MeasureLengthFromImageResult")],_t);const di=_t;function Vt(s){const n=null==s?void 0:s.time;if(n&&(null!=n.start||null!=n.end)){const u=[];null!=n.start&&u.push(n.start),null==n.end||u.includes(n.end)||u.push(n.end),s.time=u.join(",")}}function Pr(s,n,u){return zt.apply(this,arguments)}function zt(){return(zt=(0,m.A)(function*(s,n,u){const t=(0,G.Dl)(s),r=n.geometry?[n.geometry]:[],i=yield(0,Ye.el)(r),p=n.toJSON();Vt(p);const c=null==i?void 0:i[0];null!=c&&(p.geometry=De(c));const f=(0,G.lF)({...t.query,f:"json",...p});return(0,G.jV)(f,u)})).apply(this,arguments)}function Ut(){return(Ut=(0,m.A)(function*(s,n,u){var t,r;const i=n.toJSON();null!=i.angleName&&(i.angleName=i.angleName.join(",")),null!=n&&null!==(t=n.point)&&void 0!==t&&null!==(t=t.spatialReference)&&void 0!==t&&t.imageCoordinateSystem&&(i.point.spatialReference=Tt(n.point.spatialReference)),null!=n&&null!==(r=n.spatialReference)&&void 0!==r&&r.imageCoordinateSystem&&(i.spatialReference=ut(n.spatialReference));const p=(0,G.Dl)(s),c=(0,G.lF)({...p.query,f:"json",...i}),f=(0,G.jV)(c,u),{data:g}=yield(0,C.A)(`${p.path}/computeAngles`,f);return g.spatialReference=g.spatialReference?null!=g.spatialReference.geodataXform?new Pe.A({wkid:0,imageCoordinateSystem:g.spatialReference}):Pe.A.fromJSON(g.spatialReference):null,"NaN"===g.north&&(g.north=null),"NaN"===g.up&&(g.up=null),new Yr(g)})).apply(this,arguments)}function Bt(){return(Bt=(0,m.A)(function*(s,n,u){const t=n.toJSON(),{geometries:r}=n;if(r)for(let R=0;R<r.length;R++){var i;null!==(i=r[R].spatialReference)&&void 0!==i&&i.imageCoordinateSystem&&(t.geometries.geometries[R].spatialReference=Tt(r[R].spatialReference))}const p=(0,G.Dl)(s),c=(0,G.lF)({...p.query,f:"json",...t}),f=(0,G.jV)(c,u),{data:g}=yield(0,C.A)(`${p.path}/computePixelLocation`,f);return si.fromJSON(g)})).apply(this,arguments)}function Jt(){return(Jt=(0,m.A)(function*(s,n,u){const t=yield Pr(s,n,u),r=(0,G.Dl)(s),{data:i}=yield(0,C.A)(`${r.path}/computeStatisticsHistograms`,t),{statistics:p}=i;return null!=p&&p.length&&p.forEach(c=>{c.avg=c.mean,c.stddev=c.standardDeviation}),{statistics:p,histograms:i.histograms}})).apply(this,arguments)}function Gt(){return(Gt=(0,m.A)(function*(s,n,u){const t=yield Pr(s,n,u),r=(0,G.Dl)(s),{data:i}=yield(0,C.A)(`${r.path}/computeHistograms`,t);return{histograms:i.histograms}})).apply(this,arguments)}function $t(){return($t=(0,m.A)(function*(s,n,u){var t,r;const i=n.toJSON();Vt(i),null!==(t=i.outFields)&&void 0!==t&&t.length&&(i.outFields=i.outFields.join(","));const p=yield(0,Ye.el)(n.geometry),c=null==p?void 0:p[0];null!=c&&(i.geometry=De(c));const f=(0,G.Dl)(s),g=(0,G.lF)({...f.query,f:"json",...i}),R=(0,G.jV)(g,u),{data:E}=yield(0,C.A)(`${f.path}/getSamples`,R),S=null==E||null===(r=E.samples)||void 0===r?void 0:r.map(w=>{const V="NaN"===w.value||""===w.value?null:w.value.split(" ").map(J=>Number(J));return{...w,pixelValue:V}});return li.fromJSON({samples:S})})).apply(this,arguments)}function Dr(s,n,u){return Wt.apply(this,arguments)}function Wt(){return(Wt=(0,m.A)(function*(s,n,u){const t=(0,G.Dl)(s);return(0,Ye.el)(n.geometry?[n.geometry]:[]).then(i=>{const p=n.toJSON(),c=null==i?void 0:i[0];null!=c&&(p.geometry=JSON.stringify(De(c)));const f=(0,G.lF)({...t.query,f:"json",...p}),g=(0,G.jV)(f,u);return(0,C.A)(t.path+"/identify",g)}).then(i=>ni.fromJSON(i.data))})).apply(this,arguments)}function Kt(){return(Kt=(0,m.A)(function*(s,n,u){const t=yield jt(s,n,[n.fromGeometry,n.toGeometry],u);return ii.fromJSON(t)})).apply(this,arguments)}function Ht(){return(Ht=(0,m.A)(function*(s,n,u){const t=yield jt(s,n,[n.geometry],u);return Xr.fromJSON(t)})).apply(this,arguments)}function Qt(){return(Qt=(0,m.A)(function*(s,n,u){const t=yield jt(s,n,[n.geometry],u);return oi.fromJSON(t)})).apply(this,arguments)}function Yt(){return(Yt=(0,m.A)(function*(s,n,u){const t=yield jt(s,n,[n.fromGeometry,n.toGeometry],u);return kr.fromJSON(t)})).apply(this,arguments)}function jt(s,n,u,t){return Xt.apply(this,arguments)}function Xt(){return(Xt=(0,m.A)(function*(s,n,u,t){const r=(0,G.Dl)(s),i=yield(0,Ye.el)(u),p=n.toJSON();null!=i[0]&&(p.fromGeometry=JSON.stringify(De(i[0]))),null!=i[1]&&(p.toGeometry=JSON.stringify(De(i[1])));const c=(0,G.lF)({...r.query,f:"json",...p}),f=(0,G.jV)(c,t),{data:g}=yield(0,C.A)(r.path+"/measure",f);return g})).apply(this,arguments)}function qt(){return(qt=(0,m.A)(function*(s,n,u){const t=yield Or(s,n,u);return di.fromJSON(t)})).apply(this,arguments)}function kt(){return(kt=(0,m.A)(function*(s,n,u){const t=yield Or(s,n,u);return pi.fromJSON(t)})).apply(this,arguments)}function Or(s,n,u){return er.apply(this,arguments)}function er(){return(er=(0,m.A)(function*(s,n,u){const t=(0,G.Dl)(s),r=n.toJSON(),i=(0,G.lF)({...t.query,f:"json",...r}),p=(0,G.jV)(i,u),{data:c}=yield(0,C.A)(t.path+"/measureFromImage",p);return c})).apply(this,arguments)}function De(s){var n;const u=s.toJSON();return null!==(n=s.spatialReference)&&void 0!==n&&n.imageCoordinateSystem&&(u.spatialReference=Tt(s.spatialReference)),u}function Tt(s){const{imageCoordinateSystem:n}=s;if(n){const{id:u,referenceServiceName:t}=n;return null!=u?t?{icsid:u,icsns:t}:{icsid:u}:{ics:n}}return s.toJSON()}function ut(s,n){if(!s.imageCoordinateSystem)return(0,z.YX)(s);const u=Tt(s),{icsid:t,icsns:r}=u;return null!=t&&(null==r||null!=n&&n.toLowerCase().includes("/"+r.toLowerCase()+"/"))?`0:${t}`:JSON.stringify(u)}function tr(){return(tr=(0,m.A)(function*(s,n,u){const t=(0,G.Dl)(s),r=n.toJSON();n.outSpatialReference&&(r.outSR=ut(n.outSpatialReference));const i=(0,G.lF)({...t.query,f:"json",...r}),p=(0,G.jV)(i,u),{data:c}=yield(0,C.A)(t.path+"/queryBoundary",p);return qr.fromJSON(c)})).apply(this,arguments)}function rr(){return(rr=(0,m.A)(function*(s,n,u){var t,r,i;const p=n.toJSON();Vt(p),null!==(t=p.objectIds)&&void 0!==t&&t.length&&(p.objectIds=p.objectIds.join(",")),p.geometry||p.objectIds||p.time||p.where||(p.where="1=1");const c=yield(0,Ye.el)(n.geometry),f=null==c?void 0:c[0];null!=f&&(p.geometry=De(f));const g=null!==(r=null==f?void 0:f.spatialReference)&&void 0!==r?r:null===(i=n.geometry)||void 0===i?void 0:i.spatialReference;g&&(p.inSR=ut(g));const R=(0,G.Dl)(s),E=(0,G.lF)({...R.query,f:"json",...p}),S=(0,G.jV)(E,u),{data:w}=yield(0,C.A)(`${R.path}/queryGPSInfo`,S);return ri.fromJSON(w)})).apply(this,arguments)}function ir(){return(ir=(0,m.A)(function*(s,n,u){const t=n.toJSON();n.geometry.spatialReference.imageCoordinateSystem&&(t.geometry=De(n.geometry)),n.depthOffset&&n.adjust||delete t.options;const r=(0,G.Dl)(s),i=(0,G.lF)({...r.query,f:"json",...t}),p=(0,G.jV)(i,u),{data:c}=yield(0,C.A)(`${r.path}/imageToMap`,p);return(0,oe.rS)(c)})).apply(this,arguments)}function nr(){return(nr=(0,m.A)(function*(s,n,u){var t;const r=n.toJSON();null!==(t=n.rasterIds)&&void 0!==t&&t.length&&(r.rasterIds=n.rasterIds.join(","));const i=(0,G.Dl)(s),p=(0,G.lF)({...i.query,f:"json",...r}),c=(0,G.jV)(p,u),{data:f}=yield(0,C.A)(`${i.path}/imageToMapMultiray`,c);return(0,oe.rS)(f)})).apply(this,arguments)}function sr(){return(sr=(0,m.A)(function*(s,n,u){var t,r;const i=n.toJSON(),p=yield(0,Ye.el)(n.geometry),c=null==p?void 0:p[0];null!=c&&(i.geometry=De(c)),n.visibleOnly||delete i.options;const f=null!==(t=null==c?void 0:c.spatialReference)&&void 0!==t?t:null===(r=n.geometry)||void 0===r?void 0:r.spatialReference;f&&(i.inSR=ut(f));const g=(0,G.Dl)(s),R=(0,G.lF)({...g.query,f:"json",...i}),E=(0,G.jV)(R,u),{data:S}=yield(0,C.A)(`${g.path}/mapToImage`,E);return(0,oe.rS)(S)})).apply(this,arguments)}function or(){return(or=(0,m.A)(function*(s,n,u){const t=n.toJSON(),r=(0,G.Dl)(s),i=(0,G.lF)({...r.query,f:"json",...t}),p=(0,G.jV)(i,u),{data:c}=yield(0,C.A)(`${r.path}/getImageUrl`,p);return ui.fromJSON(c)})).apply(this,arguments)}function ar(){return(ar=(0,m.A)(function*(s,n,u){var t;const r=n.toJSON(),i=yield(0,Ye.el)([n.fromGeometry,n.toGeometry]);null!=i[0]&&(r.fromGeometry=De(i[0]),i[0].spatialReference&&(r.inSR=ut(i[0].spatialReference))),null!=i[1]&&(r.toGeometry=De(i[1])),null!==(t=n.objectIds)&&void 0!==t&&t.length&&(r.objectIds=r.objectIds.join(","));const p=(0,G.Dl)(s),c=(0,G.lF)({...p.query,f:"json",...r}),f=(0,G.jV)(c,u),{data:g}=yield(0,C.A)(`${p.path}/find`,f);return Qr.fromJSON(g)})).apply(this,arguments)}d(93164);var Di=d(34687),Oi=(d(23098),d(77469),d(87477),d(2296),d(69287),d(68643),d(21870)),lr=(d(93615),d(20914),d(47258),d(55912),d(87086)),ji=(d(70994),d(52466),d(33063)),Ti=d(87342),ur=(d(59487),d(61569),d(93091)),Ei=d(61599);function pr(){return(pr=(0,m.A)(function*(s,n,u){var t,r;const i=(0,G.Dl)(s),p=(0,G.lF)({...null==i?void 0:i.query,f:"json"}),c=(0,G.jV)(p,u),f=`${null==i?void 0:i.path}/${n}/info`,g=(0,C.A)(`${f}`,c),R=(0,C.A)(`${f}/keyProperties`,c),E=yield Promise.allSettled([g,R]),S="fulfilled"===E[0].status?E[0].value.data:null,w="fulfilled"===E[1].status?E[1].value.data:null;let V=null;null!==(t=S.statistics)&&void 0!==t&&t.length&&(V=S.statistics.map(pe=>({min:pe[0],max:pe[1],avg:pe[2],stddev:pe[3]})));const J=ft.A.fromJSON(S.extent),O=Math.ceil(J.width/S.pixelSizeX-.1),U=Math.ceil(J.height/S.pixelSizeY-.1),B=J.spatialReference,q=new ue.A({x:S.pixelSizeX,y:S.pixelSizeY,spatialReference:B}),ge=null!==(r=S.histograms)&&void 0!==r&&r.length?S.histograms:null,te=new Ei.A({origin:S.origin,blockWidth:S.blockWidth,blockHeight:S.blockHeight,firstPyramidLevel:S.firstPyramidLevel,maximumPyramidLevel:S.maxPyramidLevel});return new wr.A({width:O,height:U,bandCount:S.bandCount,extent:J,spatialReference:B,pixelSize:q,pixelType:S.pixelType.toLowerCase(),statistics:V,histograms:ge,keyProperties:w,storageInfo:te})})).apply(this,arguments)}let Ke=class extends((0,y.O)(T.oY)){constructor(){super(...arguments),this.fromGeometry=null,this.toGeometry=null,this.objectIds=null,this.where=null,this.maxCount=null}};(0,a._)([(0,l.MZ)({type:ue.A,json:{read:!0}})],Ke.prototype,"fromGeometry",void 0),(0,a._)([(0,l.MZ)({type:ue.A,json:{read:!0,write:!0}})],Ke.prototype,"toGeometry",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ke.prototype,"objectIds",void 0),(0,a._)([(0,l.MZ)({type:String,json:{write:!0}})],Ke.prototype,"where",void 0),(0,a._)([(0,l.MZ)({type:Number,json:{write:!0}})],Ke.prototype,"maxCount",void 0),Ke=(0,a._)([(0,h.$)("esri.rest.support.FindImagesParameters")],Ke);const Ci=Ke;var dr;let Xe=dr=class extends T.oY{constructor(s){super(s),this.angleNames=null,this.point=null,this.spatialReference=null,this.rasterId=null}clone(){return new dr((0,Z.o8)({angleNames:this.angleNames,point:this.point,spatialReference:this.spatialReference,rasterId:this.rasterId}))}};(0,a._)([(0,l.MZ)({type:[String],json:{name:"angleName",write:!0}})],Xe.prototype,"angleNames",void 0),(0,a._)([(0,l.MZ)({type:ue.A,json:{write:!0}})],Xe.prototype,"point",void 0),(0,a._)([(0,l.MZ)({type:Pe.A,json:{write:!0}})],Xe.prototype,"spatialReference",void 0),(0,a._)([(0,l.MZ)({type:N.jz,json:{write:!0}})],Xe.prototype,"rasterId",void 0),Xe=dr=(0,a._)([(0,h.$)("esri.rest.support.ImageAngleParameters")],Xe);const Ni=Xe,_e=new(d(49976).J)({esriMensurationPoint:"point",esriMensurationCentroid:"centroid",esriMensurationDistanceAndAngle:"distance-and-angle",esriMensurationAreaAndPerimeter:"area-and-perimeter",esriMensurationHeightFromBaseAndTop:"base-and-top",esriMensurationHeightFromBaseAndTopShadow:"base-and-top-shadow",esriMensurationHeightFromTopAndTopShadow:"top-and-top-shadow",esriMensurationPoint3D:"point-3D",esriMensurationCentroid3D:"centroid-3D",esriMensurationDistanceAndAngle3D:"distance-and-angle-3D",esriMensurationAreaAndPerimeter3D:"area-and-perimeter-3D"});let xe=class extends T.oY{constructor(){super(...arguments),this.type=null,this.measureOperation=null,this.mosaicRule=null,this.pixelSize=null,this.raster=void 0}};var cr;(0,a._)([(0,l.MZ)()],xe.prototype,"type",void 0),(0,a._)([(0,l.MZ)({type:_e.apiValues,json:{read:_e.read,write:_e.write}})],xe.prototype,"measureOperation",void 0),(0,a._)([(0,l.MZ)({type:ve.A,json:{write:!0}})],xe.prototype,"mosaicRule",void 0),(0,a._)([(0,l.MZ)({type:ue.A,json:{write:!0}})],xe.prototype,"pixelSize",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],xe.prototype,"raster",void 0),xe=(0,a._)([(0,h.$)("esri.rest.support.BaseImageMeasureParameters")],xe);let Le=cr=class extends xe{constructor(){super(...arguments),this.type="area-perimeter",this.geometry=null,this.is3D=!1,this.linearUnit="meters",this.areaUnit="square-meters"}writeGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]=s.toJSON())}get measureOperation(){return this.is3D?"area-and-perimeter-3D":"area-and-perimeter"}clone(){return new cr((0,Z.o8)({geometry:this.geometry,is3D:this.is3D,linearUnit:this.linearUnit,areaUnit:this.areaUnit,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};(0,a._)([(0,l.MZ)({types:F.yR,json:{name:"fromGeometry",read:!0,write:!0}})],Le.prototype,"geometry",void 0),(0,a._)([(0,I.K)("geometry")],Le.prototype,"writeGeometry",null),(0,a._)([(0,l.MZ)({type:_e.apiValues,json:{write:_e.write}})],Le.prototype,"measureOperation",null),(0,a._)([(0,l.MZ)({json:{read:!0}})],Le.prototype,"is3D",void 0),(0,a._)([(0,l.MZ)({type:String,json:{read:ce.Sk.read,write:ce.Sk.write}})],Le.prototype,"linearUnit",void 0),(0,a._)([(0,l.MZ)({type:String,json:{read:ce.dk.read,write:ce.dk.write}})],Le.prototype,"areaUnit",void 0),Le=cr=(0,a._)([(0,h.$)("esri.rest.support.ImageAreaParameters")],Le);const Vi=Le;let Et=class extends((0,y.O)(T.oY)){constructor(){super(...arguments),this.outSpatialReference=null}};(0,a._)([(0,l.MZ)({type:Pe.A,json:{name:"outSR",write:!0}})],Et.prototype,"outSpatialReference",void 0),Et=(0,a._)([(0,h.$)("esri.rest.support.ImageBoundaryParameters")],Et);const zi=Et;var mr;let Oe=mr=class extends xe{constructor(){super(...arguments),this.type="distance-angle",this.fromGeometry=null,this.toGeometry=null,this.is3D=!1,this.linearUnit="meters",this.angularUnit="degrees"}writeFromGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]=s.toJSON())}get measureOperation(){return this.is3D?"distance-and-angle-3D":"distance-and-angle"}clone(){return new mr((0,Z.o8)({fromGeometry:this.fromGeometry,toGeometry:this.toGeometry,is3D:this.is3D,linearUnit:this.linearUnit,angularUnit:this.angularUnit,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};(0,a._)([(0,l.MZ)({type:ue.A,json:{read:!0,write:!0}})],Oe.prototype,"fromGeometry",void 0),(0,a._)([(0,I.K)("fromGeometry")],Oe.prototype,"writeFromGeometry",null),(0,a._)([(0,l.MZ)({type:ue.A,json:{read:!0,write:!0}})],Oe.prototype,"toGeometry",void 0),(0,a._)([(0,l.MZ)({type:_e.apiValues,json:{write:_e.write}})],Oe.prototype,"measureOperation",null),(0,a._)([(0,l.MZ)({json:{read:!0}})],Oe.prototype,"is3D",void 0),(0,a._)([(0,l.MZ)({type:String,json:{read:ce.Sk.read,write:ce.Sk.write}})],Oe.prototype,"linearUnit",void 0),(0,a._)([(0,l.MZ)({type:String,json:{read:ce.b$.read,write:ce.b$.write}})],Oe.prototype,"angularUnit",void 0),Oe=mr=(0,a._)([(0,h.$)("esri.rest.support.ImageDistanceParameters")],Oe);const Ui=Oe;var yr=d(12849),Bi=d(15463),Ji=d(37086);let Ve=class extends((0,y.O)(T.oY)){constructor(){super(...arguments),this.geometry=null,this.objectIds=null,this.spatialRelationship="intersects",this.timeExtent=null,this.where=null}writeGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]=JSON.stringify(s.toJSON()))}};(0,a._)([(0,l.MZ)({types:F.yR,json:{read:oe.rS,write:!0}})],Ve.prototype,"geometry",void 0),(0,a._)([(0,I.K)("geometry")],Ve.prototype,"writeGeometry",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ve.prototype,"objectIds",void 0),(0,a._)([(0,Bi.e)(Ji.x,{ignoreUnknown:!1,name:"spatialRel"})],Ve.prototype,"spatialRelationship",void 0),(0,a._)([(0,l.MZ)({type:yr.A,json:{name:"time",write:!0}})],Ve.prototype,"timeExtent",void 0),(0,a._)([(0,l.MZ)({type:String,json:{write:!0}})],Ve.prototype,"where",void 0),Ve=(0,a._)([(0,h.$)("esri.rest.support.ImageGPSInfoParameters")],Ve);const Gi=Ve;var hr;let ze=hr=class extends xe{constructor(){super(...arguments),this.type="height",this.fromGeometry=null,this.toGeometry=null,this.operationType="base-and-top",this.linearUnit="meters"}writeFromGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]=s.toJSON())}get measureOperation(){return this.operationType}clone(){return new hr((0,Z.o8)({fromGeometry:this.fromGeometry,toGeometry:this.toGeometry,operationType:this.operationType,linearUnit:this.linearUnit,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};(0,a._)([(0,l.MZ)({type:ue.A,json:{read:!0}})],ze.prototype,"fromGeometry",void 0),(0,a._)([(0,I.K)("fromGeometry")],ze.prototype,"writeFromGeometry",null),(0,a._)([(0,l.MZ)({type:ue.A,json:{read:!0,write:!0}})],ze.prototype,"toGeometry",void 0),(0,a._)([(0,l.MZ)({type:_e.apiValues,json:{write:_e.write}})],ze.prototype,"measureOperation",null),(0,a._)([(0,l.MZ)({json:{read:!0}})],ze.prototype,"operationType",void 0),(0,a._)([(0,l.MZ)({type:String,json:{read:ce.Sk.read,write:ce.Sk.write}})],ze.prototype,"linearUnit",void 0),ze=hr=(0,a._)([(0,h.$)("esri.rest.support.ImageHeightParameters")],ze);const $i=ze;var fr,gr=d(98464);let re=fr=class extends T.oY{constructor(){super(...arguments),this.geometry=null,this.rasterFunctions=null,this.pixelSize=null,this.returnGeometry=!0,this.returnCatalogItems=!0,this.returnPixelValues=!0,this.maxItemCount=null,this.timeExtent=null,this.raster=void 0,this.viewId=void 0,this.processAsMultidimensional=!1}writeGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]=JSON.stringify(s.toJSON()))}set mosaicRule(s){var n;let u=s;null!==(n=u)&&void 0!==n&&n.mosaicMethod&&(u=ve.A.fromJSON({...u.toJSON(),mosaicMethod:u.mosaicMethod,mosaicOperation:u.mosaicOperation})),this._set("mosaicRule",u)}writeMosaicRule(s,n,u){null!=s&&(n[u]=JSON.stringify(s.toJSON()))}get renderingRule(){return(0,P.Lx)(v.A.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._get("rasterFunction")}set renderingRule(s){(0,P.Lx)(v.A.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._set("rasterFunction",s)}get renderingRules(){return(0,P.Lx)(v.A.getLogger(this),"renderingRules",{replacement:"rasterFunctions",version:"4.27",warnOnce:!0}),this._get("rasterFunctions")}set renderingRules(s){(0,P.Lx)(v.A.getLogger(this),"renderingRules",{replacement:"rasterFunctions",version:"4.27",warnOnce:!0}),this._set("rasterFunctions",s)}set rasterFunction(s){var n;let u=s;null!==(n=u)&&void 0!==n&&n.rasterFunction&&(u=M.A.fromJSON({...u.toJSON(),rasterFunction:u.rasterFunction,rasterFunctionArguments:u.rasterFunctionArguments})),this._set("rasterFunction",u)}writeRasterFunction(s,n,u){null!=s&&(n[u]=JSON.stringify(s.toJSON())),s.rasterFunctionDefinition&&(n[u]=JSON.stringify(s.rasterFunctionDefinition))}writeRasterFunctions(s,n,u){null!=s&&(n[u]=JSON.stringify(s.map(t=>t.rasterFunctionDefinition||t.toJSON())))}writePixelSize(s,n,u){null!=s&&(n[u]=JSON.stringify(s))}writeTimeExtent(s,n,u){if(null!=s){const t=null!=s.start?s.start.getTime():null,r=null!=s.end?s.end.getTime():null;n[u]=null!=t?null!=r?`${t},${r}`:`${t}`:null}}clone(){return new fr((0,Z.o8)({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,rasterFunctions:this.rasterFunctions,pixelSize:this.pixelSize,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,returnPixelValues:this.returnPixelValues,maxItemCount:this.maxItemCount,processAsMultidimensional:this.processAsMultidimensional,raster:this.raster,viewId:this.viewId,timeExtent:this.timeExtent}))}};(0,a._)([(0,l.MZ)({json:{write:!0}})],re.prototype,"geometry",void 0),(0,a._)([(0,I.K)("geometry")],re.prototype,"writeGeometry",null),(0,a._)([(0,l.MZ)({type:ve.A,json:{write:!0}})],re.prototype,"mosaicRule",null),(0,a._)([(0,I.K)("mosaicRule")],re.prototype,"writeMosaicRule",null),(0,a._)([(0,l.MZ)({type:M.A})],re.prototype,"renderingRule",null),(0,a._)([(0,l.MZ)({type:[M.A]})],re.prototype,"renderingRules",null),(0,a._)([(0,l.MZ)({type:M.A,json:{write:!0,name:"renderingRule"}})],re.prototype,"rasterFunction",null),(0,a._)([(0,I.K)("rasterFunction")],re.prototype,"writeRasterFunction",null),(0,a._)([(0,l.MZ)({type:[M.A],json:{write:!0,name:"renderingRules"}})],re.prototype,"rasterFunctions",void 0),(0,a._)([(0,I.K)("rasterFunctions")],re.prototype,"writeRasterFunctions",null),(0,a._)([(0,l.MZ)({type:ue.A,json:{write:!0}})],re.prototype,"pixelSize",void 0),(0,a._)([(0,I.K)("pixelSize")],re.prototype,"writePixelSize",null),(0,a._)([(0,l.MZ)({type:Boolean,json:{write:!0}})],re.prototype,"returnGeometry",void 0),(0,a._)([(0,l.MZ)({type:Boolean,json:{write:!0}})],re.prototype,"returnCatalogItems",void 0),(0,a._)([(0,l.MZ)({type:Boolean,json:{write:!0}})],re.prototype,"returnPixelValues",void 0),(0,a._)([(0,l.MZ)({type:Number,json:{write:!0}})],re.prototype,"maxItemCount",void 0),(0,a._)([(0,l.MZ)({type:yr.A,json:{write:{target:"time"}}})],re.prototype,"timeExtent",void 0),(0,a._)([(0,I.K)("timeExtent")],re.prototype,"writeTimeExtent",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],re.prototype,"raster",void 0),(0,a._)([(0,l.MZ)({json:{write:!0}})],re.prototype,"viewId",void 0),(0,a._)([(0,l.MZ)({type:Boolean,json:{write:!0}})],re.prototype,"processAsMultidimensional",void 0),re=fr=(0,a._)([(0,h.$)("esri.rest.support.ImageIdentifyParameters")],re);const jr=re;var vr;let pt=vr=class extends T.oY{constructor(){super(...arguments),this.geometries=null,this.rasterId=null}writeGeometry(s,n,u){n.geometries={geometryType:"esriGeometryPoint",geometries:s.map(t=>t.toJSON())}}clone(){var s,n;return new vr({geometries:null!==(s=null===(n=this.geometries)||void 0===n?void 0:n.map(u=>u.clone()))&&void 0!==s?s:[],rasterId:this.rasterId})}};(0,a._)([(0,l.MZ)({type:[ue.A],json:{write:!0}})],pt.prototype,"geometries",void 0),(0,a._)([(0,I.K)("geometries")],pt.prototype,"writeGeometry",null),(0,a._)([(0,l.MZ)({type:N.jz,json:{write:!0}})],pt.prototype,"rasterId",void 0),pt=vr=(0,a._)([(0,h.$)("esri.rest.support.ImagePixelLocationParameters")],pt);const Wi=pt;var _r;let qe=_r=class extends xe{constructor(){super(...arguments),this.type="point",this.geometry=null,this.is3D=!1}writeGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]=s.toJSON())}get measureOperation(){const{is3D:s,geometry:n}=this;return"point"===n.type?s?"point-3D":"point":s?"centroid-3D":"centroid"}clone(){return new _r((0,Z.o8)({geometry:this.geometry,is3D:this.is3D,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};(0,a._)([(0,l.MZ)({types:F.yR,json:{name:"fromGeometry",read:oe.rS}})],qe.prototype,"geometry",void 0),(0,a._)([(0,I.K)("geometry")],qe.prototype,"writeGeometry",null),(0,a._)([(0,l.MZ)({type:_e.apiValues,json:{read:_e.read,write:_e.write}})],qe.prototype,"measureOperation",null),(0,a._)([(0,l.MZ)({json:{read:!0}})],qe.prototype,"is3D",void 0),qe=_r=(0,a._)([(0,h.$)("esri.rest.support.ImagePointParameters")],qe);const Ki=qe;var Rr;let me=Rr=class extends T.oY{constructor(){super(...arguments),this.geometry=null,this.interpolation="nearest",this.mosaicRule=null,this.outFields=null,this.pixelSize=null,this.returnFirstValueOnly=!0,this.sampleDistance=null,this.sampleCount=null,this.sliceId=null,this.timeExtent=null}writeGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]=s.toJSON())}set locations(s){if(null!=s&&s.length){const n=new Oi.A({spatialReference:s[0].spatialReference});n.points=s.map(u=>[u.x,u.y]),this._set("locations",s),this.geometry=n}}clone(){return new Rr((0,Z.o8)({geometry:this.geometry,locations:this.locations,interpolation:this.interpolation,mosaicRule:this.mosaicRule,outFields:this.outFields,raster:this.raster,returnFirstValueOnly:this.returnFirstValueOnly,sampleDistance:this.sampleDistance,sampleCount:this.sampleCount,sliceId:this.sliceId,pixelSize:this.pixelSize,timeExtent:this.timeExtent}))}};(0,a._)([(0,l.MZ)({types:F.yR,json:{read:oe.rS}})],me.prototype,"geometry",void 0),(0,a._)([(0,I.K)("geometry")],me.prototype,"writeGeometry",null),(0,a._)([(0,l.MZ)()],me.prototype,"locations",null),(0,a._)([(0,l.MZ)({type:String,json:{type:de.SZ.jsonValues,read:de.SZ.read,write:de.SZ.write}})],me.prototype,"interpolation",void 0),(0,a._)([(0,l.MZ)({type:ve.A,json:{write:!0}})],me.prototype,"mosaicRule",void 0),(0,a._)([(0,l.MZ)({type:[String],json:{write:!0}})],me.prototype,"outFields",void 0),(0,a._)([(0,l.MZ)({type:ue.A,json:{write:!0}})],me.prototype,"pixelSize",void 0),(0,a._)([(0,l.MZ)({type:String,json:{write:!0}})],me.prototype,"raster",void 0),(0,a._)([(0,l.MZ)({type:Boolean,json:{write:!0}})],me.prototype,"returnFirstValueOnly",void 0),(0,a._)([(0,l.MZ)({type:Number,json:{write:!0}})],me.prototype,"sampleDistance",void 0),(0,a._)([(0,l.MZ)({type:Number,json:{write:!0}})],me.prototype,"sampleCount",void 0),(0,a._)([(0,l.MZ)({type:Number,json:{write:!0}})],me.prototype,"sliceId",void 0),(0,a._)([(0,l.MZ)({type:yr.A,json:{read:{source:"time"},write:{target:"time"}}})],me.prototype,"timeExtent",void 0),me=Rr=(0,a._)([(0,h.$)("esri.rest.support.ImageSampleParameters")],me);const Hi=me;let ke=class extends((0,y.O)(T.oY)){constructor(){super(...arguments),this.geometries=[],this.rasterIds=null,this.outSpatialReference=null}writeGeometries(s,n,u){n.geometries=null!=s&&s.length?{geometryType:(0,oe.$B)(s[0]),geometries:s.map(t=>({...t.toJSON(),spatialReference:void 0}))}:null}};(0,a._)([(0,l.MZ)({types:[F.yR]})],ke.prototype,"geometries",void 0),(0,a._)([(0,I.K)("geometries")],ke.prototype,"writeGeometries",null),(0,a._)([(0,l.MZ)({type:[N.jz],json:{write:!0}})],ke.prototype,"rasterIds",void 0),(0,a._)([(0,l.MZ)({type:Pe.A,json:{name:"outSR",write:!0}})],ke.prototype,"outSpatialReference",void 0),ke=(0,a._)([(0,h.$)("esri.rest.support.ImageToMapMultirayParameters")],ke);const Qi=ke;let Ue=class extends((0,y.O)(T.oY)){constructor(){super(...arguments),this.geometry=null,this.rasterId=null,this.outSpatialReference=null,this.depthOffset=0,this.adjust=!1}writeGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]={...s.toJSON(),spatialReference:void 0})}};(0,a._)([(0,l.MZ)({types:F.yR,json:{read:oe.rS,write:!0}})],Ue.prototype,"geometry",void 0),(0,a._)([(0,I.K)("geometry")],Ue.prototype,"writeGeometry",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],Ue.prototype,"rasterId",void 0),(0,a._)([(0,l.MZ)({type:Pe.A,json:{name:"outSR",write:!0}})],Ue.prototype,"outSpatialReference",void 0),(0,a._)([(0,l.MZ)({json:{name:"options.DOff",write:!0}})],Ue.prototype,"depthOffset",void 0),(0,a._)([(0,l.MZ)({json:{name:"options.Adjust",write:!0}})],Ue.prototype,"adjust",void 0),Ue=(0,a._)([(0,h.$)("esri.rest.support.ImageToMapParameters")],Ue);const Yi=Ue;let Zt=class extends((0,y.O)(T.oY)){constructor(){super(...arguments),this.referenceUri=null}};(0,a._)([(0,l.MZ)({type:String,json:{name:"uri",write:!0}})],Zt.prototype,"referenceUri",void 0),Zt=(0,a._)([(0,h.$)("esri.rest.support.ImageUrlParameters")],Zt);const Xi=Zt;let et=class extends((0,y.O)(T.oY)){constructor(){super(...arguments),this.geometry=null,this.rasterId=null,this.visibleOnly=!1}writeGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]=JSON.stringify(s))}};(0,a._)([(0,l.MZ)({types:F.yR,json:{read:oe.rS,write:!0}})],et.prototype,"geometry",void 0),(0,a._)([(0,I.K)("geometry")],et.prototype,"writeGeometry",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],et.prototype,"rasterId",void 0),(0,a._)([(0,l.MZ)({json:{name:"options.VisibleOnly",write:!0}})],et.prototype,"visibleOnly",void 0),et=(0,a._)([(0,h.$)("esri.rest.support.MapToImageParameters")],et);const qi=et;var Sr;let dt=Sr=class extends T.oY{constructor(){super(...arguments),this.geometry=null,this.rasterId=void 0}writeGeometry(s,n,u){null!=s&&(n.geometryType=(0,oe.$B)(s),n[u]={...s.toJSON(),spatialReference:void 0})}clone(){const s=(0,Z.o8)({geometry:this.geometry,rasterId:this.rasterId});return new Sr(s)}};(0,a._)([(0,l.MZ)({types:F.yR,json:{name:"fromGeometry",read:oe.rS,write:!0}})],dt.prototype,"geometry",void 0),(0,a._)([(0,I.K)("geometry")],dt.prototype,"writeGeometry",null),(0,a._)([(0,l.MZ)({json:{write:!0}})],dt.prototype,"rasterId",void 0),dt=Sr=(0,a._)([(0,h.$)("esri.rest.support.MeasureFromImageParameters")],dt);const Tr=dt;var ki=d(91551);const en=new Set(["png","png8","png24","png32","jpg","bmp","gif","jpgpng","lerc","tiff"]),tn=(0,l.Qp)(N.GB,{min:0,max:255}),nn=s=>{let n=class extends s{constructor(){super(...arguments),this._functionRasterInfos={},this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},this._cachedRendererJson=null,this._serviceSupportsMosaicRule=null,this._rasterAttributeTableFieldPrefix="Raster.",this.adjustAspectRatio=null,this.bandIds=void 0,this.capabilities=null,this.compressionQuality=void 0,this.compressionTolerance=.01,this.copyright=null,this.defaultMosaicRule=null,this.definitionExpression=null,this.exportImageServiceParameters=null,this.rasterInfo=null,this.fields=null,this.fullExtent=null,this.hasMultidimensions=!1,this.imageMaxHeight=4100,this.imageMaxWidth=4100,this.interpolation=void 0,this.minScale=0,this.maxScale=0,this.multidimensionalInfo=null,this.multidimensionalSubset=null,this.noData=null,this.noDataInterpretation=void 0,this.objectIdField=null,this.geometryType="polygon",this.typeIdField=null,this.types=[],this.pixelFilter=null,this.raster=void 0,this.sourceType=null,this.viewId=void 0,this.symbolizer=null,this.rasterFunctionInfos=null,this.serviceDataType=null,this.spatialReference=null,this.pixelType=null,this.serviceRasterInfo=null,this.sourceJSON=null,this.url=null,this.version=void 0}initialize(){this._set("exportImageServiceParameters",new se({layer:this}))}readServiceSupportsMosaicRule(t,r){return this._isMosaicRuleSupported(r)}get _rasterFunctionNamesIndex(){const t=new Map;return!this.rasterFunctionInfos||null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.length<1||null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.forEach(r=>{t.set(r.name.toLowerCase().replaceAll(/ /gi,"_"),r.name)}),t}readBandIds(t,r){if(Array.isArray(t)&&t.length>0&&t.every(i=>"number"==typeof i))return t}readCapabilities(t,r){return this._readCapabilities(r)}writeCompressionQuality(t,r,i){null!=t&&"lerc"!==this.format&&(r[i]=t)}writeCompressionTolerance(t,r,i){"lerc"===this.format&&null!=t&&(r[i]=t)}readDefaultMosaicRule(t,r){return this._serviceSupportsMosaicRule?ve.A.fromJSON(r):null}get fieldsIndex(){return this.fields?new Jr.A(this.fields):null}set format(t){t&&en.has(t.toLowerCase())&&this._set("format",t.toLowerCase())}readFormat(t,r){return"esriImageServiceDataTypeVector-UV"===r.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===r.serviceDataType||null!=this.pixelFilter?"lerc":"jpgpng"}readMinScale(t,r){return null!=r.minLOD&&null!=r.maxLOD?t:0}readMaxScale(t,r){return null!=r.minLOD&&null!=r.maxLOD?t:0}set mosaicRule(t){var r;let i=t;null!==(r=i)&&void 0!==r&&r.mosaicMethod&&(i=ve.A.fromJSON({...i.toJSON(),mosaicMethod:i.mosaicMethod,mosaicOperation:i.mosaicOperation})),this._set("mosaicRule",i)}readMosaicRule(t,r){const i=t||r.mosaicRule;return i?ve.A.fromJSON(i):this._isMosaicRuleSupported(r)?ve.A.fromJSON(r):null}writeMosaicRule(t,r,i){let p=this.mosaicRule;const c=this.definitionExpression;p?c&&c!==p.where&&(p=p.clone(),p.where=c):c&&(p=new ve.A({where:c})),this._isValidCustomizedMosaicRule(p)&&(r[i]=p.toJSON())}writeNoData(t,r,i){null!=t&&"number"==typeof t&&(r[i]=tn(t))}readObjectIdField(t,r){if(!t){const i=r.fields.find(p=>"esriFieldTypeOID"===p.type||"oid"===p.type);t=null==i?void 0:i.name}return t}get parsedUrl(){return(0,W.An)(this.url)}readSourceType(t,r){return this._isMosaicDataset(r)?"mosaic-dataset":"raster-dataset"}set renderer(t){this.loaded&&(t=this._configRenderer(t)),this._set("renderer",t)}readRenderer(t,r,i){var p;const c=null==r||null===(p=r.layerDefinition)||void 0===p||null===(p=p.drawingInfo)||void 0===p?void 0:p.renderer,f=(0,ne.LF)(c,i);return null==f?null:("vector-field"===f.type&&r.symbolTileSize&&!c.symbolTileSize&&(f.symbolTileSize=r.symbolTileSize),nt(f)||v.A.getLogger(this).warn("ArcGISImageService","Imagery layer doesn't support given renderer type."),f)}writeRenderer(t,r,i){r.layerDefinition=r.layerDefinition||{},r.layerDefinition.drawingInfo=r.layerDefinition.drawingInfo||{},r.layerDefinition.drawingInfo.renderer=t.toJSON(),"vector-field"===t.type&&(r.symbolTileSize=t.symbolTileSize)}get rasterFields(){var t,r;const i=this._rasterAttributeTableFieldPrefix,p=new Qe.A({name:"Raster.ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:"string"}),c=new Qe.A({name:"Raster.ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:"string"}),f=new Qe.A({name:"Raster.ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,editable:!1,length:50,type:"string"});let g=this.fields?(0,Z.o8)(this.fields):[];g.push(c),null!==(t=this.capabilities)&&void 0!==t&&t.operations.supportsQuery&&this.fields&&this.fields.length>0&&g.push(p),this.version>=10.4&&null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.some(E=>"none"===E.name.toLowerCase())&&g.push(f),null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.filter(E=>"none"!==E.name.toLowerCase()).forEach(E=>{g.push(new Qe.A({name:"Raster.ServicePixelValue."+E.name,alias:E.name,domain:null,editable:!1,length:50,type:"string"}))}),this._isVectorDataSet()&&(g.push(new Qe.A({name:"Raster.Magnitude",alias:"Magnitude",domain:null,editable:!1,type:"double"})),g.push(new Qe.A({name:"Raster.Direction",alias:"Direction",domain:null,editable:!1,type:"double"})));const{attributeTable:R}=null!==(r=this.rasterInfo)&&void 0!==r?r:{};if(null!=R){const E=R.fields.filter(S=>"esriFieldTypeOID"!==S.type&&"value"!==S.name.toLowerCase()).map(S=>{const w=(0,Z.o8)(S);return w.name=i+S.name,w});g=g.concat(E)}return g}get renderingRule(){return(0,P.Lx)(v.A.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this.rasterFunction}set renderingRule(t){(0,P.Lx)(v.A.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._set("rasterFunction",t)}set rasterFunction(t){var r;let i=t;null!==(r=i)&&void 0!==r&&r.rasterFunction&&(i=M.A.fromJSON({...i.toJSON(),rasterFunction:i.rasterFunction,rasterFunctionArguments:i.rasterFunctionArguments})),this._set("rasterFunction",i)}readRasterFunction(t,r){const i=r.rasterFunctionInfos;return r.renderingRule||null!=i&&i.length&&"None"!==i[0].name?this._isRFTJson(r.renderingRule)?M.A.fromJSON({rasterFunctionDefinition:r.renderingRule}):M.A.fromJSON(r.renderingRule||{rasterFunctionInfos:r.rasterFunctionInfos}):null}readSpatialReference(t,r){const i=t||r.extent.spatialReference;return i?Pe.A.fromJSON(i):null}readPixelType(t){return de.e8.fromJSON(t)||t}writePixelType(t,r,i){null!=this.serviceRasterInfo&&this.pixelType===this.serviceRasterInfo.pixelType||(r[i]=de.e8.toJSON(t))}readVersion(t,r){let i=r.currentVersion;return i||(i=r.hasOwnProperty("fields")||r.hasOwnProperty("timeInfo")?10:9.3),i}applyFilter(t){let r=t;return this.pixelFilter&&(r=this._clonePixelData(t),this.pixelFilter(r)),r}applyRenderer(t,r){var i=this;return(0,m.A)(function*(){let p=t;const{renderer:c,symbolizer:f,pixelFilter:g,bandIds:R}=i;if(!i._isPicture()&&c&&f&&!g){const E=JSON.stringify(i._cachedRendererJson)!==JSON.stringify(c.toJSON()),S=i._rasterJobHandler.instance;if(S){E&&(f.bind(),yield S.updateSymbolizer(f,r),i._cachedRendererJson=c.toJSON());const w=yield S.symbolize({bandIds:R,...t},r);p={extent:t.extent,pixelBlock:w}}else p={extent:t.extent,pixelBlock:f.symbolize({bandIds:R,...t})}}return p})()}destroy(){this._shutdownJobHandler()}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}computeAngles(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsComputeAngles)throw new o.A("imagery-layer:compute-angles","this operation is not supported on the input image service");return t=(0,N.PZ)(Ni,t).clone(),function ci(s,n,u){return Ut.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}computePixelSpaceLocations(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsComputePixelLocation)throw new o.A("imagery-layer:compute-pixel-space-locations","this operation is not supported on the input image service");return t=(0,N.PZ)(Wi,t).clone(),function mi(s,n,u){return Bt.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}computeHistograms(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsComputeHistograms)throw new o.A("imagery-layer:compute-histograms","this operation is not supported on the input image service");return t=(0,N.PZ)(gr.A,t).clone(),i._applyMosaicAndRenderingRules(t),function hi(s,n,u){return Gt.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}computeStatisticsHistograms(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsComputeStatisticsHistograms)throw new o.A("imagery-layer:compute-statistics-histograms","this operation is not supported on the input image service");return t=(0,N.PZ)(gr.A,t).clone(),i._applyMosaicAndRenderingRules(t),function yi(s,n,u){return Jt.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}measureHeight(t,r){var i=this;return(0,m.A)(function*(){const p=yield i._fetchCapabilities(null==r?void 0:r.signal);if(!("base-and-top"===t.operationType?p.mensuration.supportsHeightFromBaseAndTop:"base-and-top-shadow"===t.operationType?p.mensuration.supportsHeightFromBaseAndTopShadow:p.mensuration.supportsHeightFromTopAndTopShadow))throw new o.A("imagery-layer:measure-height","this operation is not supported on the input image service");return t=(0,N.PZ)($i,t).clone(),i._applyMosaicAndRenderingRules(t),function fi(s,n,u){return Kt.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}measureAreaAndPerimeter(t,r){var i=this;return(0,m.A)(function*(){const p=yield i._fetchCapabilities(null==r?void 0:r.signal);if(!p.mensuration.supportsAreaAndPerimeter||t.is3D&&!p.mensuration.supports3D)throw new o.A("imagery-layer:measure-area-and-perimeter","this operation is not supported on the input image service");return t=(0,N.PZ)(Vi,t).clone(),i._applyMosaicAndRenderingRules(t),function vi(s,n,u){return Ht.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}measureDistanceAndAngle(t,r){var i=this;return(0,m.A)(function*(){const p=yield i._fetchCapabilities(null==r?void 0:r.signal);if(!p.mensuration.supportsDistanceAndAngle||t.is3D&&!p.mensuration.supports3D)throw new o.A("imagery-layer:measure-distance-and-angle","this operation is not supported on the input image service");return t=(0,N.PZ)(Ui,t).clone(),i._applyMosaicAndRenderingRules(t),function Ri(s,n,u){return Yt.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}measurePointOrCentroid(t,r){var i=this;return(0,m.A)(function*(){const p=yield i._fetchCapabilities(null==r?void 0:r.signal);if(!p.mensuration.supportsPointOrCentroid||t.is3D&&!p.mensuration.supports3D)throw new o.A("imagery-layer:measure-point-or-centroid","this operation is not supported on the input image service");return t=(0,N.PZ)(Ki,t).clone(),i._applyMosaicAndRenderingRules(t),function _i(s,n,u){return Qt.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}measureLengthFromImage(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsMeasureFromImage)throw new o.A("imagery-layer:measure-length-from-image","this operation is not supported on the input image service");if("polyline"!==t.geometry.type)throw new o.A("imagery-layer:measure-length-from-image","this input geometry must be a polyline");return t=(0,N.PZ)(Tr,t).clone(),function Si(s,n,u){return qt.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}measureAreaFromImage(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsMeasureFromImage)throw new o.A("imagery-layer:measure-area-from-image","this operation is not supported on the input image service");if("polygon"!==t.geometry.type)throw new o.A("imagery-layer:measure-area-from-image","this input geometry must be a polygon");return t=(0,N.PZ)(Tr,t).clone(),function Mi(s,n,u){return kt.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}getField(t){const{fieldsIndex:r}=this;return null!=r?r.get(t):void 0}getFieldDomain(t,r){const i=this.getField(t);return i?i.domain:null}fetchImage(t,r,i,p={}){var c=this;return(0,m.A)(function*(){if(null==t||null==r||null==i)throw new o.A("imagery-layer:fetch-image","Insufficient parameters for requesting an image. A valid extent, width and height values are required.");if(c.renderer||c.symbolizer){const w=yield c._generateRasterInfo(c.rasterFunction,{signal:p.signal});w&&(c.rasterInfo=w)}const f=c.getExportImageServiceParameters(t,r,i,p.timeExtent);if(null==f){var g;if(p.requestAsImageElement&&c._canRequestImageElement(c.format)){const q=document.createElement("canvas");return q.width=r,q.height=i,p.returnImageBitmap?{imageBitmap:yield(0,Ar.m)(q,`${u(c.parsedUrl)}/exportImage`,p.signal)}:{imageOrCanvasElement:q}}const{bandIds:w,rasterInfo:V}=c,J=null!==(g=(null==w?void 0:w.length)||V.bandCount)&&void 0!==g?g:0,O=r*i,U=V.pixelType,B=[];for(let q=0;q<J;q++)B.push(Nt.A.createEmptyBand(U,O));return{pixelData:{pixelBlock:new Nt.A({width:r,height:i,pixels:B,mask:new Uint8Array(O),pixelType:U}),extent:t}}}const R=!!p.requestAsImageElement&&!c.pixelFilter;return c._requestArrayBuffer({imageServiceParameters:f,imageProps:{extent:t,width:r,height:i,format:c.format},requestAsImageElement:R,returnImageBitmap:R&&!!p.returnImageBitmap,signal:p.signal})})()}fetchKeyProperties(t){return(0,C.A)(u(this.parsedUrl)+"/keyProperties",{query:this._getQueryParams({renderingRule:this.version>=10.3?null==t?void 0:t.rasterFunction:null})}).then(r=>r.data)}fetchRasterAttributeTable(t){return this.version<10.1?Promise.reject(new o.A("#fetchRasterAttributeTable()","Failed to get rasterAttributeTable")):(0,C.A)(u(this.parsedUrl)+"/rasterAttributeTable",{query:this._getQueryParams({renderingRule:this.version>=10.3?null==t?void 0:t.rasterFunction:null})}).then(r=>br.A.fromJSON(r.data))}getCatalogItemRasterInfo(t,r){const i={...r,query:this._getQueryParams()};return function Zi(s,n,u){return pr.apply(this,arguments)}(u(this.parsedUrl),t,i)}getCatalogItemICSInfo(t,r){var i=this;return(0,m.A)(function*(){var p;const{data:c}=yield(0,C.A)(u(i.parsedUrl)+"/"+t+"/info/ics",{query:i._getQueryParams(),...r}),f=null==c?void 0:c.ics;if(!f)return;let g=null;try{g=(yield(0,C.A)(u(i.parsedUrl)+"/"+t+"/info",{query:i._getQueryParams(),...r})).data.extent}catch{}if(!g||!g.spatialReference)return{ics:f,icsToPixelTransform:null,icsExtent:null,northDirection:null};const R=i.version>=10.7?(0,C.A)(u(i.parsedUrl)+"/"+t+"/info/icstopixel",{query:i._getQueryParams(),...r}).then(H=>H.data).catch(()=>({})):{},E=g.spatialReference,S={geometries:JSON.stringify({geometryType:"esriGeometryEnvelope",geometries:[g]}),inSR:(0,z.YX)(E),outSR:"0:"+t},w=(0,C.A)(u(i.parsedUrl)+"/project",{query:i._getQueryParams(S),...r}).then(H=>H.data).catch(()=>({})),J=(g.xmin+g.xmax)/2,O=(g.ymax-g.ymin)/6,U=g.ymin+O,B=[];for(let H=0;H<5;H++)B.push({x:J,y:U+O*H});const q={geometries:JSON.stringify({geometryType:"esriGeometryPoint",geometries:B}),inSR:(0,z.YX)(E),outSR:"0:"+t},ge=(0,C.A)(u(i.parsedUrl)+"/project",{query:i._getQueryParams(q),...r}).then(H=>H.data).catch(()=>({})),te=yield Promise.all([R,w,ge]);let pe=te[0].ipxf;if(null==pe){var Be,je,Te;const H=null===(Be=f.geodataXform)||void 0===Be?void 0:Be.xf_0;"topup"===(null==H||null===(je=H.name)||void 0===je?void 0:je.toLowerCase())&&6===(null==H||null===(Te=H.coefficients)||void 0===Te?void 0:Te.length)&&(pe={affine:{name:"ics [sensor: Frame] to pixel (column, row) transformation",coefficients:H.coefficients,cellsizeRatio:0,type:"GeometricXform"}})}const He=ft.A.fromJSON(null===(p=te[1])||void 0===p||null===(p=p.geometries)||void 0===p?void 0:p[0]);He&&(He.spatialReference=new Pe.A({wkid:0,imageCoordinateSystem:f}));const ye=te[2].geometries?te[2].geometries.filter(H=>null!=(null==H?void 0:H.x)&&null!=H.y&&"NaN"!==H.x&&"NaN"!==H.y):[],le=ye.length;if(le<3)return{ics:f,icsToPixelTransform:pe,icsExtent:He,northDirection:null};let ie=0,he=0,Ee=0,Rt=0;for(let H=0;H<le;H++)ie+=ye[H].x,he+=ye[H].y,Ee+=ye[H].x*ye[H].x,Rt+=ye[H].x*ye[H].y;const Ze=(le*Rt-ie*he)/(le*Ee-ie*ie);let tt=0;const rt=ye[4].x>ye[0].x,it=ye[4].y>ye[0].y;return Ze===1/0?tt=it?90:270:0===Ze?tt=rt?0:180:Ze>0?tt=rt?180*Math.atan(Ze)/Math.PI:180*Math.atan(Ze)/Math.PI+180:Ze<0&&(tt=it?180+180*Math.atan(Ze)/Math.PI:360+180*Math.atan(Ze)/Math.PI),{ics:f,icsToPixelTransform:pe,icsExtent:He,northDirection:tt}})()}generateRasterInfo(t,r){var i=this;return(0,m.A)(function*(){var p;if(t=(0,N.PZ)(M.A,t),i.serviceRasterInfo&&(!t||"none"===(null===(p=t.functionName)||void 0===p?void 0:p.toLowerCase())||i._isVectorFieldResampleFunction(t)))return i.serviceRasterInfo;const c=function rn(s){if(!s)return null;const n=JSON.stringify(s).match(/"rasterFunction":"(.*?")/gi),u=null==n?void 0:n.map(t=>t.replace('"rasterFunction":"',"").replace('"',""));return u?u.join("/"):null}(t);if(!c)throw new o.A("imagery-layer:generate-raster-info","the rendering rule is not supported");if(i._functionRasterInfos[c])return i._functionRasterInfos[c];const f={...r,query:i._getQueryParams()},g=(0,ur.X6)(u(i.parsedUrl),t,f);i._functionRasterInfos[c]=g;try{return yield g}catch(R){throw i._functionRasterInfos[c]=null,R}})()}getExportImageServiceParameters(t,r,i,p){var c;const f=ut((t=t.clone().shiftCentralMeridian()).spatialReference,u(this.parsedUrl));this.pixelType!==this.serviceRasterInfo.pixelType&&(this.exportImageServiceParameters.pixelType=this.pixelType);const g=this.exportImageServiceParameters.toJSON(),{bandIds:R,noData:E}=g;let{renderingRule:S}=g;const w=null===(c=this.rasterFunction)||void 0===c?void 0:c.rasterFunctionDefinition,V=!this.renderer||"raster-stretch"===this.renderer.type;if(null!=R&&R.length&&this._hasRasterFunction(this.rasterFunction)&&!w&&V){const U={rasterFunction:"ExtractBand",rasterFunctionArguments:{BandIds:R}};if("Stretch"===S.rasterFunction)U.rasterFunctionArguments.Raster=S.rasterFunctionArguments.Raster,S.rasterFunctionArguments.Raster=U;else if("Colormap"===S.rasterFunction){const B=S.rasterFunctionArguments.Raster;"Stretch"===(null==B?void 0:B.rasterFunction)?(U.rasterFunctionArguments.Raster=B.rasterFunctionArguments.Raster,B.rasterFunctionArguments.Raster=U):(U.rasterFunctionArguments.Raster=B,S.rasterFunctionArguments.Raster=U)}else U.rasterFunctionArguments.Raster=S,S=U;g.bandIds=void 0}else g.bandIds=null==R?void 0:R.join(",");E instanceof Array&&E.length>0&&(g.noData=E.join(","));const J=this._processMultidimensionalIntersection(null,p,this.exportImageServiceParameters.mosaicRule);if(J.isOutSide)return null;g.mosaicRule=null!=J.mosaicRule?JSON.stringify(J.mosaicRule):null,p=J.timeExtent,g.renderingRule=this._getRenderingRuleString(M.A.fromJSON(S));const O={};if(null!=p){const{start:U,end:B}=p.toJSON();U&&B&&U===B?O.time=""+U:null==U&&null==B||(O.time=`${null!=U?U:"null"},${null!=B?B:"null"}`)}return{bbox:t.xmin+","+t.ymin+","+t.xmax+","+t.ymax,bboxSR:f,imageSR:f,size:r+","+i,...g,...O}}getSamples(t,r){var i=this;return(0,m.A)(function*(){const p=yield i._fetchCapabilities(null==r?void 0:r.signal);if(null==p||!p.operations.supportsGetSamples)throw new o.A("imagery-layer:get-samples","getSamples operation is not supported on the input image service");t=(0,N.PZ)(Hi,t).clone();const{raster:c}=i;return c&&null==t.raster&&(t.raster=c),function gi(s,n,u){return $t.apply(this,arguments)}(i.url,t,i._getRequestOptions(r))})()}identify(t,r){var i=this;return(0,m.A)(function*(){var p;if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsIdentify)throw new o.A("imagery-layer:identify","identify operation is not supported on the input image service");t=(0,N.PZ)(jr,t).clone(),i.version<10.91&&"extent"===(null===(p=t.geometry)||void 0===p?void 0:p.type)&&(t.geometry=At.A.fromExtent(t.geometry));const c=i._processMultidimensionalIntersection(t.geometry,t.timeExtent,t.mosaicRule||i.mosaicRule);if(c.isOutSide)throw new o.A("imagery-layer:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");t.timeExtent=c.timeExtent,t.mosaicRule=c.mosaicRule;const{raster:f,rasterFunction:g}=i;return g&&null==t.rasterFunction&&(t.rasterFunction=g),f&&null==t.raster&&(t.raster=f),Dr(i.url,t,i._getRequestOptions(r))})()}imageToMap(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsImageToMap)throw new o.A("imagery-layer:image-to-map","imageToMap operation is not supported on the input image service");return t=(0,N.PZ)(Yi,t),function Ai(s,n,u){return ir.apply(this,arguments)}(u(i.parsedUrl),t,i._getRequestOptions(r))})()}imageToMapMultiray(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsImageToMapMultiray)throw new o.A("imagery-layer:image-to-map-multiray","imageToMapMultiray operation is not supported on the input image service");return t=(0,N.PZ)(Qi,t),function wi(s,n,u){return nr.apply(this,arguments)}(u(i.parsedUrl),t,i._getRequestOptions(r))})()}mapToImage(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsMapToImage)throw new o.A("imagery-layer:map-to-image","mapToImage operation is not supported on the input image service");return t=(0,N.PZ)(qi,t),function Fi(s,n,u){return sr.apply(this,arguments)}(u(i.parsedUrl),t,i._getRequestOptions(r))})()}findImages(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsFindImages)throw new o.A("imagery-layer:find-images","findImages operation is not supported on the input image service");return t=(0,N.PZ)(Ci,t),function Pi(s,n,u){return ar.apply(this,arguments)}(u(i.parsedUrl),t,i._getRequestOptions(r))})()}getImageUrl(t,r){var i=this;return(0,m.A)(function*(){if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsGetImageUrl)throw new o.A("imagery-layer:get-image-url","getImageUrl operation is not supported on the input image service");return t=(0,N.PZ)(Xi,t),function bi(s,n,u){return or.apply(this,arguments)}(u(i.parsedUrl),t,i._getRequestOptions(r))})()}createQuery(){const t=new lr.A;return t.outFields=["*"],t.returnGeometry=!0,t.where=this.definitionExpression||"1=1",t}queryBoundary(t,r){var i=this;return(0,m.A)(function*(){var p;if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsQueryBoundary)throw new o.A("imagery-layer:query-boundary","queryBoundary operation is not supported on the input image service");return t=(0,N.PZ)(zi,null!==(p=t)&&void 0!==p?p:{outSpatialReference:i.spatialReference}).clone(),function Ii(s,n,u){return tr.apply(this,arguments)}(u(i.parsedUrl),t,i._getRequestOptions(r))})()}queryRasters(t,r){var i=this;return(0,m.A)(function*(){return({query:t,requestOptions:r}=yield i._prepareForQuery(t,r)),(0,Di.s)(i.url,t,r)})()}queryObjectIds(t,r){var i=this;return(0,m.A)(function*(){return({query:t,requestOptions:r}=yield i._prepareForQuery(t,r)),(0,Ti.V)(i.url,t,r)})()}queryGPSInfo(t,r){var i=this;return(0,m.A)(function*(){var p;if(!(yield i._fetchCapabilities(null==r?void 0:r.signal)).operations.supportsQueryGPSInfo)throw new o.A("imagery-layer:query-gps-info","queryGPSInfo operation is not supported on the input image service");return t=(0,N.PZ)(Gi,null!==(p=t)&&void 0!==p?p:{outSpatialReference:i.spatialReference}).clone(),function xi(s,n,u){return rr.apply(this,arguments)}(u(i.parsedUrl),t,i._getRequestOptions(r))})()}queryRasterCount(t,r){var i=this;return(0,m.A)(function*(){return({query:t,requestOptions:r}=yield i._prepareForQuery(t,r)),(0,ji.I)(i.url,t,r)})()}queryVisibleRasters(t,r){var i=this;return(0,m.A)(function*(){var p;if(!t)throw new o.A("imagery-layer: query-visible-rasters","missing query parameter");yield i.load();const{pixelSize:c,returnDomainValues:f,returnTopmostRaster:g,showNoDataRecords:R}=r||{pixelSize:null,returnDomainValues:!1,returnTopmostRaster:!1,showNoDataRecords:!1};let E=!1,S=null,w=null;const V="raster.servicepixelvalue",J=i._rasterFunctionNamesIndex;if(null!=t.outFields&&(E=t.outFields.some(le=>!le.toLowerCase().includes(V)),i.version>=10.4)){const le=t.outFields.filter(he=>he.toLowerCase().includes(V)&&he.length>24).map(he=>{const Ee=he.slice(25);return[i._updateRenderingRulesFunctionName(Ee,J),Ee]});S=le.map(he=>new M.A({functionName:he[0]})),w=le.map(he=>he[1]);const{rasterFunction:ie}=i;0===S.length?null!=ie&&ie.functionName?(S.push(ie),w.push(ie.functionName)):S=null:null!=ie&&ie.functionName&&!S.some(he=>he.functionName===ie.functionName)&&(S.push(ie),w.push(ie.functionName))}const O=null==t.outSpatialReference||t.outSpatialReference.equals(i.spatialReference),{multidimensionalSubset:U}=i;let B=t.timeExtent||i.timeExtent;if(U){var q;const{isOutside:le,intersection:ie}=(0,yt.Rp)(U,{geometry:t.geometry,timeExtent:t.timeExtent,multidimensionalDefinition:null===(q=i.exportImageServiceParameters.mosaicRule)||void 0===q?void 0:q.multidimensionalDefinition});if(le)throw new o.A("imagery-layer:query-visible-rasters","the request cannot be fulfilled when falling outside of the multidimensional subset");null!=(null==ie?void 0:ie.timeExtent)&&(B=ie.timeExtent)}const ge=i._combineMosaicRuleWithTimeExtent(i.exportImageServiceParameters.mosaicRule,B);let te=t.geometry;i.version<10.91&&"extent"===(null===(p=te)||void 0===p?void 0:p.type)&&(te=At.A.fromExtent(te));const pe=i._getQueryParams({geometry:te,timeExtent:B,mosaicRule:ge,rasterFunction:i.version<10.4?i.rasterFunction:null,rasterFunctions:S,pixelSize:c,returnCatalogItems:E,returnGeometry:O,raster:i.raster,maxItemCount:g?1:null});delete pe.f;const Be=new jr(pe);try{var je,Te,He,ye;yield i._generateRasterInfo(i.rasterFunction);const le=yield Dr(i.url,Be,{signal:null==r?void 0:r.signal,query:{...i.customParameters}}),ie=t.outFields,he=null!=le.value&&le.value.toLowerCase().includes("nodata");if(!E||O||null==le||null===(je=le.catalogItems)||void 0===je||!je.features.length||!R&&he)return i._processVisibleRastersResponse(le,{returnDomainValues:f,templateRRFunctionNames:w,showNoDataRecords:R,templateFields:ie});const Ee=i.objectIdField||"ObjectId",Rt=null!==(Te=null===(He=le.catalogItems)||void 0===He?void 0:He.features)&&void 0!==Te?Te:[],Ze=Rt.map(it=>{var H;return null===(H=it.attributes)||void 0===H?void 0:H[Ee]}),tt=new lr.A({objectIds:Ze,returnGeometry:!0,outSpatialReference:t.outSpatialReference,outFields:[Ee]}),rt=yield i.queryRasters(tt);return null!=rt&&null!==(ye=rt.features)&&void 0!==ye&&ye.length&&rt.features.forEach(it=>{Rt.forEach(H=>{H.attributes[Ee]===it.attributes[Ee]&&(H.geometry=new At.A(it.geometry),null!=t.outSpatialReference&&(H.geometry.spatialReference=t.outSpatialReference))})}),i._processVisibleRastersResponse(le,{returnDomainValues:f,templateRRFunctionNames:w,showNoDataRecords:R,templateFields:ie})}catch{throw new o.A("imagery-layer:query-visible-rasters","encountered error when querying visible rasters")}})()}fetchVariableStatisticsHistograms(t,r){var i=this;return(0,m.A)(function*(){const p=(0,C.A)(u(i.parsedUrl)+"/statistics",{query:i._getQueryParams({variable:t}),signal:r}).then(g=>{var R;return null===(R=g.data)||void 0===R?void 0:R.statistics}),c=(0,C.A)(u(i.parsedUrl)+"/histograms",{query:i._getQueryParams({variable:t}),signal:r}).then(g=>{var R;return null===(R=g.data)||void 0===R?void 0:R.histograms}),f=yield Promise.all([p,c]);return f[0]&&f[0].forEach(g=>{g.avg=g.mean,g.stddev=g.standardDeviation}),{statistics:f[0]||null,histograms:f[1]||null}})()}createFlowMesh(t,r){var i=this;return(0,m.A)(function*(){const p=i._rasterJobHandler.instance;return p?p.createFlowMesh(t,r):(0,ki.CW)(t.meshType,t.simulationSettings,t.flowData,null!=r.signal?r.signal:(new AbortController).signal)})()}getMultidimensionalSubsetVariables(t){return(0,yt.z2)(this.multidimensionalSubset,null!=t?t:this.serviceRasterInfo.multidimensionalInfo)}_fetchService(t){var r=this;return(0,m.A)(function*(){yield r._fetchServiceInfo(t),r.rasterInfo||(r.rasterInfo=r.serviceRasterInfo);const i=r.sourceJSON,p=null!=r.serviceRasterInfo?Promise.resolve(r.serviceRasterInfo):(0,ur.Tw)(u(r.parsedUrl),i,{signal:t,query:r._getQueryParams()}).then(g=>(r._set("serviceRasterInfo",g),r._set("multidimensionalInfo",g.multidimensionalInfo),(0,ur.E9)(g,i),g)),c=r._hasRasterFunction(r.rasterFunction)?r._generateRasterInfo(r.rasterFunction,{signal:t}):null,f=r._getRasterFunctionInfos();return Promise.all([p,c,f]).then(g=>{r._set("rasterInfo",g[1]?g[1]:g[0]),g[2]&&r._set("rasterFunctionInfos",g[2]),r.renderer&&!r._isSupportedRenderer(r.renderer)&&(r._set("renderer",null),v.A.getLogger(r).warn("ArcGISImageService","Switching to the default renderer. Renderer applied is not valid for this Imagery Layer")),r._set("renderer",r._configRenderer(r.renderer)),r.addHandles([(0,k.wB)(()=>r.rasterFunction,E=>{(r.renderer||r.symbolizer||r.popupEnabled&&r.popupTemplate)&&r._generateRasterInfo(E).then(S=>{S&&(r.rasterInfo=S)})})]);const{serviceRasterInfo:R}=r;null!=R.multidimensionalInfo&&r._updateMultidimensionalDefinition(R)})})()}_combineMosaicRuleWithTimeExtent(t,r){var i;const p=this.timeInfo,{multidimensionalInfo:c}=this.serviceRasterInfo;if(null==t||null==c||null==r||null==(null==p?void 0:p.startField))return t;const{startField:f}=p,g=c.variables.some(O=>O.dimensions.some(U=>U.name===f))?f:"StdTime";if(t=t.clone(),"mosaic-dataset"===this.sourceType)return t.multidimensionalDefinition=null===(i=t.multidimensionalDefinition)||void 0===i?void 0:i.filter(O=>O.dimensionName!==g),this._cleanupMultidimensionalDefinition(t);t.multidimensionalDefinition=t.multidimensionalDefinition||[];const R=t.multidimensionalDefinition.filter(O=>O.dimensionName===g),E=null!=r.start?r.start.getTime():null,S=null!=r.end?r.end.getTime():null,w=null==E||null==S||E===S,V=w?[E||S]:[[E,S]],J=this.version>=10.8;if(R.length)R.forEach(O=>{O.dimensionName===g&&(J?(O.dimensionName=null,O.isSlice=!1,O.values=[]):(O.isSlice=w,O.values=V))});else if(!J){const O=t.multidimensionalDefinition.filter(U=>null!=U.variableName&&null==U.dimensionName);O.length?O.forEach(U=>{U.dimensionName=g,U.isSlice=w,U.values=V}):t.multidimensionalDefinition.push(new X.A({variableName:"",dimensionName:g,isSlice:w,values:V}))}return this._cleanupMultidimensionalDefinition(t)}_cleanupMultidimensionalDefinition(t){return null==t?null:(t.multidimensionalDefinition&&(t.multidimensionalDefinition=t.multidimensionalDefinition.filter(r=>!(!r.variableName&&!r.dimensionName)),0===t.multidimensionalDefinition.length&&(t.multidimensionalDefinition=null)),"mosaic-dataset"!==this.sourceType&&null==t.multidimensionalDefinition?null:t)}_prepareForQuery(t,r){var i=this;return(0,m.A)(function*(){var p;if(!(yield i._fetchCapabilities(null===(p=r)||void 0===p?void 0:p.signal)).operations.supportsQuery)throw new o.A("imagery-layer:query-rasters","query operation is not supported on the input image service");return t=null!=t?(0,N.PZ)(lr.A,t):i.createQuery(),r=i._getRequestOptions(r),i.raster&&(r.query={...r.query,raster:i.raster}),{query:t,requestOptions:r}})()}_initJobHandler(){var t=this;return(0,m.A)(function*(){if(null!=t._rasterJobHandler.connectionPromise)return t._rasterJobHandler.connectionPromise;const r=new $r.A;t._rasterJobHandler.connectionPromise=r.initialize().then(()=>{t._rasterJobHandler.instance=r},()=>{}),yield t._rasterJobHandler.connectionPromise})()}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this._cachedRendererJson=null}_isSupportedRenderer(t){const{rasterInfo:r,rasterFunction:i}=this;return"unique-value"===t.type&&this._hasRasterFunction(i)&&1===(null==r?void 0:r.bandCount)&&["u8","s8"].includes(r.pixelType)||null!=r&&null!=t&&(0,Mt.fp)(r).includes(t.type)}_fetchCapabilities(t){var r=this;return(0,m.A)(function*(){return r.capabilities||(yield r._fetchServiceInfo(t)),r.capabilities})()}_fetchServiceInfo(t){var r=this;return(0,m.A)(function*(){var i;let p=r.sourceJSON;if(!p){const{data:c,ssl:f}=yield(0,C.A)(u(r.parsedUrl),{query:r._getQueryParams(),signal:t});p=c,r.sourceJSON=p,f&&(r.url=r.url.replace(/^http:/i,"https:"))}if((null===(i=p.capabilities)||void 0===i?void 0:i.toLowerCase().split(",").map(c=>c.trim()).indexOf("tilesonly"))>-1)throw new o.A("imagery-layer:fetch-service-info","use ImageryTileLayer to open tiles-only image services");r.read(p,{origin:"service",url:r.parsedUrl})})()}_isMosaicDataset(t){var r;return t.serviceSourceType?"esriImageServiceSourceTypeMosaicDataset"===t.serviceSourceType:(null===(r=t.fields)||void 0===r?void 0:r.length)>0}_isMosaicRuleSupported(t){var r;if(!t)return!1;const i=this._isMosaicDataset(t),p=t.currentVersion>=10.71&&t.hasMultidimensions&&!((null===(r=t.fields)||void 0===r?void 0:r.length)>1);return i||p}_isVectorFieldResampleFunction(t){if(null==t)return!1;const{functionName:r,functionArguments:i}=t,p="resample"===(null==r?void 0:r.toLowerCase()),c=(null==i?void 0:i.ResampleType)||(null==i?void 0:i.resampleType);return p&&(7===c||10===c)}_isPicture(){return!this.format||this.format.includes("jpg")||this.format.includes("png")}_configRenderer(t){const r=this._isPicture(),{rasterInfo:i}=this;if(!r&&!this.pixelFilter||this._isVectorDataSet()){var p;if(!this.bandIds&&i.bandCount>=3){const f=(0,Mt.ci)(i);!f||3===i.bandCount&&0===f[0]&&1===f[1]&&2===f[2]||(this.bandIds=f)}t||(t=(0,Mt.PD)(i,{bandIds:this.bandIds,variableName:this.rasterFunction?null:null===(p=this.mosaicRule)||void 0===p||null===(p=p.multidimensionalDefinition)||void 0===p?void 0:p[0].variableName}));const c=(0,Mt.$P)(t.toJSON());this.symbolizer?(this.symbolizer.rendererJSON=c,this.symbolizer.rasterInfo=i):this.symbolizer=new Kr.A({rendererJSON:c,rasterInfo:i}),this.symbolizer.bind().success||(this.symbolizer=null)}return t}_clonePixelData(t){return null==t?t:{extent:t.extent&&t.extent.clone(),pixelBlock:null!=t.pixelBlock?t.pixelBlock.clone():null}}_getQueryParams(t){null!=(null==t?void 0:t.renderingRule)&&"string"!=typeof t.renderingRule&&(t.renderingRule=this._getRenderingRuleString(t.renderingRule));const{raster:r,viewId:i}=this;return{raster:r,viewId:i,f:"json",...t,...this.customParameters}}_getRequestOptions(t){return{...t,query:{...null==t?void 0:t.query,...this.customParameters}}}_decodePixelBlock(t,r,i){return this._rasterJobHandler.instance?this._rasterJobHandler.instance.decode({data:t,options:r}):(0,Lt.D)(t,r,i)}_getRasterFunctionInfos(t){var r=this;return(0,m.A)(function*(){const i=r.sourceJSON.rasterFunctionInfos;return r.loaded?i:i&&r.version>=10.3?1===i.length&&"none"===i[0].name.toLowerCase()?i:null===(p=(yield(0,C.A)(u(r.parsedUrl)+"/rasterFunctionInfos",{query:r._getQueryParams(),signal:t})).data)||void 0===p?void 0:p.rasterFunctionInfos:null;var p})()}_canRequestImageElement(t){return!this.pixelFilter&&(!t||t.includes("png"))}_requestArrayBuffer(t){var r=this;return(0,m.A)(function*(){const{imageProps:i,requestAsImageElement:p,returnImageBitmap:c,signal:f}=t;if(p&&r._canRequestImageElement(i.format)){const O=`${u(r.parsedUrl)}/exportImage`,{data:U}=yield(0,C.A)(O,{responseType:c?"blob":"image",query:r._getQueryParams({f:"image",...r.refreshParameters,...t.imageServiceParameters}),signal:f});return U instanceof Blob?{imageBitmap:yield(0,Ar.m)(U,O,f),params:i}:{imageOrCanvasElement:U,params:i}}const g=r._initJobHandler(),R=(0,C.A)(u(r.parsedUrl)+"/exportImage",{responseType:"array-buffer",query:r._getQueryParams({f:"image",...t.imageServiceParameters}),signal:f}),E=(yield Promise.all([R,g]))[0].data,S=i.format||"jpgpng";let w=S;if("bsq"!==w&&"bip"!==w&&(w=(0,Lt.g)(E)),!w)throw new o.A("imagery-layer:fetch-image","unsupported format signature "+String.fromCharCode.apply(null,new Uint8Array(E)));const V={signal:f};return{pixelData:{pixelBlock:yield"gif"===S||"bmp"===S||S.includes("png")&&("png"===w||"jpg"===w)?(0,Lt.D)(E,{useCanvas:!0,...i},V):r._decodePixelBlock(E,{width:i.width,height:i.height,planes:null,pixelType:null,noDataValue:null,format:S},V),extent:i.extent},params:i}})()}_generateRasterInfo(t,r){return this.generateRasterInfo(t,r).catch(()=>null)}_isValidCustomizedMosaicRule(t){var r;return t&&JSON.stringify(t.toJSON())!==JSON.stringify(null===(r=this.defaultMosaicRule)||void 0===r?void 0:r.toJSON())}_updateMultidimensionalDefinition(t){if(this._isValidCustomizedMosaicRule(this.mosaicRule))return;let r=(0,yt.fy)(t,{multidimensionalSubset:this.multidimensionalSubset});if(null!=r&&r.length>0){var i;this.mosaicRule=this.mosaicRule||new ve.A;const p=this.mosaicRule.multidimensionalDefinition;!this.sourceJSON.defaultVariableName&&this.rasterFunction&&"none"!==(null===(i=this.rasterFunction.functionName)||void 0===i?void 0:i.toLowerCase())&&r.forEach(c=>c.variableName=""),r=r.filter(({variableName:c,dimensionName:f})=>c&&"*"!==c||f),(null==p||!p.length)&&r.length&&(this.mosaicRule.multidimensionalDefinition=r)}}_processVisibleRastersResponse(t,r){var i,p;r=r||{};const c=t.value,{templateRRFunctionNames:f,showNoDataRecords:g,returnDomainValues:R,templateFields:E}=r,S=t.processedValues;let w=null===(i=t.catalogItems)||void 0===i?void 0:i.features,V=(null===(p=t.properties)||void 0===p||null===(p=p.Values)||void 0===p?void 0:p.map(te=>te.replaceAll(/ /gi,", ")))||[];const J=this.objectIdField||"ObjectId",O="string"==typeof c&&c.toLowerCase().includes("nodata"),U=[];if(c&&!w&&!O){const te={};te[J]=0,V=[c],w=[new Q.A(this.fullExtent,null,te)]}if(!w)return[];let B,q,ge;this._updateResponseFieldNames(w,E),O&&!g&&(w=[]);for(let te=0;te<w.length;te++){if(B=w[te],null!=c){if(q=V[te],ge=this.rasterFunction&&S&&S.length>0&&f&&f.length>0&&f.includes(this.rasterFunction.functionName)?S[f.indexOf(this.rasterFunction.functionName)]:c,"nodata"===q.toLowerCase()&&!g)continue;const Be="Raster.ServicePixelValue";B.attributes["Raster.ItemPixelValue"]=q,B.attributes[Be]=ge,this._updateFeatureWithMagDirValues(B,q);const je=this.fields&&this.fields.length>0;let Te=this.rasterFunction&&null!=this.serviceRasterInfo.attributeTable?je?q:c:ge;this.rasterFunction||(Te=je?q:c),this._updateFeatureWithRasterAttributeTableValues(B,Te)}if(B.sourceLayer=B.layer=this,R&&this._updateFeatureWithDomainValues(B),f&&S&&f.length===S.length)for(let pe=0;pe<f.length;pe++)B.attributes["Raster.ServicePixelValue."+f[pe]]=S[pe];U.push(w[te])}return U}_processMultidimensionalIntersection(t,r,i){var p;const{multidimensionalSubset:c}=this;if(!c)return{isOutSide:!1,timeExtent:r,mosaicRule:i=this._combineMosaicRuleWithTimeExtent(i,r)};if(c){const{isOutside:f,intersection:g}=(0,yt.Rp)(c,{geometry:t,timeExtent:r});if(f)return{isOutSide:!0,timeExtent:null,mosaicRule:null};null!=(null==g?void 0:g.timeExtent)&&(r=g.timeExtent)}if(null!==(p=i=this._combineMosaicRuleWithTimeExtent(i,r))&&void 0!==p&&p.multidimensionalDefinition){const{isOutside:f}=(0,yt.Rp)(c,{multidimensionalDefinition:i.multidimensionalDefinition});if(f)return{isOutSide:!0,timeExtent:null,mosaicRule:null}}return{isOutSide:!1,timeExtent:r,mosaicRule:i}}_updateFeatureWithRasterAttributeTableValues(t,r){const i=this.rasterInfo.attributeTable||this.serviceRasterInfo.attributeTable;if(null==i)return;const{features:p,fields:c}=i,f=c.map(R=>R.name).find(R=>"value"===R.toLowerCase());if(!f)return;const g=p.filter(R=>R.attributes[f]===(null!=r?parseInt(r,10):null));g&&g[0]&&c.forEach(R=>{t.attributes[this._rasterAttributeTableFieldPrefix+R.name]=g[0].attributes[R.name]})}_updateFeatureWithMagDirValues(t,r){if(!this._isVectorDataSet())return;const i=r.split(/,\s*/).map(R=>parseFloat(R)),p=i.map(R=>[R]),c=i.map(R=>({minValue:R,maxValue:R,noDataValue:null})),f=new Nt.A({height:1,width:1,pixelType:"f32",pixels:p,statistics:c});null!=this.pixelFilter&&this.pixelFilter({pixelBlock:f,extent:new ft.A(0,0,0,0,this.spatialReference)});const g="esriImageServiceDataTypeVector-MagDir"===this.serviceDataType?[f.pixels[0][0],f.pixels[1][0]]:(0,Wr.Lu)([f.pixels[0][0],f.pixels[1][0]]);t.attributes["Raster.Magnitude"]=g[0],t.attributes["Raster.Direction"]=g[1]}_updateFeatureWithDomainValues(t){const r=this.fields&&this.fields.filter(i=>i.domain&&"coded-value"===i.domain.type);null!=r&&r.forEach(i=>{const p=t.attributes[i.name];if(null!=p){const c=i.domain.codedValues.find(f=>f.code===p);c&&(t.attributes[i.name]=c.name)}})}_updateResponseFieldNames(t,r){if(!r||r.length<1)return;const i=this.fieldsIndex;null!=i&&t.forEach(p=>{if(null!=p&&p.attributes)for(const f of r){var c;const g=null===(c=i.get(f))||void 0===c?void 0:c.name;g&&g!==f&&(p.attributes[f]=p.attributes[g],delete p.attributes[g])}})}_getRenderingRuleString(t){if(t){var r;let i=t.toJSON();return i=null!==(r=i.rasterFunctionDefinition)&&void 0!==r?r:i,(i.thumbnail||i.thumbnailEx)&&(i.thumbnail=i.thumbnailEx=null),JSON.stringify(i)}return null}_hasRasterFunction(t){return null!=(null==t?void 0:t.functionName)&&"none"!==t.functionName.toLowerCase()}_updateRenderingRulesFunctionName(t,r){if(!t||t.length<1)return;if("Raw"===t)return t.replace("Raw","None");const i=t.toLowerCase().replaceAll(/ /gi,"_");return r.has(i)?r.get(i):t}_isRFTJson(t){return(null==t?void 0:t.name)&&t.arguments&&t.function&&t.hasOwnProperty("functionType")}_isVectorDataSet(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType}_applyMosaicAndRenderingRules(t){const{raster:r,mosaicRule:i,rasterFunction:p}=this;p&&t instanceof gr.A&&null==t.rasterFunction&&(t.rasterFunction=p),i&&null==t.mosaicRule&&(t.mosaicRule=i),r&&null==t.raster&&(t.raster=r)}_readCapabilities(t){var r;const i=t.capabilities?t.capabilities.toLowerCase().split(",").map(B=>B.trim()):["image","catalog"],{currentVersion:p,advancedQueryCapabilities:c,maxRecordCount:f}=t,g=i.includes("image"),R="esriImageServiceDataTypeElevation"===t.serviceDataType,E=!!(t.spatialReference||null!==(r=t.extent)&&void 0!==r&&r.spatialReference),S=i.includes("edit"),w=i.includes("mensuration")&&E,V=null==t.mensurationCapabilities?[]:t.mensurationCapabilities.toLowerCase().split(",").map(B=>B.trim()),J=w&&V.includes("basic"),O=this._isMosaicDataset(t)&&i.includes("catalog"),U=i.includes("download");return{data:{supportsAttachment:!1},operations:{supportsComputeHistograms:g,supportsExportImage:g,supportsIdentify:g,supportsImageToMap:p>=11.2&&O,supportsImageToMapMultiray:p>=11.2&&O,supportsMapToImage:p>=11.2&&O,supportsFindImages:p>=11.2&&O,supportsGetImageUrl:p>=11.2&&U,supportsMeasure:w,supportsMeasureFromImage:p>=11.2,supportsDownload:U,supportsQuery:O&&t.fields&&t.fields.length>0,supportsGetSamples:p>=10.2&&g,supportsProject:p>=10.3&&g,supportsComputeStatisticsHistograms:p>=10.4&&g,supportsQueryBoundary:p>=10.6&&g,supportsCalculateVolume:p>=10.7&&R,supportsComputePixelLocation:p>=10.7&&O,supportsComputeAngles:p>=10.91,supportsQueryGPSInfo:p>=11.2&&O,supportsAdd:S,supportsDelete:S,supportsEditing:S,supportsUpdate:S,supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsChangeTracking:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsExceedsLimitStatistics:!1,supportsQueryAnalytics:!1,supportsQueryTopFeatures:!1,supportsAsyncConvert3D:!1},query:{maxRecordCount:f,maxRecordCountFactor:void 0,supportsStatistics:!(null==c||!c.supportsStatistics),supportsOrderBy:!(null==c||!c.supportsOrderBy),supportsDistinct:!(null==c||!c.supportsDistinct),supportsPagination:!(null==c||!c.supportsPagination),supportsStandardizedQueriesOnly:!(null==c||!c.useStandardizedQueries),supportsPercentileStatistics:!(null==c||!c.supportsPercentileStatistics),supportsCentroid:!(null==c||!c.supportsReturningGeometryCentroid),supportsDistance:!(null==c||!c.supportsQueryWithDistance),supportsExtent:!(null==c||!c.supportsReturningQueryExtent),supportsGeometryProperties:!(null==c||!c.supportsReturningGeometryProperties),supportsHavingClause:!(null==c||!c.supportsHavingClause),supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsMaxRecordCountFactor:!1,supportsSqlExpression:!1,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!1,supportsCacheHint:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!(null==c||!c.supportsDefaultSR),supportsFullTextSearch:!1,supportsCompactGeometry:!1,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0},mensuration:{supportsDistanceAndAngle:J,supportsAreaAndPerimeter:J,supportsPointOrCentroid:J,supportsHeightFromBaseAndTop:w&&V.includes("base-top height"),supportsHeightFromBaseAndTopShadow:w&&V.includes("base-top shadow height"),supportsHeightFromTopAndTopShadow:w&&V.includes("top-top shadow height"),supports3D:w&&V.includes("3d")}}}};function u(t){var r;return null!==(r=null==t?void 0:t.path)&&void 0!==r?r:""}return(0,a._)([(0,l.MZ)({clonable:!1})],n.prototype,"_functionRasterInfos",void 0),(0,a._)([(0,l.MZ)({clonable:!1})],n.prototype,"_rasterJobHandler",void 0),(0,a._)([(0,l.MZ)({clonable:!1})],n.prototype,"_cachedRendererJson",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"_serviceSupportsMosaicRule",void 0),(0,a._)([(0,K.w)("_serviceSupportsMosaicRule",["currentVersion","fields"])],n.prototype,"readServiceSupportsMosaicRule",null),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"_rasterAttributeTableFieldPrefix",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"_rasterFunctionNamesIndex",null),(0,a._)([(0,l.MZ)()],n.prototype,"adjustAspectRatio",void 0),(0,a._)([(0,l.MZ)({type:[N.jz],json:{write:!0}})],n.prototype,"bandIds",void 0),(0,a._)([(0,K.w)("bandIds")],n.prototype,"readBandIds",null),(0,a._)([(0,l.MZ)({readOnly:!0,json:{read:!1}})],n.prototype,"capabilities",void 0),(0,a._)([(0,K.w)("service","capabilities",["capabilities","currentVersion","serviceDataType"])],n.prototype,"readCapabilities",null),(0,a._)([(0,l.MZ)({type:Number})],n.prototype,"compressionQuality",void 0),(0,a._)([(0,I.K)("compressionQuality")],n.prototype,"writeCompressionQuality",null),(0,a._)([(0,l.MZ)({type:Number})],n.prototype,"compressionTolerance",void 0),(0,a._)([(0,I.K)("compressionTolerance")],n.prototype,"writeCompressionTolerance",null),(0,a._)([(0,l.MZ)({json:{read:{source:"copyrightText"}}})],n.prototype,"copyright",void 0),(0,a._)([(0,l.MZ)({readOnly:!0,dependsOn:["_serviceSupportsMosaicRule"]})],n.prototype,"defaultMosaicRule",void 0),(0,a._)([(0,K.w)("defaultMosaicRule",["defaultMosaicMethod"])],n.prototype,"readDefaultMosaicRule",null),(0,a._)([(0,l.MZ)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],n.prototype,"definitionExpression",void 0),(0,a._)([(0,l.MZ)({readOnly:!0,constructOnly:!0})],n.prototype,"exportImageServiceParameters",void 0),(0,a._)([(0,l.MZ)()],n.prototype,"rasterInfo",void 0),(0,a._)([(0,l.MZ)({readOnly:!0,type:[Qe.A]})],n.prototype,"fields",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"fieldsIndex",null),(0,a._)([(0,l.MZ)({type:["png","png8","png24","png32","jpg","bmp","gif","jpgpng","lerc","tiff"],json:{write:!0}})],n.prototype,"format",null),(0,a._)([(0,K.w)("service","format",["serviceDataType"])],n.prototype,"readFormat",null),(0,a._)([(0,l.MZ)({type:ft.A})],n.prototype,"fullExtent",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"hasMultidimensions",void 0),(0,a._)([(0,l.MZ)({json:{read:{source:"maxImageHeight"}}})],n.prototype,"imageMaxHeight",void 0),(0,a._)([(0,l.MZ)({json:{read:{source:"maxImageWidth"}}})],n.prototype,"imageMaxWidth",void 0),(0,a._)([(0,l.MZ)({type:String,json:{type:de.SZ.jsonValues,read:de.SZ.read,write:de.SZ.write}})],n.prototype,"interpolation",void 0),(0,a._)([(0,l.MZ)()],n.prototype,"minScale",void 0),(0,a._)([(0,K.w)("service","minScale")],n.prototype,"readMinScale",null),(0,a._)([(0,l.MZ)()],n.prototype,"maxScale",void 0),(0,a._)([(0,K.w)("service","maxScale")],n.prototype,"readMaxScale",null),(0,a._)([(0,l.MZ)({type:ve.A})],n.prototype,"mosaicRule",null),(0,a._)([(0,K.w)("mosaicRule",["mosaicRule","defaultMosaicMethod"])],n.prototype,"readMosaicRule",null),(0,a._)([(0,I.K)("mosaicRule")],n.prototype,"writeMosaicRule",null),(0,a._)([(0,l.MZ)()],n.prototype,"multidimensionalInfo",void 0),(0,a._)([(0,l.MZ)({type:Gr.A,json:{write:!0}})],n.prototype,"multidimensionalSubset",void 0),(0,a._)([(0,l.MZ)({json:{type:N.jz}})],n.prototype,"noData",void 0),(0,a._)([(0,I.K)("noData")],n.prototype,"writeNoData",null),(0,a._)([(0,l.MZ)({type:String,json:{type:de.hm.jsonValues,read:de.hm.read,write:de.hm.write}})],n.prototype,"noDataInterpretation",void 0),(0,a._)([(0,l.MZ)({type:String,readOnly:!0,json:{read:{source:["fields"]}}})],n.prototype,"objectIdField",void 0),(0,a._)([(0,K.w)("objectIdField")],n.prototype,"readObjectIdField",null),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"geometryType",void 0),(0,a._)([(0,l.MZ)({})],n.prototype,"typeIdField",void 0),(0,a._)([(0,l.MZ)({})],n.prototype,"types",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"parsedUrl",null),(0,a._)([(0,l.MZ)({type:Function})],n.prototype,"pixelFilter",void 0),(0,a._)([(0,l.MZ)()],n.prototype,"raster",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"sourceType",void 0),(0,a._)([(0,K.w)("sourceType",["serviceSourceType","fields"])],n.prototype,"readSourceType",null),(0,a._)([(0,l.MZ)()],n.prototype,"viewId",void 0),(0,a._)([(0,l.MZ)({types:ne.uy,json:{name:"layerDefinition.drawingInfo.renderer",origins:{"web-scene":{types:ne.Gj,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:t=>({enabled:t&&"vector-field"!==t.type&&"flow"!==t.type})}}}}})],n.prototype,"renderer",null),(0,a._)([(0,K.w)("renderer")],n.prototype,"readRenderer",null),(0,a._)([(0,I.K)("renderer")],n.prototype,"writeRenderer",null),(0,a._)([(0,l.MZ)({clonable:!1})],n.prototype,"symbolizer",void 0),(0,a._)([(0,l.MZ)(j.ke)],n.prototype,"opacity",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"rasterFields",null),(0,a._)([(0,l.MZ)({constructOnly:!0})],n.prototype,"rasterFunctionInfos",void 0),(0,a._)([(0,l.MZ)({type:M.A})],n.prototype,"renderingRule",null),(0,a._)([(0,l.MZ)({type:M.A,json:{name:"renderingRule"}})],n.prototype,"rasterFunction",null),(0,a._)([(0,K.w)("rasterFunction",["renderingRule","rasterFunctionInfos"])],n.prototype,"readRasterFunction",null),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"serviceDataType",void 0),(0,a._)([(0,l.MZ)({readOnly:!0,type:Pe.A})],n.prototype,"spatialReference",void 0),(0,a._)([(0,K.w)("spatialReference",["spatialReference","extent"])],n.prototype,"readSpatialReference",null),(0,a._)([(0,l.MZ)({json:{type:de.e8.jsonValues}})],n.prototype,"pixelType",void 0),(0,a._)([(0,K.w)("pixelType")],n.prototype,"readPixelType",null),(0,a._)([(0,I.K)("pixelType")],n.prototype,"writePixelType",null),(0,a._)([(0,l.MZ)({constructOnly:!0,type:wr.A})],n.prototype,"serviceRasterInfo",void 0),(0,a._)([(0,l.MZ)()],n.prototype,"sourceJSON",void 0),(0,a._)([(0,l.MZ)(j.OZ)],n.prototype,"url",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],n.prototype,"version",void 0),(0,a._)([(0,K.w)("version",["currentVersion","fields","timeInfo"])],n.prototype,"readVersion",null),n=(0,a._)([(0,h.$)("esri.layers.mixins.ArcGISImageService")],n),n};var sn=d(25936),on=d(93410),an=d(23e3),ln=d(17049),un=d(85551),pn=d(1151),dn=d(33036),cn=d(84311),mn=d(5540),yn=d(41843),Ct=d(71655);let fe=class extends((0,on.d)((0,cn.e)((0,dn.j)((0,ln.q)((0,un.A)(nn((0,pn.J)((0,an.d)((0,sn.b)((0,x.P)((0,y.O)(L.A)))))))))))){constructor(...s){var n;super(...s),n=this,this.isReference=null,this.operationalLayerType="ArcGISImageServiceLayer",this.popupEnabled=!0,this.popupTemplate=null,this.type="imagery",this._debouncedSaveOperations=(0,A.sg)(function(){var u=(0,m.A)(function*(t,r,i){const{save:p,saveAs:c}=yield Promise.all([d.e(2076),d.e(4973)]).then(d.bind(d,23518));switch(t){case Ct.X.SAVE:return p(n,r);case Ct.X.SAVE_AS:return c(n,i,r)}});return function(t,r,i){return u.apply(this,arguments)}}())}normalizeCtorArgs(s,n){return"string"==typeof s?{url:s,...n}:s}load(s){const n=null!=s?s.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},s).catch(A.QP).then(()=>this._fetchService(n))),Promise.resolve(this)}get legendEnabled(){var s;return!this._isPreviewLayer&&(null===(s=this._get("legendEnabled"))||void 0===s||s)}set legendEnabled(s){this._set("legendEnabled",s)}get listMode(){return this._isPreviewLayer?"hide":this._get("listMode")}set listMode(s){this._set("listMode",s)}writeOperationalLayerType(s,n,u){var t;const r="vector-field"===(null===(t=this.renderer)||void 0===t?void 0:t.type);n[u]=r?"ArcGISImageServiceVectorLayer":"ArcGISImageServiceLayer"}get defaultPopupTemplate(){return this.createPopupTemplate()}get _isPreviewLayer(){var s;return!(!this.raster||null===(s=this.url)||void 0===s||!s.toLowerCase().includes("/rasterrendering/imageserver"))}createPopupTemplate(s){var n;const u=this.rasterFields,t=this.title,r=new Set;let i=!1,p=!1;this.capabilities&&(i=this.capabilities.operations.supportsQuery&&this.fields&&this.fields.length>0,p="esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType);const c=new Set;i&&c.add("raster.itempixelvalue");for(const g of u){const R=g.name.toLowerCase();c.has(R)||R.includes("raster.servicepixelvalue.")||r.add(g.name)}p&&r.add("raster.magnitude").add("raster.direction");const f=(0,yn.tn)({fields:u,title:t},{...s,visibleFieldNames:r});return null!=f&&f.fieldInfos&&null!==(n=this.rasterInfo)&&void 0!==n&&n.pixelType.startsWith("f")&&f.fieldInfos.forEach(({format:g,fieldName:R})=>{g&&/^raster\.(item|service)pixelvalue/i.test(R)&&(g.places=2)}),f}queryFeatures(s,n){return this.queryRasters(s,n).then(u=>{if(null!=u&&u.features)for(const t of u.features)t.layer=t.sourceLayer=this;return u})}queryFeatureCount(s,n){return this.queryRasterCount(s,n)}redraw(){this.emit("redraw")}save(s){var n=this;return(0,m.A)(function*(){return n._debouncedSaveOperations(Ct.X.SAVE,s)})()}saveAs(s,n){var u=this;return(0,m.A)(function*(){return u._debouncedSaveOperations(Ct.X.SAVE_AS,n,s)})()}serviceSupportsSpatialReference(s){return(0,mn.D)(this,s)}write(s,n){return this._isPreviewLayer?(null!=n&&n.messages&&n.messages.push(new o.A("layer:unsupported",`Imagery preview layer (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${n.origin}/${n.layerContainerType||"operational-layers"}'`,{layer:this})),null):super.write(s,n)}};(0,a._)([(0,l.MZ)(j.fV)],fe.prototype,"legendEnabled",null),(0,a._)([(0,l.MZ)({type:["show","hide"]})],fe.prototype,"listMode",null),(0,a._)([(0,l.MZ)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],fe.prototype,"isReference",void 0),(0,a._)([(0,l.MZ)({type:["ArcGISImageServiceLayer"],json:{origins:{"web-map":{type:["ArcGISImageServiceLayer","ArcGISImageServiceVectorLayer"],read:!1,write:{target:"layerType",ignoreOrigin:!0}}}}})],fe.prototype,"operationalLayerType",void 0),(0,a._)([(0,I.K)("web-map","operationalLayerType")],fe.prototype,"writeOperationalLayerType",null),(0,a._)([(0,l.MZ)(j.M6)],fe.prototype,"popupEnabled",void 0),(0,a._)([(0,l.MZ)({type:D.A,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],fe.prototype,"popupTemplate",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],fe.prototype,"defaultPopupTemplate",null),(0,a._)([(0,l.MZ)({readOnly:!0,json:{read:!1}})],fe.prototype,"type",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],fe.prototype,"_isPreviewLayer",null),fe=(0,a._)([(0,h.$)("esri.layers.ImageryLayer")],fe);const hn=fe},42086:(ae,$,d)=>{d.d($,{N3:()=>a,Om:()=>m});class m{constructor(o=null,x={},A,l){this.geometry=o,this.attributes=x,this.centroid=A,this.objectId=l,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const o=new m(this.geometry,this.attributes,this.centroid,this.objectId);return o.displayId=this.displayId,o.geohashX=this.geohashX,o.geohashY=this.geohashY,o}clone(){var o,x;const A=null===(o=this.geometry)||void 0===o?void 0:o.clone(),l=new m(A,{...this.attributes},null===(x=this.centroid)||void 0===x?void 0:x.clone(),this.objectId);return l.displayId=this.displayId,l.geohashX=this.geohashX,l.geohashY=this.geohashY,l}}function a(y){var o;return!(null===(o=y.geometry)||void 0===o||null===(o=o.coords)||void 0===o||!o.length)}},61808:(ae,$,d)=>{d.d($,{A:()=>m});class m{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const D=new m;return D.objectIdFieldName=this.objectIdFieldName,D.globalIdFieldName=this.globalIdFieldName,D.geohashFieldName=this.geohashFieldName,D.geometryProperties=this.geometryProperties,D.geometryType=this.geometryType,D.spatialReference=this.spatialReference,D.hasZ=this.hasZ,D.hasM=this.hasM,D.features=this.features,D.fields=this.fields,D.transform=this.transform,D.exceededTransferLimit=this.exceededTransferLimit,D.uniqueIdField=this.uniqueIdField,D.queryGeometry=this.queryGeometry,D.queryGeometryType=this.queryGeometryType,D}}},13682:(ae,$,d)=>{d.d($,{A:()=>a});class a{constructor(y=[],o=[],x=!1){this.lengths=null!=y?y:[],this.coords=null!=o?o:[],this.hasIndeterminateRingOrder=x}static fromRect(y){const[o,x,A,l]=y,b=A-o,v=l-x;return new a([5],[o,x,b,0,0,v,-b,0,0,-v])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((y,o)=>y+o)}forEachVertex(y){let o=0;this.lengths.length||y(this.coords[0],this.coords[1]);for(let x=0;x<this.lengths.length;x++){const A=this.lengths[x];for(let l=0;l<A;l++)y(this.coords[2*(l+o)],this.coords[2*(l+o)+1]);o+=A}}deltaDecode(){const y=this.clone(),{coords:o,lengths:x}=y;let A=0;for(const l of x){for(let b=1;b<l;b++)o[2*(A+b)]+=o[2*(A+b)-2],o[2*(A+b)+1]+=o[2*(A+b)-1];A+=l}return y}clone(y){if(0===this.lengths.length)return new a([],[this.coords[0],this.coords[1]]);const o=2*(0===this.lengths.length?1:this.lengths.reduce((A,l)=>A+l)),x=this.coords.slice(0,o);return y?(y.set(x),new a(this.lengths,y,this.hasIndeterminateRingOrder)):new a(Array.from(this.lengths),Array.from(x),this.hasIndeterminateRingOrder)}}},25936:(ae,$,d)=>{d.d($,{b:()=>l});var m=d(8189),a=d(35150),D=d(85211),x=(d(3248),d(40707),d(76576)),A=d(68438);const l=b=>{let v=class extends b{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const _=(0,A.qg)(this.url);if(null!=_&&_.title)return _.title}return this._get("title")||""}set title(_){this._set("title",_)}set url(_){this._set("url",(0,A.Jf)(_,a.A.getLogger(this)))}};return(0,m._)([(0,D.MZ)()],v.prototype,"title",null),(0,m._)([(0,D.MZ)({type:String})],v.prototype,"url",null),v=(0,m._)([(0,x.$)("esri.layers.mixins.ArcGISService")],v),v}},73258:(ae,$,d)=>{d.d($,{A:()=>I});var m=d(5922),a=d(71065),D=d(35150),y=d(60797),o=d(24098),x=d(86300),A=d(22639),l=d(44549);const h=new Map;class I{static fromJSON(P){return new I(P.fields,P.timeZoneByFieldName)}static fromLayer(P){var Z;return new I(null!==(Z=P.fields)&&void 0!==Z?Z:[],ne(P))}static fromLayerJSON(P){var Z;return new I(null!==(Z=P.fields)&&void 0!==Z?Z:[],ne(P))}constructor(P=[],Z){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=P||[],this._timeZoneByFieldName=Z?new Map(Z):null;const k=[];for(const N of this.fields){const K=null==N?void 0:N.name,z=F(K);if(K&&z){var W;const j=L(K);this._fieldsMap.set(K,N),this._fieldsMap.set(j,N),this._normalizedFieldsMap.set(z,N),k.push(`${j}:${N.type}:${null===(W=this._timeZoneByFieldName)||void 0===W?void 0:W.get(K)}`),(0,x.vE)(N)?(this.dateFields.push(N),this._dateFieldsSet.add(N)):(0,x.WA)(N)&&(this._numericFieldsSet.add(N),this.numericFields.push(N)),(0,x.te)(N)||(0,x.Xz)(N)||(N.editable=null==N.editable||!!N.editable,N.nullable=null==N.nullable||!!N.nullable)}}k.sort(),this.uid=k.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const P of this.fields)(0,x.te)(P)||(0,x.Xz)(P)||P.nullable||void 0!==(0,x.lD)(P)||this._requiredFields.push(P)}return this._requiredFields}equals(P){return this.uid===(null==P?void 0:P.uid)}has(P){return null!=this.get(P)}get(P){var Z;if(!P)return;let k=this._fieldsMap.get(P);return k||(k=null!==(Z=this._fieldsMap.get(L(P)))&&void 0!==Z?Z:this._normalizedFieldsMap.get(F(P)),k&&this._fieldsMap.set(P,k),k)}getTimeZone(P){const Z=this.get(P&&"string"!=typeof P?P.name:P);return Z?this._timeZoneByFieldName?this._timeZoneByFieldName.get(Z.name):"date"===Z.type||"esriFieldTypeDate"===Z.type?(D.A.getLogger("esri.layers.support.FieldsIndex").error(new m.A("getTimeZone:no-timezone-information",`no time zone information for field '${Z.name}'`)),A.n$):Q.has(Z.type)?A.L5:null:null}getLuxonTimeZone(P){const Z=this.getTimeZone(P);return Z?Z===A.L5?o.GB.instance:Z===A.n$?l.mQ.utcInstance:(0,y.tE)(h,Z,()=>l.oh.create(Z)):null}isDateField(P){return this._dateFieldsSet.has(this.get(P))}isTimeOnlyField(P){return(0,x.OH)(this.get(P))}isNumericField(P){return this._numericFieldsSet.has(this.get(P))}normalizeFieldName(P){var Z,k;return null!==(Z=null===(k=this.get(P))||void 0===k?void 0:k.name)&&void 0!==Z?Z:void 0}toJSON(){return{fields:this.fields.map(P=>(0,a.Wj)(P)?P.toJSON():P),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function L(C){return C.trim().toLowerCase()}function F(C){var P,Z;return null!==(P=null===(Z=(0,x.rS)(C))||void 0===Z?void 0:Z.toLowerCase())&&void 0!==P?P:""}const Q=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function ne(C){var P,Z,k,W,N,K,z;const j=new Map;if(!C.fields)return j;const X=!0===C.datesInUnknownTimezone,{timeInfo:T,editFieldsInfo:M}=C,Y=null!==(P=T?"startField"in T?T.startField:T.startTimeField:"")&&void 0!==P?P:"",Ae=null!==(Z=T?"endField"in T?T.endField:T.endTimeField:"")&&void 0!==Z?Z:"",ee=function _(C){return"dateFieldsTimeZone"in C}(C)?null!==(k=C.dateFieldsTimeZone)&&void 0!==k?k:null:C.dateFieldsTimeReference?(0,A.ZS)(C.dateFieldsTimeReference):null,we=M?function b(C){return"timeZone"in C}(M)?null!==(W=M.timeZone)&&void 0!==W?W:ee:M.dateFieldsTimeReference?(0,A.ZS)(M.dateFieldsTimeReference):null!=ee?ee:A.n$:null,Je=T?function v(C){return"timeZone"in C}(T)?null!==(N=T.timeZone)&&void 0!==N?N:ee:T.timeReference?(0,A.ZS)(T.timeReference):ee:null,Fe=new Map([[L(null!==(K=null==M?void 0:M.creationDateField)&&void 0!==K?K:""),we],[L(null!==(z=null==M?void 0:M.editDateField)&&void 0!==z?z:""),we],[L(Y),Je],[L(Ae),Je]]);for(const{name:Ce,type:nt}of C.fields)if(Q.has(nt))j.set(Ce,A.L5);else if("date"!==nt&&"esriFieldTypeDate"!==nt)j.set(Ce,null);else if(X)j.set(Ce,A.L5);else{var Re;const ct=null!==(Re=Fe.get(L(null!=Ce?Ce:"")))&&void 0!==Re?Re:ee;j.set(Ce,ct)}return j}},63014:(ae,$,d)=>{d.d($,{C:()=>x,m:()=>y});var m=d(10467),a=d(5922),D=d(56492);function y(l,b,v){return o.apply(this,arguments)}function o(){return(o=(0,m.A)(function*(l,b,v){let _;try{_=yield createImageBitmap(l)}catch(h){throw new a.A("request:server",`Unable to load ${b}`,{url:b,error:h})}return(0,D.Te)(v),_})).apply(this,arguments)}function x(l,b,v,_,h){return A.apply(this,arguments)}function A(){return(A=(0,m.A)(function*(l,b,v,_,h){let I;try{I=yield createImageBitmap(l)}catch(L){throw new a.A("request:server",`Unable to load tile ${b}/${v}/${_}`,{error:L,level:b,row:v,col:_})}return(0,D.Te)(h),I})).apply(this,arguments)}},5540:(ae,$,d)=>{d.d($,{D:()=>D});var m=d(68438);const a=[];function D(y,o){var x;if((0,m.Wo)(null!==(x=y.url)&&void 0!==x?x:""))return!0;const{wkid:A}=o;for(const b of a){var l;if((null!==(l=y.version)&&void 0!==l?l:0)>=b[0])return!0;if("function"==typeof b[1]&&(b[1]=b[1]()),b[1].has(A))return!1}return!0}a.push([10.91,()=>{const y=new Set([9709,9716,9741,9761,9766]);for(let o=9712;o<=9713;o++)y.add(o);for(let o=9748;o<=9749;o++)y.add(o);for(let o=20904;o<=20932;o++)y.add(o);for(let o=21004;o<=21032;o++)y.add(o);for(let o=21207;o<=21264;o++)y.add(o);for(let o=21307;o<=21364;o++)y.add(o);for(let o=23301;o<=23333;o++)y.add(o);for(let o=102759;o<=102760;o++)y.add(o);for(let o=102934;o<=102955;o++)y.add(o);return y}]),a.push([10.9,()=>{const y=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let o=9356;o<=9360;o++)y.add(o);for(let o=9404;o<=9407;o++)y.add(o);for(let o=9476;o<=9482;o++)y.add(o);for(let o=9487;o<=9494;o++)y.add(o);for(let o=9697;o<=9699;o++)y.add(o);return y}]),a.push([10.81,()=>{const y=new Set([9265,9333,103598,103699]);for(let o=9248;o<=9254;o++)y.add(o);for(let o=9271;o<=9273;o++)y.add(o);for(let o=9284;o<=9285;o++)y.add(o);for(let o=21453;o<=21463;o++)y.add(o);return y}]),a.push([10.8,()=>{const y=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let o=8035;o<=8036;o++)y.add(o);for(let o=8455;o<=8456;o++)y.add(o);for(let o=8518;o<=8529;o++)y.add(o);for(let o=8533;o<=8536;o++)y.add(o);for(let o=8538;o<=8540;o++)y.add(o);for(let o=8677;o<=8679;o++)y.add(o);for(let o=8902;o<=8903;o++)y.add(o);for(let o=8907;o<=8910;o++)y.add(o);for(let o=8949;o<=8951;o++)y.add(o);for(let o=8972;o<=8987;o++)y.add(o);for(let o=9039;o<=9040;o++)y.add(o);for(let o=9068;o<=9069;o++)y.add(o);for(let o=9140;o<=9141;o++)y.add(o);for(let o=9148;o<=9150;o++)y.add(o);for(let o=9153;o<=9159;o++)y.add(o);for(let o=9205;o<=9218;o++)y.add(o);for(let o=9221;o<=9222;o++)y.add(o);for(let o=54098;o<=54101;o++)y.add(o);return y}]),a.push([10.71,()=>{const y=new Set([6316]);for(let o=8351;o<=8353;o++)y.add(o);for(let o=9294;o<=9297;o++)y.add(o);for(let o=22619;o<=22621;o++)y.add(o);for(let o=103586;o<=103594;o++)y.add(o);return y}]),a.push([10.7,()=>{const y=new Set([8387,8391,8427,8545,8682,8685,8818,31370,104022,104024,104975]);for(let o=8065;o<=8068;o++)y.add(o);for(let o=8082;o<=8083;o++)y.add(o);for(let o=8379;o<=8385;o++)y.add(o);for(let o=8836;o<=8840;o++)y.add(o);for(let o=8857;o<=8860;o++)y.add(o);for(let o=53035;o<=53037;o++)y.add(o);for(let o=54090;o<=54091;o++)y.add(o);for(let o=102498;o<=102499;o++)y.add(o);return y}]),a.push([10.61,()=>new Set([102497])]),a.push([10.6,()=>{const y=new Set([7803,7805,7887,8086,8232,8237,8240,8246,8249,8252,8255,9019,9391]);for(let o=7755;o<=7787;o++)y.add(o);for(let o=7791;o<=7795;o++)y.add(o);for(let o=7799;o<=7801;o++)y.add(o);for(let o=7825;o<=7831;o++)y.add(o);for(let o=7877;o<=7878;o++)y.add(o);for(let o=7882;o<=7883;o++)y.add(o);for(let o=7991;o<=7992;o++)y.add(o);for(let o=8042;o<=8043;o++)y.add(o);for(let o=8058;o<=8059;o++)y.add(o);for(let o=8311;o<=8348;o++)y.add(o);for(let o=9060;o<=9067;o++)y.add(o);for(let o=102562;o<=102568;o++)y.add(o);for(let o=102799;o<=102900;o++)y.add(o);return y}])},1832:(ae,$,d)=>{function m(a){const D={};for(const y in a){if("declaredClass"===y)continue;const o=a[y];if(null!=o&&"function"!=typeof o)if(Array.isArray(o)){D[y]=[];for(let x=0;x<o.length;x++)D[y][x]=m(o[x])}else"object"==typeof o?o.toJSON&&(D[y]=JSON.stringify(o)):D[y]=o}return D}d.d($,{z:()=>m})},33063:(ae,$,d)=>{d.d($,{I:()=>o});var m=d(10467),a=d(68800),D=d(1277),y=d(87086);function o(A,l,b){return x.apply(this,arguments)}function x(){return(x=(0,m.A)(function*(A,l,b){const v=(0,a.Dl)(A);return(0,D.gW)(v,y.A.from(l),{...b}).then(_=>_.data.count)})).apply(this,arguments)}},87342:(ae,$,d)=>{d.d($,{V:()=>o});var m=d(10467),a=d(68800),D=d(1277),y=d(87086);function o(A,l,b){return x.apply(this,arguments)}function x(){return(x=(0,m.A)(function*(A,l,b){const v=(0,a.Dl)(A);return(0,D.Pk)(v,y.A.from(l),{...b}).then(_=>_.data.objectIds)})).apply(this,arguments)}},34687:(ae,$,d)=>{d.d($,{e:()=>l,s:()=>x});var m=d(10467),a=d(68800),D=d(1277),y=d(93327),o=d(87086);function x(v,_,h){return A.apply(this,arguments)}function A(){return(A=(0,m.A)(function*(v,_,h){const I=yield l(v,_,h);return y.A.fromJSON(I)})).apply(this,arguments)}function l(v,_,h){return b.apply(this,arguments)}function b(){return(b=(0,m.A)(function*(v,_,h){const I=(0,a.Dl)(v),L={...h},F=o.A.from(_),{data:Q}=yield(0,D.eW)(I,F,F.sourceSpatialReference,L);return Q})).apply(this,arguments)}},1277:(ae,$,d)=>{d.d($,{IJ:()=>F,Jf:()=>Z,Pk:()=>C,eW:()=>I,gW:()=>P,kS:()=>ne});var m=d(10467),a=d(89563),D=d(45272),y=d(61320),o=d(77098),x=d(58701),A=d(1832),l=d(78304),b=d(98789);const v="Layer does not support extent calculation.";function h(z,j){var X;const T=z.geometry,M=z.toJSON();delete M.compactGeometryEnabled,delete M.defaultSpatialReferenceEnabled;const Y=M;let Ae,ee,we;if(null!=T&&(ee=T.spatialReference,we=(0,x.YX)(ee),Y.geometryType=(0,y.$B)(T),Y.geometry=function _(z,j){if(j&&"extent"===z.type)return`${z.xmin},${z.ymin},${z.xmax},${z.ymax}`;if(j&&"point"===z.type)return`${z.x},${z.y}`;const X=z.toJSON();return delete X.spatialReference,JSON.stringify(X)}(T,z.compactGeometryEnabled),Y.inSR=we),M.groupByFieldsForStatistics&&(Y.groupByFieldsForStatistics=M.groupByFieldsForStatistics.join(",")),M.objectIds&&(Y.objectIds=M.objectIds.join(",")),M.orderByFields&&(Y.orderByFields=M.orderByFields.join(",")),!M.outFields||!M.returnDistinctValues&&(null!=j&&j.returnCountOnly||null!=j&&j.returnExtentOnly||null!=j&&j.returnIdsOnly)?delete Y.outFields:Y.outFields=M.outFields.includes("*")?"*":M.outFields.join(","),M.outSR?(Y.outSR=(0,x.YX)(M.outSR),Ae=z.outSpatialReference):T&&(M.returnGeometry||M.returnCentroid)&&(Y.outSR=Y.inSR,Ae=ee),M.returnGeometry&&delete M.returnGeometry,M.outStatistics&&(Y.outStatistics=JSON.stringify(M.outStatistics)),M.fullText&&(Y.fullText=JSON.stringify(M.fullText)),M.pixelSize&&(Y.pixelSize=JSON.stringify(M.pixelSize)),M.quantizationParameters&&(z.defaultSpatialReferenceEnabled&&null!=ee&&null!=(null===(X=z.quantizationParameters)||void 0===X?void 0:X.extent)&&ee.equals(z.quantizationParameters.extent.spatialReference)&&delete M.quantizationParameters.extent.spatialReference,Y.quantizationParameters=JSON.stringify(M.quantizationParameters)),M.parameterValues&&(Y.parameterValues=JSON.stringify(M.parameterValues)),M.rangeValues&&(Y.rangeValues=JSON.stringify(M.rangeValues)),M.dynamicDataSource&&(Y.layer=JSON.stringify({source:M.dynamicDataSource}),delete M.dynamicDataSource),M.timeExtent){const Je=M.timeExtent,{start:Fe,end:Re}=Je;null==Fe&&null==Re||(Y.time=Fe===Re?Fe:`${null!=Fe?Fe:"null"},${null!=Re?Re:"null"}`),delete M.timeExtent}return z.defaultSpatialReferenceEnabled&&null!=ee&&null!=Ae&&ee.equals(Ae)&&(Y.defaultSR=Y.inSR,delete Y.inSR,delete Y.outSR),Y}function I(z,j,X,T){return L.apply(this,arguments)}function L(){return(L=(0,m.A)(function*(z,j,X,T){const M=null!=j.timeExtent&&j.timeExtent.isEmpty?{data:{features:[]}}:yield W(z,j,"json",T);return(0,b.q)(j,X,M.data),M})).apply(this,arguments)}function F(z,j,X,T){return Q.apply(this,arguments)}function Q(){return(Q=(0,m.A)(function*(z,j,X,T){if(null!=j.timeExtent&&j.timeExtent.isEmpty)return{data:X.createFeatureResult()};const M=yield ne(z,j,T),Y=M;return Y.data=(0,l.m)(M.data,X),Y})).apply(this,arguments)}function ne(z,j,X){return W(z,j,"pbf",X)}function C(z,j,X){return null!=j.timeExtent&&j.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):W(z,j,"json",X,{returnIdsOnly:!0})}function P(z,j,X){return null!=j.timeExtent&&j.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):W(z,j,"json",X,{returnIdsOnly:!0,returnCountOnly:!0})}function Z(z,j,X){return k.apply(this,arguments)}function k(){return(k=(0,m.A)(function*(z,j,X){if(null!=j.timeExtent&&j.timeExtent.isEmpty)return{data:{count:0,extent:null}};const T=yield W(z,j,"json",X,{returnExtentOnly:!0,returnCountOnly:!0}),M=T.data;if(M.hasOwnProperty("extent"))return T;if(M.features)throw new Error(v);if(M.hasOwnProperty("count"))throw new Error(v);return T})).apply(this,arguments)}function W(z,j,X){return N.apply(this,arguments)}function N(){return(N=(0,m.A)(function*(z,j,X,T={},M={}){const Y="string"==typeof z?(0,D.An)(z):z,Ae=j.geometry?[j.geometry]:[],ee=yield(0,o.el)(Ae,null,{signal:T.signal}),we=null==ee?void 0:ee[0];null!=we&&((j=j.clone()).geometry=we);const Je=(0,A.z)({...Y.query,f:X,...M,...h(j,M)});return(0,a.A)((0,D.fj)(Y.path,function K(z,j){return null!=z.formatOf3DObjects&&!(j.returnCountOnly||j.returnExtentOnly||j.returnIdsOnly)}(j,M)?"query3d":"query"),{...T,responseType:"pbf"===X?"array-buffer":"json",query:{...Je,...T.query}})})).apply(this,arguments)}},98789:(ae,$,d)=>{d.d($,{q:()=>a});var m=d(23743);function a(D,y,o){if(null==o||!o.features||!o.hasZ)return;const x=(0,m.N)(o.geometryType,y,D.outSpatialReference);if(null!=x)for(const A of o.features)x(A.geometry)}},70994:(ae,$,d)=>{d.d($,{A:()=>I});var v,m=d(8189),a=d(71065),D=d(85211),y=d(55739),A=(d(40707),d(3248),d(76576));const _={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let h=v=class extends a.oY{constructor(L){super(L),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:L}=this,F=function l(L){const{exifInfo:F,exifName:Q,tagName:ne}=L;if(!F||!Q||!ne)return null;const C=F.find(P=>P.name===Q);return C?function b(L){const{tagName:F,tags:Q}=L;if(!Q||!F)return null;const ne=Q.find(C=>C.name===F);return(null==ne?void 0:ne.value)||null}({tagName:ne,tags:C.tags}):null}({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:L});return _[F]||null}clone(){return new v({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};(0,m._)([(0,D.MZ)({type:String})],h.prototype,"contentType",void 0),(0,m._)([(0,D.MZ)()],h.prototype,"exifInfo",void 0),(0,m._)([(0,D.MZ)({readOnly:!0})],h.prototype,"orientationInfo",null),(0,m._)([(0,D.MZ)({type:y.jz})],h.prototype,"id",void 0),(0,m._)([(0,D.MZ)({type:String})],h.prototype,"globalId",void 0),(0,m._)([(0,D.MZ)({type:String})],h.prototype,"keywords",void 0),(0,m._)([(0,D.MZ)({type:String})],h.prototype,"name",void 0),(0,m._)([(0,D.MZ)({json:{read:!1}})],h.prototype,"parentGlobalId",void 0),(0,m._)([(0,D.MZ)({json:{read:!1}})],h.prototype,"parentObjectId",void 0),(0,m._)([(0,D.MZ)({type:y.jz})],h.prototype,"size",void 0),(0,m._)([(0,D.MZ)({json:{read:!1}})],h.prototype,"url",void 0),h=v=(0,m._)([(0,A.$)("esri.layers.support.AttachmentInfo")],h);const I=h},52466:(ae,$,d)=>{d.d($,{A:()=>v});var l,m=d(8189),a=d(71065),D=d(77806),y=d(85211),o=d(55739),x=d(76576),A=d(50305);let b=l=class extends a.oY{constructor(_){super(_),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(_,h){h.resultOffset=this.start,h.resultRecordCount=this.num||10}clone(){return new l((0,D.o8)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};(0,m._)([(0,y.MZ)({type:[String],json:{write:!0}})],b.prototype,"attachmentTypes",void 0),(0,m._)([(0,y.MZ)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],b.prototype,"attachmentsWhere",void 0),(0,m._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],b.prototype,"cacheHint",void 0),(0,m._)([(0,y.MZ)({type:[String],json:{write:!0}})],b.prototype,"keywords",void 0),(0,m._)([(0,y.MZ)({type:[Number],json:{write:!0}})],b.prototype,"globalIds",void 0),(0,m._)([(0,y.MZ)({json:{write:!0}})],b.prototype,"name",void 0),(0,m._)([(0,y.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],b.prototype,"num",void 0),(0,m._)([(0,y.MZ)({type:[Number],json:{write:!0}})],b.prototype,"objectIds",void 0),(0,m._)([(0,y.MZ)({type:Boolean,json:{default:!1,write:!0}})],b.prototype,"returnMetadata",void 0),(0,m._)([(0,y.MZ)({type:[Number],json:{write:!0}})],b.prototype,"size",void 0),(0,m._)([(0,y.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],b.prototype,"start",void 0),(0,m._)([(0,A.K)("start"),(0,A.K)("num")],b.prototype,"writeStart",null),(0,m._)([(0,y.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],b.prototype,"where",void 0),b=l=(0,m._)([(0,x.$)("esri.rest.support.AttachmentQuery")],b),b.from=(0,o.dp)(b);const v=b},59487:(ae,$,d)=>{d.r($),d.d($,{default:()=>I});var _,m=d(8189),D=(d(21152),d(71065)),y=d(77806),o=d(85211),x=d(55739),A=d(76576),l=d(50305),b=d(93164),v=d(32034);let h=_=class extends D.oY{constructor(L){super(L),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(L,F){F.historicMoment=L&&L.getTime()}writeStart(L,F){F.resultOffset=this.start,F.resultRecordCount=this.num||10,this.start>0&&null==this.where&&(F.definitionExpression="1=1")}clone(){return new _((0,y.o8)({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};(0,m._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],h.prototype,"cacheHint",void 0),(0,m._)([(0,o.MZ)({type:b.L,json:{write:!0}})],h.prototype,"dynamicDataSource",void 0),(0,m._)([(0,o.MZ)({type:String,json:{write:!0}})],h.prototype,"gdbVersion",void 0),(0,m._)([(0,o.MZ)({type:Number,json:{write:!0}})],h.prototype,"geometryPrecision",void 0),(0,m._)([(0,o.MZ)({type:Date})],h.prototype,"historicMoment",void 0),(0,m._)([(0,l.K)("historicMoment")],h.prototype,"_writeHistoricMoment",null),(0,m._)([(0,o.MZ)({type:Number,json:{write:!0}})],h.prototype,"maxAllowableOffset",void 0),(0,m._)([(0,o.MZ)({type:[Number],json:{write:!0}})],h.prototype,"objectIds",void 0),(0,m._)([(0,o.MZ)({type:[String],json:{write:!0}})],h.prototype,"orderByFields",void 0),(0,m._)([(0,o.MZ)({type:[String],json:{write:!0}})],h.prototype,"outFields",void 0),(0,m._)([(0,o.MZ)({type:v.A,json:{read:{source:"outSR"},write:{target:"outSR"}}})],h.prototype,"outSpatialReference",void 0),(0,m._)([(0,o.MZ)({json:{write:!0}})],h.prototype,"relationshipId",void 0),(0,m._)([(0,o.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],h.prototype,"start",void 0),(0,m._)([(0,l.K)("start"),(0,l.K)("num")],h.prototype,"writeStart",null),(0,m._)([(0,o.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],h.prototype,"num",void 0),(0,m._)([(0,o.MZ)({json:{write:!0}})],h.prototype,"returnGeometry",void 0),(0,m._)([(0,o.MZ)({type:Boolean,json:{write:{overridePolicy:L=>({enabled:L})}}})],h.prototype,"returnM",void 0),(0,m._)([(0,o.MZ)({type:Boolean,json:{write:{overridePolicy:L=>({enabled:L})}}})],h.prototype,"returnZ",void 0),(0,m._)([(0,o.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],h.prototype,"where",void 0),h=_=(0,m._)([(0,A.$)("esri.rest.support.RelationshipQuery")],h),h.from=(0,x.dp)(h);const I=h},61569:(ae,$,d)=>{d.d($,{A:()=>N});var F,m=d(8189),a=d(21152),D=d(12849),y=d(49976),o=d(71065),x=d(77806),A=d(85211),l=d(55739),b=d(76576),v=d(50305),_=d(61320);d(3248),d(35150),d(40707);let Q=F=class extends o.oY{constructor(K){super(K),this.groupByFields=void 0,this.topCount=void 0,this.orderByFields=void 0}clone(){return new F({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}};(0,m._)([(0,A.MZ)({type:[String],json:{write:!0}})],Q.prototype,"groupByFields",void 0),(0,m._)([(0,A.MZ)({type:Number,json:{write:!0}})],Q.prototype,"topCount",void 0),(0,m._)([(0,A.MZ)({type:[String],json:{write:!0}})],Q.prototype,"orderByFields",void 0),Q=F=(0,m._)([(0,b.$)("esri.rest.support.TopFilter")],Q);const ne=Q;var P,C=d(32034);const Z=new y.J({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),k=new y.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let W=P=class extends o.oY{constructor(K){super(K),this.cacheHint=void 0,this.distance=void 0,this.geometry=null,this.geometryPrecision=void 0,this.maxAllowableOffset=void 0,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.resultType=null,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.start=void 0,this.spatialRelationship="intersects",this.timeExtent=null,this.topFilter=void 0,this.units=null,this.where="1=1"}writeStart(K,z){z.resultOffset=this.start,z.resultRecordCount=this.num||10}clone(){return new P((0,x.o8)({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}};(0,m._)([(0,A.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"cacheHint",void 0),(0,m._)([(0,A.MZ)({type:Number,json:{write:{overridePolicy:K=>({enabled:K>0})}}})],W.prototype,"distance",void 0),(0,m._)([(0,A.MZ)({types:a.yR,json:{read:_.rS,write:!0}})],W.prototype,"geometry",void 0),(0,m._)([(0,A.MZ)({type:Number,json:{write:!0}})],W.prototype,"geometryPrecision",void 0),(0,m._)([(0,A.MZ)({type:Number,json:{write:!0}})],W.prototype,"maxAllowableOffset",void 0),(0,m._)([(0,A.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],W.prototype,"num",void 0),(0,m._)([(0,A.MZ)({json:{write:!0}})],W.prototype,"objectIds",void 0),(0,m._)([(0,A.MZ)({type:[String],json:{write:!0}})],W.prototype,"orderByFields",void 0),(0,m._)([(0,A.MZ)({type:[String],json:{write:!0}})],W.prototype,"outFields",void 0),(0,m._)([(0,A.MZ)({type:C.A,json:{read:{source:"outSR"},write:{target:"outSR"}}})],W.prototype,"outSpatialReference",void 0),(0,m._)([(0,A.MZ)({type:String,json:{write:!0}})],W.prototype,"resultType",void 0),(0,m._)([(0,A.MZ)({json:{write:!0}})],W.prototype,"returnGeometry",void 0),(0,m._)([(0,A.MZ)({type:Boolean,json:{write:{overridePolicy:K=>({enabled:K})}}})],W.prototype,"returnM",void 0),(0,m._)([(0,A.MZ)({type:Boolean,json:{write:{overridePolicy:K=>({enabled:K})}}})],W.prototype,"returnZ",void 0),(0,m._)([(0,A.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],W.prototype,"start",void 0),(0,m._)([(0,v.K)("start"),(0,v.K)("num")],W.prototype,"writeStart",null),(0,m._)([(0,A.MZ)({type:String,json:{read:{source:"spatialRel",reader:Z.read},write:{target:"spatialRel",writer:Z.write}}})],W.prototype,"spatialRelationship",void 0),(0,m._)([(0,A.MZ)({type:D.A,json:{write:!0}})],W.prototype,"timeExtent",void 0),(0,m._)([(0,A.MZ)({type:ne,json:{write:!0}})],W.prototype,"topFilter",void 0),(0,m._)([(0,A.MZ)({type:String,json:{read:k.read,write:{writer:k.write,overridePolicy(K){return{enabled:null!=K&&null!=this.distance&&this.distance>0}}}}})],W.prototype,"units",void 0),(0,m._)([(0,A.MZ)({type:String,json:{write:!0}})],W.prototype,"where",void 0),W=P=(0,m._)([(0,b.$)("esri.rest.support.TopFeaturesQuery")],W),W.from=(0,l.dp)(W);const N=W}}]);