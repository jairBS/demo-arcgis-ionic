"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9666],{69666:(ue,R,D)=>{D.r(R),D.d(R,{registerFunctions:()=>Ee});var C=D(10467),K=D(61299),W=D(45369),$=D(53787),o=D(55279),fe=D(63145),q=D(37049),P=D(15903),de=D(42970),t=D(42686),ce=D(32832),I=D(36455),j=D(888),me=D(93571),ye=D(53437),pe=D(62138),_e=D(6491),he=D(58314),X=D(7981),ee=D(97089),Z=D(59118),De=D(56492),A=D(40013),B=D(35940),S=D(29141),ne=D(73874);function H(l,n,r){return z.apply(this,arguments)}function z(){return(z=(0,C.A)(function*(l,n,r){const p=l.getVariables();if(p.length>0){const h=[];for(let e=0;e<p.length;e++){const i={name:p[e]};h.push(yield n.evaluateIdentifier(r,i))}const f={};for(let e=0;e<p.length;e++)f[p[e]]=h[e];return l.parameters=f,l}return l})).apply(this,arguments)}function y(l,n,r=null){for(const p in l)if(p.toLowerCase()===n.toLowerCase())return l[p];return r}function te(l){if(null===l)return null;const n={type:y(l,"type",""),name:y(l,"name","")};if("range"===n.type)n.range=y(l,"range",[]);else{n.codedValues=[];for(const r of y(l,"codedValues",[]))n.codedValues.push({name:y(r,"name",""),code:y(r,"code",null)})}return n}function G(l){if(null===l)return null;const n={},r=y(l,"wkt",null);null!==r&&(n.wkt=r);const p=y(l,"wkid",null);return null!==p&&(n.wkid=p),n}function ae(l){if(null===l)return null;const n={hasZ:y(l,"hasz",!1),hasM:y(l,"hasm",!1)},r=y(l,"spatialreference",null);r&&(n.spatialReference=G(r));const p=y(l,"x",null);if(null!==p)return n.x=p,n.y=y(l,"y",null),n.hasZ&&(n.z=y(l,"z",null)),n.hasM&&(n.m=y(l,"m",null)),n;const h=y(l,"rings",null);if(null!==h)return n.rings=h,n;const f=y(l,"paths",null);if(null!==f)return n.paths=f,n;const e=y(l,"points",null);if(null!==e)return n.points=e,n;for(const i of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const s=y(l,i,null);null!==s&&(n[i]=s)}return n}function N(l){return"utc"===(null==l?void 0:l.toLowerCase())?"UTC":"unknown"===(null==l?void 0:l.toLowerCase())?"Unknown":l}function Ee(l){"async"===l.mode&&(l.functions.timezone=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){var i,s,m,_;if((0,t.H)(e,1,2,n,r),(0,t.n)(e[0])||(0,t.m)(e[0]))return"Unknown";if((0,t.u)(e[0])){if(yield e[0].load(),1===e.length||null===e[1])return N(e[0].datesInUnknownTimezone?"unknown":e[0].dateFieldsTimeZone);if(!(e[1]instanceof $.A)||!1===e[1].hasField("type"))throw new o.D$(n,o.TX.InvalidParameter,r);const u=e[1].field("type");if(!1===(0,t.c)(u))throw new o.D$(n,o.TX.InvalidParameter,r);switch((0,t.j)(u).toLowerCase()){case"preferredtimezone":return N(e[0].preferredTimeZone);case"editfieldsinfo":return N(null!==(i=null===(s=e[0].editFieldsInfo)||void 0===s?void 0:s.timeZone)&&void 0!==i?i:null);case"timeinfo":return N(null!==(m=null===(_=e[0].timeInfo)||void 0===_?void 0:_.timeZone)&&void 0!==m?m:null);case"field":if(e[1].hasField("fieldname")&&(0,t.c)(e[1].field("fieldname")))return N(e[0].fieldTimeZone((0,t.j)(e[1].field("fieldname"))))}throw new o.D$(n,o.TX.InvalidParameter,r)}const d=(0,t.l)(e[0],(0,t.N)(n));if(null===d)return null;const a=d.timeZone;return"system"===a?K.lY.systemTimeZoneCanonicalName:"utc"===a.toLowerCase()?"UTC":"unknown"===a.toLowerCase()?"Unknown":a});return function(h,f,e){return p.apply(this,arguments)}}())},l.functions.sqltimestamp=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){(0,t.H)(e,1,3,n,r);const i=e[0];if((0,t.k)(i)){if(1===e.length)return i.toSQLWithKeyword();if(2===e.length)return i.changeTimeZone((0,t.j)(e[1])).toSQLWithKeyword();throw new o.D$(n,o.TX.InvalidParameter,r)}if((0,t.m)(i))return i.toSQLWithKeyword();if((0,t.u)(i)){if(3!==e.length)throw new o.D$(n,o.TX.InvalidParameter,r);yield i.load();const s=(0,t.j)(e[1]);if((0,t.m)(e[2]))return e[2].toSQLWithKeyword();if(!1===(0,t.k)(e[2]))throw new o.D$(n,o.TX.InvalidParameter,r);const m=i.fieldTimeZone(s);return null===m?e[2].toSQLWithKeyword():e[2].changeTimeZone(m).toSQLWithKeyword()}throw new o.D$(n,o.TX.InvalidParameter,r)});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"sqltimestamp",min:2,max:4}),l.functions.featuresetbyid=function(n,r){return l.standardFunctionAsync(n,r,(p,h,f)=>{if((0,t.H)(f,2,4,n,r),f[0]instanceof q.A){const e=(0,t.j)(f[1]);let i=(0,t.K)(f[2],null);const s=(0,t.h)((0,t.K)(f[3],!0));if(null===i&&(i=["*"]),!1===(0,t.o)(i))throw new o.D$(n,o.TX.InvalidParameter,r);return f[0].featureSetById(e,s,i)}throw new o.D$(n,o.TX.InvalidParameter,r)})},l.signatures.push({name:"featuresetbyid",min:2,max:4}),l.functions.getfeatureset=function(n,r){return l.standardFunctionAsync(n,r,(p,h,f)=>{if((0,t.H)(f,1,2,n,r),(0,t.r)(f[0])){let e=(0,t.K)(f[1],"datasource");return null===e&&(e="datasource"),e=(0,t.j)(e).toLowerCase(),(0,P.convertToFeatureSet)(f[0].fullSchema(),e,n.lrucache,n.interceptor,n.spatialReference)}throw new o.D$(n,o.TX.InvalidParameter,r)})},l.signatures.push({name:"getfeatureset",min:1,max:2}),l.functions.featuresetbyportalitem=function(n,r){return l.standardFunctionAsync(n,r,(p,h,f)=>{var e,i;if((0,t.H)(f,2,5,n,r),null===f[0])throw new o.D$(n,o.TX.PortalRequired,r);if(f[0]instanceof W.A){var s;const u=(0,t.j)(f[1]),c=(0,t.j)(f[2]);let F=(0,t.K)(f[3],null);const w=(0,t.h)((0,t.K)(f[4],!0));if(null===F&&(F=["*"]),!1===(0,t.o)(F))throw new o.D$(n,o.TX.InvalidParameter,r);let T=null;return T=null!==(s=n.services)&&void 0!==s&&s.portal?n.services.portal:ne.A.getDefault(),T=(0,ce.R)(f[0],T),(0,P.constructFeatureSetFromPortalItem)(u,c,n.spatialReference,F,w,T,n.lrucache,n.interceptor)}if(!1===(0,t.c)(f[0]))throw new o.D$(n,o.TX.PortalRequired,r);const m=(0,t.j)(f[0]),_=(0,t.j)(f[1]);let d=(0,t.K)(f[2],null);const a=(0,t.h)((0,t.K)(f[3],!0));if(null===d&&(d=["*"]),!1===(0,t.o)(d))throw new o.D$(n,o.TX.InvalidParameter,r);return(0,P.constructFeatureSetFromPortalItem)(m,_,n.spatialReference,d,a,null!==(e=null===(i=n.services)||void 0===i?void 0:i.portal)&&void 0!==e?e:ne.A.getDefault(),n.lrucache,n.interceptor)})},l.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),l.functions.featuresetbyname=function(n,r){return l.standardFunctionAsync(n,r,(p,h,f)=>{if((0,t.H)(f,2,4,n,r),f[0]instanceof q.A){const e=(0,t.j)(f[1]);let i=(0,t.K)(f[2],null);const s=(0,t.h)((0,t.K)(f[3],!0));if(null===i&&(i=["*"]),!1===(0,t.o)(i))throw new o.D$(n,o.TX.InvalidParameter,r);return f[0].featureSetByName(e,s,i)}throw new o.D$(n,o.TX.InvalidParameter,r)})},l.signatures.push({name:"featuresetbyname",min:2,max:4}),l.functions.featureset=function(n,r){return l.standardFunction(n,r,(p,h,f)=>{var e;(0,t.H)(f,1,1,n,r);let i=f[0];const s={layerDefinition:{geometryType:"",objectIdField:"",hasM:!1,hasZ:!1,globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,t.c)(i))i=JSON.parse(i),void 0!==i.layerDefinition?(s.layerDefinition=i.layerDefinition,s.featureSet=i.featureSet,i.layerDefinition.spatialReference&&(s.layerDefinition.spatialReference=i.layerDefinition.spatialReference)):(s.featureSet.features=i.features,s.featureSet.geometryType=i.geometryType,s.layerDefinition.geometryType=s.featureSet.geometryType,s.layerDefinition.objectIdField=null!==(e=i.objectIdFieldName)&&void 0!==e?e:"",s.layerDefinition.typeIdField=i.typeIdFieldName,s.layerDefinition.globalIdField=i.globalIdFieldName,s.layerDefinition.fields=i.fields,i.spatialReference&&(s.layerDefinition.spatialReference=i.spatialReference));else{if(!(f[0]instanceof $.A))throw new o.D$(n,o.TX.InvalidParameter,r);{i=JSON.parse(f[0].castToText(!0));const m=y(i,"layerdefinition");if(null!==m){s.layerDefinition.geometryType=y(m,"geometrytype",""),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.globalIdField=y(m,"globalidfield",""),s.layerDefinition.objectIdField=y(m,"objectidfield",""),s.layerDefinition.typeIdField=y(m,"typeidfield",""),s.layerDefinition.hasZ=!0===y(m,"hasz",!1),s.layerDefinition.hasM=!0===y(m,"hasm",!1);const _=y(m,"spatialreference",null);_&&(s.layerDefinition.spatialReference=G(_));for(const a of y(m,"fields",[])){const u={name:y(a,"name",""),alias:y(a,"alias",""),type:y(a,"type",""),nullable:y(a,"nullable",!0),editable:y(a,"editable",!0),length:y(a,"length",null),domain:te(y(a,"domain"))};s.layerDefinition.fields.push(u)}const d=y(i,"featureset",null);if(d){const a={};for(const u of s.layerDefinition.fields)a[u.name.toLowerCase()]=u.name;for(const u of y(d,"features",[])){const c={},F=y(u,"attributes",{});for(const w in F)c[a[w.toLowerCase()]]=F[w];s.featureSet.features.push({attributes:c,geometry:ae(y(u,"geometry",null))})}}}else{s.layerDefinition.hasZ=!0===y(i,"hasz",!1),s.layerDefinition.hasM=!0===y(i,"hasm",!1),s.layerDefinition.geometryType=y(i,"geometrytype",""),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.objectIdField=y(i,"objectidfieldname",""),s.layerDefinition.typeIdField=y(i,"typeidfieldname","");const _=y(i,"spatialreference",null);_&&(s.layerDefinition.spatialReference=G(_));let d=y(i,"fields",null);if((0,t.o)(d))for(const c of d){const F={name:y(c,"name",""),alias:y(c,"alias",""),type:y(c,"type",""),nullable:y(c,"nullable",!0),editable:y(c,"editable",!0),length:y(c,"length",null),domain:te(y(c,"domain"))};s.layerDefinition.fields.push(F)}else d=null,s.layerDefinition.fields=d;const a={};for(const c of s.layerDefinition.fields)a[c.name.toLowerCase()]=c.name;let u=y(i,"features",null);if((0,t.o)(u))for(const c of u){const F={},w=y(c,"attributes",{});for(const T in w)F[a[T.toLowerCase()]]=w[T];s.featureSet.features.push({attributes:F,geometry:ae(y(c,"geometry",null))})}else u=null,s.featureSet.features=u}}}if(!1===function ge(l){return!!l.layerDefinition&&!!l.featureSet&&!1!==function Ie(l,n){for(const r of n)if(r===l)return!0;return!1}(l.layerDefinition.geometryType,["",null,"esriGeometryNull","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&!1!==(0,t.o)(l.layerDefinition.fields)&&!1!==(0,t.o)(l.featureSet.features)}(s))throw new o.D$(n,o.TX.InvalidParameter,r);return s.layerDefinition.geometryType||(s.layerDefinition.geometryType="esriGeometryNull"),_e.A.create(s,n.spatialReference)})},l.signatures.push({name:"featureset",min:1,max:1}),l.functions.filter=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){if((0,t.H)(e,2,2,n,r),(0,t.o)(e[0])||(0,t.q)(e[0])){const i=[];let s=e[0];s instanceof de.A&&(s=s.toArray());let m=null;if(!(0,t.i)(e[1]))throw new o.D$(n,o.TX.InvalidParameter,r);m=e[1].createFunction(n);for(const _ of s){const d=m(_);(0,De.$X)(d)?!0===(yield d)&&i.push(_):!0===d&&i.push(_)}return i}if((0,t.u)(e[0])){const i=yield e[0].load(),s=A.WhereClause.create(e[1],i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC),m=s.getVariables();if(m.length>0){const _=[];for(let a=0;a<m.length;a++){const u={name:m[a]};_.push(yield l.evaluateIdentifier(n,u))}const d={};for(let a=0;a<m.length;a++)d[m[a]]=_[a];return s.parameters=d,new j.A({parentfeatureset:e[0],whereclause:s})}return new j.A({parentfeatureset:e[0],whereclause:s})}throw new o.D$(n,o.TX.InvalidParameter,r)});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"filter",min:2,max:2}),l.functions.orderby=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){if((0,t.H)(e,2,2,n,r),(0,t.u)(e[0])){const i=new he.A(e[1]);return new me.A({parentfeatureset:e[0],orderbyclause:i})}throw new o.D$(n,o.TX.InvalidParameter,r)});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"orderby",min:2,max:2}),l.functions.top=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){if((0,t.H)(e,2,2,n,r),(0,t.u)(e[0]))return new ye.A({parentfeatureset:e[0],topnum:e[1]});if((0,t.o)(e[0]))return(0,t.g)(e[1])>=e[0].length?e[0].slice(0):e[0].slice(0,(0,t.g)(e[1]));if((0,t.q)(e[0]))return(0,t.g)(e[1])>=e[0].length()?e[0].slice(0):e[0].slice(0,(0,t.g)(e[1]));throw new o.D$(n,o.TX.InvalidParameter,r)});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"top",min:2,max:2}),l.functions.first=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){if((0,t.H)(e,1,1,n,r),(0,t.u)(e[0])){const i=yield e[0].first(h.abortSignal);if(null!==i){const s=fe.A.createFromGraphicLikeObject(i.geometry,i.attributes,e[0],n.timeZone);return s._underlyingGraphic=i,s}return i}return(0,t.o)(e[0])?0===e[0].length?null:e[0][0]:(0,t.q)(e[0])?0===e[0].length()?null:e[0].get(0):null});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"first",min:1,max:1}),l.functions.attachments=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){(0,t.H)(e,1,2,n,r);const i={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(e.length>1)if(e[1]instanceof $.A){if(e[1].hasField("minsize")&&(i.minsize=(0,t.g)(e[1].field("minsize"))),e[1].hasField("metadata")&&(i.returnMetadata=(0,t.h)(e[1].field("metadata"))),e[1].hasField("maxsize")&&(i.maxsize=(0,t.g)(e[1].field("maxsize"))),e[1].hasField("types")){const s=(0,t.a3)(e[1].field("types"),!1);s.length>0&&(i.types=s)}}else if(null!==e[1])throw new o.D$(n,o.TX.InvalidParameter,r);if((0,t.r)(e[0])){let s=e[0]._layer;return s instanceof B.default&&(s=(0,P.constructFeatureSet)(s,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===s||!1===(0,t.u)(s)?[]:(yield s.load(),s.queryAttachments(e[0].field(s.objectIdField),i.minsize,i.maxsize,i.types,i.returnMetadata))}if(null===e[0])return[];throw new o.D$(n,o.TX.InvalidParameter,r)});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"attachments",min:1,max:2}),l.functions.featuresetbyrelationshipname=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){(0,t.H)(e,2,4,n,r);const i=e[0],s=(0,t.j)(e[1]);let m=(0,t.K)(e[2],null);const _=(0,t.h)((0,t.K)(e[3],!0));if(null===m&&(m=["*"]),!1===(0,t.o)(m))throw new o.D$(n,o.TX.InvalidParameter,r);if(null===e[0])return null;if(!(0,t.r)(e[0]))throw new o.D$(n,o.TX.InvalidParameter,r);let d=i._layer;if(d instanceof B.default&&(d=(0,P.constructFeatureSet)(d,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===d||!1===(0,t.u)(d))return null;d=yield d.load();const a=d.relationshipMetaData().filter(T=>T.name===s);if(0===a.length)return null;if(null!=a[0].relationshipTableId&&a[0].relationshipTableId>-1)return(0,P.constructFeatureSetFromRelationship)(d,a[0],i.field(d.objectIdField),d.spatialReference,m,_,n.lrucache,n.interceptor);let u=d.serviceUrl();if(!u)return null;u="/"===u.charAt(u.length-1)?u+a[0].relatedTableId.toString():u+"/"+a[0].relatedTableId.toString();const c=yield(0,P.constructFeatureSetFromUrl)(u,d.spatialReference,m,_,n.lrucache,n.interceptor);yield c.load();let F=c.relationshipMetaData();if(F=F.filter(T=>T.id===a[0].id),!1===i.hasField(a[0].keyField)||null===i.field(a[0].keyField)){const T=yield d.getFeatureByObjectId(i.field(d.objectIdField),[a[0].keyField]);if(T){const v=A.WhereClause.create(F[0].keyField+"= @id",c.getFieldsIndex(),c.dateFieldsTimeZoneDefaultUTC);return v.parameters={id:T.attributes[a[0].keyField]},c.filter(v)}return new pe.A({parentfeatureset:c})}const w=A.WhereClause.create(F[0].keyField+"= @id",c.getFieldsIndex(),c.dateFieldsTimeZoneDefaultUTC);return w.parameters={id:i.field(a[0].keyField)},c.filter(w)});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),l.functions.featuresetbyassociation=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){(0,t.H)(e,2,3,n,r);const i=e[0],s=(0,t.j)((0,t.K)(e[1],"")).toLowerCase(),m=(0,t.c)(e[2])?(0,t.j)(e[2]):null;if(null===e[0])return null;if(!(0,t.r)(e[0]))throw new o.D$(n,o.TX.InvalidParameter,r);let _=i._layer;if(_ instanceof B.default&&(_=(0,P.constructFeatureSet)(_,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===_||!1===(0,t.u)(_))return null;yield _.load();const d=_.serviceUrl(),a=yield(0,P.constructAssociationMetaDataFeatureSetFromUrl)(d,n.spatialReference);let u=null,c=null,F=!1;if(null!==m&&""!==m&&void 0!==m){for(const E of a.terminals)E.terminalName===m&&(c=E.terminalId);null===c&&(F=!0)}const w=a.associations.getFieldsIndex(),T=w.get("TOGLOBALID").name,v=w.get("FROMGLOBALID").name,k=w.get("TOTERMINALID").name,V=w.get("FROMTERMINALID").name,b=w.get("FROMNETWORKSOURCEID").name,U=w.get("TONETWORKSOURCEID").name,O=w.get("ASSOCIATIONTYPE").name,Fe=w.get("ISCONTENTVISIBLE").name,Ae=w.get("OBJECTID").name;for(const E of _.fields)if("global-id"===E.type){u=i.field(E.name);break}let L=null,ie=new I.Gr(new S.A({name:"percentalong",alias:"percentalong",type:"double"}),A.WhereClause.create("0",a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC)),re=new I.Gr(new S.A({name:"side",alias:"side",type:"string"}),A.WhereClause.create("''",a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC));const x="globalid",le="globalId",se={};for(const E in a.lkp)se[E]=a.lkp[E].sourceId;const M=new I.bV(new S.A({name:"classname",alias:"classname",type:"string"}),null,se);let g="";switch(s){case"midspan":{g=`((${T}='${u}') OR ( ${v}='${u}')) AND (${O} IN (5))`,M.codefield=A.WhereClause.create(`CASE WHEN (${T}='${u}') THEN ${b} ELSE ${U} END`,a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC);const E=(0,X.ke)(I.a.findField(a.associations.fields,v));E.name=x,E.alias=x,L=new I.Gr(E,A.WhereClause.create(`CASE WHEN (${v}='${u}') THEN ${T} ELSE ${v} END`,a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC)),ie=a.unVersion>=4?new I.IO(I.a.findField(a.associations.fields,w.get("PERCENTALONG").name)):new I.Gr(new S.A({name:"percentalong",alias:"percentalong",type:"double"}),A.WhereClause.create("0",a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC));break}case"junctionedge":{g=`((${T}='${u}') OR ( ${v}='${u}')) AND (${O} IN (4,6))`,M.codefield=A.WhereClause.create(`CASE WHEN (${T}='${u}') THEN ${b} ELSE ${U} END`,a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC);const E=(0,X.ke)(I.a.findField(a.associations.fields,v));E.name=x,E.alias=x,L=new I.Gr(E,A.WhereClause.create(`CASE WHEN (${v}='${u}') THEN ${T} ELSE ${v} END`,a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC)),re=new I.Gr(new S.A({name:"side",alias:"side",type:"string"}),A.WhereClause.create(`CASE WHEN (${O}=4) THEN 'from' ELSE 'to' END`,a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC));break}case"connected":{var Q,J;let E=`${T}='@T'`,oe=`${v}='@T'`;null!==c&&(E+=` AND ${k}=@A`,oe+=` AND ${V}=@A`),g="(("+E+") OR ("+oe+"))",g=(0,t.T)(g,"@T",null!==(Q=u)&&void 0!==Q?Q:""),E=(0,t.T)(E,"@T",null!==(J=u)&&void 0!==J?J:""),null!==c&&(E=(0,t.T)(E,"@A",c.toString()),g=(0,t.T)(g,"@A",c.toString())),M.codefield=A.WhereClause.create("CASE WHEN "+E+` THEN ${b} ELSE ${U} END`,a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC);const Y=(0,X.ke)(I.a.findField(a.associations.fields,v));Y.name=x,Y.alias=x,L=new I.Gr(Y,A.WhereClause.create("CASE WHEN "+E+` THEN ${v} ELSE ${T} END`,a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC));break}case"container":g=`${T}='${u}' AND ${O} = 2`,null!==c&&(g+=` AND ${k} = `+c.toString()),M.codefield=b,g="( "+g+" )",L=new I.p8(I.a.findField(a.associations.fields,v),x,x);break;case"content":g=`(${v}='${u}' AND ${O} = 2)`,null!==c&&(g+=` AND ${V} = `+c.toString()),M.codefield=U,g="( "+g+" )",L=new I.p8(I.a.findField(a.associations.fields,T),x,x);break;case"structure":g=`(${T}='${u}' AND ${O} = 3)`,null!==c&&(g+=` AND ${k} = `+c.toString()),M.codefield=b,g="( "+g+" )",L=new I.p8(I.a.findField(a.associations.fields,v),x,le);break;case"attached":g=`(${v}='${u}' AND ${O} = 3)`,null!==c&&(g+=` AND ${V} = `+c.toString()),M.codefield=U,g="( "+g+" )",L=new I.p8(I.a.findField(a.associations.fields,T),x,le);break;default:throw new o.D$(n,o.TX.InvalidParameter,r)}return F&&(g="1 <> 1"),new I.a({parentfeatureset:a.associations,adaptedFields:[new I.IO(I.a.findField(a.associations.fields,Ae)),new I.IO(I.a.findField(a.associations.fields,Fe)),L,re,M,ie],extraFilter:g?A.WhereClause.create(g,a.associations.getFieldsIndex(),a.associations.dateFieldsTimeZoneDefaultUTC):null})});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"featuresetbyassociation",min:2,max:6}),l.functions.groupby=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){if((0,t.H)(e,3,3,n,r),!(0,t.u)(e[0]))throw new o.D$(n,o.TX.InvalidParameter,r);const i=yield e[0].load(),s=[],m=[];let _=!1,d=[];if((0,t.c)(e[1]))d.push(e[1]);else if(e[1]instanceof $.A)d.push(e[1]);else if((0,t.o)(e[1]))d=e[1];else{if(!(0,t.q)(e[1]))throw new o.D$(n,o.TX.InvalidParameter,r);d=e[1].toArray()}for(const a of d)if((0,t.c)(a)){const u=A.WhereClause.create((0,t.j)(a),i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC),c=!0===(0,ee.DA)(u)?(0,t.j)(a):"%%%%FIELDNAME";s.push({name:c,expression:u}),"%%%%FIELDNAME"===c&&(_=!0)}else{if(!(a instanceof $.A))throw new o.D$(n,o.TX.InvalidParameter,r);{const u=a.hasField("name")?a.field("name"):"%%%%FIELDNAME",c=a.hasField("expression")?a.field("expression"):"";if("%%%%FIELDNAME"===u&&(_=!0),!u)throw new o.D$(n,o.TX.InvalidParameter,r);s.push({name:u,expression:A.WhereClause.create(c||u,i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC)})}}if(d=[],(0,t.c)(e[2]))d.push(e[2]);else if((0,t.o)(e[2]))d=e[2];else if((0,t.q)(e[2]))d=e[2].toArray();else{if(!(e[2]instanceof $.A))throw new o.D$(n,o.TX.InvalidParameter,r);d.push(e[2])}for(const a of d){if(!(a instanceof $.A))throw new o.D$(n,o.TX.InvalidParameter,r);{const u=a.hasField("name")?a.field("name"):"",c=a.hasField("statistic")?a.field("statistic"):"",F=a.hasField("expression")?a.field("expression"):"";if(!u||!c||!F)throw new o.D$(n,o.TX.InvalidParameter,r);m.push({name:u,statistic:c.toLowerCase(),expression:A.WhereClause.create(F,i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC)})}}if(_){const a={};for(const c of i.fields)a[c.name.toLowerCase()]=1;for(const c of s)"%%%%FIELDNAME"!==c.name&&(a[c.name.toLowerCase()]=1);for(const c of m)"%%%%FIELDNAME"!==c.name&&(a[c.name.toLowerCase()]=1);let u=0;for(const c of s)if("%%%%FIELDNAME"===c.name){for(;1===a["field_"+u.toString()];)u++;a["field_"+u.toString()]=1,c.name="FIELD_"+u.toString()}}for(const a of s)yield H(a.expression,l,n);for(const a of m)yield H(a.expression,l,n);return e[0].groupby(s,m)});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"groupby",min:3,max:3}),l.functions.distinct=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){if((0,t.u)(e[0])){(0,t.H)(e,2,2,n,r);const i=yield e[0].load(),s=[];let m=[];if((0,t.c)(e[1]))m.push(e[1]);else if(e[1]instanceof $.A)m.push(e[1]);else if((0,t.o)(e[1]))m=e[1];else{if(!(0,t.q)(e[1]))throw new o.D$(n,o.TX.InvalidParameter,r);m=e[1].toArray()}let _=!1;for(const d of m)if((0,t.c)(d)){const a=A.WhereClause.create((0,t.j)(d),i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC),u=!0===(0,ee.DA)(a)?(0,t.j)(d):"%%%%FIELDNAME";s.push({name:u,expression:a}),"%%%%FIELDNAME"===u&&(_=!0)}else{if(!(d instanceof $.A))throw new o.D$(n,o.TX.InvalidParameter,r);{const a=d.hasField("name")?d.field("name"):"%%%%FIELDNAME",u=d.hasField("expression")?d.field("expression"):"";if("%%%%FIELDNAME"===a&&(_=!0),!a)throw new o.D$(n,o.TX.InvalidParameter,r);s.push({name:a,expression:A.WhereClause.create(u||a,i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC)})}}if(_){const d={};for(const u of i.fields)d[u.name.toLowerCase()]=1;for(const u of s)"%%%%FIELDNAME"!==u.name&&(d[u.name.toLowerCase()]=1);let a=0;for(const u of s)if("%%%%FIELDNAME"===u.name){for(;1===d["field_"+a.toString()];)a++;d["field_"+a.toString()]=1,u.name="FIELD_"+a.toString()}}for(const d of s)yield H(d.expression,l,n);return e[0].groupby(s,[])}return function Te(l,n,r,p){if(1===p.length){if((0,t.o)(p[0]))return(0,Z.t)(l,p[0],-1);if((0,t.q)(p[0]))return(0,Z.t)(l,p[0].toArray(),-1)}return(0,Z.t)(l,p,-1)}("distinct",0,0,e)});return function(h,f,e){return p.apply(this,arguments)}}())}),l.functions.getfeaturesetinfo=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){var i,s;if((0,t.H)(e,1,1,n,r),!(0,t.u)(e[0]))return null;const m=yield e[0].getFeatureSetInfo();return m?$.A.convertObjectToArcadeDictionary({layerId:m.layerId,layerName:m.layerName,itemId:m.itemId,serviceLayerUrl:m.serviceLayerUrl,webMapLayerId:null!==(i=m.webMapLayerId)&&void 0!==i?i:null,webMapLayerTitle:null!==(s=m.webMapLayerTitle)&&void 0!==s?s:null,className:null,objectClassId:null},(0,t.N)(n),!1,!1):null});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"getfeaturesetinfo",min:1,max:1}),l.functions.filterbysubtypecode=function(n,r){return l.standardFunctionAsync(n,r,function(){var p=(0,C.A)(function*(h,f,e){if((0,t.H)(e,2,2,n,r),(0,t.u)(e[0])){const i=yield e[0].load();if(!(0,t.O)(e[1]))throw new o.D$(n,o.TX.InvalidParameter,r);if(i.subtypeField){const _=A.WhereClause.create(`${i.subtypeField}= ${e[1]}`,i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC);return new j.A({parentfeatureset:e[0],whereclause:_})}if(null===i.typeIdField||""===i.typeIdField)throw new o.D$(n,o.TX.FeatureSetDoesNotHaveSubtypes,r);const m=A.WhereClause.create(`${i.typeIdField}= ${e[1]}`,i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC);return new j.A({parentfeatureset:e[0],whereclause:m})}throw new o.D$(n,o.TX.InvalidParameter,r)});return function(h,f,e){return p.apply(this,arguments)}}())},l.signatures.push({name:"filterbysubtypecode",min:2,max:2})}},32832:(ue,R,D)=>{D.d(R,{R:()=>K});var C=D(73874);function K(W,$){return null===W?$:new C.A({url:W.field("url")})}}}]);