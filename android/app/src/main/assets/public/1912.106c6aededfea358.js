"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1912,9927],{41912:(Q,j,s)=>{s.r(j),s.d(j,{default:()=>i});var g=s(10467),m=s(8189),W=s(89563),T=s(5922),Z=s(35150),D=s(69287),S=s(39693),L=s(56492),p=s(85211),C=(s(3248),s(40707),s(76576)),u=s(28714),I=s(25866),b=s(87477),P=s(28067),M=s(32034),y=s(23234),x=s(95478),H=s(94376),z=s(25936),F=s(23e3),V=s(17049),N=s(85551),Y=s(33036),B=s(81687),o=s(73812);let r=class extends((0,z.b)((0,V.q)((0,N.A)((0,Y.j)((0,S.P)((0,F.d)((0,H.p)(x.A)))))))){constructor(l){super(l),this.operationalLayerType="IntegratedMesh3DTilesLayer",this.spatialReference=new M.A({wkid:4326,vcsWkid:115700}),this.fullExtent=new P.A(-180,-90,180,90,this.spatialReference),this.url=null,this.type="integrated-mesh-3dtiles",this.path=null,this.minScale=0,this.maxScale=0}set elevationInfo(l){this._set("elevationInfo",l),this._validateElevationInfo()}_verifyArray(l,a){if(!Array.isArray(l)||l.length<a)return!1;for(const E of l)if("number"!=typeof E)return!1;return!0}_initFullExtent(l){var a,E;const v=null===(a=l.root)||void 0===a?void 0:a.boundingVolume;if(!v)return;if(v.box){const c=null==v?void 0:v.box;if(c[3]>7972671&&c[7]>7972671&&c[11]>7945940)return}const O=null===(E=l.root)||void 0===E?void 0:E.transform,A=(0,I.vt)();if(v.region&&this._verifyArray(v.region,6)){const c=v.region,f=(0,D.KJ)(c[0]),K=(0,D.KJ)(c[1]),R=c[4],U=(0,D.KJ)(c[2]),_=(0,D.KJ)(c[3]);this.fullExtent=new P.A({xmin:f,ymin:K,zmin:R,xmax:U,ymax:_,zmax:c[5],spatialReference:this.spatialReference})}else if(v.sphere&&this._verifyArray(v.sphere,4)){const c=v.sphere,f=(0,I.fA)(c[0],c[1],c[2]),K=c[3]/Math.sqrt(3),R=(0,I.vt)();(0,u.f)(R,f,(0,I.fA)(-K,-K,-K));const U=(0,I.vt)();if((0,u.g)(U,f,(0,I.fA)(K,K,K)),O&&this._verifyArray(O,16)){const J=O;(0,u.e)(A,R,J),(0,u.c)(R,A),(0,u.e)(A,U,J),(0,u.c)(U,A)}(0,y.projectBuffer)(R,b.Ro,0,R,M.A.WGS84,0,1),(0,y.projectBuffer)(U,b.Ro,0,U,M.A.WGS84,0,1);const _=(0,I.vt)(),$=(0,I.vt)();(0,u.y)(_,R,U),(0,u.C)($,R,U),this.fullExtent=new P.A({xmin:_[0],ymin:_[1],zmin:_[2],xmax:$[0],ymax:$[1],zmax:$[2],spatialReference:this.spatialReference})}else if(v.box&&this._verifyArray(v.box,12)){const c=v.box,f=(0,I.fA)(c[0],c[1],c[2]),K=(0,I.fA)(c[3],c[4],c[5]),R=(0,I.fA)(c[6],c[7],c[8]),U=(0,I.fA)(c[9],c[10],c[11]),_=[];for(let G=0;G<8;++G)_.push((0,I.vt)());if((0,u.g)(_[0],f,K),(0,u.g)(_[0],_[0],R),(0,u.g)(_[0],_[0],U),(0,u.z)(_[1],f,K),(0,u.g)(_[1],_[1],R),(0,u.g)(_[1],_[1],U),(0,u.g)(_[2],f,K),(0,u.z)(_[2],_[2],R),(0,u.g)(_[2],_[2],U),(0,u.z)(_[3],f,K),(0,u.z)(_[3],_[3],R),(0,u.g)(_[3],_[3],U),(0,u.g)(_[4],f,K),(0,u.g)(_[4],_[4],R),(0,u.z)(_[4],_[4],U),(0,u.z)(_[5],f,K),(0,u.g)(_[5],_[5],R),(0,u.z)(_[5],_[5],U),(0,u.g)(_[6],f,K),(0,u.z)(_[6],_[6],R),(0,u.z)(_[6],_[6],U),(0,u.z)(_[7],f,K),(0,u.z)(_[7],_[7],R),(0,u.z)(_[7],_[7],U),O&&this._verifyArray(O,16)){const G=O;for(let X=0;X<8;++X)(0,u.e)(_[X],_[X],G)}const $=(0,I.fA)(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),J=(0,I.fA)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);for(let G=0;G<8;++G)(0,y.projectBuffer)(_[G],b.Ro,0,_[G],M.A.WGS84,0,1),(0,u.y)(J,J,_[G]),(0,u.C)($,$,_[G]);this.fullExtent=new P.A({xmin:J[0],ymin:J[1],zmin:J[2],xmax:$[0],ymax:$[1],zmax:$[2],spatialReference:this.spatialReference})}}load(l){var a=this;return(0,g.A)(function*(){return a.addResolvingPromise(a._doLoad(l)),a})()}_doLoad(l){var a=this;return(0,g.A)(function*(){const E=null!=l?l.signal:null;try{yield a.loadFromPortal({supportedTypes:["3DTiles Service"],validateItem:v=>{var O;if(null!==(O=v.typeKeywords)&&void 0!==O&&O.includes("IntegratedMesh"))return!0;throw new T.A("portal:invalid-layer-item-type","Invalid layer item, expected '${expectedType}' ",{expectedType:"3DTiles Service containing IntegratedMesh"})}},l)}catch(v){(0,L.QP)(v)}a.url&&(yield(0,W.A)(a.url,{query:{f:"json",...a.customParameters,token:a.apiKey},responseType:"json",signal:E}).then(O=>{a._initFullExtent(O.data)},O=>{(0,L.QP)(O)}))})()}fetchAttributionData(){var l=this;return(0,g.A)(function*(){return l.load().then(()=>({}))})()}_validateElevationInfo(){const l=this.elevationInfo,a="Integrated mesh 3d tiles layers";(0,o.XF)(Z.A.getLogger(this),(0,o.B)(a,"absolute-height",l)),(0,o.XF)(Z.A.getLogger(this),(0,o.tW)(a,l))}};(0,m._)([(0,p.MZ)({type:["IntegratedMesh3DTilesLayer"]})],r.prototype,"operationalLayerType",void 0),(0,m._)([(0,p.MZ)({type:M.A})],r.prototype,"spatialReference",void 0),(0,m._)([(0,p.MZ)({type:P.A})],r.prototype,"fullExtent",void 0),(0,m._)([(0,p.MZ)(B.Yj)],r.prototype,"elevationInfo",null),(0,m._)([(0,p.MZ)({type:["show","hide"]})],r.prototype,"listMode",void 0),(0,m._)([(0,p.MZ)(B.OZ)],r.prototype,"url",void 0),(0,m._)([(0,p.MZ)({readOnly:!0})],r.prototype,"type",void 0),(0,m._)([(0,p.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],r.prototype,"path",void 0),(0,m._)([(0,p.MZ)({type:Number,json:{origins:{"web-scene":{name:"layerDefinition.minScale",write:()=>{},read:()=>{}},"portal-item":{name:"layerDefinition.minScale",write:()=>{},read:()=>{}}}}})],r.prototype,"minScale",void 0),(0,m._)([(0,p.MZ)({type:Number,json:{origins:{"web-scene":{name:"layerDefinition.maxScale",write:()=>{},read:()=>{}},"portal-item":{name:"layerDefinition.maxScale",write:()=>{},read:()=>{}}}}})],r.prototype,"maxScale",void 0),r=(0,m._)([(0,C.$)("esri.layers.IntegratedMesh3DTilesLayer")],r);const i=r},94376:(Q,j,s)=>{s.d(j,{p:()=>L});var g=s(8189),m=s(85211),D=(s(3248),s(35150),s(40707),s(76576));const L=p=>{let d=class extends p{get apiKey(){var h;return this._isOverridden("apiKey")?this._get("apiKey"):function S(p){return"portalItem"in p}(this)?null===(h=this.portalItem)||void 0===h?void 0:h.apiKey:null}set apiKey(h){null!=h?this._override("apiKey",h):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return(0,g._)([(0,m.MZ)({type:String})],d.prototype,"apiKey",null),d=(0,g._)([(0,D.$)("esri.layers.mixins.APIKeyMixin")],d),d}},25936:(Q,j,s)=>{s.d(j,{b:()=>L});var g=s(8189),m=s(35150),W=s(85211),D=(s(3248),s(40707),s(76576)),S=s(68438);const L=p=>{let d=class extends p{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const h=(0,S.qg)(this.url);if(null!=h&&h.title)return h.title}return this._get("title")||""}set title(h){this._set("title",h)}set url(h){this._set("url",(0,S.Jf)(h,m.A.getLogger(this)))}};return(0,g._)([(0,W.MZ)()],d.prototype,"title",null),(0,g._)([(0,W.MZ)({type:String})],d.prototype,"url",null),d=(0,g._)([(0,D.$)("esri.layers.mixins.ArcGISService")],d),d}},23e3:(Q,j,s)=>{s.d(j,{d:()=>S});var g=s(8189),m=s(85211),D=(s(3248),s(35150),s(40707),s(76576));const S=L=>{let p=class extends L{constructor(){super(...arguments),this.customParameters=null}};return(0,g._)([(0,m.MZ)({type:Object,json:{write:{overridePolicy:d=>({enabled:!!(d&&Object.keys(d).length>0)})}}})],p.prototype,"customParameters",void 0),p=(0,g._)([(0,D.$)("esri.layers.mixins.CustomParametersMixin")],p),p}},85551:(Q,j,s)=>{s.d(j,{A:()=>V});var g=s(10467),m=s(8189),W=s(23098),T=s(77469),Z=s(89563),D=s(89447),S=s(5922),L=s(35150),p=s(11432),d=s(56492),h=s(45272),C=s(85211),b=(s(3248),s(40707),s(17221)),P=s(76576),M=s(50305),y=s(58443),x=s(73874),H=s(46577),z=s(52606),F=s(69927);const V=Y=>{let B=class extends Y{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,p.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(o){o!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",o))}readPortalItem(o,r,i){if(r.itemId)return new H.default({id:r.itemId,portal:null==i?void 0:i.portal})}writePortalItem(o,r){null!=o&&o.id&&(r.itemId=o.id)}loadFromPortal(o,r){var i=this;return(0,g.A)(function*(){var l;if(null!==(l=i.portalItem)&&void 0!==l&&l.id)try{const{load:a}=yield Promise.all([s.e(5565),s.e(2076),s.e(6180)]).then(s.bind(s,56180));return(0,d.Te)(r),yield a({instance:i,supportedTypes:o.supportedTypes,validateItem:o.validateItem,supportsData:o.supportsData,layerModuleTypeMap:o.layerModuleTypeMap},r)}catch(a){throw(0,d.zf)(a)||L.A.getLogger(i).warn(`Failed to load layer (${i.title}, ${i.id}) portal item (${i.portalItem.id})\n  ${a}`),a}})()}finishLoadEditablePortalLayer(o){var r=this;return(0,g.A)(function*(){r._set("userHasEditingPrivileges",yield r._fetchUserHasEditingPrivileges(o).catch(i=>((0,d.QP)(i),!0)))})()}setUserPrivileges(o,r){var i=this;return(0,g.A)(function*(){if(!W.A.userPrivilegesApplied)return i.finishLoadEditablePortalLayer(r);if(i.url)try{const{features:{edit:l,fullEdit:a},content:{updateItem:E}}=yield i._fetchUserPrivileges(o,r);i._set("userHasEditingPrivileges",l),i._set("userHasFullEditingPrivileges",a),i._set("userHasUpdateItemPrivileges",E)}catch(l){(0,d.QP)(l)}})()}_fetchUserPrivileges(o,r){var i=this;return(0,g.A)(function*(){let l=i.portalItem;if(!o||!l||!l.loaded||l.sourceUrl)return i._fetchFallbackUserPrivileges(r);const a=o===l.id;if(a&&l.portal.user)return(0,F.It)(l);let E,v;if(a)E=l.portal.url;else try{E=yield(0,y.wI)(i.url,r)}catch(f){(0,d.QP)(f)}if(!E||!(0,h.b8)(E,l.portal.url))return i._fetchFallbackUserPrivileges(r);try{const f=null!=r?r.signal:null;v=yield null==T.id?void 0:T.id.getCredential(`${E}/sharing`,{prompt:!1,signal:f})}catch(f){(0,d.QP)(f)}if(!v)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(a?yield l.reload():(l=new H.default({id:o,portal:{url:E}}),yield l.load(r)),l.portal.user)return(0,F.It)(l)}catch(f){(0,d.QP)(f)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_fetchFallbackUserPrivileges(o){var r=this;return(0,g.A)(function*(){let i=!0;try{i=yield r._fetchUserHasEditingPrivileges(o)}catch(l){(0,d.QP)(l)}return{features:{edit:i,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(o){var r=this;return(0,g.A)(function*(){const i=r.url?null==T.id?void 0:T.id.findCredential(r.url):null;if(!i)return!0;const l=N.credential===i?N.user:yield r._fetchEditingUser(o);return N.credential=i,N.user=l,null==(null==l?void 0:l.privileges)||l.privileges.includes("features:user:edit")})()}_fetchEditingUser(o){var r=this;return(0,g.A)(function*(){var i,l;const a=null===(i=r.portalItem)||void 0===i||null===(i=i.portal)||void 0===i?void 0:i.user;if(a)return a;const E=T.id.findServerInfo(null!==(l=r.url)&&void 0!==l?l:"");if(null==E||!E.owningSystemUrl)return null;const v=`${E.owningSystemUrl}/sharing/rest`,O=x.A.getDefault();if(O&&O.loaded&&(0,h.S8)(O.restUrl)===(0,h.S8)(v))return O.user;const A=`${v}/community/self`,c=null!=o?o.signal:null,f=yield(0,D.Ke)((0,Z.A)(A,{authMode:"no-prompt",query:{f:"json"},signal:c}));return f.ok?z.A.fromJSON(f.value.data):null})()}read(o,r){r&&(r.layer=this),super.read(o,r)}write(o,r){var i;const l=null==r?void 0:r.portal,a=(null===(i=this.portalItem)||void 0===i?void 0:i.id)&&(this.portalItem.portal||x.A.getDefault());return l&&a&&!(0,h.ut)(a.restUrl,l.restUrl)?(r.messages&&r.messages.push(new S.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(o,{...r,layer:this})}};return(0,m._)([(0,C.MZ)({type:H.default})],B.prototype,"portalItem",null),(0,m._)([(0,b.w)("web-document","portalItem",["itemId"])],B.prototype,"readPortalItem",null),(0,m._)([(0,M.K)("web-document","portalItem",{itemId:{type:String}})],B.prototype,"writePortalItem",null),(0,m._)([(0,C.MZ)({clonable:!1})],B.prototype,"resourceReferences",void 0),(0,m._)([(0,C.MZ)({type:Boolean,readOnly:!0})],B.prototype,"userHasEditingPrivileges",void 0),(0,m._)([(0,C.MZ)({type:Boolean,readOnly:!0})],B.prototype,"userHasFullEditingPrivileges",void 0),(0,m._)([(0,C.MZ)({type:Boolean,readOnly:!0})],B.prototype,"userHasUpdateItemPrivileges",void 0),B=(0,m._)([(0,P.$)("esri.layers.mixins.PortalLayer")],B),B},N={credential:null,user:null}},33036:(Q,j,s)=>{s.d(j,{j:()=>S});var g=s(8189),m=s(85211),D=(s(3248),s(35150),s(40707),s(76576));const S=p=>{let d=class extends p{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const h={minScale:this.minScale,maxScale:this.maxScale},C=this.parent;C&&"effectiveScaleRange"in C&&function L(p,d){p.minScale=p.minScale>0?d.minScale>0?Math.min(p.minScale,d.minScale):p.minScale:d.minScale,p.maxScale=p.maxScale>0?d.maxScale>0?Math.max(p.maxScale,d.maxScale):p.maxScale:d.maxScale}(h,C.effectiveScaleRange);const u=this._get("effectiveScaleRange");return u&&u.minScale===h.minScale&&u.maxScale===h.maxScale?u:h}};return(0,g._)([(0,m.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],d.prototype,"minScale",void 0),(0,g._)([(0,m.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],d.prototype,"maxScale",void 0),(0,g._)([(0,m.MZ)({readOnly:!0})],d.prototype,"effectiveScaleRange",null),d=(0,g._)([(0,D.$)("esri.layers.mixins.ScaleRangeLayer")],d),d}},69927:(Q,j,s)=>{s.d(j,{It:()=>b,LG:()=>S,OM:()=>d,Sm:()=>h,Y:()=>L,bK:()=>p,mm:()=>I,sQ:()=>C});var g=s(10467),m=s(11817),W=s(32034),T=s(55039);function D(){return(D=(0,g.A)(function*(P){const M=P.spatialReference;if(M.isWGS84)return P.clone();if(M.isWebMercator)return(0,T.ci)(P);const y=W.A.WGS84;return yield(0,m.initializeProjection)(M,y),(0,m.project)(P,y)})).apply(this,arguments)}function S(P,M){if(!L(P,M)){const y=P.typeKeywords;y?y.push(M):P.typeKeywords=[M]}}function L(P,M){var y;return!(null===(y=P.typeKeywords)||void 0===y||!y.includes(M))}function p(P){return L(P,I.HOSTED_SERVICE)}function d(P,M){const y=P.typeKeywords;if(y){const x=y.indexOf(M);x>-1&&y.splice(x,1)}}function h(P,M,y){y?S(P,M):d(P,M)}function C(P){return u.apply(this,arguments)}function u(){return u=(0,g.A)(function*(P){const M=P.clone().normalize();let y;if(M.length>1)for(const x of M)y?x.width>y.width&&(y=x):y=x;else y=M[0];return function Z(P){return D.apply(this,arguments)}(y)}),u.apply(this,arguments)}const I={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function b(P){var M;const{portal:y,isOrgItem:x,itemControl:H}=P,z=null===(M=y.user)||void 0===M?void 0:M.privileges;let F=!z||z.includes("features:user:edit"),V=!!x&&!(null==z||!z.includes("features:user:fullEdit"));const N="update"===H||"admin"===H;return N?V=F=!0:V&&(F=!0),{features:{edit:F,fullEdit:V},content:{updateItem:N}}}},73812:(Q,j,s)=>{function D(o,r){return function T(o,r){return null!=r&&r.mode?r.mode:function W(o){return o?Y:B}(o).mode}(null!=o&&o.hasZ,r)}function H(o,r,i){return i&&i.mode!==r?`${o} only support ${r} elevation mode`:null}function z(o,r,i){return(null==i?void 0:i.mode)===r?`${o} do not support ${r} elevation mode`:null}function F(o,r){return null!=(null==r?void 0:r.featureExpressionInfo)&&"0"!==r.featureExpressionInfo.expression?`${o} do not support featureExpressionInfo`:null}function V(o,r){r&&o.warn(".elevationInfo=",r)}s.d(j,{$7:()=>z,B:()=>H,XF:()=>V,tW:()=>F,w7:()=>D}),s(82663),s(82575);const Y={mode:"absolute-height",offset:0},B={mode:"on-the-ground",offset:null}}}]);