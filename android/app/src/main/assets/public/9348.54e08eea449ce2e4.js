"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9348,9927,4098,3258],{33087:(Be,ye,l)=>{l.d(ye,{q:()=>i});var U=l(60611);class i{constructor(C,ee){this._storage=new U.F,this.id="",this.name="",this.size=0,this._storage.maxSize=C,this._storage.register(this),ee&&this._storage.registerRemoveFunc("",ee)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(C,ee,J=1){this._storage.put(this,C,ee,J,1)}pop(C){return this._storage.pop(this,C)}get(C){return this._storage.get(this,C)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(C){this._storage.maxSize=C}resetHitRate(){}}},60611:(Be,ye,l)=>{l.d(ye,{F:()=>J,Mn:()=>ee});var C,re,U=l(12438);(re=C||(C={}))[re.ALL=0]="ALL",re[re.SOME=1]="SOME";class ee{constructor(h,f,A){this.name=h,this._storage=f,this.id=te+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),A&&(this._storage.registerRemoveFunc(this.id,A),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(h){return this._storage.getSize(this,h)}resetHitRate(){this._hit=this._miss=0}put(h,f,A,g=0){this._storage.put(this,h,f,A,g)}pop(h){const f=this._storage.pop(this,h);return void 0===f?++this._miss:++this._hit,f}get(h){const f=this._storage.get(this,h);return void 0===f?++this._miss:++this._hit,f}peek(h){return this._storage.peek(this,h)}updateSize(h,f,A){this._storage.updateSize(this,h,f,A)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class J{get size(){return this._size}constructor(h=10485760){this._maxSize=h,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new U.A,this._users=new U.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(h){this._users.push(h)}deregister(h){this._users.removeUnordered(h)}registerRemoveFunc(h,f){this._removeFuncs.push([h,f])}deregisterRemoveFunc(h){this._removeFuncs.filterInPlace(f=>f[0]!==h)}get maxSize(){return this._maxSize}set maxSize(h){this._maxSize=Math.max(h,-1),this._checkSize()}getSize(h,f){var A;const g=this._db.get(h.id+f);return null!==(A=null==g?void 0:g.size)&&void 0!==A?A:0}put(h,f,A,g,L){const E=this._db.get(f=h.id+f);if(E&&(this._size-=E.size,h.size-=E.size,this._db.delete(f),E.entry!==A&&this._notifyRemove(f,E.entry,E.size,C.ALL)),g>this._maxSize)return void this._notifyRemove(f,A,g,C.ALL);if(void 0===A)return void console.warn("Refusing to cache undefined entry ");if(!g||g<0)return console.warn(`Refusing to cache entry with size ${g} for key ${f}`),void this._notifyRemove(f,A,0,C.ALL);const O=1+Math.max(L,-4)- -3;this._db.set(f,new fe(A,g,O)),this._size+=g,h.size+=g,this._checkSize()}updateSize(h,f,A,g){const L=this._db.get(f=h.id+f);if(L&&L.entry===A){for(this._size-=L.size,h.size-=L.size;g>this._maxSize;){const E=this._notifyRemove(f,A,g,C.SOME);if(!(null!=E&&E>0))return void this._db.delete(f);g=E}L.size=g,this._size+=g,h.size+=g,this._checkSize()}}pop(h,f){const A=this._db.get(f=h.id+f);if(A)return this._size-=A.size,h.size-=A.size,this._db.delete(f),++this._hit,A.entry;++this._miss}get(h,f){const A=this._db.get(f=h.id+f);if(void 0!==A)return this._db.delete(f),A.lives=A.lifetime,this._db.set(f,A),++this._hit,A.entry;++this._miss}peek(h,f){const A=this._db.get(h.id+f);return A?++this._hit:++this._miss,null==A?void 0:A.entry}get performanceInfo(){const h={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},f={},A=new Array;this._db.forEach((E,O)=>{const N=E.lifetime;A[N]=(A[N]||0)+E.size,this._users.forAll(w=>{const{id:T,name:v}=w;O.startsWith(T)&&(f[v]=(f[v]||0)+E.size)})});const g={};this._users.forAll(E=>{const O=E.name;"hitRate"in E&&"number"==typeof E.hitRate&&!isNaN(E.hitRate)&&E.hitRate>0?(f[O]=f[O]||0,g[O]=Math.round(100*E.hitRate)+"%"):g[O]="0%"});const L=Object.keys(f);L.sort((E,O)=>f[O]-f[E]),L.forEach(E=>h[E]=Math.round(f[E]/2**20)+"MB / "+g[E]);for(let E=A.length-1;E>=0;--E){const O=A[E];O&&(h["Priority "+(E+-3-1)]=Math.round(O/this._size*100)+"%")}return h}resetStats(){this._hit=this._miss=0,this._users.forAll(h=>h.resetHitRate())}clear(h){const f=h.id;this._db.forEach((A,g)=>{g.startsWith(f)&&(this._size-=A.size,this._db.delete(g),this._notifyRemove(g,A.entry,A.size,C.ALL))}),h.size=0}clearAll(){this._db.forEach((h,f)=>this._notifyRemove(f,h.entry,h.size,C.ALL)),this._users.forAll(h=>h.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(h,f,A,g){let L;return this._removeFuncs.some(E=>{if(h.startsWith(E[0])){const O=E[1](f,g,A);return"number"==typeof O&&(L=O),!0}return!1}),L}_checkSize(){this._users.forAll(h=>this._checkSizeLimits(h)),this._checkSizeLimits()}_checkSizeLimits(h){const f=null!=h?h:this;if(f.maxSize<0||f.size<=f.maxSize)return;const A=null==h?void 0:h.id;let g=!0;for(;g;){g=!1;for(const[L,E]of this._db)if(0===E.lifetime&&(!A||L.startsWith(A))){if(this._purgeItem(L,E,h),f.size<=.9*f.maxSize)return;g||(g=this._db.has(L))}}for(const[L,E]of this._db)if((!A||L.startsWith(A))&&(this._purgeItem(L,E,h),f.size<=.9*f.maxSize))return}_purgeItem(h,f,A=this._users.find(g=>h.startsWith(g.id))){if(this._db.delete(h),f.lives<=1){this._size-=f.size,A&&(A.size-=f.size);const g=this._notifyRemove(h,f.entry,f.size,C.SOME);null!=g&&g>0&&(this._size+=g,A&&(A.size+=g),f.lives=f.lifetime,f.size=g,this._db.set(h,f))}else--f.lives,this._db.set(h,f)}}let te=0;class fe{constructor(h,f,A){this.entry=h,this.size=f,this.lifetime=A,this.lives=A}}},23506:(Be,ye,l)=>{l.d(ye,{v:()=>i});var U=l(99305);function i(ae){null!=ae&&ae.writtenProperties&&ae.writtenProperties.forEach(({target:C,propName:ee,newOrigin:J})=>{(0,U.H)(C)&&J&&C.originOf(ee)!==J&&C.updateOrigin(ee,J)})}},99305:(Be,ye,l)=>{function U(i){return i&&"getAtOrigin"in i&&"originOf"in i}l.d(ye,{H:()=>U})},24098:(Be,ye,l)=>{l.d(ye,{GB:()=>i,Qo:()=>C,Y4:()=>ae});var U=l(44549);class i{}function ae(J){return J instanceof U.bo?J===i.instance:"unknown"===(null==J?void 0:J.toString().toLowerCase())}function C(J){return ae(J)?i.instance:J}i.instance=new U.oh("Etc/UTC")},721:(Be,ye,l)=>{l.d(ye,{$X:()=>Pe,Gy:()=>R,P5:()=>Ke,SW:()=>Le,Tr:()=>we,VV:()=>J}),l(61320);const ae=(c,p,m)=>[p,m],C=(c,p,m)=>[p,m,c[2]],ee=(c,p,m)=>[p,m,c[2],c[3]];function J(c){return c?{originPosition:"upper-left"===c.originPosition?"upperLeft":"lower-left"===c.originPosition?"lowerLeft":c.originPosition,scale:c.tolerance?[c.tolerance,c.tolerance]:[1,1],translate:null!=c.extent?[c.extent.xmin,c.extent.ymax]:[0,0]}:null}function E({scale:c,translate:p},m){return m*c[0]+p[0]}function O({scale:c,translate:p},m){return p[1]-m*c[1]}function N(c,p,m){const Z=new Array(m.length);if(!m.length)return Z;const[$,ie]=c.scale;let ge=E(c,m[0][0]),ve=O(c,m[0][1]);Z[0]=p(m[0],ge,ve);for(let Re=1;Re<m.length;Re++){const Me=m[Re];ge+=Me[0]*$,ve-=Me[1]*ie,Z[Re]=p(Me,ge,ve)}return Z}function w(c,p,m){const Z=new Array(m.length);for(let $=0;$<m.length;$++)Z[$]=N(c,p,m[$]);return Z}function R(c,p,m,Z,$){return p.x=function fe({scale:c,translate:p},m){return Math.round((m-p[0])/c[0])}(c,m.x),p.y=function re({scale:c,translate:p},m){return Math.round((p[1]-m)/c[1])}(c,m.y),p!==m&&(Z&&(p.z=m.z),$&&(p.m=m.m)),p}function Le(c,p,m,Z,$){return null!=m&&(p.points=function v(c,p,m,Z){return N(c,m?Z?ee:C:Z?C:ae,p)}(c,m.points,Z,$)),p}function we(c,p,m,Z,$){return null==m||(p.x=E(c,m.x),p.y=O(c,m.y),p!==m&&(Z&&(p.z=m.z),$&&(p.m=m.m))),p}function Pe(c,p,m,Z,$){return null!=m&&(p.rings=function Y(c,p,m,Z){return w(c,m?Z?ee:C:Z?C:ae,p)}(c,m.rings,Z,$)),p}function Ke(c,p,m,Z,$){return null!=m&&(p.paths=function b(c,p,m,Z){return w(c,m?Z?ee:C:Z?C:ae,p)}(c,m.paths,Z,$)),p}},30380:(Be,ye,l)=>{l.r(ye),l.d(ye,{default:()=>Gr});var U=l(10467),i=l(8189),ae=l(23098),C=l(21152),ee=l(81098),J=l(92165),E=(l(79122),l(70176),l(92089),l(9826),l(15317),l(38582),l(73747),l(13318),l(85718)),O=l(35150),N=l(31178),w=l(5922),T=l(39693),v=l(89221),b=l(56492),Y=l(48900),P=l(82663),x=l(45272),s=l(85211),M=(l(3248),l(40707),l(17221)),y=l(76576),R=l(50305),z=l(23506),H=l(28067),_e=l(11817),X=l(58701),Le=l(95478),we=l(93410),Pe=l(17049),Ke=l(85551),c=l(33036),p=l(68438),m=l(47280),Z=l(71065),$=l(46602);let ie=class extends Z.oY{constructor(o){super(o),this.break=new $.A({color:[255,255,255],size:12,outline:{color:[0,122,194],width:3}}),this.first=new $.A({color:[0,255,0],size:20,outline:{color:[255,255,255],width:4}}),this.unlocated=new $.A({color:[255,0,0],size:12,outline:{color:[255,255,255],width:3}}),this.last=new $.A({color:[255,0,0],size:20,outline:{color:[255,255,255],width:4}}),this.middle=new $.A({color:[51,51,51],size:12,outline:{color:[0,122,194],width:3}}),this.waypoint=new $.A({color:[255,255,255],size:12,outline:{color:[0,122,194],width:3}})}};(0,i._)([(0,s.MZ)({types:m.Es})],ie.prototype,"break",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],ie.prototype,"first",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],ie.prototype,"unlocated",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],ie.prototype,"last",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],ie.prototype,"middle",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],ie.prototype,"waypoint",void 0),ie=(0,i._)([(0,y.$)("esri.layers.support.RouteStopSymbols")],ie);const ge=ie;var ve=l(55417),Re=l(88521);let Me=class extends Z.oY{constructor(o){super(o),this.directionLines=new ve.A({color:[0,122,194],width:6}),this.directionPoints=new $.A({color:[255,255,255],size:6,outline:{color:[0,122,194],width:2}}),this.pointBarriers=new $.A({style:"x",size:10,outline:{color:[255,0,0],width:3}}),this.polygonBarriers=new Re.A({color:[255,170,0,.6],outline:{width:7.5,color:[255,0,0,.6]}}),this.polylineBarriers=new ve.A({width:7.5,color:[255,85,0,.7]}),this.routeInfo=new ve.A({width:8,color:[20,89,127]}),this.stops=new ge}};(0,i._)([(0,s.MZ)({types:m.Es})],Me.prototype,"directionLines",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],Me.prototype,"directionPoints",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],Me.prototype,"pointBarriers",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],Me.prototype,"polygonBarriers",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],Me.prototype,"polylineBarriers",void 0),(0,i._)([(0,s.MZ)({types:m.Es})],Me.prototype,"routeInfo",void 0),(0,i._)([(0,s.MZ)({type:ge})],Me.prototype,"stops",void 0),Me=(0,i._)([(0,y.$)("esri.layers.support.RouteSymbols")],Me);const Ge=Me;var et=l(73874),or=l(46577),ir=l(69927),Ve=l(89563),Ye=l(68800),Oe=l(15463),Ee=l(81401);let Ze=class extends Z.oY{constructor(o){super(o),this.dataType=null,this.name=null,this.parameterNames=null,this.restrictionUsageParameterName=null,this.timeNeutralAttributeName=null,this.trafficSupport=null,this.units=null,this.usageType=null}};(0,i._)([(0,s.MZ)({type:String})],Ze.prototype,"dataType",void 0),(0,i._)([(0,Oe.e)(Ee.et,{ignoreUnknown:!1})],Ze.prototype,"name",void 0),(0,i._)([(0,s.MZ)({type:[String]})],Ze.prototype,"parameterNames",void 0),(0,i._)([(0,s.MZ)({type:String})],Ze.prototype,"restrictionUsageParameterName",void 0),(0,i._)([(0,Oe.e)(Ee.Mm,{ignoreUnknown:!1})],Ze.prototype,"timeNeutralAttributeName",void 0),(0,i._)([(0,s.MZ)({type:String})],Ze.prototype,"trafficSupport",void 0),(0,i._)([(0,Oe.e)(Ee.dn)],Ze.prototype,"units",void 0),(0,i._)([(0,Oe.e)(Ee.WU)],Ze.prototype,"usageType",void 0),Ze=(0,i._)([(0,y.$)("esri.rest.support.NetworkAttribute")],Ze);const sr=Ze;let $e=class extends Z.oY{constructor(o){super(o),this.buildTime=null,this.name=null,this.networkAttributes=null,this.networkSources=null,this.state=null}};(0,i._)([(0,s.MZ)({type:Number})],$e.prototype,"buildTime",void 0),(0,i._)([(0,s.MZ)({type:String})],$e.prototype,"name",void 0),(0,i._)([(0,s.MZ)({type:[sr]})],$e.prototype,"networkAttributes",void 0),(0,i._)([(0,s.MZ)()],$e.prototype,"networkSources",void 0),(0,i._)([(0,s.MZ)({type:String})],$e.prototype,"state",void 0),$e=(0,i._)([(0,y.$)("esri.rest.support.NetworkDataset")],$e);const nr=$e;var ht=l(36938);let Te=class extends Z.oY{constructor(o){super(o),this.accumulateAttributeNames=null,this.attributeParameterValues=null,this.currentVersion=null,this.defaultTravelMode=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsSupportedLanguages=null,this.directionsTimeAttribute=null,this.hasZ=null,this.impedance=null,this.networkDataset=null,this.supportedTravelModes=null}readAccumulateAttributes(o){return null==o?null:o.map(a=>Ee.et.fromJSON(a))}writeAccumulateAttributes(o,a,d){null!=o&&o.length&&(a[d]=o.map(_=>Ee.et.toJSON(_)))}get capabilities(){var o;return{supportsNow:(null!==(o=this.currentVersion)&&void 0!==o?o:10)>=10.81}}readDefaultTravelMode(o,a){var d,_,S;const j=null!==(d=null===(_=a.supportedTravelModes)||void 0===_?void 0:_.find(({id:D})=>D===a.defaultTravelMode))&&void 0!==d?d:null===(S=a.supportedTravelModes)||void 0===S?void 0:S.find(({itemId:D})=>D===a.defaultTravelMode);return j?ht.A.fromJSON(j):null}};(0,i._)([(0,s.MZ)()],Te.prototype,"accumulateAttributeNames",void 0),(0,i._)([(0,M.w)("accumulateAttributeNames")],Te.prototype,"readAccumulateAttributes",null),(0,i._)([(0,R.K)("accumulateAttributeNames")],Te.prototype,"writeAccumulateAttributes",null),(0,i._)([(0,s.MZ)()],Te.prototype,"attributeParameterValues",void 0),(0,i._)([(0,s.MZ)()],Te.prototype,"capabilities",null),(0,i._)([(0,s.MZ)()],Te.prototype,"currentVersion",void 0),(0,i._)([(0,s.MZ)()],Te.prototype,"defaultTravelMode",void 0),(0,i._)([(0,M.w)("defaultTravelMode",["defaultTravelMode","supportedTravelModes"])],Te.prototype,"readDefaultTravelMode",null),(0,i._)([(0,s.MZ)()],Te.prototype,"directionsLanguage",void 0),(0,i._)([(0,Oe.e)(Ee.Z7)],Te.prototype,"directionsLengthUnits",void 0),(0,i._)([(0,s.MZ)()],Te.prototype,"directionsSupportedLanguages",void 0),(0,i._)([(0,Oe.e)(Ee.Mm,{ignoreUnknown:!1})],Te.prototype,"directionsTimeAttribute",void 0),(0,i._)([(0,s.MZ)()],Te.prototype,"hasZ",void 0),(0,i._)([(0,Oe.e)(Ee.et,{ignoreUnknown:!1})],Te.prototype,"impedance",void 0),(0,i._)([(0,s.MZ)({type:nr})],Te.prototype,"networkDataset",void 0),(0,i._)([(0,s.MZ)({type:[ht.A]})],Te.prototype,"supportedTravelModes",void 0),Te=(0,i._)([(0,y.$)("esri.rest.support.NetworkServiceDescription")],Te);const lr=Te;function nt(o,a,d,_){_[d]=[a.length,a.length+o.length],o.forEach(S=>{a.push(S.geometry)})}function Ft(o,a,d){return ft.apply(this,arguments)}function ft(){return ft=(0,U.A)(function*(o,a,d){if(!o)throw new w.A("network-service:missing-url","Url to Network service is missing");const _=(0,Ye.jV)({f:"json",token:a},d),{data:S}=yield(0,Ve.A)(o,_),j=S.currentVersion>=10.4?function cr(o,a,d){return _t.apply(this,arguments)}(o,a,d):function pr(o,a){return vt.apply(this,arguments)}(o,d),{defaultTravelMode:D,supportedTravelModes:B}=yield j;return S.defaultTravelMode=D,S.supportedTravelModes=B,lr.fromJSON(S)}),ft.apply(this,arguments)}function vt(){return(vt=(0,U.A)(function*(o,a){var d;const _=(0,Ye.jV)({f:"json"},a),{data:S}=yield(0,Ve.A)(o.replace(/\/rest\/.*$/i,"/info"),_);if(null==S||!S.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};const{owningSystemUrl:j}=S,D=(0,x.UC)(j)+"/sharing/rest/portals/self",{data:B}=yield(0,Ve.A)(D,_),q=(0,v.wc)("helperServices.routingUtilities.url",B);if(!q)return{supportedTravelModes:[],defaultTravelMode:null};const ne=(0,Ye.Dl)(j),I=/\/solve$/i.test(ne.path)?"Route":/\/solveclosestfacility$/i.test(ne.path)?"ClosestFacility":"ServiceAreas",pe=(0,Ye.jV)({f:"json",serviceName:I},a),Se=(0,x.UC)(q)+"/GetTravelModes/execute",ce=yield(0,Ve.A)(Se,pe),ue=[];let me=null;if(null!=ce&&null!==(d=ce.data)&&void 0!==d&&null!==(d=d.results)&&void 0!==d&&d.length){const se=ce.data.results;for(const G of se)if("supportedTravelModes"===G.paramName){var k;if(null!==(k=G.value)&&void 0!==k&&k.features)for(const{attributes:Q}of G.value.features)if(Q){const le=JSON.parse(Q.TravelMode);ue.push(le)}}else"defaultTravelMode"===G.paramName&&(me=G.value)}return{supportedTravelModes:ue,defaultTravelMode:me}})).apply(this,arguments)}function _t(){return(_t=(0,U.A)(function*(o,a,d){try{const _=(0,Ye.jV)({f:"json",token:a},d),S=(0,x.UC)(o)+"/retrieveTravelModes",{data:{supportedTravelModes:j,defaultTravelMode:D}}=yield(0,Ve.A)(S,_);return{supportedTravelModes:j,defaultTravelMode:D}}catch(_){throw new w.A("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:_})}})).apply(this,arguments)}var yr=l(92073),mr=l(77098),zt=l(50254),be=l(93327),$t=l(89952),Wt=l(49976);const Kt=new Wt.J({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let tt=class extends Z.oY{constructor(o){super(o),this.description=null,this.type=null}};(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],tt.prototype,"description",void 0),(0,i._)([(0,s.MZ)({type:String,json:{read:Kt.read,write:Kt.write}})],tt.prototype,"type",void 0),tt=(0,i._)([(0,y.$)("esri.rest.support.GPMessage")],tt);const hr=tt,Jt=new Wt.J({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});let lt=class extends hr{constructor(o){super(o),this.type=null}};(0,i._)([(0,s.MZ)({type:String,json:{read:Jt.read,write:Jt.write}})],lt.prototype,"type",void 0),lt=(0,i._)([(0,y.$)("esri.rest.support.NAMessage")],lt);const fr=lt;let rt=class extends Z.oY{constructor(o){super(o)}};(0,i._)([(0,s.MZ)({json:{read:{source:"string"}}})],rt.prototype,"text",void 0),(0,i._)([(0,Oe.e)(Ee.Ec,{name:"stringType"})],rt.prototype,"type",void 0),rt=(0,i._)([(0,y.$)("esri.rest.support.DirectionsString")],rt);const Gt=rt;var Vt=l(13303);let Fe=class extends Z.oY{constructor(o){super(o),this.arriveTime=null,this.arriveTimeOffset=null,this.geometry=null,this.strings=null}readArriveTimeOffset(o,a){return(0,zt.Zn)(a.ETA,a.arriveTimeUTC)}readGeometry(o,a){return Vt.A.fromJSON(a.point)}};(0,i._)([(0,s.MZ)({type:Date,json:{read:{source:"arriveTimeUTC"}}})],Fe.prototype,"arriveTime",void 0),(0,i._)([(0,s.MZ)()],Fe.prototype,"arriveTimeOffset",void 0),(0,i._)([(0,M.w)("arriveTimeOffset",["arriveTimeUTC","ETA"])],Fe.prototype,"readArriveTimeOffset",null),(0,i._)([(0,s.MZ)({type:Vt.A})],Fe.prototype,"geometry",void 0),(0,i._)([(0,M.w)("geometry",["point"])],Fe.prototype,"readGeometry",null),(0,i._)([(0,s.MZ)({type:[Gt]})],Fe.prototype,"strings",void 0),Fe=(0,i._)([(0,y.$)("esri.rest.support.DirectionsEvent")],Fe);const vr=Fe;var gt=l(93615);let He=class extends ee.A{constructor(o){super(o),this.events=null,this.strings=null}readGeometry(o,a){const d=function _r(o){if(null==o||""===o)return null;let a=0,d=0,_=0,S=0;const j=[];let D,B,q,ne,I,pe,Se,ce,ue=0,me=0,k=0;if(I=o.match(/((\+|\-)[^\+\-\|]+|\|)/g),I||(I=[]),0===parseInt(I[ue],32)){ue=2;const se=parseInt(I[ue],32);ue++,pe=parseInt(I[ue],32),ue++,1&se&&(me=I.indexOf("|")+1,Se=parseInt(I[me],32),me++),2&se&&(k=I.indexOf("|",me)+1,ce=parseInt(I[k],32),k++)}else pe=parseInt(I[ue],32),ue++;for(;ue<I.length&&"|"!==I[ue];){D=parseInt(I[ue],32)+a,ue++,a=D,B=parseInt(I[ue],32)+d,ue++,d=B;const se=[D/pe,B/pe];me&&(ne=parseInt(I[me],32)+_,me++,_=ne,se.push(ne/Se)),k&&(q=parseInt(I[k],32)+S,k++,S=q,se.push(q/ce)),j.push(se)}return{paths:[j],hasZ:me>0,hasM:k>0}}(a.compressedGeometry);return null!=d?gt.A.fromJSON(d):null}};(0,i._)([(0,s.MZ)({type:[vr]})],He.prototype,"events",void 0),(0,i._)([(0,M.w)("geometry",["compressedGeometry"])],He.prototype,"readGeometry",null),(0,i._)([(0,s.MZ)({type:[Gt]})],He.prototype,"strings",void 0),He=(0,i._)([(0,y.$)("esri.rest.support.DirectionsFeature")],He);const gr=He;var ze=l(32034);let Ne=class extends be.A{constructor(o){super(o),this.extent=null,this.features=[],this.geometryType="polyline",this.routeId=null,this.routeName=null,this.totalDriveTime=null,this.totalLength=null,this.totalTime=null}readFeatures(o,a){var d;if(!o)return[];const _=null!==(d=a.summary.envelope.spatialReference)&&void 0!==d?d:a.spatialReference,S=_&&ze.A.fromJSON(_);return o.map(j=>{const D=gr.fromJSON(j);if(null!=D.geometry&&(D.geometry.spatialReference=S),null!=D.events)for(const B of D.events)null!=B.geometry&&(B.geometry.spatialReference=S);return D})}get mergedGeometry(){return this.features?function Mr(o,a){if(0===o.length)return new gt.A({spatialReference:a});const d=[];for(const D of o)for(const B of D.paths)d.push(...B);const _=[];d.forEach((D,B)=>{0!==B&&D[0]===d[B-1][0]&&D[1]===d[B-1][1]||_.push(D)});const{hasM:S,hasZ:j}=o[0];return new gt.A({hasM:S,hasZ:j,paths:[_],spatialReference:a})}(this.features.map(({geometry:o})=>o),this.extent.spatialReference):null}get strings(){return this.features.flatMap(({strings:o})=>o).filter($t.Ru)}};(0,i._)([(0,s.MZ)({type:H.A,json:{read:{source:"summary.envelope"}}})],Ne.prototype,"extent",void 0),(0,i._)([(0,s.MZ)({nonNullable:!0})],Ne.prototype,"features",void 0),(0,i._)([(0,M.w)("features")],Ne.prototype,"readFeatures",null),(0,i._)([(0,s.MZ)()],Ne.prototype,"geometryType",void 0),(0,i._)([(0,s.MZ)({readOnly:!0})],Ne.prototype,"mergedGeometry",null),(0,i._)([(0,s.MZ)()],Ne.prototype,"routeId",void 0),(0,i._)([(0,s.MZ)()],Ne.prototype,"routeName",void 0),(0,i._)([(0,s.MZ)({value:null,readOnly:!0})],Ne.prototype,"strings",null),(0,i._)([(0,s.MZ)({json:{read:{source:"summary.totalDriveTime"}}})],Ne.prototype,"totalDriveTime",void 0),(0,i._)([(0,s.MZ)({json:{read:{source:"summary.totalLength"}}})],Ne.prototype,"totalLength",void 0),(0,i._)([(0,s.MZ)({json:{read:{source:"summary.totalTime"}}})],Ne.prototype,"totalTime",void 0),Ne=(0,i._)([(0,y.$)("esri.rest.support.DirectionsFeatureSet")],Ne);const Sr=Ne;let xe=class extends Z.oY{constructor(o){super(o),this.directionLines=null,this.directionPoints=null,this.directions=null,this.route=null,this.routeName=null,this.stops=null,this.traversedEdges=null,this.traversedJunctions=null,this.traversedTurns=null}};(0,i._)([(0,s.MZ)({type:be.A,json:{write:!0}})],xe.prototype,"directionLines",void 0),(0,i._)([(0,s.MZ)({type:be.A,json:{write:!0}})],xe.prototype,"directionPoints",void 0),(0,i._)([(0,s.MZ)({type:Sr,json:{write:!0}})],xe.prototype,"directions",void 0),(0,i._)([(0,s.MZ)({type:ee.A,json:{write:!0}})],xe.prototype,"route",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],xe.prototype,"routeName",void 0),(0,i._)([(0,s.MZ)({type:[ee.A],json:{write:!0}})],xe.prototype,"stops",void 0),(0,i._)([(0,s.MZ)({type:be.A,json:{write:!0}})],xe.prototype,"traversedEdges",void 0),(0,i._)([(0,s.MZ)({type:be.A,json:{write:!0}})],xe.prototype,"traversedJunctions",void 0),(0,i._)([(0,s.MZ)({type:be.A,json:{write:!0}})],xe.prototype,"traversedTurns",void 0),xe=(0,i._)([(0,y.$)("esri.rest.support.RouteResult")],xe);const Ar=xe;function Mt(o){return o?be.A.fromJSON(o).features.filter($t.Ru):[]}let je=class extends Z.oY{constructor(o){super(o),this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routeResults=null}readPointBarriers(o,a){return Mt(a.barriers)}readPolylineBarriers(o){return Mt(o)}readPolygonBarriers(o){return Mt(o)}};(0,i._)([(0,s.MZ)({type:[fr]})],je.prototype,"messages",void 0),(0,i._)([(0,s.MZ)({type:[ee.A]})],je.prototype,"pointBarriers",void 0),(0,i._)([(0,M.w)("pointBarriers",["barriers"])],je.prototype,"readPointBarriers",null),(0,i._)([(0,s.MZ)({type:[ee.A]})],je.prototype,"polylineBarriers",void 0),(0,i._)([(0,M.w)("polylineBarriers")],je.prototype,"readPolylineBarriers",null),(0,i._)([(0,s.MZ)({type:[ee.A]})],je.prototype,"polygonBarriers",void 0),(0,i._)([(0,M.w)("polygonBarriers")],je.prototype,"readPolygonBarriers",null),(0,i._)([(0,s.MZ)({type:[Ar]})],je.prototype,"routeResults",void 0),je=(0,i._)([(0,y.$)("esri.rest.support.RouteSolveResult")],je);const Er=je;function at(o){return o instanceof be.A}function St(){return(St=(0,U.A)(function*(o,a,d){const _=[],S=[],j={},D={},B=(0,Ye.Dl)(o),{path:q}=B;at(a.stops)&&nt(a.stops.features,S,"stops.features",j),at(a.pointBarriers)&&nt(a.pointBarriers.features,S,"pointBarriers.features",j),at(a.polylineBarriers)&&nt(a.polylineBarriers.features,S,"polylineBarriers.features",j),at(a.polygonBarriers)&&nt(a.polygonBarriers.features,S,"polygonBarriers.features",j);const ne=yield(0,mr.el)(S);for(const ce in j){const ue=j[ce];_.push(ce),D[ce]=ne.slice(ue[0],ue[1])}if(function dr(o,a){for(let d=0;d<a.length;d++){const _=o[a[d]];if(_&&_.length)for(const S of _)if(null!=S&&S.hasZ)return!0}return!1}(D,_)){let ce=null;try{ce=yield Ft(q,a.apiKey,d)}catch{}ce&&!ce.hasZ&&function ur(o,a){for(let d=0;d<a.length;d++){const _=o[a[d]];if(_&&_.length)for(const S of _)S.z=void 0}O.A.getLogger("esri.rest.networkService").warnOnce("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")}(D,_)}for(const ce in D)D[ce].forEach((ue,me)=>{(0,yr.Jt)(a,ce)[me].geometry=ue});const I={...d,query:{...B.query,...(0,zt.r9)(a),f:"json"}},pe=q.endsWith("/solve")?q:`${q}/solve`,{data:Se}=yield(0,Ve.A)(pe,I);return function Tr(o){var a;const{barriers:d,directionLines:_,directionPoints:S,directions:j,messages:D,polygonBarriers:B,polylineBarriers:q,routes:ne,stops:I,traversedEdges:pe,traversedJunctions:Se,traversedTurns:ce}=o,ue=G=>{const Q=k.find(oe=>oe.routeName===G);if(null!=Q)return Q;const le={routeId:k.length+1,routeName:G};return k.push(le),le},me=G=>{const Q=k.find(oe=>oe.routeId===G);if(null!=Q)return Q;const le={routeId:G,routeName:null};return k.push(le),le},k=[];null!=ne&&ne.features.forEach((G,Q)=>{var le;G.geometry.spatialReference=null!==(le=ne.spatialReference)&&void 0!==le?le:void 0,k.push({routeId:Q+1,routeName:G.attributes.Name,route:G})}),null==j||j.forEach(G=>{const{routeName:Q}=G;ue(Q).directions=G});const se=null!==(a=null==I?void 0:I.features.every(G=>null==G.attributes.RouteName))&&void 0!==a&&a&&k.length>0?k[0].routeName:null;return null!=I&&I.features.forEach(G=>{var Q,le,oe,Ae;G.geometry&&(null!==(le=(Q=G.geometry).spatialReference)&&void 0!==le||(Q.spatialReference=null!==(oe=I.spatialReference)&&void 0!==oe?oe:void 0));const Ie=ue(null!=se?se:G.attributes.RouteName);null!==(Ae=Ie.stops)&&void 0!==Ae||(Ie.stops=[]),Ie.stops.push(G)}),null!=_&&_.features.forEach(G=>{var Q;const oe=me(G.attributes.RouteID),{geometryType:Ae,spatialReference:he}=_;null!==(Q=oe.directionLines)&&void 0!==Q||(oe.directionLines={features:[],geometryType:Ae,spatialReference:he}),oe.directionLines.features.push(G)}),null!=S&&S.features.forEach(G=>{var Q;const oe=me(G.attributes.RouteID),{geometryType:Ae,spatialReference:he}=S;null!==(Q=oe.directionPoints)&&void 0!==Q||(oe.directionPoints={features:[],geometryType:Ae,spatialReference:he}),oe.directionPoints.features.push(G)}),null!=pe&&pe.features.forEach(G=>{var Q;const oe=me(G.attributes.RouteID),{geometryType:Ae,spatialReference:he}=pe;null!==(Q=oe.traversedEdges)&&void 0!==Q||(oe.traversedEdges={features:[],geometryType:Ae,spatialReference:he}),oe.traversedEdges.features.push(G)}),null!=Se&&Se.features.forEach(G=>{var Q;const oe=me(G.attributes.RouteID),{geometryType:Ae,spatialReference:he}=Se;null!==(Q=oe.traversedJunctions)&&void 0!==Q||(oe.traversedJunctions={features:[],geometryType:Ae,spatialReference:he}),oe.traversedJunctions.features.push(G)}),null!=ce&&ce.features.forEach(G=>{var Q;const oe=me(G.attributes.RouteID);null!==(Q=oe.traversedTurns)&&void 0!==Q||(oe.traversedTurns={features:[]}),oe.traversedTurns.features.push(G)}),Er.fromJSON({routeResults:k,barriers:d,polygonBarriers:B,polylineBarriers:q,messages:D})}(Se)})).apply(this,arguments)}var ot=l(58226),it=l(37304),Qe=l(23632),Xe=l(34720),ke=l(51882),ut=l(22560),At=l(90660),wr=l(55739);const Or={type:String,json:{read:{source:"token"},write:{target:"token"}}};var Rr=l(61320);let Ue=class extends((0,At.O)(Z.oY)){constructor(o){super(o),this.doNotLocateOnRestrictedElements=null,this.geometry=null,this.geometryType=null,this.name=null,this.spatialRelationship=null,this.type="layer",this.where=null}};(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],Ue.prototype,"doNotLocateOnRestrictedElements",void 0),(0,i._)([(0,s.MZ)({types:C.yR,json:{read:Rr.rS,write:!0}})],Ue.prototype,"geometry",void 0),(0,i._)([(0,Oe.e)(Ee.Vj)],Ue.prototype,"geometryType",void 0),(0,i._)([(0,s.MZ)({type:String,json:{name:"layerName",write:!0}})],Ue.prototype,"name",void 0),(0,i._)([(0,Oe.e)(Ee.vS,{name:"spatialRel"})],Ue.prototype,"spatialRelationship",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],Ue.prototype,"type",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],Ue.prototype,"where",void 0),Ue=(0,i._)([(0,y.$)("esri.rest.support.DataLayer")],Ue);const Ir=Ue;var Et;let dt=Et=class extends be.A{constructor(o){super(o),this.doNotLocateOnRestrictedElements=null}clone(){return new Et({doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements,...this.cloneProperties()})}};(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],dt.prototype,"doNotLocateOnRestrictedElements",void 0),dt=Et=(0,i._)([(0,y.$)("esri.rest.support.NetworkFeatureSet")],dt);const Dr=dt;let st=class extends((0,At.O)(Z.oY)){constructor(o){super(o),this.doNotLocateOnRestrictedElements=null,this.url=null}};(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],st.prototype,"doNotLocateOnRestrictedElements",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],st.prototype,"url",void 0),st=(0,i._)([(0,y.$)("esri.rest.support.NetworkUrl")],st);const Br=st;var Pt;let W=Pt=class extends((0,At.O)(Z.oY)){constructor(o){super(o),this.accumulateAttributes=null,this.apiKey=null,this.attributeParameterValues=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsOutputType=null,this.directionsStyleName=null,this.directionsTimeAttribute=null,this.findBestSequence=null,this.geometryPrecision=null,this.geometryPrecisionM=null,this.geometryPrecisionZ=null,this.ignoreInvalidLocations=null,this.impedanceAttribute=null,this.outputGeometryPrecision=null,this.outputGeometryPrecisionUnits=null,this.outputLines="true-shape",this.outSpatialReference=null,this.overrides=null,this.pointBarriers=null,this.polygonBarriers=null,this.polylineBarriers=null,this.preserveFirstStop=null,this.preserveLastStop=null,this.preserveObjectID=null,this.restrictionAttributes=null,this.restrictUTurns=null,this.returnBarriers=!1,this.returnDirections=!1,this.returnPolygonBarriers=!1,this.returnPolylineBarriers=!1,this.returnRoutes=!0,this.returnStops=!1,this.returnTraversedEdges=null,this.returnTraversedJunctions=null,this.returnTraversedTurns=null,this.returnZ=!0,this.startTime=null,this.startTimeIsUTC=!0,this.stops=null,this.timeWindowsAreUTC=null,this.travelMode=null,this.useHierarchy=null,this.useTimeWindows=null}static from(o){return(0,wr.PZ)(Pt,o)}readAccumulateAttributes(o){return null==o?null:o.map(a=>Ee.et.fromJSON(a))}writeAccumulateAttributes(o,a,d){null!=o&&o.length&&(a[d]=o.map(_=>Ee.et.toJSON(_)))}writePointBarriers(o,a,d){pt(o,a,d)}writePolygonBarrier(o,a,d){pt(o,a,d)}writePolylineBarrier(o,a,d){pt(o,a,d)}readRestrictionAttributes(o){return null==o?null:o.map(a=>Ee.OC.fromJSON(a))}writeRestrictionAttributes(o,a,d){null!=o&&o.length&&(a[d]=o.map(_=>Ee.OC.toJSON(_)))}readStartTime(o,a){const{startTime:d}=a;return null==d?null:"now"===d?"now":new Date(d)}writeStartTime(o,a){null!=o&&(a.startTime="now"===o?"now":o.getTime())}readStops(o,a){return function br(o){return function Nr(o){return o&&"type"in o}(o)?Ir.fromJSON(o):function Zr(o){return o&&"url"in o}(o)?Br.fromJSON(o):function xr(o){return o&&"features"in o&&"doNotLocateOnRestrictedElements"in o}(o)?Dr.fromJSON(o):function jr(o){return o&&"features"in o}(o)?be.A.fromJSON(o):null}(a.stops)}writeStops(o,a,d){pt(o,a,d)}};(0,i._)([(0,s.MZ)({type:[String],json:{name:"accumulateAttributeNames",write:!0}})],W.prototype,"accumulateAttributes",void 0),(0,i._)([(0,M.w)("accumulateAttributes")],W.prototype,"readAccumulateAttributes",null),(0,i._)([(0,R.K)("accumulateAttributes")],W.prototype,"writeAccumulateAttributes",null),(0,i._)([(0,s.MZ)(Or)],W.prototype,"apiKey",void 0),(0,i._)([(0,s.MZ)({json:{write:!0}})],W.prototype,"attributeParameterValues",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],W.prototype,"directionsLanguage",void 0),(0,i._)([(0,Oe.e)(Ee.Z7)],W.prototype,"directionsLengthUnits",void 0),(0,i._)([(0,Oe.e)(Ee.aJ)],W.prototype,"directionsOutputType",void 0),(0,i._)([(0,Oe.e)(Ee.$n)],W.prototype,"directionsStyleName",void 0),(0,i._)([(0,Oe.e)(Ee.Mm,{name:"directionsTimeAttributeName",ignoreUnknown:!1})],W.prototype,"directionsTimeAttribute",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"findBestSequence",void 0),(0,i._)([(0,s.MZ)({type:Number,json:{write:!0}})],W.prototype,"geometryPrecision",void 0),(0,i._)([(0,s.MZ)({type:Number,json:{write:!0}})],W.prototype,"geometryPrecisionM",void 0),(0,i._)([(0,s.MZ)({type:Number,json:{write:!0}})],W.prototype,"geometryPrecisionZ",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"ignoreInvalidLocations",void 0),(0,i._)([(0,Oe.e)(Ee.et,{name:"impedanceAttributeName",ignoreUnknown:!1})],W.prototype,"impedanceAttribute",void 0),(0,i._)([(0,s.MZ)({type:Number,json:{write:!0}})],W.prototype,"outputGeometryPrecision",void 0),(0,i._)([(0,Oe.e)(Ee.hY)],W.prototype,"outputGeometryPrecisionUnits",void 0),(0,i._)([(0,Oe.e)(Ee.Sr)],W.prototype,"outputLines",void 0),(0,i._)([(0,s.MZ)({type:ze.A,json:{name:"outSR",write:!0}})],W.prototype,"outSpatialReference",void 0),(0,i._)([(0,s.MZ)({json:{write:!0}})],W.prototype,"overrides",void 0),(0,i._)([(0,s.MZ)({json:{name:"barriers",write:!0}})],W.prototype,"pointBarriers",void 0),(0,i._)([(0,R.K)("pointBarriers")],W.prototype,"writePointBarriers",null),(0,i._)([(0,s.MZ)({json:{write:!0}})],W.prototype,"polygonBarriers",void 0),(0,i._)([(0,R.K)("polygonBarriers")],W.prototype,"writePolygonBarrier",null),(0,i._)([(0,s.MZ)({json:{write:!0}})],W.prototype,"polylineBarriers",void 0),(0,i._)([(0,R.K)("polylineBarriers")],W.prototype,"writePolylineBarrier",null),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"preserveFirstStop",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"preserveLastStop",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"preserveObjectID",void 0),(0,i._)([(0,s.MZ)({type:[String],json:{name:"restrictionAttributeNames",write:!0}})],W.prototype,"restrictionAttributes",void 0),(0,i._)([(0,M.w)("restrictionAttributes")],W.prototype,"readRestrictionAttributes",null),(0,i._)([(0,R.K)("restrictionAttributes")],W.prototype,"writeRestrictionAttributes",null),(0,i._)([(0,Oe.e)(Ee.hE)],W.prototype,"restrictUTurns",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnBarriers",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnDirections",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnPolygonBarriers",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnPolylineBarriers",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnRoutes",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnStops",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnTraversedEdges",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnTraversedJunctions",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnTraversedTurns",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"returnZ",void 0),(0,i._)([(0,s.MZ)({json:{write:!0}})],W.prototype,"startTime",void 0),(0,i._)([(0,M.w)("startTime")],W.prototype,"readStartTime",null),(0,i._)([(0,R.K)("startTime")],W.prototype,"writeStartTime",null),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"startTimeIsUTC",void 0),(0,i._)([(0,s.MZ)({json:{write:!0}})],W.prototype,"stops",void 0),(0,i._)([(0,M.w)("stops")],W.prototype,"readStops",null),(0,i._)([(0,R.K)("stops")],W.prototype,"writeStops",null),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"timeWindowsAreUTC",void 0),(0,i._)([(0,s.MZ)({type:ht.A,json:{write:!0}})],W.prototype,"travelMode",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"useHierarchy",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"useTimeWindows",void 0),W=Pt=(0,i._)([(0,y.$)("esri.rest.support.RouteParameters")],W);const Lr=W;function pt(o,a,d){null!=o&&(a[d]=N.A.isCollection(o)?{features:o.toArray().map(_=>_.toJSON())}:o.toJSON())}var Ur=l(20677),qe=l(48393),Cr=l(21870);function Tt(o){return o.length?o:null}function wt(o){switch(o){case"esriGeometryPoint":return{type:"esriSMS",style:"esriSMSCircle",size:12,color:[0,0,0,0],outline:wt("esriGeometryPolyline")};case"esriGeometryPolyline":return{type:"esriSLS",style:"esriSLSSolid",width:1,color:[0,0,0,0]};case"esriGeometryPolygon":return{type:"esriSFS",style:"esriSFSNull",outline:wt("esriGeometryPolyline")}}}function ct(o){return"layers"in o}function Yt(o){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,U.A)(function*(o){const a=ze.A.WGS84;return yield(0,_e.initializeProjection)(o.spatialReference,a),(0,_e.project)(o,a)})).apply(this,arguments)}function Je(o,a){switch(a){case"seconds":return o/60;case"hours":return 60*o;case"days":return 60*o*24;default:return o}}function Rt(o,a){return"decimal-degrees"===a||"points"===a||"unknown"===a?o:(0,P.oU)(o,a,"meters")}const Kr=N.A.ofType(ot.A),Jr=N.A.ofType(it.A),Ht=N.A.ofType(Qe.A),Qt=N.A.ofType(Xe.A),Xt=N.A.ofType(ke.A),kt=N.A.ofType(qe.A),qt="esri.layers.RouteLayer",er=()=>O.A.getLogger(qt);let de=class extends((0,we.d)((0,c.j)((0,Pe.q)((0,Ke.A)((0,T.P)(Le.A)))))){constructor(o){super(o),this._cachedServiceDescription=null,this._featureCollection=null,this._type="Feature Collection",this.defaultSymbols=new Ge,this.directionLines=null,this.directionPoints=null,this.featureCollectionType="route",this.legendEnabled=!1,this.maxScale=0,this.minScale=0,this.pointBarriers=new Ht,this.polygonBarriers=new Qt,this.polylineBarriers=new Xt,this.routeInfo=null,this.spatialReference=ze.A.WGS84,this.stops=new kt,this.type="route";const a=()=>{this._setStopSymbol(this.stops)};this.addHandles((0,Y.on)(()=>this.stops,"change",a,{sync:!0,onListenerAdd:a}))}writeFeatureCollectionWebmap(o,a,d,_){const S=[this._writePolygonBarriers(),this._writePolylineBarriers(),this._writePointBarriers(),this._writeRouteInfo(),this._writeDirectionLines(),this._writeDirectionPoints(),this._writeStops()].filter(B=>!!B),j=S.map((B,q)=>q);(0,v.sM)("web-map"===_.origin?"featureCollection.layers":"layers",S,a),a.opacity=this.opacity,a.visibility=this.visible,a.visibleLayers=j}readDirectionLines(o,a){return this._getNetworkFeatures(a,"DirectionLines",d=>ot.A.fromGraphic(d))}readDirectionPoints(o,a){return this._getNetworkFeatures(a,"DirectionPoints",d=>it.A.fromGraphic(d))}get fullExtent(){var o,a;const d=new H.A({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:ze.A.WGS84});if(null!=(null===(o=this.routeInfo)||void 0===o?void 0:o.geometry))return null!==(a=this.routeInfo.geometry.extent)&&void 0!==a?a:d;if(null==this.stops)return d;const _=this.stops.filter(D=>null!=D.geometry);if(_.length<2)return d;const{spatialReference:S}=_.at(0).geometry;if(null==S)return d;const j=_.toArray().map(D=>{const B=D.geometry;return[B.x,B.y]});return new Cr.A({points:j,spatialReference:S}).extent}readMaxScale(o,a){var d,_;const S=ct(a)?a.layers:null===(d=a.featureCollection)||void 0===d?void 0:d.layers,j=null==S?void 0:S.find(D=>null!=D.layerDefinition.maxScale);return null!==(_=null==j?void 0:j.layerDefinition.maxScale)&&void 0!==_?_:0}readMinScale(o,a){var d,_;const S=ct(a)?a.layers:null===(d=a.featureCollection)||void 0===d?void 0:d.layers,j=null==S?void 0:S.find(D=>null!=D.layerDefinition.minScale);return null!==(_=null==j?void 0:j.layerDefinition.minScale)&&void 0!==_?_:0}readPointBarriers(o,a){return this._getNetworkFeatures(a,"Barriers",d=>Qe.A.fromGraphic(d))}readPolygonBarriers(o,a){return this._getNetworkFeatures(a,"PolygonBarriers",d=>Xe.A.fromGraphic(d))}readPolylineBarriers(o,a){return this._getNetworkFeatures(a,"PolylineBarriers",d=>ke.A.fromGraphic(d))}readRouteInfo(o,a){const d=this._getNetworkFeatures(a,"RouteInfo",_=>ut.A.fromGraphic(_));return d.length>0?d.at(0):null}readSpatialReference(o,a){var d,_,S,j,D,B;const q=ct(a)?a.layers:null===(d=a.featureCollection)||void 0===d?void 0:d.layers;if(null==q||!q.length)return ze.A.WGS84;const{layerDefinition:ne,featureSet:I}=q[0],pe=I.features[0],Se=null!==(_=null!==(S=null!==(j=null!==(D=null==pe||null===(B=pe.geometry)||void 0===B?void 0:B.spatialReference)&&void 0!==D?D:I.spatialReference)&&void 0!==j?j:ne.spatialReference)&&void 0!==S?S:ne.extent.spatialReference)&&void 0!==_?_:X.KK;return ze.A.fromJSON(Se)}readStops(o,a){return this._getNetworkFeatures(a,"Stops",d=>qe.A.fromGraphic(d),d=>this._setStopSymbol(d))}get title(){var o;return null!=(null===(o=this.routeInfo)||void 0===o?void 0:o.name)?this.routeInfo.name:"Route"}set title(o){this._overrideIfSome("title",o)}get url(){return ae.A.routeServiceUrl}set url(o){this._set("url",null!=o?(0,p.Jf)(o,er()):ae.A.routeServiceUrl)}load(o){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},o)),Promise.resolve(this)}removeAll(){this.removeResult(),this.pointBarriers.removeAll(),this.polygonBarriers.removeAll(),this.polylineBarriers.removeAll(),this.stops.removeAll()}removeResult(){null!=this.directionLines&&(this.directionLines.removeAll(),this._set("directionLines",null)),null!=this.directionPoints&&(this.directionPoints.removeAll(),this._set("directionPoints",null)),null!=this.routeInfo&&this._set("routeInfo",null)}save(){var o=this;return(0,U.A)(function*(){yield o.load();const{fullExtent:a,portalItem:d}=o;if(!d)throw new w.A("routelayer:portal-item-not-set","save() requires to the layer to have a portal item");if(!d.id)throw new w.A("routelayer:portal-item-not-saved","Please use saveAs() first to save the routelayer");if("Feature Collection"!==d.type)throw new w.A("routelayer:portal-item-wrong-type",'Portal item needs to have type "Feature Collection"');if(null==o.routeInfo)throw new w.A("routelayer:route-unsolved","save() requires a solved route");const{portal:_}=d;yield _.signIn(),_.user||(yield d.reload());const{itemUrl:S,itemControl:j}=d;if("admin"!==j&&"update"!==j)throw new w.A("routelayer:insufficient-permissions","To save this layer, you need to be the owner or an administrator of your organization");const D={messages:[],origin:"portal-item",portal:_,url:S?(0,x.An)(S):void 0,writtenProperties:[]},B=o.write(void 0,D);return d.extent=yield Yt(a),d.title=o.title,yield d.update({data:B}),d})()}saveAs(o,a={}){var d=this;return(0,U.A)(function*(){var _,S,j,D;if(yield d.load(),null==d.routeInfo)throw new w.A("routelayer:route-unsolved","saveAs() requires a solved route");const B=or.default.from(o).clone();null!==(_=B.extent)&&void 0!==_||(B.extent=yield Yt(d.fullExtent)),B.id=null,null!==(S=B.portal)&&void 0!==S||(B.portal=et.A.getDefault()),null!==(j=B.title)&&void 0!==j||(B.title=d.title),B.type="Feature Collection",B.typeKeywords=["Data","Feature Collection",ir.mm.MULTI_LAYER,"Route Layer"];const{portal:q}=B,ne={messages:[],origin:"portal-item",portal:q,url:null,writtenProperties:[]};yield q.signIn();const I=null==a?void 0:a.folder,pe=d.write(void 0,ne);return yield null===(D=q.user)||void 0===D?void 0:D.addItem({item:B,folder:I,data:pe}),d.portalItem=B,(0,z.v)(ne),ne.portalItem=B,B})()}solve(o,a){var d=this;return(0,U.A)(function*(){var _,S,j,D,B,q,ne;const I=null!==(_=null==o?void 0:o.stops)&&void 0!==_?_:d.stops,pe=null!==(S=null==o?void 0:o.pointBarriers)&&void 0!==S?S:Tt(d.pointBarriers),Se=null!==(j=null==o?void 0:o.polylineBarriers)&&void 0!==j?j:Tt(d.polylineBarriers),ce=null!==(D=null==o?void 0:o.polygonBarriers)&&void 0!==D?D:Tt(d.polygonBarriers);if(null==I)throw new w.A("routelayer:undefined-stops","the route layer must have stops defined in the route parameters.");if((function Fr(o){return"esri.rest.support.FeatureSet"===o.declaredClass}(I)||function zr(o){return"esri.rest.support.NetworkFeatureSet"===o.declaredClass}(I))&&I.features.length<2||N.A.isCollection(I)&&I.length<2)throw new w.A("routelayer:insufficent-stops","the route layer must have two or more stops to solve a route.");if(N.A.isCollection(I))for(const he of I)he.routeName=null;const ue=null==o?void 0:o.apiKey,me=d.url,k=yield d._getServiceDescription(me,ue,a),se=null!==(B=null==o?void 0:o.travelMode)&&void 0!==B?B:k.defaultTravelMode,G=null!==(q=null==o?void 0:o.accumulateAttributes)&&void 0!==q?q:[];null!=se&&(G.push(se.distanceAttributeName),se.timeAttributeName&&G.push(se.timeAttributeName));const Q={accumulateAttributes:G,directionsOutputType:"featuresets",ignoreInvalidLocations:!0,pointBarriers:pe,polylineBarriers:Se,polygonBarriers:ce,preserveFirstStop:!0,preserveLastStop:!0,returnBarriers:!!pe,returnDirections:!0,returnPolygonBarriers:!!ce,returnPolylineBarriers:!!Se,returnRoutes:!0,returnStops:!0,stops:I},le=Lr.from(null!=o?o:{});let oe;le.set(Q);try{oe=yield function Pr(o,a,d){return St.apply(this,arguments)}(me,le,a)}catch(he){throw(0,b.zf)(he)?he:new w.A("routelayer:failed-route-request","the routing request failed",{error:he})}const Ae=d._toRouteLayerSolution(oe);return d._isOverridden("title")||(d.title=null!==(ne=Ae.routeInfo.name)&&void 0!==ne?ne:"Route"),function $r(o,a,d){var _,S,j,D,B,q,ne,I,pe,Se,ce,ue,me,k,se,G,Q;const le=null===(_=a.networkDataset)||void 0===_?void 0:_.networkAttributes,oe=null!==(S=null==le?void 0:le.filter(({usageType:V})=>"cost"===V))&&void 0!==S?S:[],Ae=null!==(j=d.travelMode)&&void 0!==j?j:a.defaultTravelMode;if(null==Ae)return void er().warn("route-layer:missing-travel-mode","The routing service must have a default travel mode or one must be specified in the route parameter.");const{timeAttributeName:he,distanceAttributeName:Ie}=Ae,It=oe.find(({name:V})=>V===he),Dt=oe.find(({name:V})=>V===Ie),yt=null!==(D=null!==(B=null===(q=d.travelMode)||void 0===q?void 0:q.impedanceAttributeName)&&void 0!==B?B:d.impedanceAttribute)&&void 0!==D?D:a.impedance,We=null==It?void 0:It.units,mt=null==Dt?void 0:Dt.units;if(!We||!mt)throw new w.A("routelayer:unknown-impedance-units","the units of either the distance or time impedance are unknown");const Vr=null!==(ne=d.directionsLanguage)&&void 0!==ne?ne:a.directionsLanguage,tr=null!==(I=null!==(pe=d.accumulateAttributes)&&void 0!==pe?pe:a.accumulateAttributeNames)&&void 0!==I?I:[],Yr=new Set(oe.filter(({name:V})=>V===he||V===Ie||V===yt||null!=V&&tr.includes(V)).map(({name:V})=>V)),Ce=V=>{for(const rr in V)Yr.has(rr)||delete V[rr]};for(const V of o.pointBarriers){var Bt;null!=V.costs&&(V.addedCost=null!==(Bt=V.costs[yt])&&void 0!==Bt?Bt:0,Ce(V.costs))}for(const V of o.polygonBarriers){var Lt;null!=V.costs&&(V.scaleFactor=null!==(Lt=V.costs[yt])&&void 0!==Lt?Lt:1,Ce(V.costs))}for(const V of o.polylineBarriers){var Nt;null!=V.costs&&(V.scaleFactor=null!==(Nt=V.costs[yt])&&void 0!==Nt?Nt:1,Ce(V.costs))}const{routeInfo:De}=o,{findBestSequence:Hr,preserveFirstStop:Qr,preserveLastStop:Xr,startTimeIsUTC:kr,timeWindowsAreUTC:qr}=d;De.analysisSettings=new Ur.A({accumulateAttributes:tr,directionsLanguage:Vr,findBestSequence:Hr,preserveFirstStop:Qr,preserveLastStop:Xr,startTimeIsUTC:kr,timeWindowsAreUTC:qr,travelMode:Ae}),De.totalDuration=Je(null!==(Se=null===(ce=De.totalCosts)||void 0===ce?void 0:ce[he])&&void 0!==Se?Se:0,We),De.totalDistance=Rt(null!==(ue=null===(me=De.totalCosts)||void 0===me?void 0:me[Ie])&&void 0!==ue?ue:0,mt),De.totalLateDuration=Je(null!==(k=null===(se=De.totalViolations)||void 0===se?void 0:se[he])&&void 0!==k?k:0,We),De.totalWaitDuration=Je(null!==(G=null===(Q=De.totalWait)||void 0===Q?void 0:Q[he])&&void 0!==G?G:0,We),null!=De.totalCosts&&Ce(De.totalCosts),null!=De.totalViolations&&Ce(De.totalViolations),null!=De.totalWait&&Ce(De.totalWait);for(const V of o.stops){var xt,Zt,jt,bt,Ut,Ct;null!=V.serviceCosts&&(V.serviceDuration=Je(null!==(xt=V.serviceCosts[he])&&void 0!==xt?xt:0,We),V.serviceDistance=Rt(null!==(Zt=V.serviceCosts[Ie])&&void 0!==Zt?Zt:0,mt),Ce(V.serviceCosts)),null!=V.cumulativeCosts&&(V.cumulativeDuration=Je(null!==(jt=V.cumulativeCosts[he])&&void 0!==jt?jt:0,We),V.cumulativeDistance=Rt(null!==(bt=V.cumulativeCosts[Ie])&&void 0!==bt?bt:0,mt),Ce(V.cumulativeCosts)),null!=V.violations&&(V.lateDuration=Je(null!==(Ut=V.violations[he])&&void 0!==Ut?Ut:0,We),Ce(V.violations)),null!=V.wait&&(V.waitDuration=Je(null!==(Ct=V.wait[he])&&void 0!==Ct?Ct:0,We),Ce(V.wait))}}(Ae,k,le),Ae})()}update(o){const{stops:a,directionLines:d,directionPoints:_,pointBarriers:S,polylineBarriers:j,polygonBarriers:D,routeInfo:B}=o;this.set({stops:a,pointBarriers:S,polylineBarriers:j,polygonBarriers:D}),this._set("directionLines",d),this._set("directionPoints",_),this._set("routeInfo",B),null!=B.geometry&&(this.spatialReference=B.geometry.spatialReference)}_getNetworkFeatures(o,a,d,_){var S,j,D,B;const q=ct(o)?o.layers:null===(S=o.featureCollection)||void 0===S?void 0:S.layers,ne=null==q?void 0:q.find(Q=>Q.layerDefinition.name===a);if(null==ne)return new N.A;const{layerDefinition:I,popupInfo:pe,featureSet:Se}=ne,ce=I.drawingInfo.renderer,{features:ue}=Se,me=null!==(j=null!==(D=null!==(B=Se.spatialReference)&&void 0!==B?B:I.spatialReference)&&void 0!==D?D:I.extent.spatialReference)&&void 0!==j?j:X.KK,k=ce&&(0,E.L)(ce),se=ze.A.fromJSON(me),G=ue.map(Q=>{var le,oe,Ae;const he=ee.A.fromJSON(Q);null!=he.geometry&&null!=Q.geometry&&null==Q.geometry.spatialReference&&(he.geometry.spatialReference=se);const Ie=d(he);return null!==(le=Ie.symbol)&&void 0!==le||(Ie.symbol=null!==(oe=null==k?void 0:k.getSymbol(he))&&void 0!==oe?oe:this._getNetworkSymbol(a)),null!==(Ae=Ie.popupTemplate)&&void 0!==Ae||(Ie.popupTemplate=pe&&J.A.fromJSON(pe)),Ie});return _&&G.some(Q=>!Q.symbol)&&_(G),new N.A(G)}_getNetworkSymbol(o){switch(o){case"Barriers":return this.defaultSymbols.pointBarriers;case"DirectionPoints":return this.defaultSymbols.directionPoints;case"DirectionLines":return this.defaultSymbols.directionLines;case"PolylineBarriers":return this.defaultSymbols.polylineBarriers;case"PolygonBarriers":return this.defaultSymbols.polygonBarriers;case"RouteInfo":return this.defaultSymbols.routeInfo;case"Stops":return null}}_getServiceDescription(o,a,d){var _=this;return(0,U.A)(function*(){if(null!=_._cachedServiceDescription&&_._cachedServiceDescription.url===o)return _._cachedServiceDescription.serviceDescription;const S=yield Ft(o,a,d);return _._cachedServiceDescription={serviceDescription:S,url:o},S})()}_setStopSymbol(o){if(!o||0===o.length||null==this.defaultSymbols.stops||o.every(({symbol:I})=>null!=I))return;const{first:a,last:d,middle:_,unlocated:S,waypoint:j,break:D}=this.defaultSymbols.stops;if(null==this.routeInfo||1===o.length)return void o.forEach((I,pe)=>{switch(pe){case 0:I.symbol=a;break;case o.length-1:I.symbol=d;break;default:I.symbol=_}});const B=o.map(({sequence:I})=>I).filter(I=>null!=I),q=Math.min(...B),ne=Math.max(...B);for(const I of o)I.symbol=I.sequence!==q?I.sequence!==ne?"ok"===I.status||"not-located-on-closest"===I.status?"waypoint"!==I.locationType?"break"!==I.locationType?_:D:j:S:d:a}_toRouteLayerSolution(o){var a,d,_,S,j,D,B;const q=null===(a=o.routeResults[0].stops)||void 0===a?void 0:a.map(k=>qe.A.fromJSON(k.toJSON()));this._setStopSymbol(q);const ne=new kt(q),I=new Qt(null===(d=o.polygonBarriers)||void 0===d?void 0:d.map(k=>{const se=Xe.A.fromJSON(k.toJSON());return se.symbol=this.defaultSymbols.polygonBarriers,se})),pe=new Xt(null===(_=o.polylineBarriers)||void 0===_?void 0:_.map(k=>{const se=ke.A.fromJSON(k.toJSON());return se.symbol=this.defaultSymbols.polylineBarriers,se})),Se=new Ht(null===(S=o.pointBarriers)||void 0===S?void 0:S.map(k=>{const se=Qe.A.fromJSON(k.toJSON());return se.symbol=this.defaultSymbols.pointBarriers,se})),ce=null===(j=o.routeResults[0].route)||void 0===j?void 0:j.toJSON(),ue=ut.A.fromJSON(ce);ue.symbol=this.defaultSymbols.routeInfo;const me=new Jr(null===(D=o.routeResults[0].directionPoints)||void 0===D?void 0:D.features.map(k=>{const se=it.A.fromJSON(k.toJSON());return se.symbol=this.defaultSymbols.directionPoints,se}));return{directionLines:new Kr(null===(B=o.routeResults[0].directionLines)||void 0===B?void 0:B.features.map(k=>{const se=ot.A.fromJSON(k.toJSON());return se.symbol=this.defaultSymbols.directionLines,se})),directionPoints:me,pointBarriers:Se,polygonBarriers:I,polylineBarriers:pe,routeInfo:ue,stops:ne}}_writeDirectionLines(){return this._writeNetworkFeatures(this.directionLines,this.defaultSymbols.directionLines,"esriGeometryPolyline",ot.A.fields,ot.A.popupInfo,"DirectionLines","Direction Lines")}_writeDirectionPoints(){return this._writeNetworkFeatures(this.directionPoints,this.defaultSymbols.directionPoints,"esriGeometryPoint",it.A.fields,it.A.popupInfo,"DirectionPoints","Direction Points")}_writeNetworkFeatures(o,a,d,_,S,j,D){if(null==o||!o.length)return null;const B=this.spatialReference.toJSON(),{fullExtent:q,maxScale:ne,minScale:I}=this;return{featureSet:{features:o.toArray().map(pe=>function Wr(o){const{attributes:a,geometry:d,popupTemplate:_,symbol:S}=o.toGraphic().toJSON();return{attributes:a,geometry:d,popupInfo:_,symbol:S}}(pe)),geometryType:d,spatialReference:B},layerDefinition:{capabilities:"Query,Update,Editing",drawingInfo:{renderer:{type:"simple",symbol:null!=a?a.toJSON():wt(d)}},extent:q.toJSON(),fields:_,geometryType:d,hasM:!1,hasZ:!1,maxScale:ne,minScale:I,name:j,objectIdField:"ObjectID",spatialReference:B,title:D,type:"Feature Layer",typeIdField:""},popupInfo:S}}_writePointBarriers(){return this._writeNetworkFeatures(this.pointBarriers,this.defaultSymbols.pointBarriers,"esriGeometryPoint",Qe.A.fields,Qe.A.popupInfo,"Barriers","Point Barriers")}_writePolygonBarriers(){return this._writeNetworkFeatures(this.polygonBarriers,this.defaultSymbols.polygonBarriers,"esriGeometryPolygon",Xe.A.fields,Xe.A.popupInfo,"PolygonBarriers","Polygon Barriers")}_writePolylineBarriers(){return this._writeNetworkFeatures(this.polylineBarriers,this.defaultSymbols.polylineBarriers,"esriGeometryPolyline",ke.A.fields,ke.A.popupInfo,"PolylineBarriers","Line Barriers")}_writeRouteInfo(){return this._writeNetworkFeatures(null!=this.routeInfo?new N.A([this.routeInfo]):null,this.defaultSymbols.routeInfo,"esriGeometryPolyline",ut.A.fields,ut.A.popupInfo,"RouteInfo","Route Details")}_writeStops(){var o,a,d;const _=this._writeNetworkFeatures(this.stops,null,"esriGeometryPoint",qe.A.fields,qe.A.popupInfo,"Stops","Stops");if(null==_)return null;const{stops:S}=this.defaultSymbols,j=null==S||null===(o=S.first)||void 0===o?void 0:o.toJSON(),D=null==S||null===(a=S.middle)||void 0===a?void 0:a.toJSON(),B=null==S||null===(d=S.last)||void 0===d?void 0:d.toJSON();return _.layerDefinition.drawingInfo.renderer={type:"uniqueValue",field1:"Sequence",defaultSymbol:D,uniqueValueInfos:[{value:"1",symbol:j,label:"First Stop"},{value:`${this.stops.length}`,symbol:B,label:"Last Stop"}]},_}};(0,i._)([(0,s.MZ)({readOnly:!0,json:{read:!1,origins:{"portal-item":{write:{allowNull:!0,ignoreOrigin:!0}},"web-map":{write:{overridePolicy(){return{allowNull:!0,ignoreOrigin:null==this.portalItem}}}}}}})],de.prototype,"_featureCollection",void 0),(0,i._)([(0,R.K)(["web-map","portal-item"],"_featureCollection")],de.prototype,"writeFeatureCollectionWebmap",null),(0,i._)([(0,s.MZ)({readOnly:!0,json:{read:!1,origins:{"web-map":{write:{target:"type",overridePolicy(){return{ignoreOrigin:null!=this.portalItem}}}}}}})],de.prototype,"_type",void 0),(0,i._)([(0,s.MZ)({nonNullable:!0,type:Ge})],de.prototype,"defaultSymbols",void 0),(0,i._)([(0,s.MZ)({readOnly:!0})],de.prototype,"directionLines",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"directionLines",["layers","featureCollection.layers"])],de.prototype,"readDirectionLines",null),(0,i._)([(0,s.MZ)({readOnly:!0})],de.prototype,"directionPoints",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"directionPoints",["layers","featureCollection.layers"])],de.prototype,"readDirectionPoints",null),(0,i._)([(0,s.MZ)({readOnly:!0,json:{read:!1,origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],de.prototype,"featureCollectionType",void 0),(0,i._)([(0,s.MZ)({readOnly:!0})],de.prototype,"fullExtent",null),(0,i._)([(0,s.MZ)({json:{origins:{"web-map":{name:"featureCollection.showLegend"}},write:!0}})],de.prototype,"legendEnabled",void 0),(0,i._)([(0,s.MZ)({type:["show","hide"]})],de.prototype,"listMode",void 0),(0,i._)([(0,s.MZ)({type:Number,nonNullable:!0,json:{write:!1}})],de.prototype,"maxScale",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"maxScale",["layers","featureCollection.layers"])],de.prototype,"readMaxScale",null),(0,i._)([(0,s.MZ)({type:Number,nonNullable:!0,json:{write:!1}})],de.prototype,"minScale",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"minScale",["layers","featureCollection.layers"])],de.prototype,"readMinScale",null),(0,i._)([(0,s.MZ)({type:["ArcGISFeatureLayer"],value:"ArcGISFeatureLayer"})],de.prototype,"operationalLayerType",void 0),(0,i._)([(0,s.MZ)({nonNullable:!0,type:N.A.ofType(Qe.A)})],de.prototype,"pointBarriers",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"pointBarriers",["layers","featureCollection.layers"])],de.prototype,"readPointBarriers",null),(0,i._)([(0,s.MZ)({nonNullable:!0,type:N.A.ofType(Xe.A)})],de.prototype,"polygonBarriers",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"polygonBarriers",["layers","featureCollection.layers"])],de.prototype,"readPolygonBarriers",null),(0,i._)([(0,s.MZ)({nonNullable:!0,type:N.A.ofType(ke.A)})],de.prototype,"polylineBarriers",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"polylineBarriers",["layers","featureCollection.layers"])],de.prototype,"readPolylineBarriers",null),(0,i._)([(0,s.MZ)({readOnly:!0})],de.prototype,"routeInfo",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"routeInfo",["layers","featureCollection.layers"])],de.prototype,"readRouteInfo",null),(0,i._)([(0,s.MZ)({type:ze.A})],de.prototype,"spatialReference",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"spatialReference",["layers","featureCollection.layers"])],de.prototype,"readSpatialReference",null),(0,i._)([(0,s.MZ)({nonNullable:!0,type:N.A.ofType(qe.A)})],de.prototype,"stops",void 0),(0,i._)([(0,M.w)(["web-map","portal-item"],"stops",["layers","featureCollection.layers"])],de.prototype,"readStops",null),(0,i._)([(0,s.MZ)()],de.prototype,"title",null),(0,i._)([(0,s.MZ)({readOnly:!0,json:{read:!1}})],de.prototype,"type",void 0),(0,i._)([(0,s.MZ)()],de.prototype,"url",null),de=(0,i._)([(0,y.$)(qt)],de);const Gr=de},72211:(Be,ye,l)=>{l.d(ye,{LF:()=>ee,M9:()=>J,zu:()=>h});var U=l(5922),i=l(89221),ae=l(79845),C=l(26073);function ee(g,L,E){try{return function fe(g){if(!g||0===g.length)return null;if(function re(g){const L=g[0];return!!L&&"scale"in L}(g)){const L=[];for(const E of g)L.push({scale:E.scale,value:h(E.value)});return L}return h(g)}(g)}catch(N){var O;null==E||null===(O=E.messages)||void 0===O||O.push(N)}return null}function J(g,L,E,O){try{const N=function te(g){const L=(0,ae.q)(g);return L?(0,C.dw)(L)?L.map(E=>E.toJSON()):L.map(({scale:E,effects:O})=>({scale:E,value:O.map(N=>N.toJSON())})):null}(g);(0,i.sM)(E,N,L)}catch(N){O.messages&&O.messages.push(N)}}function h(g){if(null==g||!g.length)return"";const L=[];for(const E of g){let O=[];switch(E.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":O=[f(E,"amount")];break;case"blur":O=[f(E,"radius","pt")];break;case"hue-rotate":O=[f(E,"angle","deg")];break;case"drop-shadow":O=[f(E,"xoffset","pt"),f(E,"yoffset","pt"),f(E,"blurRadius","pt"),A(E,"color")];break;case"bloom":O=[f(E,"strength"),f(E,"radius","pt"),f(E,"threshold")]}const N=`${E.type}(${O.filter(Boolean).join(" ")})`;(0,ae.q)(N),L.push(N)}return L.join(" ")}function f(g,L,E){if(null==g[L])throw new U.A("effect:missing-parameter",`Missing parameter '${L}' in ${g.type} effect`,{effect:g});return E?g[L]+E:""+g[L]}function A(g,L){if(null==g[L])throw new U.A("effect:missing-parameter",`Missing parameter '${L}' in ${g.type} effect`,{effect:g});const E=g[L];return`rgba(${E[0]||0}, ${E[1]||0}, ${E[2]||0}, ${E[3]/255||0})`}},93410:(Be,ye,l)=>{l.d(ye,{d:()=>re});var U=l(8189),i=l(85211),J=(l(3248),l(35150),l(40707),l(76576)),te=l(72211);const fe={read:{reader:te.LF},write:{allowNull:!0,writer:te.M9}},re=h=>{let f=class extends h{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,U._)([(0,i.MZ)({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],f.prototype,"blendMode",void 0),(0,U._)([(0,i.MZ)({json:{read:!1,write:!1,origins:{"web-map":fe,"portal-item":fe}}})],f.prototype,"effect",void 0),f=(0,U._)([(0,J.$)("esri.layers.mixins.BlendLayer")],f),f}},85551:(Be,ye,l)=>{l.d(ye,{A:()=>P});var U=l(10467),i=l(8189),ae=l(23098),C=l(77469),ee=l(89563),J=l(89447),te=l(5922),fe=l(35150),re=l(11432),h=l(56492),f=l(45272),A=l(85211),E=(l(3248),l(40707),l(17221)),O=l(76576),N=l(50305),w=l(58443),T=l(73874),v=l(46577),b=l(52606),Y=l(69927);const P=s=>{let K=class extends s{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,re.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(F){F!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",F))}readPortalItem(F,M,y){if(M.itemId)return new v.default({id:M.itemId,portal:null==y?void 0:y.portal})}writePortalItem(F,M){null!=F&&F.id&&(M.itemId=F.id)}loadFromPortal(F,M){var y=this;return(0,U.A)(function*(){var R;if(null!==(R=y.portalItem)&&void 0!==R&&R.id)try{const{load:z}=yield Promise.all([l.e(5565),l.e(2076),l.e(6180)]).then(l.bind(l,56180));return(0,h.Te)(M),yield z({instance:y,supportedTypes:F.supportedTypes,validateItem:F.validateItem,supportsData:F.supportsData,layerModuleTypeMap:F.layerModuleTypeMap},M)}catch(z){throw(0,h.zf)(z)||fe.A.getLogger(y).warn(`Failed to load layer (${y.title}, ${y.id}) portal item (${y.portalItem.id})\n  ${z}`),z}})()}finishLoadEditablePortalLayer(F){var M=this;return(0,U.A)(function*(){M._set("userHasEditingPrivileges",yield M._fetchUserHasEditingPrivileges(F).catch(y=>((0,h.QP)(y),!0)))})()}setUserPrivileges(F,M){var y=this;return(0,U.A)(function*(){if(!ae.A.userPrivilegesApplied)return y.finishLoadEditablePortalLayer(M);if(y.url)try{const{features:{edit:R,fullEdit:z},content:{updateItem:H}}=yield y._fetchUserPrivileges(F,M);y._set("userHasEditingPrivileges",R),y._set("userHasFullEditingPrivileges",z),y._set("userHasUpdateItemPrivileges",H)}catch(R){(0,h.QP)(R)}})()}_fetchUserPrivileges(F,M){var y=this;return(0,U.A)(function*(){let R=y.portalItem;if(!F||!R||!R.loaded||R.sourceUrl)return y._fetchFallbackUserPrivileges(M);const z=F===R.id;if(z&&R.portal.user)return(0,Y.It)(R);let H,_e;if(z)H=R.portal.url;else try{H=yield(0,w.wI)(y.url,M)}catch(Pe){(0,h.QP)(Pe)}if(!H||!(0,f.b8)(H,R.portal.url))return y._fetchFallbackUserPrivileges(M);try{const Pe=null!=M?M.signal:null;_e=yield null==C.id?void 0:C.id.getCredential(`${H}/sharing`,{prompt:!1,signal:Pe})}catch(Pe){(0,h.QP)(Pe)}if(!_e)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(z?yield R.reload():(R=new v.default({id:F,portal:{url:H}}),yield R.load(M)),R.portal.user)return(0,Y.It)(R)}catch(Pe){(0,h.QP)(Pe)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_fetchFallbackUserPrivileges(F){var M=this;return(0,U.A)(function*(){let y=!0;try{y=yield M._fetchUserHasEditingPrivileges(F)}catch(R){(0,h.QP)(R)}return{features:{edit:y,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(F){var M=this;return(0,U.A)(function*(){const y=M.url?null==C.id?void 0:C.id.findCredential(M.url):null;if(!y)return!0;const R=x.credential===y?x.user:yield M._fetchEditingUser(F);return x.credential=y,x.user=R,null==(null==R?void 0:R.privileges)||R.privileges.includes("features:user:edit")})()}_fetchEditingUser(F){var M=this;return(0,U.A)(function*(){var y,R;const z=null===(y=M.portalItem)||void 0===y||null===(y=y.portal)||void 0===y?void 0:y.user;if(z)return z;const H=C.id.findServerInfo(null!==(R=M.url)&&void 0!==R?R:"");if(null==H||!H.owningSystemUrl)return null;const _e=`${H.owningSystemUrl}/sharing/rest`,X=T.A.getDefault();if(X&&X.loaded&&(0,f.S8)(X.restUrl)===(0,f.S8)(_e))return X.user;const Le=`${_e}/community/self`,we=null!=F?F.signal:null,Pe=yield(0,J.Ke)((0,ee.A)(Le,{authMode:"no-prompt",query:{f:"json"},signal:we}));return Pe.ok?b.A.fromJSON(Pe.value.data):null})()}read(F,M){M&&(M.layer=this),super.read(F,M)}write(F,M){var y;const R=null==M?void 0:M.portal,z=(null===(y=this.portalItem)||void 0===y?void 0:y.id)&&(this.portalItem.portal||T.A.getDefault());return R&&z&&!(0,f.ut)(z.restUrl,R.restUrl)?(M.messages&&M.messages.push(new te.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(F,{...M,layer:this})}};return(0,i._)([(0,A.MZ)({type:v.default})],K.prototype,"portalItem",null),(0,i._)([(0,E.w)("web-document","portalItem",["itemId"])],K.prototype,"readPortalItem",null),(0,i._)([(0,N.K)("web-document","portalItem",{itemId:{type:String}})],K.prototype,"writePortalItem",null),(0,i._)([(0,A.MZ)({clonable:!1})],K.prototype,"resourceReferences",void 0),(0,i._)([(0,A.MZ)({type:Boolean,readOnly:!0})],K.prototype,"userHasEditingPrivileges",void 0),(0,i._)([(0,A.MZ)({type:Boolean,readOnly:!0})],K.prototype,"userHasFullEditingPrivileges",void 0),(0,i._)([(0,A.MZ)({type:Boolean,readOnly:!0})],K.prototype,"userHasUpdateItemPrivileges",void 0),K=(0,i._)([(0,O.$)("esri.layers.mixins.PortalLayer")],K),K},x={credential:null,user:null}},33036:(Be,ye,l)=>{l.d(ye,{j:()=>te});var U=l(8189),i=l(85211),J=(l(3248),l(35150),l(40707),l(76576));const te=re=>{let h=class extends re{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const f={minScale:this.minScale,maxScale:this.maxScale},A=this.parent;A&&"effectiveScaleRange"in A&&function fe(re,h){re.minScale=re.minScale>0?h.minScale>0?Math.min(re.minScale,h.minScale):re.minScale:h.minScale,re.maxScale=re.maxScale>0?h.maxScale>0?Math.max(re.maxScale,h.maxScale):re.maxScale:h.maxScale}(f,A.effectiveScaleRange);const g=this._get("effectiveScaleRange");return g&&g.minScale===f.minScale&&g.maxScale===f.maxScale?g:f}};return(0,U._)([(0,i.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],h.prototype,"minScale",void 0),(0,U._)([(0,i.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],h.prototype,"maxScale",void 0),(0,U._)([(0,i.MZ)({readOnly:!0})],h.prototype,"effectiveScaleRange",null),h=(0,U._)([(0,J.$)("esri.layers.mixins.ScaleRangeLayer")],h),h}},73258:(Be,ye,l)=>{l.d(ye,{A:()=>g});var U=l(5922),i=l(71065),ae=l(35150),C=l(60797),ee=l(24098),J=l(86300),te=l(22639),fe=l(44549);const A=new Map;class g{static fromJSON(T){return new g(T.fields,T.timeZoneByFieldName)}static fromLayer(T){var v;return new g(null!==(v=T.fields)&&void 0!==v?v:[],N(T))}static fromLayerJSON(T){var v;return new g(null!==(v=T.fields)&&void 0!==v?v:[],N(T))}constructor(T=[],v){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=T||[],this._timeZoneByFieldName=v?new Map(v):null;const b=[];for(const P of this.fields){const x=null==P?void 0:P.name,s=E(x);if(x&&s){var Y;const K=L(x);this._fieldsMap.set(x,P),this._fieldsMap.set(K,P),this._normalizedFieldsMap.set(s,P),b.push(`${K}:${P.type}:${null===(Y=this._timeZoneByFieldName)||void 0===Y?void 0:Y.get(x)}`),(0,J.vE)(P)?(this.dateFields.push(P),this._dateFieldsSet.add(P)):(0,J.WA)(P)&&(this._numericFieldsSet.add(P),this.numericFields.push(P)),(0,J.te)(P)||(0,J.Xz)(P)||(P.editable=null==P.editable||!!P.editable,P.nullable=null==P.nullable||!!P.nullable)}}b.sort(),this.uid=b.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const T of this.fields)(0,J.te)(T)||(0,J.Xz)(T)||T.nullable||void 0!==(0,J.lD)(T)||this._requiredFields.push(T)}return this._requiredFields}equals(T){return this.uid===(null==T?void 0:T.uid)}has(T){return null!=this.get(T)}get(T){var v;if(!T)return;let b=this._fieldsMap.get(T);return b||(b=null!==(v=this._fieldsMap.get(L(T)))&&void 0!==v?v:this._normalizedFieldsMap.get(E(T)),b&&this._fieldsMap.set(T,b),b)}getTimeZone(T){const v=this.get(T&&"string"!=typeof T?T.name:T);return v?this._timeZoneByFieldName?this._timeZoneByFieldName.get(v.name):"date"===v.type||"esriFieldTypeDate"===v.type?(ae.A.getLogger("esri.layers.support.FieldsIndex").error(new U.A("getTimeZone:no-timezone-information",`no time zone information for field '${v.name}'`)),te.n$):O.has(v.type)?te.L5:null:null}getLuxonTimeZone(T){const v=this.getTimeZone(T);return v?v===te.L5?ee.GB.instance:v===te.n$?fe.mQ.utcInstance:(0,C.tE)(A,v,()=>fe.oh.create(v)):null}isDateField(T){return this._dateFieldsSet.has(this.get(T))}isTimeOnlyField(T){return(0,J.OH)(this.get(T))}isNumericField(T){return this._numericFieldsSet.has(this.get(T))}normalizeFieldName(T){var v,b;return null!==(v=null===(b=this.get(T))||void 0===b?void 0:b.name)&&void 0!==v?v:void 0}toJSON(){return{fields:this.fields.map(T=>(0,i.Wj)(T)?T.toJSON():T),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function L(w){return w.trim().toLowerCase()}function E(w){var T,v;return null!==(T=null===(v=(0,J.rS)(w))||void 0===v?void 0:v.toLowerCase())&&void 0!==T?T:""}const O=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function N(w){var T,v,b,Y,P,x,s;const K=new Map;if(!w.fields)return K;const F=!0===w.datesInUnknownTimezone,{timeInfo:M,editFieldsInfo:y}=w,R=null!==(T=M?"startField"in M?M.startField:M.startTimeField:"")&&void 0!==T?T:"",z=null!==(v=M?"endField"in M?M.endField:M.endTimeField:"")&&void 0!==v?v:"",H=function f(w){return"dateFieldsTimeZone"in w}(w)?null!==(b=w.dateFieldsTimeZone)&&void 0!==b?b:null:w.dateFieldsTimeReference?(0,te.ZS)(w.dateFieldsTimeReference):null,_e=y?function re(w){return"timeZone"in w}(y)?null!==(Y=y.timeZone)&&void 0!==Y?Y:H:y.dateFieldsTimeReference?(0,te.ZS)(y.dateFieldsTimeReference):null!=H?H:te.n$:null,X=M?function h(w){return"timeZone"in w}(M)?null!==(P=M.timeZone)&&void 0!==P?P:H:M.timeReference?(0,te.ZS)(M.timeReference):H:null,Le=new Map([[L(null!==(x=null==y?void 0:y.creationDateField)&&void 0!==x?x:""),_e],[L(null!==(s=null==y?void 0:y.editDateField)&&void 0!==s?s:""),_e],[L(R),X],[L(z),X]]);for(const{name:Pe,type:Ke}of w.fields)if(O.has(Ke))K.set(Pe,te.L5);else if("date"!==Ke&&"esriFieldTypeDate"!==Ke)K.set(Pe,null);else if(F)K.set(Pe,te.L5);else{var we;const c=null!==(we=Le.get(L(null!=Pe?Pe:"")))&&void 0!==we?we:H;K.set(Pe,c)}return K}},69927:(Be,ye,l)=>{l.d(ye,{It:()=>E,LG:()=>te,OM:()=>h,Sm:()=>f,Y:()=>fe,bK:()=>re,mm:()=>L,sQ:()=>A});var U=l(10467),i=l(11817),ae=l(32034),C=l(55039);function J(){return(J=(0,U.A)(function*(O){const N=O.spatialReference;if(N.isWGS84)return O.clone();if(N.isWebMercator)return(0,C.ci)(O);const w=ae.A.WGS84;return yield(0,i.initializeProjection)(N,w),(0,i.project)(O,w)})).apply(this,arguments)}function te(O,N){if(!fe(O,N)){const w=O.typeKeywords;w?w.push(N):O.typeKeywords=[N]}}function fe(O,N){var w;return!(null===(w=O.typeKeywords)||void 0===w||!w.includes(N))}function re(O){return fe(O,L.HOSTED_SERVICE)}function h(O,N){const w=O.typeKeywords;if(w){const T=w.indexOf(N);T>-1&&w.splice(T,1)}}function f(O,N,w){w?te(O,N):h(O,N)}function A(O){return g.apply(this,arguments)}function g(){return g=(0,U.A)(function*(O){const N=O.clone().normalize();let w;if(N.length>1)for(const T of N)w?T.width>w.width&&(w=T):w=T;else w=N[0];return function ee(O){return J.apply(this,arguments)}(w)}),g.apply(this,arguments)}const L={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function E(O){var N;const{portal:w,isOrgItem:T,itemControl:v}=O,b=null===(N=w.user)||void 0===N?void 0:N.privileges;let Y=!b||b.includes("features:user:edit"),P=!!T&&!(null==b||!b.includes("features:user:fullEdit"));const x="update"===v||"admin"===v;return x?P=Y=!0:P&&(Y=!0),{features:{edit:Y,fullEdit:P},content:{updateItem:x}}}},78592:(Be,ye,l)=>{l.d(ye,{O3:()=>re,PU:()=>te,YW:()=>f,ex:()=>ee,hv:()=>h,zp:()=>J});var U=l(69287),i=l(67685),ae=l(53781),C=l(89141);const ee=2.4;function J(A){return(0,i.PN)(A*ee)}function te(A){return(0,i.Lz)(A)/ee}function fe(A,g,L,E){let{color:O,ratio:N}=g,{color:w,ratio:T}=L;T===N&&(1===T?N-=1e-6:T+=1e-6);const v=(0,U.qE)((E-N)/(T-N),0,1);(0,ae.l)(A,O.toArray(),w.toArray(),v)}function re(A){const L=new Uint8ClampedArray(2048);if((A=A.filter(({ratio:T})=>T>=0&&T<=1).sort((T,v)=>T.ratio-v.ratio).map(({color:T,ratio:v})=>({color:T,ratio:Math.max(v,.001)}))).length<1)return L;let E=A[0],O=A[0],N=1;const w=(0,C.vt)();for(let T=0;T<512;T++){const v=(T+.5)/512;for(;v>O.ratio&&N<A.length;)E=O,O=A[N++];fe(w,E,O,v),L.set(w,4*T)}return L}function h(A,g,L){const E=Math.sqrt(A**2+g**2)/L;return E>1?0:3/(Math.PI*L**2)*(1-E**2)**2}function f(A){return"function"==typeof A?A:A?g=>+g[A]:()=>1}},93327:(Be,ye,l)=>{l.d(ye,{A:()=>T});var O,U=l(8189),i=l(21152),ae=l(81098),C=l(49976),ee=l(71065),J=l(77806),te=l(85211),h=(l(3248),l(35150),l(17221)),f=l(76576),A=l(50305),g=l(32034),L=l(61320),E=l(29141);const N=new C.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let w=O=class extends ee.oY{constructor(v){super(v),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(v,b){const Y=g.A.fromJSON(b.spatialReference),P=[];for(let s=0;s<v.length;s++){var x;const K=v[s],F=ae.A.fromJSON(K),M=null===(x=K.geometry)||void 0===x?void 0:x.spatialReference;null==F.geometry||M||(F.geometry.spatialReference=Y);const y=K.aggregateGeometries,R=F.aggregateGeometries;if(y&&null!=R)for(const z in R){const H=R[z],_e=y[z];null==H||(null==_e?void 0:_e.spatialReference)||(H.spatialReference=Y)}P.push(F)}return P}writeGeometryType(v,b,Y,P){if(v)return void N.write(v,b,Y,P);const{features:x}=this;if(x)for(const s of x)if(null!=(null==s?void 0:s.geometry))return void N.write(s.geometry.type,b,Y,P)}readQueryGeometry(v,b){if(!v)return null;const Y=!!v.spatialReference,P=(0,L.rS)(v);return P&&!Y&&b.spatialReference&&(P.spatialReference=g.A.fromJSON(b.spatialReference)),P}writeSpatialReference(v,b){if(v)return void(b.spatialReference=v.toJSON());const{features:Y}=this;if(Y)for(const P of Y)if(P&&null!=P.geometry&&P.geometry.spatialReference)return void(b.spatialReference=P.geometry.spatialReference.toJSON())}clone(){return new O(this.cloneProperties())}cloneProperties(){return(0,J.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(v){const b=this.write();if(b.features&&Array.isArray(v)&&v.length>0)for(let Y=0;Y<b.features.length;Y++){const P=b.features[Y];if(P.geometry){const x=null==v?void 0:v[Y];P.geometry=(null==x?void 0:x.toJSON())||P.geometry}}return b}quantize(v){const{scale:[b,Y],translate:[P,x]}=v,F=this.features,M=this._getQuantizationFunction(this.geometryType,y=>Math.round((y-P)/b),y=>Math.round((x-y)/Y));for(let y=0,R=F.length;y<R;y++)null!=M&&M(F[y].geometry)||(F.splice(y,1),y--,R--);return this.transform=v,this}unquantize(){var v,b;const{geometryType:Y,features:P,transform:x}=this;if(!x)return this;const{translate:[s,K],scale:[F,M]}=x;let z=null,H=null;if(this.hasZ&&null!=(null==x||null===(v=x.scale)||void 0===v?void 0:v[2])){const{translate:[,,X],scale:[,,Le]}=x;z=we=>we*Le+X}if(this.hasM&&null!=(null==x||null===(b=x.scale)||void 0===b?void 0:b[3])){const{translate:[,,,X],scale:[,,,Le]}=x;H=we=>null==we?we:we*Le+X}const _e=this._getHydrationFunction(Y,X=>X*F+s,X=>K-X*M,z,H);for(const{geometry:X}of P)null!=X&&_e&&_e(X);return this.transform=null,this}_quantizePoints(v,b,Y){let P,x;const s=[];for(let K=0,F=v.length;K<F;K++){const M=v[K];if(K>0){const y=b(M[0]),R=Y(M[1]);y===P&&R===x||(s.push([y-P,R-x]),P=y,x=R)}else P=b(M[0]),x=Y(M[1]),s.push([P,x])}return s.length>0?s:null}_getQuantizationFunction(v,b,Y){return"point"===v?P=>(P.x=b(P.x),P.y=Y(P.y),P):"polyline"===v||"polygon"===v?P=>{const x=(0,L.Bi)(P)?P.rings:P.paths,s=[];for(let K=0,F=x.length;K<F;K++){const y=this._quantizePoints(x[K],b,Y);y&&s.push(y)}return s.length>0?((0,L.Bi)(P)?P.rings=s:P.paths=s,P):null}:"multipoint"===v?P=>{const x=this._quantizePoints(P.points,b,Y);return x&&x.length>0?(P.points=x,P):null}:"extent"===v?P=>P:null}_getHydrationFunction(v,b,Y,P,x){return"point"===v?s=>{s.x=b(s.x),s.y=Y(s.y),P&&(s.z=P(s.z))}:"polyline"===v||"polygon"===v?s=>{const K=(0,L.Bi)(s)?s.rings:s.paths;let F,M;for(let y=0,R=K.length;y<R;y++){const z=K[y];for(let H=0,_e=z.length;H<_e;H++){const X=z[H];H>0?(F+=X[0],M+=X[1]):(F=X[0],M=X[1]),X[0]=b(F),X[1]=Y(M)}}if(P&&x)for(let y=0,R=K.length;y<R;y++){const z=K[y];for(let H=0,_e=z.length;H<_e;H++){const X=z[H];X[2]=P(X[2]),X[3]=x(X[3])}}else if(P)for(let y=0,R=K.length;y<R;y++){const z=K[y];for(let H=0,_e=z.length;H<_e;H++){const X=z[H];X[2]=P(X[2])}}else if(x)for(let y=0,R=K.length;y<R;y++){const z=K[y];for(let H=0,_e=z.length;H<_e;H++){const X=z[H];X[2]=x(X[2])}}}:"extent"===v?s=>{s.xmin=b(s.xmin),s.ymin=Y(s.ymin),s.xmax=b(s.xmax),s.ymax=Y(s.ymax),P&&null!=s.zmax&&null!=s.zmin&&(s.zmax=P(s.zmax),s.zmin=P(s.zmin)),x&&null!=s.mmax&&null!=s.mmin&&(s.mmax=x(s.mmax),s.mmin=x(s.mmin))}:"multipoint"===v?s=>{const K=s.points;let F,M;for(let y=0,R=K.length;y<R;y++){const z=K[y];y>0?(F+=z[0],M+=z[1]):(F=z[0],M=z[1]),z[0]=b(F),z[1]=Y(M)}if(P&&x)for(let y=0,R=K.length;y<R;y++){const z=K[y];z[2]=P(z[2]),z[3]=x(z[3])}else if(P)for(let y=0,R=K.length;y<R;y++){const z=K[y];z[2]=P(z[2])}else if(x)for(let y=0,R=K.length;y<R;y++){const z=K[y];z[2]=x(z[2])}}:null}};(0,U._)([(0,te.MZ)({type:String,json:{write:!0}})],w.prototype,"displayFieldName",void 0),(0,U._)([(0,te.MZ)({type:Boolean,json:{write:{overridePolicy:v=>({enabled:v})}}})],w.prototype,"exceededTransferLimit",void 0),(0,U._)([(0,te.MZ)({type:[ae.A],json:{write:!0}})],w.prototype,"features",void 0),(0,U._)([(0,h.w)("features")],w.prototype,"readFeatures",null),(0,U._)([(0,te.MZ)({type:[E.A],json:{write:!0}})],w.prototype,"fields",void 0),(0,U._)([(0,te.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:N.read}}})],w.prototype,"geometryType",void 0),(0,U._)([(0,A.K)("geometryType")],w.prototype,"writeGeometryType",null),(0,U._)([(0,te.MZ)({type:Boolean,json:{write:{overridePolicy:v=>({enabled:v})}}})],w.prototype,"hasM",void 0),(0,U._)([(0,te.MZ)({type:Boolean,json:{write:{overridePolicy:v=>({enabled:v})}}})],w.prototype,"hasZ",void 0),(0,U._)([(0,te.MZ)({types:i.yR,json:{write:!0}})],w.prototype,"queryGeometry",void 0),(0,U._)([(0,h.w)("queryGeometry")],w.prototype,"readQueryGeometry",null),(0,U._)([(0,te.MZ)({type:g.A,json:{write:!0}})],w.prototype,"spatialReference",void 0),(0,U._)([(0,A.K)("spatialReference")],w.prototype,"writeSpatialReference",null),(0,U._)([(0,te.MZ)({json:{write:!0}})],w.prototype,"transform",void 0),w=O=(0,U._)([(0,f.$)("esri.rest.support.FeatureSet")],w),w.prototype.toJSON.isDefaultToJSON=!0;const T=w}}]);