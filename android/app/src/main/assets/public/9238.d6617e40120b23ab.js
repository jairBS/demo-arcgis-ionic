"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9238,7340],{23506:(L,E,r)=>{r.d(E,{v:()=>f});var l=r(99305);function f(m){null!=m&&m.writtenProperties&&m.writtenProperties.forEach(({target:i,propName:p,newOrigin:_})=>{(0,l.H)(i)&&_&&i.originOf(p)!==_&&i.updateOrigin(p,_)})}},99305:(L,E,r)=>{function l(f){return f&&"getAtOrigin"in f&&"originOf"in f}r.d(E,{H:()=>l})},54814:(L,E,r)=>{r.r(E),r.d(E,{save:()=>d,saveAs:()=>I});var l=r(10467),f=r(17994),m=r(15764),i=r(69927),p=r(3458);const _="Group Layer",O="group-layer-save",x="group-layer-save-as",P=i.mm.GROUP_LAYER_MAP;function D(e){return{isValid:"group"===e.type,errorMessage:"Layer.type should be 'group'"}}function T(e){return{isValid:(0,i.Y)(e,P),errorMessage:`Layer.portalItem.typeKeywords should have '${P}'`}}function M(e,t){return{...(0,m.m)(e,"web-map",!0),initiator:t}}function R(e){const t=e.layerJSON;return Promise.resolve(t&&Object.keys(t).length?t:null)}function u(e,t){return o.apply(this,arguments)}function o(){return(o=(0,l.A)(function*(e,t){t.title||(t.title=e.title),(0,i.OM)(t,i.mm.METADATA),(0,i.LG)(t,P)})).apply(this,arguments)}function d(e,t){return c.apply(this,arguments)}function c(){return c=(0,l.A)(function*(e,t){return(0,f.UN)({layer:e,itemType:_,validateLayer:D,validateItem:T,createJSONContext:s=>M(s,e),createItemData:R,errorNamePrefix:O,saveResources:(s=(0,l.A)(function*(a,h){return e.sourceIsPortalItem||(yield a.removeAllResources().catch(()=>{})),(0,p.r)(e.resourceReferences,h)}),function(h,n){return s.apply(this,arguments)})},t);var s}),c.apply(this,arguments)}function I(e,t,s){return v.apply(this,arguments)}function v(){return(v=(0,l.A)(function*(e,t,s){return(0,f.Uh)({layer:e,itemType:_,validateLayer:D,createJSONContext:a=>M(a,e),createItemData:R,errorNamePrefix:x,newItem:t,setItemProperties:u,saveResources:(a,h)=>(0,p.r)(e.resourceReferences,h)},s)})).apply(this,arguments)}},15764:(L,E,r)=>{r.d(E,{m:()=>i,v:()=>m});var l=r(45272),f=r(73874);function m(_,O){return{...p(_,O),readResourcePaths:[]}}function i(_,O,x){const P=(0,l.An)(_.itemUrl);return{...p(_,O),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:P?{rootPath:P.path,writtenUrls:[]}:null,resources:x?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function p(_,O){return{origin:O,url:(0,l.An)(_.itemUrl),portal:_.portal||f.A.getDefault(),portalItem:_}}},57340:(L,E,r)=>{r.r(E),r.d(E,{addOrUpdateResources:()=>O,contentToBlob:()=>d,fetchResources:()=>p,getSiblingOfSameType:()=>I,getSiblingOfSameTypeI:()=>v,removeAllResources:()=>T,removeResource:()=>P,splitPrefixFileNameAndExtension:()=>u});var l=r(10467),f=r(89563),m=r(5922),i=r(45272);function p(e){return _.apply(this,arguments)}function _(){return(_=(0,l.A)(function*(e,t={},s){yield e.load(s);const a=(0,i.fj)(e.itemUrl,"resources"),{start:h=1,num:n=10,sortOrder:y="asc",sortField:j="resource"}=t,A={query:{start:h,num:n,sortOrder:y,sortField:j,token:e.apiKey},signal:null==s?void 0:s.signal},g=yield e.portal.request(a,A);return{total:g.total,nextStart:g.nextStart,resources:g.resources.map(({created:B,size:U,resource:C})=>({created:new Date(B),size:U,resource:e.resourceFromPath(C)}))}})).apply(this,arguments)}function O(e,t,s,a){return x.apply(this,arguments)}function x(){return(x=(0,l.A)(function*(e,t,s,a){const h=new Map;for(const{resource:y,content:j,compress:A,access:g}of t){if(!y.hasPath())throw new m.A(`portal-item-resource-${s}:invalid-path`,"Resource does not have a valid path");const[B,U]=R(y.path),C=`${B}/${null!=A?A:""}/${null!=g?g:""}`;h.has(C)||h.set(C,{prefix:B,compress:A,access:g,files:[]}),h.get(C).files.push({fileName:U,content:j})}yield e.load(a);const n=(0,i.fj)(e.userItemUrl,"add"===s?"addResources":"updateResources");for(const{prefix:y,compress:j,access:A,files:g}of h.values())for(let U=0;U<g.length;U+=25){const C=g.slice(U,U+25),K=new FormData;y&&"."!==y&&K.append("resourcesPrefix",y),j&&K.append("compress","true"),A&&K.append("access",A);let S=0;for(const{fileName:W,content:b}of C)K.append("file"+ ++S,b,W);K.append("f","json"),yield e.portal.request(n,{method:"post",body:K,signal:null==a?void 0:a.signal})}})).apply(this,arguments)}function P(e,t,s){return D.apply(this,arguments)}function D(){return(D=(0,l.A)(function*(e,t,s){if(!t.hasPath())throw new m.A("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield e.load(s);const a=(0,i.fj)(e.userItemUrl,"removeResources");yield e.portal.request(a,{method:"post",query:{resource:t.path},signal:null==s?void 0:s.signal}),t.portalItem=null})).apply(this,arguments)}function T(e,t){return M.apply(this,arguments)}function M(){return(M=(0,l.A)(function*(e,t){yield e.load(t);const s=(0,i.fj)(e.userItemUrl,"removeResources");return e.portal.request(s,{method:"post",query:{deleteAll:!0},signal:null==t?void 0:t.signal})})).apply(this,arguments)}function R(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function u(e){const[t,s]=function o(e){const t=(0,i.Zo)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[a,h]=R(t);return[a,h,s]}function d(e){return c.apply(this,arguments)}function c(){return(c=(0,l.A)(function*(e){return"blob"===e.type?e.blob:"json"===e.type?new Blob([e.jsonString],{type:"application/json"}):(yield(0,f.A)(e.url,{responseType:"blob"})).data})).apply(this,arguments)}function I(e,t){if(!e.hasPath())return null;const[s,,a]=u(e.path);return e.portalItem.resourceFromPath((0,i.fj)(s,t+a))}function v(e,t){if(!e.hasPath())return null;const[s,,a]=u(e.path);return e.portalItem.resourceFromPath((0,i.fj)(s,t+a))}},3458:(L,E,r)=>{r.d(E,{S:()=>x,r:()=>_});var l=r(10467),f=r(5922),m=r(56492),i=r(43085),p=r(57340);function _(u,o,d){return O.apply(this,arguments)}function O(){return(O=(0,l.A)(function*(u,o,d){const c=yield D(u,o,d);yield M(c,o,d)})).apply(this,arguments)}function x(u,o,d,c,I){return P.apply(this,arguments)}function P(){return(P=(0,l.A)(function*(u,o,d,c,I){const v=yield D(d,c,I);yield u.update({data:o}),yield M(v,c,I)})).apply(this,arguments)}function D(u,o,d){return T.apply(this,arguments)}function T(){return(T=(0,l.A)(function*(u,o,d){if(null==o||!o.resources)return;const c=o.portalItem===u.portalItem?new Set(u.paths):new Set;u.paths.length=0,u.portalItem=o.portalItem;const I=new Set(o.resources.toKeep.map(n=>n.resource.path)),v=new Set,e=[];I.forEach(n=>{c.delete(n),u.paths.push(n)});const t=[],s=[],a=[];for(const n of o.resources.toUpdate)if(c.delete(n.resource.path),I.has(n.resource.path)||v.has(n.resource.path)){const{resource:y,content:j,finish:A}=n,g=(0,p.getSiblingOfSameTypeI)(y,(0,i.lk)());u.paths.push(g.path),t.push({resource:g,content:yield(0,p.contentToBlob)(j),compress:n.compress}),A&&a.push(()=>A(g))}else{u.paths.push(n.resource.path),s.push({resource:n.resource,content:yield(0,p.contentToBlob)(n.content),compress:n.compress});const y=n.finish;y&&a.push(()=>y(n.resource)),v.add(n.resource.path)}for(const n of o.resources.toAdd)if(u.paths.push(n.resource.path),c.has(n.resource.path))c.delete(n.resource.path);else{t.push({resource:n.resource,content:yield(0,p.contentToBlob)(n.content),compress:n.compress});const y=n.finish;y&&a.push(()=>y(n.resource))}if(t.length||s.length){const{addOrUpdateResources:n}=yield Promise.resolve().then(r.bind(r,57340));yield n(o.portalItem,t,"add",d),yield n(o.portalItem,s,"update",d)}if(a.forEach(n=>n()),0===e.length)return c;const h=yield(0,m.Ol)(e);if((0,m.Te)(d),h.length>0)throw new f.A("save:resources","Failed to save one or more resources",{errors:h});return c})).apply(this,arguments)}function M(u,o,d){return R.apply(this,arguments)}function R(){return(R=(0,l.A)(function*(u,o,d){if(!u||!o.portalItem)return;const c=[];for(const I of u){const v=o.portalItem.resourceFromPath(I);c.push(v.portalItem.removeResource(v,d))}yield(0,m.Lx)(c)})).apply(this,arguments)}},96904:(L,E,r)=>{r.d(E,{X:()=>i});var l=r(23098),f=r(5922),m=r(2174);function i(p){if(l.A.apiKey&&(0,m.Q)(p.portal.url))throw new f.A("save-api-key-utils:api-key-not-supported",`Saving is not supported on ${p.portal.url} when using an api key`)}}}]);