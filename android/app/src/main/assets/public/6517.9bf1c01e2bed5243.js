"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6517],{53781:(Ut,pt,C)=>{C.d(pt,{a:()=>st,b:()=>W,c:()=>F,e:()=>vt,f:()=>h,g:()=>Dt,i:()=>bt,j:()=>j,l:()=>_t,n:()=>tt,s:()=>N,t:()=>Y});var k=C(85952);function F(u,y){return u[0]=y[0],u[1]=y[1],u[2]=y[2],u[3]=y[3],u}function N(u,y,l,_,m){return u[0]=y,u[1]=l,u[2]=_,u[3]=m,u}function h(u,y,l){return u[0]=y[0]+l[0],u[1]=y[1]+l[1],u[2]=y[2]+l[2],u[3]=y[3]+l[3],u}function g(u,y,l){return u[0]=y[0]-l[0],u[1]=y[1]-l[1],u[2]=y[2]-l[2],u[3]=y[3]-l[3],u}function f(u,y,l){return u[0]=y[0]*l[0],u[1]=y[1]*l[1],u[2]=y[2]*l[2],u[3]=y[3]*l[3],u}function D(u,y,l){return u[0]=y[0]/l[0],u[1]=y[1]/l[1],u[2]=y[2]/l[2],u[3]=y[3]/l[3],u}function W(u,y,l){return u[0]=y[0]*l,u[1]=y[1]*l,u[2]=y[2]*l,u[3]=y[3]*l,u}function at(u,y){const l=y[0]-u[0],_=y[1]-u[1],m=y[2]-u[2],b=y[3]-u[3];return Math.sqrt(l*l+_*_+m*m+b*b)}function Et(u,y){const l=y[0]-u[0],_=y[1]-u[1],m=y[2]-u[2],b=y[3]-u[3];return l*l+_*_+m*m+b*b}function bt(u){const y=u[0],l=u[1],_=u[2],m=u[3];return Math.sqrt(y*y+l*l+_*_+m*m)}function j(u){const y=u[0],l=u[1],_=u[2],m=u[3];return y*y+l*l+_*_+m*m}function tt(u,y){const l=y[0],_=y[1],m=y[2],b=y[3];let w=l*l+_*_+m*m+b*b;return w>0&&(w=1/Math.sqrt(w),u[0]=l*w,u[1]=_*w,u[2]=m*w,u[3]=b*w),u}function Dt(u,y){return u[0]*y[0]+u[1]*y[1]+u[2]*y[2]+u[3]*y[3]}function _t(u,y,l,_){const m=y[0],b=y[1],w=y[2],U=y[3];return u[0]=m+_*(l[0]-m),u[1]=b+_*(l[1]-b),u[2]=w+_*(l[2]-w),u[3]=U+_*(l[3]-U),u}function Y(u,y,l){const _=y[0],m=y[1],b=y[2],w=y[3];return u[0]=l[0]*_+l[4]*m+l[8]*b+l[12]*w,u[1]=l[1]*_+l[5]*m+l[9]*b+l[13]*w,u[2]=l[2]*_+l[6]*m+l[10]*b+l[14]*w,u[3]=l[3]*_+l[7]*m+l[11]*b+l[15]*w,u}function st(u,y){return u[0]===y[0]&&u[1]===y[1]&&u[2]===y[2]&&u[3]===y[3]}function vt(u,y){const l=u[0],_=u[1],m=u[2],b=u[3],w=y[0],U=y[1],G=y[2],K=y[3],yt=(0,k.FD)();return Math.abs(l-w)<=yt*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(_-U)<=yt*Math.max(1,Math.abs(_),Math.abs(U))&&Math.abs(m-G)<=yt*Math.max(1,Math.abs(m),Math.abs(G))&&Math.abs(b-K)<=yt*Math.max(1,Math.abs(b),Math.abs(K))}Object.freeze(Object.defineProperty({__proto__:null,add:h,ceil:function L(u,y){return u[0]=Math.ceil(y[0]),u[1]=Math.ceil(y[1]),u[2]=Math.ceil(y[2]),u[3]=Math.ceil(y[3]),u},copy:F,copyVec3:function P(u,y){return u[0]=y[0],u[1]=y[1],u[2]=y[2],u},dist:at,distance:at,div:D,divide:D,dot:Dt,equals:vt,exactEquals:st,floor:function A(u,y){return u[0]=Math.floor(y[0]),u[1]=Math.floor(y[1]),u[2]=Math.floor(y[2]),u[3]=Math.floor(y[3]),u},inverse:function H(u,y){return u[0]=1/y[0],u[1]=1/y[1],u[2]=1/y[2],u[3]=1/y[3],u},len:bt,length:bt,lerp:_t,max:function z(u,y,l){return u[0]=Math.max(y[0],l[0]),u[1]=Math.max(y[1],l[1]),u[2]=Math.max(y[2],l[2]),u[3]=Math.max(y[3],l[3]),u},min:function O(u,y,l){return u[0]=Math.min(y[0],l[0]),u[1]=Math.min(y[1],l[1]),u[2]=Math.min(y[2],l[2]),u[3]=Math.min(y[3],l[3]),u},mul:f,multiply:f,negate:function Q(u,y){return u[0]=-y[0],u[1]=-y[1],u[2]=-y[2],u[3]=-y[3],u},normalize:tt,random:function Rt(u,y){const l=k.Ov;let _,m,b,w,U,G;y=y||1;do{_=2*l()-1,m=2*l()-1,U=_*_+m*m}while(U>=1);do{b=2*l()-1,w=2*l()-1,G=b*b+w*w}while(G>=1);const K=Math.sqrt((1-U)/G);return u[0]=y*_,u[1]=y*m,u[2]=y*b*K,u[3]=y*w*K,u},round:function M(u,y){return u[0]=Math.round(y[0]),u[1]=Math.round(y[1]),u[2]=Math.round(y[2]),u[3]=Math.round(y[3]),u},scale:W,scaleAndAdd:function $(u,y,l,_){return u[0]=y[0]+l[0]*_,u[1]=y[1]+l[1]*_,u[2]=y[2]+l[2]*_,u[3]=y[3]+l[3]*_,u},set:N,sqrDist:Et,sqrLen:j,squaredDistance:Et,squaredLength:j,str:function Z(u){return"vec4("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+")"},sub:g,subtract:g,transformMat4:Y,transformQuat:function ot(u,y,l){const _=y[0],m=y[1],b=y[2],w=l[0],U=l[1],G=l[2],K=l[3],yt=K*_+U*b-G*m,Pt=K*m+G*_-w*b,Nt=K*b+w*m-U*_,Lt=-w*_-U*m-G*b;return u[0]=yt*K+Lt*-w+Pt*-G-Nt*-U,u[1]=Pt*K+Lt*-U+Nt*-w-yt*-G,u[2]=Nt*K+Lt*-G+yt*-U-Pt*-w,u[3]=y[3],u}},Symbol.toStringTag,{value:"Module"}))},29430:(Ut,pt,C)=>{C.d(pt,{$:()=>_t,IB:()=>N,N2:()=>Rt,RH:()=>ot,Ws:()=>vt,ZD:()=>Y});var k=C(68677);function N(l){return"r"in l&&"g"in l&&"b"in l}function h(l){return"h"in l&&"s"in l&&"v"in l}function g(l){return"l"in l&&"a"in l&&"b"in l}function f(l){return"l"in l&&"c"in l&&"h"in l}C(53781),C(89141);const L=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],A=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function O(l,_){const m=[];let b,w;if(l[0].length!==_.length)throw new Error("dimensions do not match");const U=l.length,G=l[0].length;let K=0;for(b=0;b<U;b++){for(K=0,w=0;w<G;w++)K+=l[b][w]*_[w];m.push(K)}return m}function z(l){const _=[l.r/255,l.g/255,l.b/255].map(b=>b<=.04045?b/12.92:((b+.055)/1.055)**2.4),m=O(L,_);return{x:100*m[0],y:100*m[1],z:100*m[2]}}function M(l){const _=O(A,[l.x/100,l.y/100,l.z/100]).map(m=>Math.min(1,Math.max(m<=.0031308?12.92*m:1.055*m**.4166666666666667-.055,0)));return{r:Math.round(255*_[0]),g:Math.round(255*_[1]),b:Math.round(255*_[2])}}function W(l){const _=[l.x/95.047,l.y/100,l.z/108.883].map(m=>m>.008856451679035631?m**.3333333333333333:7.787037037037035*m+.13793103448275862);return{l:116*_[1]-16,a:500*(_[0]-_[1]),b:200*(_[1]-_[2])}}function $(l){const _=l.l,m=[(_+16)/116+l.a/500,(_+16)/116,(_+16)/116-l.b/200].map(b=>b>6/29?b**3:3*(6/29)**2*(b-4/29));return{x:95.047*m[0],y:100*m[1],z:108.883*m[2]}}function _t(l){return N(l)?l:f(l)?function H(l){return M($(function Et(l){const m=l.c,b=l.h;return{l:l.l,a:m*Math.cos(b),b:m*Math.sin(b)}}(l)))}(l):g(l)?function j(l){return M($(l))}(l):function D(l){return"x"in l&&"y"in l&&"z"in l}(l)?M(l):h(l)?function Dt(l){const _=(l.h+360)%360/60,b=l.v/100*255,w=b*(l.s/100),U=w*(1-Math.abs(_%2-1));let G;switch(Math.floor(_)){case 0:G={r:w,g:U,b:0};break;case 1:G={r:U,g:w,b:0};break;case 2:G={r:0,g:w,b:U};break;case 3:G={r:0,g:U,b:w};break;case 4:G={r:U,g:0,b:w};break;case 5:case 6:G={r:w,g:0,b:U};break;default:G={r:0,g:0,b:0}}return G.r=Math.round(G.r+b-w),G.g=Math.round(G.g+b-w),G.b=Math.round(G.b+b-w),G}(l):l}function Rt(l){return h(l)?l:function tt(l){const _=l.r,m=l.g,b=l.b,w=Math.max(_,m,b),U=w-Math.min(_,m,b);let G=w,K=0===U?0:w===_?(m-b)/U%6:w===m?(b-_)/U+2:(_-m)/U+4,yt=0===U?0:U/G;return K<0&&(K+=6),K*=60,yt*=100,G*=100/255,{h:K,s:yt,v:G}}(_t(l))}function Y(l){return g(l)?l:function bt(l){return W(z(l))}(_t(l))}function ot(l){return f(l)?l:function Q(l){return function at(l){const _=l.l,m=l.a,b=l.b,w=Math.sqrt(m*m+b*b);let U=Math.atan2(b,m);return U=U>0?U:U+2*Math.PI,{l:_,c:w,h:U}}(W(z(l)))}(_t(l))}function vt(l,_){const{r:m,g:b,b:w}=null!=_&&_.ignoreAlpha?l:function st(l){let{r:_,g:m,b,a:w}=l;return w<1&&(_=Math.round(w*_+255*(1-w)),m=Math.round(w*m+255*(1-w)),b=Math.round(w*b+255*(1-w))),new k.A({r:_,g:m,b})}(l);return.2126*m+.7152*b+.0722*w}var lt,l;(l=lt||(lt={}))[l.Low=160]="Low",l[l.High=225]="High"},89141:(Ut,pt,C)=>{function k(){return[0,0,0,0]}function P(j,Q,H,tt){return[j,Q,H,tt]}function f(){return P(1,1,1,1)}function D(){return P(1,0,0,0)}function L(){return P(0,1,0,0)}function A(){return P(0,0,1,0)}function O(){return P(0,0,0,1)}C.d(pt,{fA:()=>P,vt:()=>k});const M=f(),W=D(),$=L(),at=A(),Et=O();Object.freeze(Object.defineProperty({__proto__:null,ONES:M,UNIT_W:Et,UNIT_X:W,UNIT_Y:$,UNIT_Z:at,ZEROS:[0,0,0,0],clone:function F(j){return[j[0],j[1],j[2],j[3]]},create:k,createView:function h(j,Q){return new Float64Array(j,Q,4)},fromArray:function N(j,Q=[0,0,0,0]){const H=Math.min(4,j.length);for(let tt=0;tt<H;++tt)Q[tt]=j[tt];return Q},fromValues:P,ones:f,unitW:O,unitX:D,unitY:L,unitZ:A,zeros:function g(){return[0,0,0,0]}},Symbol.toStringTag,{value:"Module"}))},80913:(Ut,pt,C)=>{C.d(pt,{A:()=>k});class k{constructor(P){this._array=[],P<=0&&console.error("strideInBytes must be positive!"),this._stride=P}get array(){return this._array}get index(){return 4*this._array.length/this._stride}get itemSize(){return this._stride}get sizeInBytes(){return 4*this._array.length}reset(){this.array.length=0}toBuffer(){return new Uint32Array(this._array).buffer}static i1616to32(P,N){return 65535&P|N<<16}static i8888to32(P,N,h,g){return 255&P|(255&N)<<8|(255&h)<<16|g<<24}static i8816to32(P,N,h){return 255&P|(255&N)<<8|h<<16}}},20904:(Ut,pt,C)=>{var k,F,P,N;C.d(pt,{$q:()=>P,NP:()=>k,kh:()=>F}),(N=k||(k={}))[N.FILL=1]="FILL",N[N.LINE=2]="LINE",N[N.SYMBOL=3]="SYMBOL",N[N.CIRCLE=4]="CIRCLE",function(N){N[N.BACKGROUND=0]="BACKGROUND",N[N.FILL=1]="FILL",N[N.OUTLINE=2]="OUTLINE",N[N.LINE=3]="LINE",N[N.ICON=4]="ICON",N[N.CIRCLE=5]="CIRCLE",N[N.TEXT=6]="TEXT",N[N.TILEINFO=7]="TILEINFO"}(F||(F={})),function(N){N[N.PAINTER_CHANGED=0]="PAINTER_CHANGED",N[N.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",N[N.LAYER_CHANGED=2]="LAYER_CHANGED",N[N.LAYER_REMOVED=3]="LAYER_REMOVED",N[N.SPRITES_CHANGED=4]="SPRITES_CHANGED"}(P||(P={}))},53220:(Ut,pt,C)=>{C.d(pt,{lf:()=>Ie,L:()=>Ae,A4:()=>De,aR:()=>Pe,e4:()=>we,tU:()=>Te,V1:()=>Re,uU:()=>Ne});var h,g,p,k=C(51995),F=C(20904),P=C(4139),N=C(80913);(p=h||(h={}))[p.R8_SIGNED=0]="R8_SIGNED",p[p.R8_UNSIGNED=1]="R8_UNSIGNED",p[p.R16_SIGNED=2]="R16_SIGNED",p[p.R16_UNSIGNED=3]="R16_UNSIGNED",p[p.R8G8_SIGNED=4]="R8G8_SIGNED",p[p.R8G8_UNSIGNED=5]="R8G8_UNSIGNED",p[p.R16G16_SIGNED=6]="R16G16_SIGNED",p[p.R16G16_UNSIGNED=7]="R16G16_UNSIGNED",p[p.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED",p[p.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED",p[p.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR",p[p.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY",p[p.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN",function(p){p[p.UNIFORM=0]="UNIFORM",p[p.DATA_DRIVEN=1]="DATA_DRIVEN",p[p.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN",p[p.UNUSED=3]="UNUSED"}(g||(g={}));var f=C(50915),D=C(30454);class L{constructor(e){this._locations=new Map,this._key=e}get key(){return this._key}get type(){return 7&this._key}defines(){return[]}getStride(){return this._layoutInfo||this._buildAttributesInfo(),this._stride}getAttributeLocations(){return 0===this._locations.size&&this._buildAttributesInfo(),this._locations}getLayoutInfo(){return this._layoutInfo||this._buildAttributesInfo(),this._layoutInfo}getEncodingInfos(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}getUniforms(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}getShaderHeader(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}getShaderMain(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}setDataUniforms(e,i,a,o,s){const v=this.getUniforms();for(const c of v){const{name:d,type:E,getValue:T}=c,I=T(a,i,o,s);if(null!==I)switch(E){case"float":e.setUniform1f(d,I);break;case"vec2":e.setUniform2fv(d,I);break;case"vec4":e.setUniform4fv(d,I)}}}encodeAttributes(e,i,a,o){const s=this.attributesInfo(),v=this.getEncodingInfos(),c=[];let d=0,E=0;for(const I of Object.keys(v)){var T;const R=v[I],{type:B,precisionFactor:V,isLayout:x}=s[I],et=x?a.getLayoutProperty(I):a.getPaintProperty(I),It=null===(T=et.interpolator)||void 0===T?void 0:T.getInterpolationRange(i);let rt=0;for(const ct of R){const{offset:X,bufferElementsToAdd:ft}=ct;if(ft>0){for(let it=0;it<ft;it++)c.push(0);d+=E,E=ct.bufferElementsToAdd}const nt=null!=o?o:et.getValue(It?It[rt]:i,e);switch(B){case h.R8_SIGNED:case h.R8_UNSIGNED:c[d]|=this._encodeByte(nt*(V||1),8*X);break;case h.R16_SIGNED:case h.R16_UNSIGNED:c[d]|=this._encodeShort(nt*(V||1),8*X);break;case h.R8G8_SIGNED:case h.R8G8_UNSIGNED:c[d]|=this._encodeByte(nt*(V||1),8*X),c[d]|=this._encodeByte(nt*(V||1),8*X+8);break;case h.R16G16_SIGNED:case h.R16G16_UNSIGNED:c[d]|=this._encodeShort(nt*(V||1),8*X),c[d]|=this._encodeShort(nt*(V||1),8*X+16);break;case h.R8G8B8A8_SIGNED:case h.R8G8B8A8_UNSIGNED:c[d]|=this._encodeByte(nt*(V||1),8*X),c[d]|=this._encodeByte(nt*(V||1),8*X+8),c[d]|=this._encodeByte(nt*(V||1),8*X+16),c[d]|=this._encodeByte(nt*(V||1),8*X+24);break;case h.R8G8B8A8_COLOR:c[d]=this._encodeColor(nt);break;case h.R16G16B16A16_DASHARRAY:case h.R16G16B16A16_PATTERN:this._encodePattern(d,c,nt);break;default:throw new Error("Unsupported encoding type")}rt++}}return c}getAtributeState(e){let i=0;const a=3+2*e;return i|=this._bit(a),i|=this._bit(a+1)<<1,i}_buildAttributesInfo(){const e=[],i={},a={};let o=-1;const s=this.attributesInfo(),v=this.attributes();let c=-1;for(const I of v){c++;const R=this.getAtributeState(c);if(R===g.UNIFORM||R===g.UNUSED)continue;const B=s[I],V=[];i[I]=V;const x=B.type;for(let et=0;et<R;et++){const{dataType:It,bytesPerElement:rt,count:ct,normalized:X}=L._encodingInfo[x],ft=rt*ct,nt=`${It}-${!0===X}`;let it=a[nt],dt=0;if(!it||it.count+ct>4)o++,it={dataIndex:o,count:0,offset:0},4!==ct&&(a[nt]=it),e.push({location:-1,name:"a_data_"+o,count:ct,type:It,normalized:X}),dt=Math.ceil(Math.max(ft/4,1));else{const gt=e[it.dataIndex];gt.count+=ct,dt=Math.ceil(Math.max(gt.count*rt/4,1))-Math.ceil(Math.max(it.offset/4,1))}V.push({dataIndex:it.dataIndex,offset:it.offset,bufferElementsToAdd:dt}),it.offset+=ft,it.count+=ct}}for(const I of e)switch(I.type){case f.pe.BYTE:case f.pe.UNSIGNED_BYTE:I.count=4;break;case f.pe.SHORT:case f.pe.UNSIGNED_SHORT:I.count+=I.count%2}this._buildVertexBufferLayout(e);let d=0;const E=this._layoutInfo.geometry;for(const I of E)this._locations.set(I.name,d++);const T=this._layoutInfo.opacity;if(T)for(const I of T)this._locations.set(I.name,d++);this._buildShaderInfo(e,i),this._propertyEncodingInfo=i}_buildVertexBufferLayout(e){const i={},a=this.geometryInfo();let o=a[0].stride;if(0===e.length)i.geometry=a;else{const s=[];let v=o;for(const c of e)o+=A(c.type)*c.count;for(const c of a)s.push(new D._(c.name,c.count,c.type,c.offset,o,c.normalized));for(const c of e)s.push(new D._(c.name,c.count,c.type,v,o,c.normalized)),v+=A(c.type)*c.count;i.geometry=s}this.opacityInfo()&&(i.opacity=this.opacityInfo()),this._layoutInfo=i,this._stride=o}_buildShaderInfo(e,i){let a="\n",o="\n";const s=[];for(const E of e)a+=`attribute ${this._getType(E.count)} ${E.name};\n`;const v=this.attributes(),c=this.attributesInfo();let d=-1;for(const E of v){d++;const{name:T,type:I,precisionFactor:R,isLayout:B}=c[E],V=R&&1!==R?" * "+1/R:"",{bytesPerElement:x,count:et}=L._encodingInfo[I],It=rt=>`a_data_${rt.dataIndex}${O(et,rt.offset,x)}`;switch(this.getAtributeState(d)){case g.UNIFORM:{const rt=this._getType(et),ct=`u_${T}`;s.push({name:ct,type:rt,getValue:(X,ft,nt,it)=>{const dt=B?X.getLayoutValue(E,ft):X.getPaintValue(E,ft);if(I===h.R16G16B16A16_DASHARRAY){const gt=X.getDashKey(dt,X.getLayoutValue("line-cap",ft)),zt=it.getMosaicItemPosition(gt,!1);if(null==zt)return null;const{tl:$t,br:fe}=zt;return[$t[0],fe[1],fe[0],$t[1]]}if(I===h.R16G16B16A16_PATTERN){const gt=it.getMosaicItemPosition(dt,!E.includes("line-"));if(null==gt)return null;const{tl:zt,br:$t}=gt;return[zt[0],$t[1],$t[0],zt[1]]}if(I===h.R8G8B8A8_COLOR){const gt=dt[3];return[gt*dt[0],gt*dt[1],gt*dt[2],gt]}return dt}}),a+=`uniform ${rt} ${ct};\n`,o+=`${rt} ${T} = ${ct};\n`}break;case g.DATA_DRIVEN:{const rt=It(i[E][0]);o+=`${this._getType(et)} ${T} = ${rt}${V};\n`}break;case g.INTERPOLATED_DATA_DRIVEN:{const rt=`u_t_${T}`;s.push({name:rt,type:"float",getValue:(ft,nt,it,dt)=>(B?ft.getLayoutProperty(E):ft.getPaintProperty(E)).interpolator.interpolationUniformValue(it,nt)}),a+=`uniform float ${rt};\n`;const ct=It(i[E][0]),X=It(i[E][1]);o+=`${this._getType(et)} ${T} = mix(${ct}${V}, ${X}${V}, ${rt});\n`}}}this._shaderHeader=a,this._shaderMain=o,this._uniforms=s}_bit(e){return(this._key&1<<e)>>e}_getType(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}_encodeColor(e){const i=255*e[3];return N.A.i8888to32(e[0]*i,e[1]*i,e[2]*i,i)}_encodePattern(e,i,a){if(null==a||!a.rect)return;const s=a.rect,v=a.width,c=a.height;i[e]=this._encodeShort(s.x+2,0),i[e]|=this._encodeShort(s.y+2+c,16),i[e+1]=this._encodeShort(s.x+2+v,0),i[e+1]|=this._encodeShort(s.y+2,16)}_encodeByte(e,i){return(255&e)<<i}_encodeShort(e,i){return(65535&e)<<i}}L._encodingInfo={[h.R8_SIGNED]:{dataType:f.pe.BYTE,bytesPerElement:1,count:1,normalized:!1},[h.R8_UNSIGNED]:{dataType:f.pe.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[h.R16_SIGNED]:{dataType:f.pe.SHORT,bytesPerElement:2,count:1,normalized:!1},[h.R16_UNSIGNED]:{dataType:f.pe.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[h.R8G8_SIGNED]:{dataType:f.pe.BYTE,bytesPerElement:1,count:2,normalized:!1},[h.R8G8_UNSIGNED]:{dataType:f.pe.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[h.R16G16_SIGNED]:{dataType:f.pe.SHORT,bytesPerElement:2,count:2,normalized:!1},[h.R16G16_UNSIGNED]:{dataType:f.pe.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[h.R8G8B8A8_SIGNED]:{dataType:f.pe.BYTE,bytesPerElement:1,count:4,normalized:!1},[h.R8G8B8A8_UNSIGNED]:{dataType:f.pe.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[h.R8G8B8A8_COLOR]:{dataType:f.pe.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[h.R16G16B16A16_DASHARRAY]:{dataType:f.pe.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[h.R16G16B16A16_PATTERN]:{dataType:f.pe.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const A=p=>{switch(p){case f.pe.FLOAT:case f.pe.INT:case f.pe.UNSIGNED_INT:return 4;case f.pe.SHORT:case f.pe.UNSIGNED_SHORT:return 2;case f.pe.BYTE:case f.pe.UNSIGNED_BYTE:return 1}},O=(p,e,i)=>{const a=e/i;if(1===p)switch(a){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===p)switch(a){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===p)switch(a){case 0:return".xyz";case 1:return".yzw"}return""};class z extends L{constructor(e){super(e)}geometryInfo(){return z.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return z.ATTRIBUTES}attributesInfo(){return z.ATTRIBUTES_INFO}}z.ATTRIBUTES=[],z.GEOMETRY_LAYOUT=[new D._("a_pos",2,f.pe.BYTE,0,2)],z.ATTRIBUTES_INFO={};class M extends L{constructor(e){super(e)}geometryInfo(){return M.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return M.ATTRIBUTES}attributesInfo(){return M.ATTRIBUTES_INFO}}M.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],M.GEOMETRY_LAYOUT=[new D._("a_pos",2,f.pe.SHORT,0,4)],M.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:h.R8_UNSIGNED},"circle-color":{name:"color",type:h.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:h.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:h.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:h.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:h.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:h.R8_UNSIGNED,precisionFactor:32}};class W extends L{constructor(e){super(e)}geometryInfo(){return W.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return W.ATTRIBUTES}attributesInfo(){return W.ATTRIBUTES_INFO}}W.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],W.GEOMETRY_LAYOUT=[new D._("a_pos",2,f.pe.SHORT,0,4)],W.ATTRIBUTES_INFO={"fill-color":{name:"color",type:h.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:h.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:h.R16G16B16A16_PATTERN,isOptional:!0}};class $ extends L{constructor(e,i){super(e),this._usefillColor=i}geometryInfo(){return $.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return this._usefillColor?$.ATTRIBUTES_FILL:$.ATTRIBUTES_OUTLINE}attributesInfo(){return this._usefillColor?$.ATTRIBUTES_INFO_FILL:$.ATTRIBUTES_INFO_OUTLINE}}$.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],$.ATTRIBUTES_FILL=["fill-color","fill-opacity"],$.GEOMETRY_LAYOUT=[new D._("a_pos",2,f.pe.SHORT,0,8),new D._("a_offset",2,f.pe.BYTE,4,8),new D._("a_xnormal",2,f.pe.BYTE,6,8)],$.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:h.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:h.R8_UNSIGNED,precisionFactor:100}},$.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:h.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:h.R8_UNSIGNED,precisionFactor:100}};class at extends L{constructor(e){super(e)}geometryInfo(){return at.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return at.ATTRIBUTES}attributesInfo(){return at.ATTRIBUTES_INFO}}at.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],at.GEOMETRY_LAYOUT=[new D._("a_pos",2,f.pe.SHORT,0,16),new D._("a_extrude_offset",4,f.pe.BYTE,4,16),new D._("a_dir_normal",4,f.pe.BYTE,8,16),new D._("a_accumulatedDistance",2,f.pe.UNSIGNED_SHORT,12,16)],at.ATTRIBUTES_INFO={"line-width":{name:"width",type:h.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:h.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:h.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:h.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:h.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:h.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:h.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:h.R16G16B16A16_DASHARRAY,isOptional:!0}};const Et=[new D._("a_pos",2,f.pe.SHORT,0,16),new D._("a_vertexOffset",2,f.pe.SHORT,4,16),new D._("a_texAngleRange",4,f.pe.UNSIGNED_BYTE,8,16),new D._("a_levelInfo",4,f.pe.UNSIGNED_BYTE,12,16)],bt=[new D._("a_opacityInfo",1,f.pe.UNSIGNED_BYTE,0,1)];class j extends L{constructor(e){super(e)}geometryInfo(){return Et}opacityInfo(){return bt}attributes(){return j.ATTRIBUTES}attributesInfo(){return j.ATTRIBUTES_INFO}}j.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],j.ATTRIBUTES_INFO={"icon-color":{name:"color",type:h.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:h.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:h.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:h.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:h.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:h.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};class Q extends L{constructor(e){super(e)}geometryInfo(){return Et}opacityInfo(){return bt}attributes(){return Q.ATTRIBUTES}attributesInfo(){return Q.ATTRIBUTES_INFO}}Q.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],Q.ATTRIBUTES_INFO={"text-color":{name:"color",type:h.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:h.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:h.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:h.R8_UNSIGNED,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:h.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:h.R8_UNSIGNED,isLayout:!0}};var H=C(68677),tt=C(29430),Dt=C(91766),_t=C(47461);const Rt={kind:"null"},Y={kind:"number"},ot={kind:"string"},Z={kind:"boolean"},st={kind:"color"},vt={kind:"object"},lt={kind:"value"};function Tt(p,e){return{kind:"array",itemType:p,n:e}}const Vt=[Rt,Y,ot,Z,st,vt,Tt(lt)];function wt(p){if("array"===p.kind){const e=wt(p.itemType);return"number"==typeof p.n?`array<${e}, ${p.n}>`:"value"===p.itemType.kind?"array":`array<${e}>`}return p.kind}function At(p){if(null===p)return Rt;if("string"==typeof p)return ot;if("boolean"==typeof p)return Z;if("number"==typeof p)return Y;if(p instanceof H.A)return st;if(Array.isArray(p)){let e;for(const i of p){const a=At(i);if(e){if(e!==a){e=lt;break}}else e=a}return Tt(e||lt,p.length)}return"object"==typeof p?vt:lt}function Ot(p,e){if("array"===e.kind)return"array"===p.kind&&(0===p.n&&"value"===p.itemType.kind||Ot(p.itemType,e.itemType))&&("number"!=typeof e.n||e.n===p.n);if("value"===e.kind)for(const i of Vt)if(Ot(p,i))return!0;return e.kind===p.kind}function Gt(p){if(null===p)return"";const e=typeof p;return"string"===e?p:"number"===e||"boolean"===e?String(p):p instanceof H.A?p.toString():JSON.stringify(p)}class Wt{constructor(e){this._parent=e,this._vars={}}add(e,i){this._vars[e]=i}get(e){return this._vars[e]?this._vars[e]:this._parent?this._parent.get(e):null}}class u{constructor(){this.type=lt}static parse(e){if(e.length>1)throw new Error('"id" does not expect arguments');return new u}evaluate(e,i){return null==e?void 0:e.id}}class y{constructor(){this.type=ot}static parse(e){if(e.length>1)throw new Error('"geometry-type" does not expect arguments');return new y}evaluate(e,i){if(!e)return null;switch(e.type){case Dt.dC.Point:return"Point";case Dt.dC.LineString:return"LineString";case Dt.dC.Polygon:return"Polygon";default:return null}}}class l{constructor(){this.type=vt}static parse(e){if(e.length>1)throw new Error('"properties" does not expect arguments');return new l}evaluate(e,i){return null==e?void 0:e.values}}class _{constructor(){this.type=Y}static parse(e){if(e.length>1)throw new Error('"zoom" does not expect arguments');return new _}evaluate(e,i){return i}}class m{constructor(e,i,a){this._lhs=e,this._rhs=i,this._compare=a,this.type=Z}static parse(e,i,a){if(3!==e.length&&4!==e.length)throw new Error(`"${e[0]}" expects 2 or 3 arguments`);if(4===e.length)throw new Error(`"${e[0]}" collator not supported`);return new m(S(e[1],i),S(e[2],i),a)}evaluate(e,i){return this._compare(this._lhs.evaluate(e,i),this._rhs.evaluate(e,i))}}class Pt{constructor(e){this._arg=e,this.type=Z}static parse(e,i){if(2!==e.length)throw new Error('"!" expects 1 argument');return new Pt(S(e[1],i))}evaluate(e,i){return!this._arg.evaluate(e,i)}}class Nt{constructor(e){this._args=e,this.type=Z}static parse(e,i){const a=[];for(let o=1;o<e.length;o++)a.push(S(e[o],i));return new Nt(a)}evaluate(e,i){for(const a of this._args)if(!a.evaluate(e,i))return!1;return!0}}class Lt{constructor(e){this._args=e,this.type=Z}static parse(e,i){const a=[];for(let o=1;o<e.length;o++)a.push(S(e[o],i));return new Lt(a)}evaluate(e,i){for(const a of this._args)if(a.evaluate(e,i))return!0;return!1}}class Kt{constructor(e){this._args=e,this.type=Z}static parse(e,i){const a=[];for(let o=1;o<e.length;o++)a.push(S(e[o],i));return new Kt(a)}evaluate(e,i){for(const a of this._args)if(a.evaluate(e,i))return!1;return!0}}class qt{constructor(e,i,a){this.type=e,this._args=i,this._fallback=a}static parse(e,i,a){if(e.length<4)throw new Error('"case" expects at least 3 arguments');if(e.length%2==1)throw new Error('"case" expects an odd number of arguments');let o;const s=[];for(let c=1;c<e.length-1;c+=2){const d=S(e[c],i),E=S(e[c+1],i,a);o||(o=E.type),s.push({condition:d,output:E})}const v=S(e[e.length-1],i,a);return o||(o=v.type),new qt(o,s,v)}evaluate(e,i){for(const a of this._args)if(a.condition.evaluate(e,i))return a.output.evaluate(e,i);return this._fallback.evaluate(e,i)}}class Zt{constructor(e,i){this.type=e,this._args=i}static parse(e,i){if(e.length<2)throw new Error('"coalesce" expects at least 1 argument');let a;const o=[];for(let s=1;s<e.length;s++){const v=S(e[s],i);a||(a=v.type),o.push(v)}return new Zt(a,o)}evaluate(e,i){for(const a of this._args){const o=a.evaluate(e,i);if(null!==o)return o}return null}}class Xt{constructor(e,i,a,o,s){this.type=e,this._input=i,this._labels=a,this._outputs=o,this._fallback=s}static parse(e,i){if(e.length<3)throw new Error('"match" expects at least 3 arguments');if(e.length%2==0)throw new Error('"case" expects an even number of arguments');let a;const o=S(e[1],i),s=[],v={};let c;for(let d=2;d<e.length-1;d+=2){let E=e[d];Array.isArray(E)||(E=[E]);for(const I of E){const R=typeof I;if("string"!==R&&"number"!==R)throw new Error('"match" requires string or number literal as labels');if(c){if(R!==c)throw new Error('"match" requires labels to have the same type')}else c=R;v[I]=s.length}const T=S(e[d+1],i);a||(a=T.type),s.push(T)}return new Xt(a,o,v,s,S(e[e.length-1],i))}evaluate(e,i){const a=this._input.evaluate(e,i);return(this._outputs[this._labels[a]]||this._fallback).evaluate(e,i)}}class mt{constructor(e,i,a,o,s){this._operator=e,this.type=i,this.interpolation=a,this.input=o,this._stops=s}static parse(e,i,a){const o=e[0];if(e.length<5)throw new Error(`"${o}" expects at least 4 arguments`);const s=e[1];if(!Array.isArray(s)||0===s.length)throw new Error(`"${s}" is not a valid interpolation`);switch(s[0]){case"linear":if(1!==s.length)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(2!==s.length||"number"!=typeof s[1])throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(5!==s.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(let E=1;E<5;E++){const T=s[E];if("number"!=typeof T||T<0||T>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error(`"${e[0]}" unknown interpolation type "${s[0]}"`)}if(e.length%2!=1)throw new Error(`"${o}" expects an even number of arguments`);const v=S(e[2],i,Y);let c;"interpolate-hcl"===o||"interpolate-lab"===o?c=st:a&&"value"!==a.kind&&(c=a);const d=[];for(let E=3;E<e.length;E+=2){const T=e[E];if("number"!=typeof T)throw new Error(`"${o}" requires stop inputs as literal numbers`);if(d.length&&d[d.length-1][0]>=T)throw new Error(`"${o}" requires strictly ascending stop inputs`);const I=S(e[E+1],i,c);c||(c=I.type),d.push([T,I])}if(c&&c!==st&&c!==Y&&("array"!==c.kind||c.itemType!==Y))throw new Error(`"${o}" cannot interpolate type ${wt(c)}`);return new mt(o,c,s,v,d)}evaluate(e,i){const a=this._stops;if(1===a.length)return a[0][1].evaluate(e,i);const o=this.input.evaluate(e,i);if(o<=a[0][0])return a[0][1].evaluate(e,i);if(o>=a[a.length-1][0])return a[a.length-1][1].evaluate(e,i);let s=0;for(;++s<a.length&&!(o<a[s][0]););const d=mt.interpolationRatio(this.interpolation,o,a[s-1][0],a[s][0]),E=a[s-1][1].evaluate(e,i),T=a[s][1].evaluate(e,i);if("interpolate"===this._operator){if("array"===this.type.kind&&Array.isArray(E)&&Array.isArray(T))return E.map((I,R)=>(0,P.GW)(I,T[R],d));if("color"===this.type.kind&&E instanceof H.A&&T instanceof H.A){const I=new H.A(E),R=new H.A(T);return new H.A([(0,P.GW)(I.r,R.r,d),(0,P.GW)(I.g,R.g,d),(0,P.GW)(I.b,R.b,d),(0,P.GW)(I.a,R.a,d)])}if("number"===this.type.kind&&"number"==typeof E&&"number"==typeof T)return(0,P.GW)(E,T,d);throw new Error(`"${this._operator}" cannot interpolate type ${wt(this.type)}`)}if("interpolate-hcl"===this._operator){const I=(0,tt.RH)(E),R=(0,tt.RH)(T),B=R.h-I.h,V=(0,tt.$)({h:I.h+d*(B>180||B<-180?B-360*Math.round(B/360):B),c:(0,P.GW)(I.c,R.c,d),l:(0,P.GW)(I.l,R.l,d)});return new H.A({a:(0,P.GW)(E.a,T.a,d),...V})}if("interpolate-lab"===this._operator){const I=(0,tt.ZD)(E),R=(0,tt.ZD)(T),B=(0,tt.$)({l:(0,P.GW)(I.l,R.l,d),a:(0,P.GW)(I.a,R.a,d),b:(0,P.GW)(I.b,R.b,d)});return new H.A({a:(0,P.GW)(E.a,T.a,d),...B})}throw new Error(`Unexpected operator "${this._operator}"`)}interpolationUniformValue(e,i){const a=this._stops;if(1===a.length||e>=a[a.length-1][0])return 0;let o=0;for(;++o<a.length&&!(e<a[o][0]););return mt.interpolationRatio(this.interpolation,i,a[o-1][0],a[o][0])}getInterpolationRange(e){const i=this._stops;if(1===i.length){const s=i[0][0];return[s,s]}const a=i[i.length-1][0];if(e>=a)return[a,a];let o=0;for(;++o<i.length&&!(e<i[o][0]););return[i[o-1][0],i[o][0]]}static interpolationRatio(e,i,a,o){let s=0;return"linear"===e[0]?s=mt._exponentialInterpolationRatio(i,1,a,o):"exponential"===e[0]?s=mt._exponentialInterpolationRatio(i,e[1],a,o):"cubic-bezier"===e[0]&&(s=(0,_t.gb)(e[1],e[2],e[3],e[4])(mt._exponentialInterpolationRatio(i,1,a,o),1e-5)),s<0?s=0:s>1&&(s=1),s}static _exponentialInterpolationRatio(e,i,a,o){const s=o-a;if(0===s)return 0;const v=e-a;return 1===i?v/s:(i**v-1)/(i**s-1)}}class Qt{constructor(e,i,a){this.type=e,this._input=i,this._stops=a}static parse(e,i){if(e.length<5)throw new Error('"step" expects at least 4 arguments');if(e.length%2!=1)throw new Error('"step" expects an even number of arguments');const a=S(e[1],i,Y);let o;const s=[];s.push([-1/0,S(e[2],i)]);for(let v=3;v<e.length;v+=2){const c=e[v];if("number"!=typeof c)throw new Error('"step" requires stop inputs as literal numbers');if(s.length&&s[s.length-1][0]>=c)throw new Error('"step" requires strictly ascending stop inputs');const d=S(e[v+1],i);o||(o=d.type),s.push([c,d])}return new Qt(o,a,s)}evaluate(e,i){const a=this._stops;if(1===a.length)return a[0][1].evaluate(e,i);const o=this._input.evaluate(e,i);let s=0;for(;++s<a.length&&!(o<a[s][0]););return this._stops[s-1][1].evaluate(e,i)}}class Jt{constructor(e,i){this.type=e,this._output=i}static parse(e,i,a){if(e.length<4)throw new Error('"let" expects at least 3 arguments');if(e.length%2==1)throw new Error('"let" expects an odd number of arguments');const o=new Wt(i);for(let v=1;v<e.length-1;v+=2){const c=e[v];if("string"!=typeof c)throw new Error(`"let" requires a string to define variable names - found ${c}`);o.add(c,S(e[v+1],i))}const s=S(e[e.length-1],o,a);return new Jt(s.type,s)}evaluate(e,i){return this._output.evaluate(e,i)}}class te{constructor(e,i){this.type=e,this.output=i}static parse(e,i,a){if(2!==e.length||"string"!=typeof e[1])throw new Error('"var" requires just one literal string argument');const o=i.get(e[1]);if(!o)throw new Error(`${e[1]} must be defined before being used in a "var" expression`);return new te(a||lt,o)}evaluate(e,i){return this.output.evaluate(e,i)}}class ee{constructor(e,i,a){this.type=e,this._index=i,this._array=a}static parse(e,i){if(3!==e.length)throw new Error('"at" expects 2 arguments');const a=S(e[1],i,Y),o=S(e[2],i);return new ee(o.type.itemType,a,o)}evaluate(e,i){const a=this._index.evaluate(e,i),o=this._array.evaluate(e,i);if(a<0||a>=o.length)throw new Error('"at" index out of bounds');if(a!==Math.floor(a))throw new Error('"at" index must be an integer');return o[a]}}class Ct{constructor(e,i){this._key=e,this._obj=i,this.type=lt}static parse(e,i){let a,o;switch(e.length){case 2:return a=S(e[1],i),new Ct(a);case 3:return a=S(e[1],i),o=S(e[2],i),new Ct(a,o);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(e,i){const a=this._key.evaluate(e,i);return this._obj?this._obj.evaluate(e,i)[a]:null==e?void 0:e.values[a]}}class Ft{constructor(e,i){this._key=e,this._obj=i,this.type=Z}static parse(e,i){let a,o;switch(e.length){case 2:return a=S(e[1],i),new Ft(a);case 3:return a=S(e[1],i),o=S(e[2],i),new Ft(a,o);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(e,i){const a=this._key.evaluate(e,i);return this._obj?a in this._obj.evaluate(e,i):!(null==e||!e.values[a])}}class re{constructor(e,i){this._key=e,this._vals=i,this.type=Z}static parse(e,i){if(3!==e.length)throw new Error('"in" expects 2 arguments');return new re(S(e[1],i),S(e[2],i))}evaluate(e,i){const a=this._key.evaluate(e,i);return this._vals.evaluate(e,i).includes(a)}}class Yt{constructor(e,i,a){this._item=e,this._array=i,this._from=a,this.type=Y}static parse(e,i){if(e.length<3||e.length>4)throw new Error('"index-of" expects 3 or 4 arguments');const a=S(e[1],i),o=S(e[2],i);if(4===e.length){const s=S(e[3],i,Y);return new Yt(a,o,s)}return new Yt(a,o)}evaluate(e,i){const a=this._item.evaluate(e,i),o=this._array.evaluate(e,i);if(this._from){const s=this._from.evaluate(e,i);if(s!==Math.floor(s))throw new Error('"index-of" index must be an integer');return o.indexOf(a,s)}return o.indexOf(a)}}class ne{constructor(e){this._arg=e,this.type=Y}static parse(e,i){if(2!==e.length)throw new Error('"length" expects 2 arguments');const a=S(e[1],i);return new ne(a)}evaluate(e,i){const a=this._arg.evaluate(e,i);if("string"==typeof a||Array.isArray(a))return a.length;throw new Error('"length" expects string or array')}}class Ht{constructor(e,i,a,o){this.type=e,this._array=i,this._from=a,this._to=o}static parse(e,i){if(e.length<3||e.length>4)throw new Error('"slice" expects 2 or 3 arguments');const a=S(e[1],i),o=S(e[2],i,Y);if(o.type!==Y)throw new Error('"slice" index must return a number');if(4===e.length){const s=S(e[3],i,Y);if(s.type!==Y)throw new Error('"slice" index must return a number');return new Ht(a.type,a,o,s)}return new Ht(a.type,a,o)}evaluate(e,i){const a=this._array.evaluate(e,i);if(!Array.isArray(a)&&"string"!=typeof a)throw new Error('"slice" input must be an array or a string');const o=this._from.evaluate(e,i);if(o<0||o>=a.length)throw new Error('"slice" index out of bounds');if(o!==Math.floor(o))throw new Error('"slice" index must be an integer');if(this._to){const s=this._to.evaluate(e,i);if(s<0||s>=a.length)throw new Error('"slice" index out of bounds');if(s!==Math.floor(s))throw new Error('"slice" index must be an integer');return a.slice(o,s)}return a.slice(o)}}class ie{constructor(){this.type=Z}static parse(e){if(1!==e.length)throw new Error('"has-id" expects no arguments');return new ie}evaluate(e,i){return void 0!==(null==e?void 0:e.id)}}class ut{constructor(e,i){this._args=e,this._calculate=i,this.type=Y}static parse(e,i,a){const o=e.slice(1).map(s=>S(s,i));return new ut(o,a)}evaluate(e,i){let a;return this._args&&(a=this._args.map(o=>o.evaluate(e,i))),this._calculate(a)}}let J=(()=>{class p{constructor(i,a){this._args=i,this._calculate=a,this.type=Y}static parse(i,a){const o=i.slice(1).map(s=>S(s,a));return new p(o,p.ops[i[0]])}evaluate(i,a){let o;return this._args&&(o=this._args.map(s=>s.evaluate(i,a))),this._calculate(o)}}return p.ops={abs:e=>Math.abs(e[0]),acos:e=>Math.acos(e[0]),asin:e=>Math.asin(e[0]),atan:e=>Math.atan(e[0]),ceil:e=>Math.ceil(e[0]),cos:e=>Math.cos(e[0]),e:()=>Math.E,floor:e=>Math.floor(e[0]),ln:e=>Math.log(e[0]),ln2:()=>Math.LN2,log10:e=>Math.log(e[0])/Math.LN10,log2:e=>Math.log(e[0])/Math.LN2,max:e=>Math.max(...e),min:e=>Math.min(...e),pi:()=>Math.PI,round:e=>Math.round(e[0]),sin:e=>Math.sin(e[0]),sqrt:e=>Math.sqrt(e[0]),tan:e=>Math.tan(e[0])},p})();class ae{constructor(e){this._args=e,this.type=ot}static parse(e,i){return new ae(e.slice(1).map(a=>S(a,i)))}evaluate(e,i){return this._args.map(a=>a.evaluate(e,i)).join("")}}let pe=(()=>{class p{constructor(i,a){this._arg=i,this._calculate=a,this.type=ot}static parse(i,a){if(2!==i.length)throw new Error(`${i[0]} expects 1 argument`);const o=S(i[1],a);return new p(o,p.ops[i[0]])}evaluate(i,a){return this._calculate(this._arg.evaluate(i,a))}}return p.ops={downcase:e=>e.toLowerCase(),upcase:e=>e.toUpperCase()},p})();class oe{constructor(e){this._args=e,this.type=st}static parse(e,i){if(4!==e.length)throw new Error('"rgb" expects 3 arguments');const a=e.slice(1).map(o=>S(o,i));return new oe(a)}evaluate(e,i){const a=this._validate(this._args[0].evaluate(e,i)),o=this._validate(this._args[1].evaluate(e,i)),s=this._validate(this._args[2].evaluate(e,i));return new H.A({r:a,g:o,b:s})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error(`${e}: invalid color component`);return Math.round(e)}}class se{constructor(e){this._args=e,this.type=st}static parse(e,i){if(5!==e.length)throw new Error('"rgba" expects 4 arguments');const a=e.slice(1).map(o=>S(o,i));return new se(a)}evaluate(e,i){const a=this._validate(this._args[0].evaluate(e,i)),o=this._validate(this._args[1].evaluate(e,i)),s=this._validate(this._args[2].evaluate(e,i)),v=this._validateAlpha(this._args[3].evaluate(e,i));return new H.A({r:a,g:o,b:s,a:v})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error(`${e}: invalid color component`);return Math.round(e)}_validateAlpha(e){if("number"!=typeof e||e<0||e>1)throw new Error(`${e}: invalid alpha color component`);return e}}class le{constructor(e){this._color=e,this.type=Tt(Y,4)}static parse(e,i){if(2!==e.length)throw new Error('"to-rgba" expects 1 argument');const a=S(e[1],i);return new le(a)}evaluate(e,i){return new H.A(this._color.evaluate(e,i)).toRgba()}}class xt{constructor(e,i){this.type=e,this._args=i}static parse(e,i){const a=e[0];if(e.length<2)throw new Error(`${a} expects at least one argument`);let o,s=1;if("array"===a){if(e.length>2){switch(e[1]){case"string":o=ot;break;case"number":o=Y;break;case"boolean":o=Z;break;default:throw new Error('"array" type argument must be string, number or boolean')}s++}else o=lt;let c;if(e.length>3){if(c=e[2],null!==c&&("number"!=typeof c||c<0||c!==Math.floor(c)))throw new Error('"array" length argument must be a positive integer literal');s++}o=Tt(o,c)}else switch(a){case"string":o=ot;break;case"number":o=Y;break;case"boolean":o=Z;break;case"object":o=vt}const v=[];for(;s<e.length;s++){const c=S(e[s],i);v.push(c)}return new xt(o,v)}evaluate(e,i){let a;for(const o of this._args){const s=o.evaluate(e,i);if(a=At(s),Ot(a,this.type))return s}throw new Error(`Expected ${wt(this.type)} but got ${wt(a)}`)}}let St=(()=>{class p{constructor(i,a){this.type=i,this._args=a}static parse(i,a){const o=i[0],s=p.types[o];if(s===Z||s===ot){if(2!==i.length)throw new Error(`${o} expects one argument`)}else if(i.length<2)throw new Error(`${o} expects at least one argument`);const v=[];for(let c=1;c<i.length;c++){const d=S(i[c],a);v.push(d)}return new p(s,v)}evaluate(i,a){if(this.type===Z)return!!this._args[0].evaluate(i,a);if(this.type===ot)return Gt(this._args[0].evaluate(i,a));if(this.type===Y){for(const o of this._args){const s=Number(o.evaluate(i,a));if(!isNaN(s))return s}return null}if(this.type===st){for(const o of this._args)try{const s=p.toColor(o.evaluate(i,a));if(s instanceof H.A)return s}catch{}return null}}static toBoolean(i){return!!i}static toString(i){return Gt(i)}static toNumber(i){const a=Number(i);if(isNaN(a))throw new Error(`"${i}" is not a number`);return a}static toColor(i){if(i instanceof H.A)return i;if("string"==typeof i){const a=H.A.fromString(i);if(a)return a;throw new Error(`"${i}" is not a color`)}if(Array.isArray(i))return H.A.fromArray(i);throw new Error(`"${i}" is not a color`)}}return p.types={"to-boolean":Z,"to-color":st,"to-number":Y,"to-string":ot},p})();class ue{constructor(e){this._val=e,this.type=At(e)}static parse(e){if(2!==e.length)throw new Error('"literal" expects 1 argument');return new ue(e[1])}evaluate(e,i){return this._val}}class ce{constructor(e){this._arg=e,this.type=ot}static parse(e,i){if(2!==e.length)throw new Error('"typeof" expects 1 argument');return new ce(S(e[1],i))}evaluate(e,i){return wt(At(this._arg.evaluate(e,i)))}}function S(p,e,i){const a=typeof p;if("string"===a||"boolean"===a||"number"===a||null===p){if(i)switch(i.kind){case"string":"string"!==a&&(p=St.toString(p));break;case"number":"number"!==a&&(p=St.toNumber(p));break;case"color":p=St.toColor(p)}p=["literal",p]}if(!Array.isArray(p)||0===p.length)throw new Error("Expression must be a non empty array");const o=p[0];if("string"!=typeof o)throw new Error("First element of expression must be a string");const s=ye[o];if(void 0===s)throw new Error(`Invalid expression operator "${o}"`);if(!s)throw new Error(`Unimplemented expression operator "${o}"`);return s.parse(p,e,i)}const ye={array:xt,boolean:xt,collator:null,format:null,image:null,literal:ue,number:xt,"number-format":null,object:xt,string:xt,"to-boolean":St,"to-color":St,"to-number":St,"to-string":St,typeof:ce,accumulated:null,"feature-state":null,"geometry-type":y,id:u,"line-progress":null,properties:l,at:ee,get:Ct,has:Ft,in:re,"index-of":Yt,length:ne,slice:Ht,"!":Pt,"!=":class w extends m{static parse(e,i){return m.parse(e,i,(a,o)=>a!==o)}},"<":class U extends m{static parse(e,i){return m.parse(e,i,(a,o)=>a<o)}},"<=":class G extends m{static parse(e,i){return m.parse(e,i,(a,o)=>a<=o)}},"==":class b extends m{static parse(e,i){return m.parse(e,i,(a,o)=>a===o)}},">":class K extends m{static parse(e,i){return m.parse(e,i,(a,o)=>a>o)}},">=":class yt extends m{static parse(e,i){return m.parse(e,i,(a,o)=>a>=o)}},all:Nt,any:Lt,case:qt,coalesce:Zt,match:Xt,within:null,interpolate:mt,"interpolate-hcl":mt,"interpolate-lab":mt,step:Qt,let:Jt,var:te,concat:ae,downcase:pe,"is-supported-script":null,"resolved-locale":null,upcase:pe,rgb:oe,rgba:se,"to-rgba":le,"-":class de extends ut{static parse(e,i){switch(e.length){case 2:return ut.parse(e,i,a=>-a[0]);case 3:return ut.parse(e,i,a=>a[0]-a[1]);default:throw new Error('"-" expects 1 or 2 arguments')}}},"*":class ge extends ut{static parse(e,i){return ut.parse(e,i,a=>{let o=1;for(const s of a)o*=s;return o})}},"/":class _e extends ut{static parse(e,i){if(3===e.length)return ut.parse(e,i,a=>a[0]/a[1]);throw new Error('"/" expects 2 arguments')}},"%":class me extends ut{static parse(e,i){if(3===e.length)return ut.parse(e,i,a=>a[0]%a[1]);throw new Error('"%" expects 2 arguments')}},"^":class ve extends ut{static parse(e,i){if(3===e.length)return ut.parse(e,i,a=>a[0]**a[1]);throw new Error('"^" expects 1 or 2 arguments')}},"+":class Ee extends ut{static parse(e,i){return ut.parse(e,i,a=>{let o=0;for(const s of a)o+=s;return o})}},abs:J,acos:J,asin:J,atan:J,ceil:J,cos:J,e:J,floor:J,ln:J,ln2:J,log10:J,log2:J,max:J,min:J,pi:J,round:J,sin:J,sqrt:J,tan:J,zoom:_,"heatmap-density":null,"has-id":ie,none:Kt};class ht{constructor(e){this._expression=e}filter(e,i){if(!this._expression)return!0;try{return this._expression.evaluate(e,i)}catch(a){return console.log(a.message),!0}}static createFilter(e){if(!e)return null;this.isLegacyFilter(e)&&(e=this.convertLegacyFilter(e));try{const i=S(e,null,Z);return new ht(i)}catch(i){return console.log(i.message),null}}static isLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return!0;switch(e[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===e.length&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"in":return e.length>=3&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(let i=1;i<e.length;i++)if(this.isLegacyFilter(e[i]))return!0;return!1;case"has":return 2===e.length&&("$id"===e[1]||"$type"===e[1]);default:return!1}}static convertLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return!0;const i=e[0];if(1===e.length)return"any"!==i;switch(i){case"==":return ht.convertComparison("==",e[1],e[2]);case"!=":return ht.negate(ht.convertComparison("==",e[1],e[2]));case">":case"<":case">=":case"<=":return ht.convertComparison(i,e[1],e[2]);case"in":return ht.convertIn(e[1],e.slice(2));case"!in":return ht.negate(ht.convertIn(e[1],e.slice(2)));case"any":case"all":case"none":return ht.convertCombining(i,e.slice(1));case"has":return ht.convertHas(e[1]);case"!has":return ht.negate(ht.convertHas(e[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(e,i,a){switch(i){case"$type":return[e,["geometry-type"],a];case"$id":return[e,["id"],a];default:return[e,["get",i],a]}}static convertIn(e,i){switch(e){case"$type":return["in",["geometry-type"],["literal",i]];case"$id":return["in",["id"],["literal",i]];default:return["in",["get",e],["literal",i]]}}static convertHas(e){switch(e){case"$type":return!0;case"$id":return["has-id"];default:return["has",e]}}static convertCombining(e,i){return[e].concat(i.map(this.convertLegacyFilter))}static negate(e){return["!",e]}}var q=C(54e3);class jt{constructor(e,i){var a;let o;switch(this.isDataDriven=!1,this.interpolator=null,e.type){case"number":case"color":o=!0;break;case"array":o="number"===e.value;break;default:o=!1}if(null==i&&(i=e.default),Array.isArray(i)&&i.length>0&&ye[i[0]]){const v={number:Y,color:st,string:ot,boolean:Z,enum:ot};try{const d=S(i,null,"array"===e.type?Tt(v[e.value]||lt,e.length):v[e.type]);this.getValue=this._buildExpression(d,e),this.isDataDriven=!0,d instanceof mt&&d.input instanceof _&&(this.interpolator=d)}catch(c){console.log(c.message),this.getValue=this._buildSimple(e.default)}return}o&&"interval"===i.type&&(o=!1);const s=(null===(a=i)||void 0===a?void 0:a.stops)&&i.stops.length>0;if(s)for(const v of i.stops)v[1]=this._validate(v[1],e);if(this.isDataDriven=!!i&&!!i.property,this.isDataDriven)if(void 0!==i.default&&(i.default=this._validate(i.default,e)),s)switch(i.type){case"identity":this.getValue=this._buildIdentity(i,e);break;case"categorical":this.getValue=this._buildCategorical(i,e);break;default:this.getValue=o?this._buildInterpolate(i,e):this._buildInterval(i,e)}else this.getValue=this._buildIdentity(i,e);else s?this.getValue=o?this._buildZoomInterpolate(i):this._buildZoomInterval(i):(i=this._validate(i,e),this.getValue=this._buildSimple(i))}_validate(e,i){if("number"===i.type){if(null!=i.minimum&&e<i.minimum)return i.minimum;if(null!=i.maximum&&e>i.maximum)return i.maximum}else"color"===i.type?e=jt._parseColor(e):"enum"===i.type?"string"==typeof e&&(e=i.values.indexOf(e)):"array"===i.type&&"enum"===i.value?e=e.map(a=>"string"==typeof a?i.values.indexOf(a):a):"string"===i.type&&(e=Gt(e));return e}_buildSimple(e){return()=>e}_buildExpression(e,i){return(a,o)=>{try{const s=e.evaluate(o,a);return void 0===s?i.default:this._validate(s,i)}catch(s){return console.log(s.message),i.default}}}_buildIdentity(e,i){return(a,o)=>{let s;return o&&(s=o.values[e.property]),void 0!==s&&(s=this._validate(s,i)),null!=s?s:void 0!==e.default?e.default:i.default}}_buildCategorical(e,i){return(a,o)=>{let s;return o&&(s=o.values[e.property]),s=this._categorical(s,e.stops),void 0!==s?s:void 0!==e.default?e.default:i.default}}_buildInterval(e,i){return(a,o)=>{let s;return o&&(s=o.values[e.property]),"number"==typeof s?this._interval(s,e.stops):void 0!==e.default?e.default:i.default}}_buildInterpolate(e,i){return(a,o)=>{let s;return o&&(s=o.values[e.property]),"number"==typeof s?this._interpolate(s,e.stops,e.base||1):void 0!==e.default?e.default:i.default}}_buildZoomInterpolate(e){return i=>this._interpolate(i,e.stops,e.base||1)}_buildZoomInterval(e){return i=>this._interval(i,e.stops)}_categorical(e,i){const a=i.length;for(let o=0;o<a;o++)if(i[o][0]===e)return i[o][1]}_interval(e,i){const a=i.length;let o=0;for(let s=0;s<a&&i[s][0]<=e;s++)o=s;return i[o][1]}_interpolate(e,i,a){let o,s;const v=i.length;for(let c=0;c<v;c++){const d=i[c];if(!(d[0]<=e)){s=d;break}o=d}if(o&&s){const c=s[0]-o[0],d=e-o[0],E=1===a?d/c:(a**d-1)/(a**c-1);if(Array.isArray(o[1])){const T=o[1],I=s[1],R=[];for(let B=0;B<T.length;B++)R.push((0,P.GW)(T[B],I[B],E));return R}return(0,P.GW)(o[1],s[1],E)}return o?o[1]:s?s[1]:void 0}static _isEmpty(e){for(const i in e)if(e.hasOwnProperty(i))return!1;return!0}static _parseColor(e){return Array.isArray(e)?e:("string"==typeof e&&(e=new H.A(e)),e instanceof H.A&&!this._isEmpty(e)?H.A.toUnitRGBA(e):void 0)}}var Mt,be=C(47669);!function(p){p[p.BUTT=0]="BUTT",p[p.ROUND=1]="ROUND",p[p.SQUARE=2]="SQUARE",p[p.UNKNOWN=4]="UNKNOWN"}(Mt||(Mt={}));class we{constructor(e,i,a,o,s,v){this.layer=e,this.feature=i,this.bounds=a,this.normalizationRatio=o,this.normalizationOffsetX=s,this.normalizationOffsetY=v}}class kt{constructor(e,i,a,o){switch(this.type=e,this.typeName=i.type,this.id=i.id,this.source=i.source,this.sourceLayer=i["source-layer"],this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,this.filter=i.filter,this.layout=i.layout,this.paint=i.paint,this.z=a,this.uid=o,e){case q.Dc.BACKGROUND:this._layoutDefinition=q.$u.backgroundLayoutDefinition,this._paintDefinition=q.$u.backgroundPaintDefinition;break;case q.Dc.FILL:this._layoutDefinition=q.$u.fillLayoutDefinition,this._paintDefinition=q.$u.fillPaintDefinition;break;case q.Dc.LINE:this._layoutDefinition=q.$u.lineLayoutDefinition,this._paintDefinition=q.$u.linePaintDefinition;break;case q.Dc.SYMBOL:this._layoutDefinition=q.$u.symbolLayoutDefinition,this._paintDefinition=q.$u.symbolPaintDefinition;break;case q.Dc.CIRCLE:this._layoutDefinition=q.$u.circleLayoutDefinition,this._paintDefinition=q.$u.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}getFeatureFilter(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=ht.createFilter(this.filter)}getLayoutProperty(e){return this._layoutProperties[e]}getPaintProperty(e){return this._paintProperties[e]}getLayoutValue(e,i,a){let o;const s=this._layoutProperties[e];return s&&(o=s.getValue(i,a)),void 0===o&&(o=this._layoutDefinition[e].default),o}getPaintValue(e,i,a){let o;const s=this._paintProperties[e];return s&&(o=s.getValue(i,a)),void 0===o&&(o=this._paintDefinition[e].default),o}isPainterDataDriven(){const e=this._paintProperties;if(e)for(const i in e)if(e[i].isDataDriven)return!0;return!1}isIntersectingFeature(e,i,a,o,s,v,c){return!1}getFeatureInflatedBounds(e,i,a,o){return null}_parseLayout(e){const i={};for(const a in e){const o=this._layoutDefinition[a];o&&(i[a]=new jt(o,e[a]))}return i}_parsePaint(e){const i={};for(const a in e){const o=this._paintDefinition[a];o&&(i[a]=new jt(o,e[a]))}return i}computeAttributesKey(e,i,a,o){let s=0,v=0;for(const c of i){let d=3;if(!c||c!==o){const E=a[c],{isLayout:T,isOptional:I}=E,R=T?this.getLayoutProperty(c):this.getPaintProperty(c);d=null!=R&&R.interpolator?2:null!=R&&R.isDataDriven?1:I&&!R?3:0}v|=d<<s,s+=2}return v<<3|e}}class Ie extends kt{constructor(e,i,a,o){super(e,i,a,o),this.backgroundMaterial=new z(this.computeAttributesKey(F.kh.BACKGROUND,z.ATTRIBUTES,z.ATTRIBUTES_INFO))}}class De extends kt{constructor(e,i,a,o){super(e,i,a,o);const s=this.getPaintProperty("fill-color"),v=this.getPaintProperty("fill-opacity"),c=this.getPaintProperty("fill-pattern");this.hasDataDrivenColor=null==s?void 0:s.isDataDriven,this.hasDataDrivenOpacity=null==v?void 0:v.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity||(null==c?void 0:c.isDataDriven);const d=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!d,this.hasDataDrivenOutlineColor=null==d?void 0:d.isDataDriven,this.hasDataDrivenOutline=d?d.isDataDriven:!!s&&s.isDataDriven,this.hasDataDrivenOutline=(d?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity,this.fillMaterial=new W(this.computeAttributesKey(F.kh.FILL,W.ATTRIBUTES,W.ATTRIBUTES_INFO)),this.outlineMaterial=new $(this.computeAttributesKey(F.kh.OUTLINE,this.outlineUsesFillColor?$.ATTRIBUTES_FILL:$.ATTRIBUTES_OUTLINE,this.outlineUsesFillColor?$.ATTRIBUTES_INFO_FILL:$.ATTRIBUTES_INFO_OUTLINE),this.outlineUsesFillColor)}getFeatureInflatedBounds(e,i,a,o){const s=he(e);if(!s)return null;const v=this.getPaintValue("fill-translate",i,e),c=o*Math.max(v[0],v[1]);return s[0]-=c,s[2]-=c,s[1]+=c,s[3]+=c,s}isIntersectingFeature(e,i,a,o,s,v,c){const d=o.getGeometry();if(!d)return!1;const E=8/c.normalizationRatio;e=e/c.normalizationRatio+c.normalizationOffsetX,i=i/c.normalizationRatio+c.normalizationOffsetY;const T=(0,P.yM)(this.getPaintValue("fill-translate",s,o),this.getPaintValue("fill-translate-anchor",s,o),v,8);return!!(0,P.s3)(e-=E*T.x,i-=E*T.y,d)||(0,P.ru)(e,i,d,E*a)}}class Te extends kt{constructor(e,i,a,o){var s,v,c,d,E,T,I,R,B;super(e,i,a,o);const V=this.getPaintProperty("line-pattern");if(this.lineMaterial=new at(this.computeAttributesKey(F.kh.LINE,at.ATTRIBUTES,at.ATTRIBUTES_INFO,V?"line-dasharray":"")),this.hasDataDrivenLine=(null===(s=this.getPaintProperty("line-blur"))||void 0===s?void 0:s.isDataDriven)||(null===(v=this.getPaintProperty("line-color"))||void 0===v?void 0:v.isDataDriven)||(null===(c=this.getPaintProperty("line-gap-width"))||void 0===c?void 0:c.isDataDriven)||(null===(d=this.getPaintProperty("line-offset"))||void 0===d?void 0:d.isDataDriven)||(null===(E=this.getPaintProperty("line-opacity"))||void 0===E?void 0:E.isDataDriven)||(null===(T=this.getPaintProperty("line-pattern"))||void 0===T?void 0:T.isDataDriven)||(null===(I=this.getPaintProperty("line-dasharray"))||void 0===I?void 0:I.isDataDriven)||(null===(R=this.getLayoutProperty("line-cap"))||void 0===R?void 0:R.isDataDriven)||(null===(B=this.getPaintProperty("line-width"))||void 0===B?void 0:B.isDataDriven),this.canUseThinTessellation=!1,!this.hasDataDrivenLine){const x=this.getPaintProperty("line-width");if(!x||"number"==typeof x&&.5*x<be.Gh){const et=this.getPaintProperty("line-offset");(!et||"number"==typeof et&&0===et)&&(this.canUseThinTessellation=!0)}}}getDashKey(e,i){let a;switch(i){case Mt.BUTT:a="Butt";break;case Mt.ROUND:a="Round";break;case Mt.SQUARE:a="Square";break;default:a="Butt"}return`dasharray-[${e.toString()}]-${a}`}getFeatureInflatedBounds(e,i,a,o){const s=he(e);if(!s)return null;const v=this.getPaintValue("line-translate",i,e),c=o*Math.max(v[0],v[1]);s[0]-=c,s[2]-=c,s[1]+=c,s[3]+=c;const d=o*Math.abs(this.getPaintValue("line-offset",i,e)||0),E=o*(this.getPaintValue("line-width",i,e)/2);return s[0]-=d+E,s[1]-=d+E,s[2]+=d+E,s[3]+=d+E,s}isIntersectingFeature(e,i,a,o,s,v,c){let d=o.getGeometry();if(!d)return!1;const E=8/c.normalizationRatio;e=e/c.normalizationRatio+c.normalizationOffsetX,i=i/c.normalizationRatio+c.normalizationOffsetY;const T=(0,P.yM)(this.getPaintValue("line-translate",s,o),this.getPaintValue("line-translate-anchor",s,o),v,8);e-=E*T.x,i-=E*T.y;const I=E*this.getPaintValue("line-offset",s,o)||0;0!==I&&(d=(0,P.cP)(d,-I));const R=this.getPaintValue("line-width",s,o);return(0,P.ru)(e,i,d,E*(a+R/2))}}class Re extends kt{constructor(e,i,a,o){var s,v,c,d,E,T,I,R,B,V,x,et;super(e,i,a,o),this.iconMaterial=new j(this.computeAttributesKey(F.kh.ICON,j.ATTRIBUTES,j.ATTRIBUTES_INFO)),this.textMaterial=new Q(this.computeAttributesKey(F.kh.TEXT,Q.ATTRIBUTES,Q.ATTRIBUTES_INFO)),this.hasDataDrivenIcon=(null===(s=this.getPaintProperty("icon-color"))||void 0===s?void 0:s.isDataDriven)||(null===(v=this.getPaintProperty("icon-halo-blur"))||void 0===v?void 0:v.isDataDriven)||(null===(c=this.getPaintProperty("icon-halo-color"))||void 0===c?void 0:c.isDataDriven)||(null===(d=this.getPaintProperty("icon-halo-width"))||void 0===d?void 0:d.isDataDriven)||(null===(E=this.getPaintProperty("icon-opacity"))||void 0===E?void 0:E.isDataDriven)||(null===(T=this.getLayoutProperty("icon-size"))||void 0===T?void 0:T.isDataDriven),this.hasDataDrivenText=(null===(I=this.getPaintProperty("text-color"))||void 0===I?void 0:I.isDataDriven)||(null===(R=this.getPaintProperty("text-halo-blur"))||void 0===R?void 0:R.isDataDriven)||(null===(B=this.getPaintProperty("text-halo-color"))||void 0===B?void 0:B.isDataDriven)||(null===(V=this.getPaintProperty("text-halo-width"))||void 0===V?void 0:V.isDataDriven)||(null===(x=this.getPaintProperty("text-opacity"))||void 0===x?void 0:x.isDataDriven)||(null===(et=this.getLayoutProperty("text-size"))||void 0===et?void 0:et.isDataDriven)}}class Ae extends kt{constructor(e,i,a,o){super(e,i,a,o),this.circleMaterial=new M(this.computeAttributesKey(F.kh.CIRCLE,M.ATTRIBUTES,M.ATTRIBUTES_INFO))}getFeatureInflatedBounds(e,i,a,o){const s=he(e);if(!s)return null;const v=this.getPaintValue("circle-translate",i,e),c=Math.max(v[0],v[1]);s[0]-=c,s[2]-=c,s[1]+=c,s[3]+=c;const d=o*(8*(this.getPaintValue("circle-radius",i,e)+this.getPaintValue("circle-stroke-width",i,e))/2);return s[0]-=d,s[1]-=d,s[2]+=d,s[3]+=d,s}isIntersectingFeature(e,i,a,o,s,v,c){const d=o.getGeometry();if(!d)return!1;const E=8/c.normalizationRatio;e=e/c.normalizationRatio+c.normalizationOffsetX,i=i/c.normalizationRatio+c.normalizationOffsetY,a*=E;const T=(0,P.yM)(this.getPaintValue("circle-translate",s,o),this.getPaintValue("circle-translate-anchor",s,o),v,E),I=E*(this.getPaintValue("circle-radius",s,o)+this.getPaintValue("circle-stroke-width",s,o));let R,B;for(const V of d)if(V)for(const x of V)if(R=x.x+T.x,B=x.y+T.y,Math.sqrt((e-R)*(e-R)+(i-B)*(i-B))-a<=I)return!0;return!1}}class Pe{constructor(e,i,a){var o,s,v,c,d;let E;this.allowOverlap=e.getLayoutValue("icon-allow-overlap",i),this.ignorePlacement=e.getLayoutValue("icon-ignore-placement",i),this.keepUpright=e.getLayoutValue("icon-keep-upright",i),this.optional=e.getLayoutValue("icon-optional",i),this.rotationAlignment=e.getLayoutValue("icon-rotation-alignment",i),this.rotationAlignment===q.I5.AUTO&&(this.rotationAlignment=a?q.I5.MAP:q.I5.VIEWPORT),E=e.getLayoutProperty("icon-anchor"),null!==(o=E)&&void 0!==o&&o.isDataDriven?this._anchorProp=E:this.anchor=e.getLayoutValue("icon-anchor",i),E=e.getLayoutProperty("icon-offset"),null!==(s=E)&&void 0!==s&&s.isDataDriven?this._offsetProp=E:this.offset=e.getLayoutValue("icon-offset",i),E=e.getLayoutProperty("icon-padding"),null!==(v=E)&&void 0!==v&&v.isDataDriven?this._paddingProp=E:this.padding=e.getLayoutValue("icon-padding",i),E=e.getLayoutProperty("icon-rotate"),null!==(c=E)&&void 0!==c&&c.isDataDriven?this._rotateProp=E:this.rotate=e.getLayoutValue("icon-rotate",i),E=e.getLayoutProperty("icon-size"),null!==(d=E)&&void 0!==d&&d.isDataDriven?this._sizeProp=E:this.size=e.getLayoutValue("icon-size",i)}update(e,i){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,i)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,i)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,i)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,i)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,i))}}class Ne{constructor(e,i,a){var o,s,v,c,d,E,T,I,R,B,V;let x;this.allowOverlap=e.getLayoutValue("text-allow-overlap",i),this.ignorePlacement=e.getLayoutValue("text-ignore-placement",i),this.keepUpright=e.getLayoutValue("text-keep-upright",i),this.optional=e.getLayoutValue("text-optional",i),this.rotationAlignment=e.getLayoutValue("text-rotation-alignment",i),this.rotationAlignment===q.I5.AUTO&&(this.rotationAlignment=a?q.I5.MAP:q.I5.VIEWPORT),x=e.getLayoutProperty("text-anchor"),null!==(o=x)&&void 0!==o&&o.isDataDriven?this._anchorProp=x:this.anchor=e.getLayoutValue("text-anchor",i),x=e.getLayoutProperty("text-justify"),null!==(s=x)&&void 0!==s&&s.isDataDriven?this._justifyProp=x:this.justify=e.getLayoutValue("text-justify",i),x=e.getLayoutProperty("text-letter-spacing"),null!==(v=x)&&void 0!==v&&v.isDataDriven?this._letterSpacingProp=x:this.letterSpacing=e.getLayoutValue("text-letter-spacing",i),x=e.getLayoutProperty("text-line-height"),null!==(c=x)&&void 0!==c&&c.isDataDriven?this._lineHeightProp=x:this.lineHeight=e.getLayoutValue("text-line-height",i),x=e.getLayoutProperty("text-max-angle"),null!==(d=x)&&void 0!==d&&d.isDataDriven?this._maxAngleProp=x:this.maxAngle=e.getLayoutValue("text-max-angle",i),x=e.getLayoutProperty("text-max-width"),null!==(E=x)&&void 0!==E&&E.isDataDriven?this._maxWidthProp=x:this.maxWidth=e.getLayoutValue("text-max-width",i),x=e.getLayoutProperty("text-offset"),null!==(T=x)&&void 0!==T&&T.isDataDriven?this._offsetProp=x:this.offset=e.getLayoutValue("text-offset",i),x=e.getLayoutProperty("text-padding"),null!==(I=x)&&void 0!==I&&I.isDataDriven?this._paddingProp=x:this.padding=e.getLayoutValue("text-padding",i),x=e.getLayoutProperty("text-rotate"),null!==(R=x)&&void 0!==R&&R.isDataDriven?this._rotateProp=x:this.rotate=e.getLayoutValue("text-rotate",i),x=e.getLayoutProperty("text-size"),null!==(B=x)&&void 0!==B&&B.isDataDriven?this._sizeProp=x:this.size=e.getLayoutValue("text-size",i),x=e.getLayoutProperty("text-writing-mode"),null!==(V=x)&&void 0!==V&&V.isDataDriven?this._writingModeProp=x:this.writingMode=e.getLayoutValue("text-writing-mode",i)}update(e,i){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,i)),this._justifyProp&&(this.justify=this._justifyProp.getValue(e,i)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(e,i)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(e,i)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(e,i)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(e,i)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,i)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,i)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,i)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,i)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(e,i))}}function he(p){const e=null==p?void 0:p.getGeometry();if(null==e)return null;let i=1/0,a=1/0,o=-1/0,s=-1/0;for(const v of e)if(v)for(const c of v)i=Math.min(i,c.x),a=Math.min(a,c.y),o=Math.max(o,c.x),s=Math.max(s,c.y);return(0,k.fA)(i,a,o,s)}},6517:(Ut,pt,C)=>{C.d(pt,{A:()=>P});var k=C(54e3),F=C(53220);class P{constructor(h){if(this._style=h,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,h.layers||(h.layers=[]),this.version=parseFloat(h.version),this.layers=h.layers.map((g,f,D)=>this._create(g,f,D)).filter(g=>!!g),this.layers)for(let g=0;g<this.layers.length;g++){const f=this.layers[g];this._layerByName[f.id]=f,this._uidToLayer.set(f.uid,f),f.type===k.Dc.BACKGROUND&&this.backgroundBucketIds.push(f.id)}this._identifyRefLayers()}isPainterDataDriven(h){const g=this._layerByName[h];return!!g&&g.isPainterDataDriven()}getStyleLayerId(h){return h>=this.layers.length?null:this.layers[h].id}getStyleLayerByUID(h){var g;return null!==(g=this._uidToLayer.get(h))&&void 0!==g?g:null}getStyleLayerIndex(h){const g=this._layerByName[h];return g?this.layers.indexOf(g):-1}setStyleLayer(h,g){if(null==h||!h.id)return;const f=this._style;null!=g&&g>=this.layers.length&&(g=this.layers.length-1);let D,L=!0;const A=this._layerByName[h.id];if(A){const O=this.layers.indexOf(A);g||(g=O),g===O?(L=!1,D=P._recreateLayer(h,A),this.layers[g]=D,f.layers[g]=h):(this.layers.splice(O,1),f.layers.splice(O,1),D=this._create(h,g,this.layers),this.layers.splice(g,0,D),f.layers.splice(g,0,h))}else D=this._create(h,g,this.layers),!g||g>=this.layers.length?(this.layers.push(D),f.layers.push(h)):(this.layers.splice(g,0,D),f.layers.splice(g,0,h));this._layerByName[h.id]=D,this._uidToLayer.set(D.uid,D),L&&this._recomputeZValues(),this._identifyRefLayers()}getStyleLayer(h){const g=this._layerByName[h];return g?{type:g.typeName,id:g.id,source:g.source,"source-layer":g.sourceLayer,minzoom:g.minzoom,maxzoom:g.maxzoom,filter:g.filter,layout:g.layout,paint:g.paint}:null}deleteStyleLayer(h){const g=this._layerByName[h];if(g){delete this._layerByName[h],this._uidToLayer.delete(g.uid);const f=this.layers.indexOf(g);this.layers.splice(f,1),this._style.layers.splice(f,1),this._recomputeZValues(),this._identifyRefLayers()}}getLayerById(h){return this._layerByName[h]}getLayoutProperties(h){const g=this._layerByName[h];return g?g.layout:null}getPaintProperties(h){const g=this._layerByName[h];return g?g.paint:null}setPaintProperties(h,g){const f=this._layerByName[h];if(!f)return;const L=P._recreateLayer({type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:f.layout,paint:g},f),A=this.layers.indexOf(f);this.layers[A]=L,this._style.layers[A].paint=g,this._layerByName[f.id]=L,this._uidToLayer.set(f.uid,L)}setLayoutProperties(h,g){const f=this._layerByName[h];if(!f)return;const L=P._recreateLayer({type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:g,paint:f.paint},f),A=this.layers.indexOf(f);this.layers[A]=L,this._style.layers[A].layout=g,this._layerByName[f.id]=L,this._uidToLayer.set(f.uid,L)}setStyleLayerVisibility(h,g){const f=this._layerByName[h];if(!f)return;const D=f.layout||{};D.visibility=g;const A=P._recreateLayer({type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:D,paint:f.paint},f),O=this.layers.indexOf(f);this.layers[O]=A,this._style.layers[O].layout=D,this._layerByName[f.id]=A,this._uidToLayer.set(f.uid,A)}getStyleLayerVisibility(h){var g;const f=this._layerByName[h];if(!f)return"none";const D=f.layout;return null!==(g=null==D?void 0:D.visibility)&&void 0!==g?g:"visible"}_recomputeZValues(){const h=this.layers,g=1/(h.length+1);for(let f=0;f<h.length;f++)h[f].z=1-(1+f)*g}_identifyRefLayers(){const h=[],g=[];let f=0;for(const A of this.layers){const O=A.layout;if(A.type===k.Dc.FILL){var D;const z=A;let M=A.source+"|"+A.sourceLayer;M+="|"+(null!==(D=null==O?void 0:O.visibility)&&void 0!==D?D:""),M+="|"+A.minzoom,M+="|"+A.maxzoom,M+="|"+JSON.stringify(A.filter),(z.hasDataDrivenFill||z.hasDataDrivenOutline)&&(M+="|"+f),h.push({key:M,layer:A})}else if(A.type===k.Dc.LINE){var L;const z=A,M=A.paint,W=null!=M&&(null!=M["line-pattern"]||null!=M["line-dasharray"]);let $=A.source+"|"+A.sourceLayer;$+="|"+(null!==(L=null==O?void 0:O.visibility)&&void 0!==L?L:""),$+="|"+A.minzoom,$+="|"+A.maxzoom,$+="|"+JSON.stringify(A.filter),$+="|"+(void 0!==O?O["line-cap"]:""),$+="|"+(void 0!==O?O["line-join"]:""),(z.hasDataDrivenLine||W)&&($+="|"+f),g.push({key:$,layer:A})}++f}this._assignRefLayers(h),this._assignRefLayers(g)}_assignRefLayers(h){let g,f;h.sort((L,A)=>L.key<A.key?-1:L.key>A.key?1:0);const D=h.length;for(let L=0;L<D;L++){const A=h[L];if(A.key===g)A.layer.refLayerId=f;else if(g=A.key,f=A.layer.id,A.layer.type===k.Dc.FILL){if(!A.layer.getPaintProperty("fill-outline-color"))for(let O=L+1;O<D;O++){const z=h[O];if(z.key!==g)break;if(z.layer.getPaintProperty("fill-outline-color")){h[L]=z,h[O]=A,f=z.layer.id;break}}}else if(A.layer.type===k.Dc.LINE){let O=A.layer;for(let z=L+1;z<D;z++){const M=h[z];if(M.key!==g)break;const W=M.layer;(O.canUseThinTessellation&&!W.canUseThinTessellation||!O.canUseThinTessellation&&(W.getPaintProperty("line-pattern")||W.getPaintProperty("line-dasharray")))&&(O=W,h[L]=M,h[z]=A,f=M.layer.id)}}}}_create(h,g,f){const D=1-(1+g)*(1/(f.length+1)),L=this._runningId++;switch(h.type){case"background":return new F.lf(k.Dc.BACKGROUND,h,D,L);case"fill":return new F.A4(k.Dc.FILL,h,D,L);case"line":return new F.tU(k.Dc.LINE,h,D,L);case"symbol":return new F.V1(k.Dc.SYMBOL,h,D,L);case"raster":return console.warn(`Unsupported vector tile raster layer ${h.id}`),null;case"circle":return new F.L(k.Dc.CIRCLE,h,D,L)}return null}static _recreateLayer(h,g){switch(h.type){case"background":return new F.lf(k.Dc.BACKGROUND,h,g.z,g.uid);case"fill":return new F.A4(k.Dc.FILL,h,g.z,g.uid);case"line":return new F.tU(k.Dc.LINE,h,g.z,g.uid);case"symbol":return new F.V1(k.Dc.SYMBOL,h,g.z,g.uid);case"raster":return console.warn(`Unsupported vector tile raster layer ${h.id}`),null;case"circle":return new F.L(k.Dc.CIRCLE,h,g.z,g.uid)}return null}}}}]);