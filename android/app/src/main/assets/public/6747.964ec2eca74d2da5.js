"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6747],{47139:(pt,ht,v)=>{v.d(ht,{y:()=>N});const Q=new(v(82818).A);function N(O){if(null==O)return["",!1];if(!Q.hasBidiChar(O))return[O,!1];let j;return j="rtl"===Q.checkContextual(O)?"IDNNN":"ICNNN",[Q.bidiTransform(O,j,"VLYSN"),!0]}},98894:(pt,ht,v)=>{v.d(ht,{Al:()=>_,Vb:()=>N,af:()=>r,rK:()=>n});var st=v(10467),Q=v(23098);const N="arial-unicode-ms",O="woff2",j=new Map,x=new Set;class P{constructor(g,S){this.fontFace=g,this.promise=S}}function _(o){return u.apply(this,arguments)}function u(){return(u=(0,st.A)(function*(o){const g=n(o),S=j.get(g);if(S)return S.promise;const w=new FontFace(o.family,`url('${Q.A.fontsUrl}/woff2/${g}.${O}') format('${O}')`,{style:o.style,weight:o.weight}),W=document.fonts;if(W.has(w)&&"loading"===w.status)return w.loaded;const K=w.load().then(()=>(W.add(w),w));return j.set(g,new P(w,K)),x.add(w),K})).apply(this,arguments)}function r(o){if(!o)return N;const g=o.toLowerCase().split(" ").join("-");switch(g){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return g}}function n(o){const g=function l(o){if(!o.weight)return"";switch(o.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}(o)+function e(o){if(!o.style)return"";switch(o.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}(o);return r(o.family)+(g.length>0?g:"-regular")}},72137:(pt,ht,v)=>{v.d(ht,{z:()=>j});var st=v(77806),Q=v(53262),N=v(61320),O=v(13682);class j{static fromOptimized(e,o,g=!1,S=!1,w=1){return(new x).initialize(e,o,g,S,w)}static fromJSON(e,o=!1,g=!1){const[S,w]=_(e);return(new u).initialize(S,w,o,g,1)}static fromOptimizedCIM(e,o,g=!1,S=!1,w=1){return(new r).initialize(e,o,g,S,w)}static fromJSONCIM(e,o=!1,g=!1,S=1){const[w,W]=_(e);return(new n).initialize(w,W,o,g,S)}static fromFeatureSetReader(e){const o=e.readGeometryForDisplay(),g=e.geometryType;return o&&g?this.fromOptimized(o,g):null}static fromFeatureSetReaderCIM(e){const o=e.readGeometryForDisplay(),g=e.geometryType;return o&&g?this.fromOptimizedCIM(o,g):null}static createEmptyOptimized(e,o=!1,g=!1,S=1){return(new x).initialize(new O.A,e,o,g,S)}static createEmptyJSON(e,o=!1,g=!1){return(new u).initialize([],e,o,g,1)}static createEmptyOptimizedCIM(e,o=!1,g=!1,S=1){return(new r).initialize(new O.A,e,o,g,S)}static createEmptyJSONCIM(e,o=!1,g=!1,S=1){return(new n).initialize([],e,o,g,S)}asJSON(){const e=(0,Q.x)(this);return"esriGeometryEnvelope"===this.geometryType?{xmin:e[0][0][0],ymin:e[0][0][1],xmax:e[0][2][0],ymax:e[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:e.flat()}:"esriGeometryPoint"===this.geometryType?{x:e[0][0][0],y:e[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:e}:{paths:e}}getCurrentRingArea(){if(this.pathSize<3)return 0;let e,o,g=0;if(this.seekPathStart(),!this.nextPoint())return 0;e=this.x,o=this.y;const S=e,w=o;for(;this.nextPoint();)g+=(e-this.x)*(o+this.y),e=this.x,o=this.y;return g+=(e-S)*(o+w),-.5*g}invertY(){this.yFactor*=-1}}class x extends j{constructor(){super(...arguments),this._end=-1}initialize(e,o,g,S,w){return this.hasZ=g,this.hasM=S,this.geometryType=o,this._stride=2+Number(g)+Number(S),this._geometry=e,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=w,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(e){if(e>=0&&e<this.totalSize){if(this._pathIndex<e)for(;this._pathIndex<e&&this.nextPath(););else if(this._pathIndex>e)for(;this._pathIndex>e&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(e){const o=this._pathOffset+e*this._stride;return o>=0&&o<this._end&&(this._pointOffset=o,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return!(this.pathIndex>=this.totalSize-1||(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,0))}prevPath(){return!(this.pathIndex<=0||(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,0))}pathLength(){const e=this._end,o=this._stride,g=this._geometry.coords;let S=0;for(let w=this._pathOffset+o;w<e;w+=o){const H=g[w]-g[w-o],V=g[w+1]-g[w-o+1];S+=Math.sqrt(H*H+V*V)}return S}startPath(){this._geometry.lengths.push(0)}pushPath(e){this.startPath(),this.pushPoints(e)}pushPoint(e){for(let o=0;o<this._stride;++o)this._geometry.coords.push(e[o]);this._geometry.lengths[this.totalSize-1]++}pushXY(e,o){this._geometry.coords.push(e,o),this._geometry.lengths[this.totalSize-1]++}pushPoints(e){for(const o of e)for(let g=0;g<this._stride;++g)this._geometry.coords.push(o[g]);this._geometry.lengths[this.totalSize-1]+=e.length}pushCursor(e){const o=e.asOptimized();this._geometry.coords.push(...o.coords),this._geometry.lengths.push(...o.lengths)}asOptimized(){const e=this._geometry.clone();if(1!==this.yFactor)for(let o=1;o<e.coords.length;o+=this._stride)e.coords[o]*=this.yFactor;return"esriGeometryPoint"===this.geometryType&&(e.lengths.length=0),e}isClosed(){const e=this._geometry.coords,o=this._pathOffset,g=this._end-this._stride;for(let S=0;S<this._stride;S++)if(e[o+S]!==e[g+S])return!1;return!0}clone(){return(new x).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce((e,o)=>e+o)}get pathSize(){const{lengths:e}=this._geometry;return this._pathIndex<0||this._pathIndex>e.length-1?0:this._geometry.isPoint?1:e[this._pathIndex]}get totalSize(){return this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(e){this._geometry.coords[this._pointOffset]=e}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(e){this._geometry.coords[this._pointOffset+1]=this.yFactor*e}get z(){return this._geometry.coords[this._pointOffset+2]}set z(e){this._geometry.coords[this._pointOffset+2]=e}get m(){return this._geometry.coords[this._pointOffset+(this.hasZ?3:2)]}set m(e){this._geometry.coords[this._pointOffset+3]=e}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}}function P(l){const e=[l.x,l.y];return l.z&&e.push(l.z),l.m&&e.push(l.m),e}function _(l){return(0,N.Bi)(l)?[l.rings,"esriGeometryPolygon"]:(0,N.Rg)(l)?[l.paths,"esriGeometryPolyline"]:(0,N.U9)(l)?[[l.points],"esriGeometryMultipoint"]:(0,N.ZC)(l)?[[[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]]],"esriGeometryEnvelope"]:(0,N.fT)(l)?[[[P(l)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}class u extends j{initialize(e,o,g,S,w){return this._paths=e,this.geometryType=o,this.hasZ=g,this.hasM=S,this._pathIndex=this._pointIndex=-1,this.yFactor=w,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(e){return this._pathIndex=e,this._pointIndex=-1,e>=0&&e<this.totalSize&&(this._currentPath=this._paths[e],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(e){return e>=0&&e<this._currentPath.length&&(this._pointIndex=e,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const e=this._currentPath.length,o=this._currentPath;let g=0;for(let S=1;S<e;S++){const w=o[S-1],W=o[S],V=W[0]-w[0],et=W[1]-w[1];g+=Math.sqrt(V*V+et*et)}return g}startPath(){this._paths.push([])}pushPath(e){this._paths.push(e)}pushPoint(e){this._paths[this.totalSize-1].push(e)}pushXY(e,o){this._paths[this.totalSize-1].push([e,o])}pushPoints(e){this._paths[this.totalSize-1].push(...e)}pushCursor(e){const o=(0,Q.x)(e);for(const g of o)this.pushPath(g)}asOptimized(){const e=new O.A;if("esriGeometryPoint"===this.geometryType)e.coords.push(...this._paths[0][0]),e.lengths.length=0;else for(const o of this._paths){for(const g of o)e.coords.push(g[0]),e.coords.push(g[1]*this.yFactor),this.hasZ&&e.coords.push(g[2]),this.hasM&&e.coords.push(g[this._mIndex]);e.lengths.push(o.length)}return e}isClosed(){const e=this._currentPath[0],o=this._currentPath[this._currentPath.length-1];for(let g=0;g<e.length;g++)if(e[g]!==o[g])return!1;return!0}clone(){return(new u).initialize((0,st.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map(e=>e.length).reduce((e,o)=>e+o)}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(e){this._currentPoint[0]=e}get y(){return this.yFactor*this._currentPoint[1]}set y(e){this._currentPoint[1]=this.yFactor*e}get z(){return this._currentPoint[2]}set z(e){this._currentPoint[2]=e}get m(){return this._currentPoint[this._mIndex]}set m(e){this._currentPoint[this._mIndex]=e}get pathIndex(){return this._pathIndex}}class r extends x{initialize(e,o,g,S,w){return super.initialize(e,o,g,S,w),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map(W=>new Set)),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const e=(new r).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return e._controlPoints=this._controlPoints,e}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(e){this._controlPoints[this.pathIndex].add(e)}getControlPointAt(e){return this._controlPoints[this.pathIndex].has(e)}}class n extends u{initialize(e,o,g,S,w){return super.initialize(e,o,g,S,w)}clone(){return(new n).initialize((0,st.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][4]=1}getControlPoint(){return 1===this._paths[this.pathIndex][this._pointIndex][4]}setControlPointAt(e){this._paths[this.pathIndex][e][4]=1}getControlPointAt(e){return 1===this._paths[this.pathIndex][e][4]}}},13259:(pt,ht,v)=>{v.d(ht,{d:()=>P});var st=v(51995),Q=v(83065),N=v(39239),O=v(15268),j=v(62928);const x=222045e-19;function P(E){if(0===E.totalSize)return null;const L=(0,Q.z8)(E);if(!L)return null;const I=4*(Math.abs(L[0])+Math.abs(L[2])+Math.abs(L[1])+Math.abs(L[3])+1)*x;let D=0,T=0;E.reset();for(let M=0;E.nextPath();M++){const A=E.getCurrentRingArea();A>T&&(T=A,D=M)}if(E.seekPath(D),0===E.pathSize)return null;E.seekPathStart();const U=(0,Q.B$)(E);if(Math.abs(T)<=2*I*I)return[(U[0]+U[2])/2,(U[1]+U[3])/2];E.seekPathStart();const B=(0,N.w2)(E,(0,st.vt)());if(null===B)return null;if(E.totalPoints<4)return B;const G=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],$=[NaN,NaN,NaN,NaN],tt=[NaN,NaN,NaN,NaN];let lt=!1,q=u(B,E,!0);0===q.distance&&(lt=!0,G[0][0]=B[0],G[0][1]=B[1],q=u(B,E,!1)),$[0]=q.distance,tt[0]=0;const rt=[NaN,NaN];let ct=!1,_t=.25,mt=-1,at=NaN;do{if(at=NaN,G[1]=c(E,S(U[0],U[2],_t),0,L),isNaN(G[1][0])||isNaN(G[1][1])||(q=u(G[1],E,!1),at=q.distance),!isNaN(at)&&at>I&&_(G[1],E))ct=!0,$[1]=at,tt[1]=w(G[1],B);else if(!isNaN(at)&&at>mt&&(mt=at,rt[0]=G[1][0],rt[1]=G[1][1]),_t-=.01,_t<.1){if(!(mt>=0))break;ct=!0,$[1]=mt,G[1][0]=rt[0],G[1][1]=rt[1],tt[1]=w(G[1],B)}}while(!ct);ct=!1,_t=.5,mt=-1;let Z=.01,h=1;do{if(at=NaN,G[2]=c(E,S(U[0],U[2],_t),0,L),isNaN(G[2][0])||isNaN(G[2][1])||(q=u(G[2],E,!1),at=q.distance),!isNaN(at)&&at>I&&_(G[2],E))ct=!0,$[2]=at,tt[2]=w(G[2],B);else if(!isNaN(at)&&at>mt)mt=at,rt[0]=G[2][0],rt[1]=G[2][1];else if(at>mt&&(mt=at,rt[0]=G[2][0],rt[1]=G[2][1]),_t=.5+Z*h,Z+=.01,h*=-1,_t<.3||_t>.7){if(!(mt>=0))break;ct=!0,$[2]=mt,G[2][0]=rt[0],G[2][1]=rt[1],tt[2]=w(G[2],B)}}while(!ct);ct=!1,_t=.75,mt=-1;do{if(at=NaN,G[3]=c(E,S(U[0],U[2],_t),0,L),isNaN(G[3][0])||isNaN(G[3][1])||(q=u(G[3],E,!1),at=q.distance),!isNaN(at)&&at>I&&_(G[3],E))ct=!0,$[3]=at,tt[3]=w(G[3],B);else if(at>mt&&(mt=at,rt[0]=G[3][0],rt[1]=G[3][1]),_t+=.01,_t>.9){if(!(mt>=0))break;ct=!0,$[3]=mt,G[3][0]=rt[0],G[3][1]=rt[1],tt[3]=w(G[3],B)}}while(!ct);const p=[0,1,2,3],b=lt?0:1;let C;for(let M=b;M<4;M++)for(let A=b;A<3;A++){const k=tt[A],z=tt[A+1];W(k,z)>0&&(C=p[A],p[A]=p[A+1],p[A+1]=C,tt[A]=z,tt[A+1]=k)}let y=b,m=0,f=0;for(let M=b;M<4;M++){switch(M){case 0:f=2*$[p[M]];break;case 1:f=1.66666666*$[p[M]];break;case 2:f=1.33333333*$[p[M]];break;case 3:f=$[p[M]]}f>m&&(m=f,y=p[M])}return G[y]}function _(E,L){let I,D,T,U,B=0;for(L.reset();L.nextPath()&&L.nextPoint();)for(I=L.x,D=L.y;L.nextPoint();I=T,D=U)T=L.x,U=L.y,D>E[1]!=U>E[1]&&((T-I)*(E[1]-D)-(U-D)*(E[0]-I)>0?B++:B--);return 0!==B}function u(E,L,I){if(I&&_(E,L))return{coord:E,distance:0};let D=1/0,T=0,U=0,B=[0,0],G=[0,0];const $=[0,0];for(L.reset();L.nextPath()&&L.nextPoint();)if(!(L.pathSize<2))for(B[0]=L.x,B[1]=L.y;L.nextPoint();B=G){G=[L.x,L.y],(0,O.gR)($,E,B,G);const tt=w(E,$);tt<D&&(D=tt,T=$[0],U=$[1])}return{coord:[T,U],distance:Math.sqrt(D)}}function c(E,L,I,D){const T=[L,0];let U=1/0,B=1/0,G=!1,$=!1;const tt=[[L,D[1]-1],[L,D[3]+1]],lt=[0,0],q=[0,0],rt=[0,0],ct=[[0,0],[0,0]],_t=(0,st.vt)();for(E.reset();E.nextPath()&&E.nextPoint();)if(!(E.pathSize<2))for(ct[0][0]=E.x,ct[0][1]=E.y;E.nextPoint();ct[0][0]=ct[1][0],ct[0][1]=ct[1][1]){if(ct[1][0]=E.x,ct[1][1]=E.y,null===d(_t,ct)||(q[0]=tt[0][0],q[1]=tt[0][1],rt[0]=tt[1][0],rt[1]=tt[1][1],0===o(_t,q,rt))||!(0,j.Ql)(tt[0],tt[1],ct[0],ct[1],lt))continue;const mt=lt[1];U>B?mt<U&&(U=mt,G=!0):mt<B&&(B=mt,$=!0)}return G&&$?T[1]=(U+B)/2:T[0]=T[1]=NaN,T}function d(E,L){if(L.length<2)return null;E||(E=(0,st.vt)());const[I,D]=L[0],[T,U]=L[1];return E[0]=Math.min(I,T),E[1]=Math.min(D,U),E[2]=Math.max(I,T),E[3]=Math.max(D,U),E}const r=1,n=4,l=3,e=12;function o(E,L,I){let D=g(L,E),T=g(I,E);const U=E[0],B=E[1],G=E[2],$=E[3];if(D&T)return 0;if(!(D|T))return 4;const tt=(D?1:0)|(T?2:0);do{const lt=I[0]-L[0],q=I[1]-L[1];if(lt>q)D&l?(D&r?(L[1]+=q*(U-L[0])/lt,L[0]=U):(L[1]+=q*(G-L[0])/lt,L[0]=G),D=g(L,E)):T&l?(T&r?(I[1]+=q*(U-I[0])/lt,I[0]=U):(I[1]+=q*(G-I[0])/lt,I[0]=G),T=g(I,E)):D?(D&n?(L[0]+=lt*(B-L[1])/q,L[1]=B):(L[0]+=lt*($-L[1])/q,L[1]=$),D=g(L,E)):(T&n?(I[0]+=lt*(B-I[1])/q,I[1]=B):(I[0]+=lt*($-I[1])/q,I[1]=$),T=g(I,E));else if(D&e?(D&n?(L[0]+=lt*(B-L[1])/q,L[1]=B):(L[0]+=lt*($-L[1])/q,L[1]=$),D=g(L,E)):T&e?(T&n?(I[0]+=lt*(B-I[1])/q,I[1]=B):(I[0]+=lt*($-I[1])/q,I[1]=$),T=g(I,E)):D?(D&r?(L[1]+=q*(U-L[0])/lt,L[0]=U):(L[1]+=q*(G-L[0])/lt,L[0]=G),D=g(L,E)):(T&r?(I[1]+=q*(U-I[0])/lt,I[0]=U):(I[1]+=q*(G-I[0])/lt,I[0]=G),T=g(I,E)),D&T)return 0}while(D|T);return tt}function g(E,L){return(E[0]<L[0]?1:0)|(E[0]>L[2]?1:0)<<1|(E[1]<L[1]?1:0)<<2|(E[1]>L[3]?1:0)<<3}function S(E,L,I){return E+(L-E)*I}function w(E,L){return(E[0]-L[0])*(E[0]-L[0])+(E[1]-L[1])*(E[1]-L[1])}function W(E,L){if(E<L)return-1;if(E>L)return 1;if(E===L)return 0;const I=isNaN(E),D=isNaN(L);return I<D?-1:I>D?1:0}},61245:(pt,ht,v)=>{v.d(ht,{Aq:()=>N,pC:()=>O,rx:()=>j});var st=v(76571);function N(x,P){x[4]=P}class O{constructor(P,_=!0,u=!0,c=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!_&&"esriGeometryPolygon"===P.geometryType||!u&&"esriGeometryPolyline"===P.geometryType?null:P,this.geomUnitsPerPoint=c,this.iteratePath=!1,this.internalPlacement=new st.W}next(){if(!this.geometryCursor)return null;for(;this.iteratePath||this.geometryCursor.pathIndex<this.geometryCursor.totalSize-1;){this.iteratePath||this.geometryCursor.nextPath();const P=this.processPath(this.geometryCursor);if(P)return P}return this.geometryCursor=null,null}}class j{constructor(P,_,u,c=0){this.isClosed=!1,this.inputGeometries=P,this.acceptPolygon=_,this.acceptPolyline=u,this.geomUnitsPerPoint=c,this.iteratePath=!1,this.multiPathCursor=null}next(){for(;;){if(!this.multiPathCursor){let P=this.inputGeometries.next();for(;P&&(this.isClosed=this.acceptPolygon&&"esriGeometryPolygon"===P.geometryType||"esriGeometryEnvelope"===P.geometryType,this.multiPathCursor=P,!this.multiPathCursor);)P=this.inputGeometries.next();if(!this.multiPathCursor)return null}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const P=this.processPath(this.multiPathCursor);if(P)return P}this.multiPathCursor=null}}}},47961:(pt,ht,v)=>{v.d(ht,{k:()=>j,q:()=>x});var st=v(72137),Q=v(91766);const N=512;let O;class j{constructor(_){this._geometry=_}next(){const _=this._geometry;return this._geometry=null,_}}function x(P,_){O||(O=new Q.O3(0,0,0,1));const u="esriGeometryPolygon"===P.geometryType,d=u?3:2;let r,n;for(O.reset(u?Q.dC.Polygon:Q.dC.LineString),O.setPixelMargin(_+1),O.setExtent(N);P.nextPath();)if(!(P.pathSize<d)){for(P.nextPoint(),r=P.x,n=-P.y,O.moveTo(r,n);P.nextPoint();)r=P.x,n=-P.y,O.lineTo(r,n);u&&O.close()}const l=O.result(!1);if(l){const e=st.z.createEmptyOptimizedCIM(P.geometryType);for(const o of l){e.startPath();for(const g of o)e.pushXY(g.x,-g.y)}return e.reset(),e}return null}},91486:(pt,ht,v)=>{v.d(ht,{A:()=>L,c:()=>I});let st=(()=>{class D{static local(){return null===D.instance&&(D.instance=new D),D.instance}execute(U,B,G,$,tt){return new Q(U,B,G)}}return D.instance=null,D})();class Q{constructor(T,U,B){this._inputGeometries=T,this._angleTolerance=void 0!==U.angleTolerance?U.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let T=this._inputGeometries.next();for(;T;){if("esriGeometryPolygon"===T.geometryType)this._isClosed=!0;else if("esriGeometryPolyline"===T.geometryType)this._isClosed=!1;else{if("esriGeometryEnvelope"!==T.geometryType){T=this._inputGeometries.next();continue}if(this._maxCosAngle)return T;this._isClosed=!0}for(;T.nextPath();)this._processPath(T);return T.reset(),T}return null}_processPath(T){if(T.nextPoint()){const U=T.x,B=T.y;let G=U,$=B,tt=T.pathSize,lt=0,q=0,rt=0,ct=0,_t=0,mt=0;this._isClosed&&++tt;for(let at=1;T.nextPoint()||at<tt;++at){let Z,h;this._isClosed&&at===tt-1?(Z=U,h=B):(Z=T.x,h=T.y);const p=Z-G,b=h-$,C=Math.sqrt(p*p+b*b);at>1&&C>0&&rt>0&&(lt*p+q*b)/C/rt<=this._maxCosAngle&&T.setControlPointAt(at-1),1===at&&(ct=p,_t=b,mt=C),C>0&&(G=Z,$=h,lt=p,q=b,rt=C)}this._isClosed&&rt>0&&mt>0&&(lt*ct+q*_t)/mt/rt<=this._maxCosAngle&&T.setControlPointAt(0)}}}var N=v(47763),O=v(69630),j=v(71045),x=v(82854),P=v(65264),_=v(70614),u=v(88918);let c=(()=>{class D{static local(){return null===D.instance&&(D.instance=new D),D.instance}execute(U,B,G,$,tt){return new d(U,B,G)}}return D.instance=null,D})();class d{constructor(T,U,B){this._inputGeometries=T,this._offsetX=void 0!==U.offsetX?U.offsetX*B:0,this._offsetY=void 0!==U.offsetY?U.offsetY*B:0}next(){let T=this._inputGeometries.next();for(;T;){if(T.totalSize>0)return this._move(T.clone(),this._offsetX,this._offsetY);T=this._inputGeometries.next()}return null}_move(T,U,B){for(;T.nextPath();)for(;T.nextPoint();)T.x=T.x+U,T.y=T.y+B;return T.reset(),T}}var r=v(3691);let n=(()=>{class D{static local(){return null===D.instance&&(D.instance=new D),D.instance}execute(U,B,G,$,tt){return new l(U,B,G)}}return D.instance=null,D})();class l{constructor(T,U,B){this._inputGeometries=T,this._reverse=void 0===U.reverse||U.reverse}next(){let T=this._inputGeometries.next();for(;T;){if(!this._reverse)return T;if("esriGeometryPolyline"===T.geometryType)return e(T.clone());T=this._inputGeometries.next()}return null}}function e(D){for(;D.nextPath();)for(let T=0;T<D.pathSize/2;T++){D.seekInPath(T);const U=D.x,B=D.y;D.seekInPath(D.pathSize-T-1);const G=D.x,$=D.y;D.x=U,D.y=B,D.seekInPath(T),D.x=G,D.y=$}return D.reset(),D}var o=v(25867),g=v(39516),S=v(57249),w=v(2544),W=v(34572),K=v(56854),H=v(47942),V=v(53737),et=v(3688),E=v(68051);function L(D){if(!D)return null;switch(D.type){case"CIMGeometricEffectAddControlPoints":return st.local();case"CIMGeometricEffectArrow":return N.B.local();case"CIMGeometricEffectBuffer":return O.s.local();case"CIMGeometricEffectControlMeasureLine":return j.v.local();case"CIMGeometricEffectCut":return x.y.local();case"CIMGeometricEffectDashes":return P.I.local();case"CIMGeometricEffectDonut":return _.O.local();case"CIMGeometricEffectJog":return u.U.local();case"CIMGeometricEffectMove":return c.local();case"CIMGeometricEffectOffset":return r.V.local();case"CIMGeometricEffectReverse":return n.local();case"CIMGeometricEffectRotate":return o.v.local();case"CIMGeometricEffectScale":return g.W.local();case"CIMGeometricEffectWave":return S.l.local()}return null}function I(D){if(!D)return null;switch(D.type){case"CIMMarkerPlacementAlongLineSameSize":return w.e.local();case"CIMMarkerPlacementAtExtremities":return W.y.local();case"CIMMarkerPlacementAtRatioPositions":return K.S.local();case"CIMMarkerPlacementInsidePolygon":return H.M.local();case"CIMMarkerPlacementOnLine":return V.R.local();case"CIMMarkerPlacementOnVertices":return et.A.local();case"CIMMarkerPlacementPolygonCenter":return E.L.local()}return null}},76571:(pt,ht,v)=>{v.d(ht,{W:()=>st});class st{constructor(){this.setIdentity()}getAngle(){return(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}setTranslate(O,j){this.tx=O,this.ty=j}setTranslateZ(O){this.tz=O}setRotateCS(O,j){this.rz=void 0,this.rzCos=O,this.rzSin=j}setRotate(O){this.rz=O,this.rzCos=void 0,this.rzSin=void 0}setRotateY(O){this.ry=O}setScale(O){this.s=O}setMeasure(O){this.m=O}}},91767:(pt,ht,v)=>{v.d(ht,{Rj:()=>lt,mx:()=>$,CK:()=>tt,IT:()=>B,QF:()=>ct});var st=v(98894),Q=v(3248),N=v(77806),O=v(35150),j=v(61591),x=v(67685),P=v(72137),_=v(51995),u=v(83065),c=v(39239),d=v(61320),r=v(47961);class n{applyColorSubstituition(h,p){if(!p)return h;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:b,height:C}=h,y=this._rasterizationCanvas,m=y.getContext("2d",{willReadFrequently:!0});h!==y&&(y.width=b,y.height=C,m.drawImage(h,0,0,b,C));const f=m.getImageData(0,0,b,C).data;if(p)for(const A of p)if(A&&A.oldColor&&4===A.oldColor.length&&A.newColor&&4===A.newColor.length){const[k,z,F,R]=A.oldColor,[J,X,Y,ot]=A.newColor;if(k===J&&z===X&&F===Y&&R===ot)continue;for(let it=0;it<f.length;it+=4)k===f[it]&&z===f[it+1]&&F===f[it+2]&&R===f[it+3]&&(f[it]=J,f[it+1]=X,f[it+2]=Y,f[it+3]=ot)}const M=new ImageData(f,b,C);return m.putImageData(M,0,0),y}tintImageData(h,p){if(!p||p.length<4)return h;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:b,height:C}=h,y=this._rasterizationCanvas,m=y.getContext("2d",{willReadFrequently:!0});h!==y&&(y.width=b,y.height=C,m.drawImage(h,0,0,b,C));const f=m.getImageData(0,0,b,C),M=new Uint8Array(f.data),A=[p[0]/255,p[1]/255,p[2]/255,p[3]/255];for(let z=0;z<M.length;z+=4)M[z]*=A[0],M[z+1]*=A[1],M[z+2]*=A[2],M[z+3]*=A[3];const k=new ImageData(new Uint8ClampedArray(M.buffer),b,C);return m.putImageData(k,0,0),y}}var l=v(91486),e=v(76571),o=v(46988),g=v(65374);function S(Z){const h=Z.getFrame(0);if(h instanceof HTMLImageElement||h instanceof HTMLCanvasElement)return h;const p=document.createElement("canvas");p.width=Z.width,p.height=Z.height;const b=p.getContext("2d");return h instanceof ImageData?b.putImageData(h,0,0):b.drawImage(h,0,0),p}var w=v(9792),W=v(68448);function H(Z){return`rgba(${Z.slice(0,3).toString()},${Z[3]})`}class V{constructor(h){h&&(this._textRasterizationCanvas=h)}rasterizeText(h,p){var b;this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const C=this._textRasterizationCanvas,y=C.getContext("2d",{willReadFrequently:!0});this._setFontProperties(y,p),this._parameters=p,this._textLines=h.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const{decoration:m,weight:f}=p.font;this._lineThroughWidthOffset=m&&"line-through"===m?.1*this._lineHeight:0;const M=null!=p.backgroundColor||null!=p.borderLine,A=M?W.y7:0,k=this._computeTextWidth(y,p)+2*A,z=this._lineHeight*this._textLines.length+2*A;if(C.width=k+2*this._lineThroughWidthOffset,C.height=z,0===C.width||0===C.height)return C.width=C.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:C};this._renderedLineHeight=Math.round(this._lineHeight*p.pixelRatio),this._renderedHaloSize=(0,x.Lz)(p.halo.size)*p.pixelRatio,this._renderedWidth=k*p.pixelRatio,this._renderedHeight=z*p.pixelRatio,this._lineThroughWidthOffset*=p.pixelRatio;const F=null!==(b=p.color)&&void 0!==b?b:[0,0,0,0],R=p.halo&&p.halo.color?p.halo.color:[0,0,0,0];this._fillStyle=H(F),this._haloStyle=function K(Z){return`rgb(${Z.slice(0,3).toString()})`}(R);const J=this._renderedLineHeight,X=this._renderedHaloSize;y.save(),y.clearRect(0,0,C.width,C.height),this._setFontProperties(y,p);const Y=A*p.pixelRatio,ot=function et(Z,h){return"center"===Z?.5*h:"right"===Z?h:0}(y.textAlign,this._renderedWidth-2*Y)+X+Y,it=X+Y,ft=X>0;let nt=this._lineThroughWidthOffset,ut=0;if(M){var gt,dt,Pt,yt,Mt;y.save();const Ct=null!==(gt=p.backgroundColor)&&void 0!==gt?gt:[0,0,0,0],xt=null!==(dt=null===(Pt=p.borderLine)||void 0===Pt?void 0:Pt.color)&&void 0!==dt?dt:[0,0,0,0],Lt=2*(0,x.Lz)(null!==(yt=null===(Mt=p.borderLine)||void 0===Mt?void 0:Mt.size)&&void 0!==yt?yt:0);y.fillStyle=H(Ct),y.strokeStyle=H(xt),y.lineWidth=Lt,y.fillRect(0,0,C.width,C.height),y.strokeRect(0,0,C.width,C.height),y.restore()}ft&&this._renderHalo(y,ot,it,nt,ut,p),ut+=it,nt+=ot;for(const Ct of this._textLines)ft?(y.globalCompositeOperation="destination-out",y.fillStyle="rgb(0, 0, 0)",y.fillText(Ct,nt,ut),y.globalCompositeOperation="source-over",y.fillStyle=this._fillStyle,y.fillText(Ct,nt,ut)):(y.fillStyle=this._fillStyle,y.fillText(Ct,nt,ut)),m&&"none"!==m&&this._renderDecoration(y,nt,ut,m,f),ut+=J;y.restore();const vt=this._renderedWidth+2*this._lineThroughWidthOffset,bt=this._renderedHeight,wt=y.getImageData(0,0,vt,bt),St=new Uint8Array(wt.data);if(p.premultiplyColors){let Ct;for(let xt=0;xt<St.length;xt+=4)Ct=St[xt+3]/255,St[xt]=St[xt]*Ct,St[xt+1]=St[xt+1]*Ct,St[xt+2]=St[xt+2]*Ct}let It,Et;switch(p.horizontalAlignment){case"left":It=-.5;break;case"right":It=.5;break;default:It=0}switch(p.verticalAlignment){case"bottom":Et=-.5;break;case"top":Et=.5;break;case"baseline":Et=-1/6;break;default:Et=0}return{size:[vt,bt],image:new Uint32Array(St.buffer),sdf:!1,simplePattern:!1,anchorX:It,anchorY:Et,canvas:C}}_renderHalo(h,p,b,C,y,m){const f=this._renderedWidth,M=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=f,this._haloRasterizationCanvas.height=M;const A=this._haloRasterizationCanvas,k=A.getContext("2d");k.clearRect(0,0,f,M),this._setFontProperties(k,m);const{decoration:z,weight:F}=m.font;k.fillStyle=this._haloStyle,k.strokeStyle=this._haloStyle,k.lineJoin="round",this._renderHaloNative(k,p,b,z,F),h.globalAlpha=this._parameters.halo.color[3],h.drawImage(A,0,0,f,M,C,y,f,M),h.globalAlpha=1}_renderHaloNative(h,p,b,C,y){const m=this._renderedLineHeight,f=this._renderedHaloSize;for(const M of this._textLines){const A=2*f,k=5,z=.1;for(let F=0;F<k;F++){const R=(1-(k-1)*z+F*z)*A;h.lineWidth=R,h.strokeText(M,p,b),C&&"none"!==C&&this._renderDecoration(h,p,b,C,y,R)}b+=m}}_setFontProperties(h,p){const b=Math.max(p.size,.5),C=p.font,y=`${C.style} ${C.weight} ${(0,x.Lz)(b*p.pixelRatio).toFixed(1)}px ${C.family}, sans-serif`;let m;switch(h.font=y,h.textBaseline="top",p.horizontalAlignment){case"left":default:m="left";break;case"right":m="right";break;case"center":m="center"}h.textAlign=m}computeTextSize(h,p){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const b=this._textRasterizationCanvas,C=b.getContext("2d");this._setFontProperties(C,p),this._parameters=p,this._textLines=h.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const y=this._computeTextWidth(C,p),m=this._lineHeight*this._textLines.length;return b.width=y,b.height=m,[y*p.pixelRatio,m*p.pixelRatio]}_computeTextWidth(h,p){let b=0;for(const y of this._textLines)b=Math.max(b,h.measureText(y).width);const C=p.font;return("italic"===C.style||"oblique"===C.style||"string"==typeof C.weight&&("bold"===C.weight||"bolder"===C.weight)||"number"==typeof C.weight&&C.weight>600)&&(b+=.3*h.measureText("w").width),b+=2*(0,x.Lz)(this._parameters.halo.size),Math.round(b)}_computeLineHeight(){let h=1.275*this._parameters.size;const p=this._parameters.font.decoration;return p&&"underline"===p&&(h*=1.3),Math.round(h+2*(0,x.Lz)(this._parameters.halo.size))}_renderDecoration(h,p,b,C,y,m){const f=.9*this._lineHeight,M="bold"===y?.06:"bolder"===y?.09:.04;switch(h.textAlign){case"center":p-=this._renderedWidth/2;break;case"right":p-=this._renderedWidth}const A=h.textBaseline;if("underline"===C)switch(A){case"top":b+=f;break;case"middle":b+=f/2}else if("line-through"===C)switch(A){case"top":b+=f/1.5;break;case"middle":b+=f/3}const k=m?1.5*m:Math.ceil(f*M);h.save(),h.beginPath(),h.strokeStyle=h.fillStyle,h.lineWidth=k,h.moveTo(p-this._lineThroughWidthOffset,b),h.lineTo(p+this._renderedWidth+2*this._lineThroughWidthOffset,b),h.stroke(),h.restore()}}var E=v(32117),L=v(47669),I=v(42058);const D=Math.PI/180;class B{constructor(h){this._t=h}static createIdentity(){return new B([1,0,0,0,1,0])}clone(){return new B(this._t.slice())}transform(h){const p=this._t;return[p[0]*h[0]+p[1]*h[1]+p[2],p[3]*h[0]+p[4]*h[1]+p[5]]}static createScale(h,p){return new B([h,0,0,0,p,0])}scale(h,p){const b=this._t;return b[0]*=h,b[1]*=h,b[2]*=h,b[3]*=p,b[4]*=p,b[5]*=p,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(h,p){return new B([0,0,h,0,0,p])}translate(h,p){const b=this._t;return b[2]+=h,b[5]+=p,this}static createRotate(h){const p=Math.cos(h),b=Math.sin(h);return new B([p,-b,0,b,p,0])}rotate(h){return B.multiply(this,B.createRotate(h),this)}angle(){const h=this._t[0],p=this._t[3],b=Math.sqrt(h*h+p*p);return[h/b,p/b]}static multiply(h,p,b){const C=h._t,y=p._t,f=C[1]*y[0]+C[4]*y[1],M=C[2]*y[0]+C[5]*y[1]+y[2],A=C[0]*y[3]+C[3]*y[4],k=C[1]*y[3]+C[4]*y[4],z=C[2]*y[3]+C[5]*y[4]+y[5],F=b._t;return F[0]=C[0]*y[0]+C[3]*y[1],F[1]=f,F[2]=M,F[3]=A,F[4]=k,F[5]=z,b}invert(){const h=this._t;let p=h[0]*h[4]-h[1]*h[3];return 0===p?new B([0,0,0,0,0,0]):(p=1/p,new B([h[4]*p,-h[1]*p,(h[1]*h[5]-h[2]*h[4])*p,-h[3]*p,h[0]*p,(h[2]*h[3]-h[0]*h[5])*p]))}}class G{constructor(h,p){this._resourceManager=h,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new j.A(e.W,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(p||B.createIdentity()),this._sizeTransfos.push(p?p.scaleRatio():1)}setTransform(h,p){this._transfos=[h||B.createIdentity()],this._sizeTransfos=[p||(h?h.scaleRatio():1)]}setGeomUnitsPerPoint(h){this._geomUnitsPerPoint=h}transformPt(h){return this._transfos[this._transfos.length-1].transform(h)}transformSize(h){return h*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(h){return this._transfos[this._transfos.length-1].invert().transform(h)}reverseTransformSize(h){return h/this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformScalar(h){return h/this._transfos[this._transfos.length-1].scaleRatio()}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}prevGeomUnitsPerPoint(){return this._transfos.length>2?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(h,p){const b=p?h.scaleRatio():1;B.multiply(h,this.back(),h),this._transfos.push(h),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*b)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(h,p,b){if(h)switch(h.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(h,p);break;case"CIMTextSymbol":this.drawTextSymbol(h,p,b)}}drawMultiLayerSymbol(h,p){if(!h||!p)return;const b=h.symbolLayers;if(!b)return;const C=h.effects;if(C&&C.length>0){const y=this.executeEffects(C,p);if(y){let m=y.next();for(;m;)this.drawSymbolLayers(b,m.asJSON()),m=y.next()}}else this.drawSymbolLayers(b,p)}executeEffects(h,p){const b=this._resourceManager.geometryEngine;let C=new r.k(P.z.fromJSONCIM(p));for(const y of h){const m=(0,l.A)(y);m&&(C=m.execute(C,y,this.geomUnitsPerPoint(),null,b))}return C}drawSymbolLayers(h,p){let b=h.length;for(;b--;){const C=h[b];if(!C||!1===C.enable)continue;const y=C.effects;if(y&&y.length>0){const m=this.executeEffects(y,p);if(m){let f=null;for(;(f=m.next())&&(this.drawSymbolLayer(C,f.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(C,p);if(this._earlyReturn)return}}drawSymbolLayer(h,p){switch(h.type){case"CIMSolidFill":this.drawSolidFill(p,h.color);break;case"CIMHatchFill":this.drawHatchFill(p,h);break;case"CIMPictureFill":this.drawPictureFill(p,h);break;case"CIMGradientFill":this.drawGradientFill(p,h);break;case"CIMSolidStroke":this.drawSolidStroke(p,h.color,h.width,h.capStyle,h.joinStyle,h.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(p,h);break;case"CIMGradientStroke":this.drawGradientStroke(p,h);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(h,p)}}drawHatchFill(h,p){const b=this._buildHatchPolyline(p,h,this.geomUnitsPerPoint());b&&(this.pushClipPath(h),this.drawMultiLayerSymbol(p.lineSymbol,b),this.popClipPath())}drawPictureFill(h,p){}drawGradientFill(h,p){}drawPictureStroke(h,p){}drawGradientStroke(h,p){}drawMarkerLayer(h,p){const b=h.markerPlacement;if(b){const C=(0,l.c)(b);if(C){const y="CIMMarkerPlacementInsidePolygon"===b.type||"CIMMarkerPlacementPolygonCenter"===b.type&&b.clipAtBoundary;y&&this.pushClipPath(p);const m=C.execute(P.z.fromJSONCIM(p),b,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(m){let f=null;for(;(f=m.next())&&(this.drawMarker(h,f),!this._earlyReturn););}y&&this.popClipPath()}}else{const C=this._placementPool.acquire();if((0,d.fT)(p))C.tx=p.x,C.ty=p.y,this.drawMarker(h,C);else if((0,d.Bi)(p)){const y=(0,c.l8)(p);y&&([C.tx,C.ty]=y,this.drawMarker(h,C))}else for(const y of p.points)if(C.tx=y[0],C.ty=y[1],this.drawMarker(h,C),this._earlyReturn)break;this._placementPool.release(C)}}drawMarker(h,p){switch(h.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(h,p);break;case"CIMVectorMarker":this.drawVectorMarker(h,p)}}drawPictureMarker(h,p){if(!h)return;const b=this._resourceManager.getResource(h.url),C=(0,E._W)(h.size,o.D.CIMPictureMarker.size);if(null==b||C<=0)return;const y=b.width,m=b.height;if(!y||!m)return;const f=y/m,M=(0,E._W)(h.scaleX,1),A=B.createIdentity(),k=h.anchorPoint;if(k){let Y=k.x,ot=k.y;"Absolute"!==h.anchorPointUnits&&(Y*=C*f*M,ot*=C),A.translate(-Y,-ot)}let z=(0,E._W)(h.rotation);h.rotateClockwise&&(z=-z),this._mapRotation&&(z+=this._mapRotation),z&&A.rotate(z*D);let F=(0,E._W)(h.offsetX),R=(0,E._W)(h.offsetY);if(F||R){if(this._mapRotation){const Y=D*this._mapRotation,ot=Math.cos(Y),it=Math.sin(Y),ft=F*it+R*ot;F=F*ot-R*it,R=ft}A.translate(F,R)}const J=this.geomUnitsPerPoint();1!==J&&A.scale(J,J);const X=p.getAngle();X&&A.rotate(X),A.translate(p.tx,p.ty),this.push(A,!1),this.drawImage(h,C),this.pop()}drawVectorMarker(h,p){if(!h)return;const b=h.markerGraphics;if(!b)return;const C=(0,E._W)(h.size,o.D.CIMVectorMarker.size),y=h.frame,m=y?y.ymax-y.ymin:0,f=C&&m?C/m:1,M=B.createIdentity();y&&M.translate(.5*-(y.xmax+y.xmin),.5*-(y.ymax+y.ymin));const A=h.anchorPoint;if(A){let X=A.x,Y=A.y;"Absolute"!==h.anchorPointUnits?y&&(X*=y.xmax-y.xmin,Y*=y.ymax-y.ymin):(X/=f,Y/=f),M.translate(-X,-Y)}1!==f&&M.scale(f,f);let k=(0,E._W)(h.rotation);h.rotateClockwise&&(k=-k),this._mapRotation&&(k+=this._mapRotation),k&&M.rotate(k*D);let z=(0,E._W)(h.offsetX),F=(0,E._W)(h.offsetY);if(z||F){if(this._mapRotation){const X=D*this._mapRotation,Y=Math.cos(X),ot=Math.sin(X),it=z*ot+F*Y;z=z*Y-F*ot,F=it}M.translate(z,F)}const R=this.geomUnitsPerPoint();1!==R&&M.scale(R,R);const J=p.getAngle();J&&M.rotate(J),M.translate(p.tx,p.ty),this.push(M,h.scaleSymbolsProportionally);for(const X of b){null!=X&&X.symbol&&X.geometry||O.A.getLogger("esri.symbols.cim.CIMSymbolDrawHelper").error("Invalid marker graphic",X);let Y=X.textString;if("number"==typeof Y&&(Y=Y.toString()),this.drawSymbol(X.symbol,X.geometry,Y),this._earlyReturn)break}this.pop()}drawTextSymbol(h,p,b){if(!h||!(0,d.fT)(p)||(0,E._W)(h.height,o.D.CIMTextSymbol.height)<=0)return;const C=B.createIdentity();let y=(0,E._W)(h.angle);y=-y,y&&C.rotate(y*D);const m=(0,E._W)(h.offsetX),f=(0,E._W)(h.offsetY);(m||f)&&C.translate(m,f);const M=this.geomUnitsPerPoint();1!==M&&C.scale(M,M),C.translate(p.x,p.y),this.push(C,!1),this.drawText(h,b),this.pop()}_buildHatchPolyline(h,p,b){let C=(0,E._W)(h.separation,o.D.CIMHatchFill.separation)*b,y=(0,E._W)(h.rotation);if(0===C)return null;C<0&&(C=-C);let m=0;const f=.5*C;for(;m>f;)m-=C;for(;m<-f;)m+=C;const M=(0,_.vt)();(0,u.Rg)(M,p),M[0]-=f,M[1]-=f,M[2]+=f,M[3]+=f;const A=[[M[0],M[1]],[M[0],M[3]],[M[2],M[3]],[M[2],M[1]]];for(;y>180;)y-=180;for(;y<0;)y+=180;const k=Math.cos(y*D),z=Math.sin(y*D),F=-C*z,R=C*k;let J,X,Y,ot;m=(0,E._W)(h.offsetX)*b*z-(0,E._W)(h.offsetY)*b*k,J=Y=Number.MAX_VALUE,X=ot=-Number.MAX_VALUE;for(const Pt of A){const yt=Pt[0],Mt=Pt[1],vt=k*yt+z*Mt,bt=-z*yt+k*Mt;J=Math.min(J,vt),Y=Math.min(Y,bt),X=Math.max(X,vt),ot=Math.max(ot,bt)}Y=Math.floor(Y/C)*C;let it=k*J-z*Y-F*m/C,ft=z*J+k*Y-R*m/C,nt=k*X-z*Y-F*m/C,ut=z*X+k*Y-R*m/C;const gt=1+Math.round((ot-Y)/C),dt=[];for(let Pt=0;Pt<gt;Pt++)it+=F,ft+=R,nt+=F,ut+=R,dt.push([[it,ft],[nt,ut]]);return{paths:dt}}}class $ extends G{constructor(h,p){super(h,p),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new w.A(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return(0,_.fA)(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(h){if(h&&!(this._clipCount>0))if((0,d.Bi)(h))this._processPath(h.rings,0);else if((0,d.Rg)(h))this._processPath(h.paths,0);else if((0,d.ZC)(h)){const p=rt(h);p&&this._processPath(p.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}drawSolidStroke(h,p,b){if(!h||this._clipCount>0||null==b||b<=0)return;const C=Math.max(.5*this.transformSize((0,E._W)(b,o.D.CIMSolidStroke.width)),.25);if((0,d.Bi)(h))this._processPath(h.rings,C);else if((0,d.Rg)(h))this._processPath(h.paths,C);else if((0,d.ZC)(h)){const y=rt(h);y&&this._processPath(y.rings,C)}else console.error("drawSolidStroke unexpected geometry type!")}drawMarkerLayer(h,p){(0,d.Bi)(p)&&h.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===h.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===h.markerPlacement.type&&h.markerPlacement.clipAtBoundary)?this._processPath(p.rings,0):super.drawMarkerLayer(h,p)}drawHatchFill(h,p){this.drawSolidFill(h)}drawPictureFill(h,p){this.drawSolidFill(h)}drawGradientFill(h,p){this.drawSolidFill(h)}drawPictureStroke(h,p){this.drawSolidStroke(h,null,p.width)}drawGradientStroke(h,p){this.drawSolidStroke(h,null,p.width)}pushClipPath(h){this.drawSolidFill(h),this._clipCount++}popClipPath(){this._clipCount--}drawImage(h,p){const{url:b}=h,C=(0,E._W)(h.scaleX,1);let y=C*p,m=p;const f=this._resourceManager.getResource(b);if(null!=f){const M=f.height/f.width;y=C*(p?M>1?p:p/M:f.width),m=p?M>1?p*M:p:f.height}this._merge(this.transformPt([-y/2,-m/2]),0),this._merge(this.transformPt([-y/2,m/2]),0),this._merge(this.transformPt([y/2,-m/2]),0),this._merge(this.transformPt([y/2,m/2]),0)}drawText(h,p){if(!p||0===p.length)return;this._textRasterizer||(this._textRasterizer=new V);const b=_t(h);let[C,y]=this._textRasterizer.computeTextSize(p,b);C=(0,x.PN)(C),y=(0,x.PN)(y);let m=0;switch(h.horizontalAlignment){case"Left":m=C/2;break;case"Right":m=-C/2}let f=0;switch(h.verticalAlignment){case"Bottom":f=y/2;break;case"Top":f=-y/2;break;case"Baseline":f=y/6}this._merge(this.transformPt([-C/2+m,-y/2+f]),0),this._merge(this.transformPt([-C/2+m,y/2+f]),0),this._merge(this.transformPt([C/2+m,-y/2+f]),0),this._merge(this.transformPt([C/2+m,y/2+f]),0)}_processPath(h,p){if(h)for(const b of h){const C=b?b.length:0;if(C>1){this._merge(this.transformPt(b[0]),p);for(let y=1;y<C;y++)this._merge(this.transformPt(b[y]),p)}}}_merge(h,p){h[0]-p<this._xmin&&(this._xmin=h[0]-p),h[0]+p>this._xmax&&(this._xmax=h[0]+p),h[1]-p<this._ymin&&(this._ymin=h[1]-p),h[1]+p>this._ymax&&(this._ymax=h[1]+p)}}class tt extends G{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null}hitTest(h,p,b,C,y,m){const f=m*(0,x.Lz)(1);if(this.setTransform(),this.setGeomUnitsPerPoint(f),this._searchPoint=[(h[0]+h[2])/2,(h[1]+h[3])/2],this._searchDistPoint=(h[2]-h[0])/2/f,this._textInfo=C,this._mapRotation=p&&("CIMPointSymbol"===p.type&&"Map"!==p.angleAlignment||"CIMTextSymbol"===p.type)?y:0,!(0,Q.A)("esri-mobile")){var A,k;const z=(0,x.PN)((0,Q.A)("hittest-2d-small-symbol-tolerance")*window.devicePixelRatio),F=(0,x.PN)((0,Q.A)("hittest-2d-small-symbol-tolerance-threshold"));("CIMLineSymbol"!==(null==p?void 0:p.type)&&"CIMPolygonSymbol"!==(null==p?void 0:p.type)||null===(A=p.symbolLayers)||void 0===A||!A.some(E.jn))&&"CIMMeshSymbol"!==(null==p?void 0:p.type)&&(null!==(k=(0,E.YC)(p))&&void 0!==k?k:0)<F&&(this._searchDistPoint=z)}return this._earlyReturn=!1,this.drawSymbol(p,b),this._earlyReturn}drawSolidFill(h,p){this._hitTestFill(h)}drawHatchFill(h,p){this._hitTestFill(h)}drawPictureFill(h,p){this._hitTestFill(h)}drawGradientFill(h,p){this._hitTestFill(h)}drawSolidStroke(h,p,b,C,y,m){this._hitTestStroke(h,b)}drawPictureStroke(h,p){this._hitTestStroke(h,p.width)}drawGradientStroke(h,p){this._hitTestStroke(h,p.width)}drawMarkerLayer(h,p){h.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===h.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===h.markerPlacement.type&&h.markerPlacement.clipAtBoundary)?this._hitTestFill(p):super.drawMarkerLayer(h,p)}pushClipPath(h){}popClipPath(){}drawImage(h,p){const{url:b}=h,C=(0,E._W)(h.scaleX,1),y=this._resourceManager.getResource(b);if(null==y||0===y.height||0===p)return;const m=p*this.geomUnitsPerPoint(),f=m*C*(y.width/y.height),M=this.reverseTransformPt(this._searchPoint),A=this._searchDistPoint;Math.abs(M[0])<f/2+A&&Math.abs(M[1])<m/2+A&&(this._earlyReturn=!0)}drawText(h,p){var b;const C=this._textInfo;if(!C)return;const y=C.get(h);if(!y||!y.glyphMosaicItems.glyphs.length)return;const m=(0,E._W)(h.height,o.D.CIMTextSymbol.height),{lineGapType:f,lineGap:M}=h,A=f?ct(f,(0,E._W)(M),m):0,k="CIMBackgroundCallout"===(null===(b=h.callout)||void 0===b?void 0:b.type),z=(0,I.Tl)(y.glyphMosaicItems,{scale:m/L.eG,angle:0,xOffset:0,yOffset:0,horizontalAlignment:h.horizontalAlignment,verticalAlignment:h.verticalAlignment,maxLineWidth:512,lineHeight:L.DY*Math.max(.25,Math.min(A||1,4)),decoration:h.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:k}),F=this.reverseTransformPt(this._searchPoint),R=F[0],J=F[1];for(const X of z.glyphs)if(R>X.xTopLeft&&R<X.xBottomRight&&J>-X.yBottomRight&&J<-X.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(h){let p=null;if((0,d.ZC)(h))p=[[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]]];else if((0,d.Bi)(h))p=h.rings;else{if(!(0,d.Rg)(h))return;p=h.paths}const b=this.reverseTransformPt(this._searchPoint);if(this._pointInPolygon(b,p)&&(this._earlyReturn=!0),!this._earlyReturn){const C=this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint();this._nearLine(b,p,C)&&(this._earlyReturn=!0)}}_hitTestStroke(h,p){let b=null;if((0,d.ZC)(h))b=[[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]]];else if((0,d.Bi)(h))b=h.rings;else{if(!(0,d.Rg)(h))return;b=h.paths}const C=this.reverseTransformPt(this._searchPoint),y=(0,E._W)(p,o.D.CIMSolidStroke.width)*this.geomUnitsPerPoint(),m=this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint();this._nearLine(C,b,y/2+m)&&(this._earlyReturn=!0)}_pointInPolygon(h,p){let b=0;for(const C of p){const y=C.length;for(let m=1;m<y;m++){const f=C[m-1],M=C[m];f[1]>h[1]!=M[1]>h[1]&&((M[0]-f[0])*(h[1]-f[1])-(M[1]-f[1])*(h[0]-f[0])>0?b++:b--)}}return 0!==b}_nearLine(h,p,b){for(const C of p){const y=C.length;for(let m=1;m<y;m++){const f=C[m-1],M=C[m];let A=(M[0]-f[0])*(M[0]-f[0])+(M[1]-f[1])*(M[1]-f[1]);if(0!==A&&(A=Math.sqrt(A),Math.abs(((M[0]-f[0])*(h[1]-f[1])-(M[1]-f[1])*(h[0]-f[0]))/A)<b)){const z=((M[0]-f[0])*(h[0]-f[0])+(M[1]-f[1])*(h[1]-f[1]))/A;if(z>-b&&z<A+b)return!0}}}return!1}}class lt extends G{constructor(h,p,b,C){super(p,b),this._applyAdditionalRenderProps=C,this._colorSubstitutionHelper=new n,this._ctx=h}drawSolidFill(h,p){var b;if(!h)return;if((0,d.Bi)(h))this._buildPath(h.rings,!0);else if((0,d.Rg)(h))this._buildPath(h.paths,!0);else if((0,d.ZC)(h))this._buildPath(rt(h).rings,!0);else{if(!(0,d.U9)(h))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}const C=this._ctx;C.fillStyle="string"==typeof p?p:"rgba("+Math.round(p[0])+","+Math.round(p[1])+","+Math.round(p[2])+","+(null!==(b=p[3])&&void 0!==b?b:255)/255+")",C.fill("evenodd")}drawSolidStroke(h,p,b,C,y,m){var f;if(!h||!p||0===b)return;if((0,d.Bi)(h))this._buildPath(h.rings,!0);else if((0,d.Rg)(h))this._buildPath(h.paths,!1);else{if(!(0,d.ZC)(h))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(rt(h).rings,!0)}const M=this._ctx;M.strokeStyle="string"==typeof p?p:"rgba("+Math.round(p[0])+","+Math.round(p[1])+","+Math.round(p[2])+","+(null!==(f=p[3])&&void 0!==f?f:255)/255+")",M.lineWidth=Math.max(this.transformSize(b),.5),this._setCapStyle(C),this._setJoinStyle(y),M.miterLimit=m,M.stroke()}pushClipPath(h){if(this._ctx.save(),(0,d.Bi)(h))this._buildPath(h.rings,!0);else if((0,d.Rg)(h))this._buildPath(h.paths,!0);else{if(!(0,d.ZC)(h))return;this._buildPath(rt(h).rings,!0)}this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}drawImage(h,p){const{colorSubstitutions:b,url:C,tintColor:y}=h,m=(0,E._W)(h.scaleX,1),f=this._resourceManager.getResource(C);if(null==f)return;let M=p*(f.width/f.height),A=p;p||(M=f.width,A=f.height);const k=(0,E.UE)(C)||"src"in f&&(0,E.UE)(f.src);let z="getFrame"in f?S(f):f;b&&(z=this._colorSubstitutionHelper.applyColorSubstituition(z,b)),this._applyAdditionalRenderProps&&!k&&y&&(z=this._colorSubstitutionHelper.tintImageData(z,y));const F=this.transformPt([0,0]),[R,J]=this.getTransformAngle(),X=this.transformSize(1),Y=this._ctx;Y.save(),Y.setTransform({m11:m*X*R,m12:m*X*J,m21:-X*J,m22:X*R,m41:F[0],m42:F[1]}),Y.drawImage(z,-M/2,-A/2,M,A),Y.restore()}drawText(h,p){if(!p||0===p.length)return;this._textRasterizer||(this._textRasterizer=new V);const b=_t(h);b.size*=this.transformSize((0,x.PN)(1));const C=this._textRasterizer.rasterizeText(p,b);if(!C)return;const{size:y,anchorX:m,anchorY:f,canvas:M}=C,A=y[0]*(m+.5),k=y[1]*(f-.5),z=this._ctx,F=this.transformPt([0,0]),[R,J]=this.getTransformAngle();z.save(),z.setTransform({m11:1*R,m12:1*J,m21:-1*J,m22:1*R,m41:F[0]-1*A,m42:F[1]+1*k}),z.drawImage(M,0,0),z.restore()}drawPictureFill(h,p){if(!h)return;let{colorSubstitutions:b,height:C,offsetX:y,offsetY:m,rotation:f,scaleX:M,tintColor:A,url:k}=p;const z=this._resourceManager.getResource(k);if(null==z)return;if((0,d.Bi)(h))this._buildPath(h.rings,!0);else if((0,d.Rg)(h))this._buildPath(h.paths,!0);else if((0,d.ZC)(h))this._buildPath(rt(h).rings,!0);else{if(!(0,d.U9)(h))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}const F=this._ctx,R=(0,E.UE)(k)||"src"in z&&(0,E.UE)(z.src);let J,X="getFrame"in z?S(z):z;if(b&&(X=this._colorSubstitutionHelper.applyColorSubstituition(X,b)),this._applyAdditionalRenderProps){R||A&&(X=this._colorSubstitutionHelper.tintImageData(X,A)),J=F.createPattern(X,"repeat");const Y=this.transformSize(1);f||(f=0),y?y*=Y:y=0,m?m*=Y:m=0,C&&(C*=Y);const ot=C?C/z.height:1,it=M&&C?M*C/z.width:1;if(0!==f||1!==ot||1!==it||0!==y||0!==m){const ft=new DOMMatrix;ft.rotateSelf(0,0,-f).translateSelf(y,m).scaleSelf(it,ot,1),J.setTransform(ft)}}else J=F.createPattern(X,"repeat");F.save(),F.fillStyle=J,F.fill("evenodd"),F.restore()}drawPictureStroke(h,p){if(!h)return;let{colorSubstitutions:b,capStyle:C,joinStyle:y,miterLimit:m,tintColor:f,url:M,width:A}=p;const k=this._resourceManager.getResource(M);if(null==k)return;let z;if((0,d.Bi)(h))z=h.rings;else if((0,d.Rg)(h))z=h.paths;else{if(!(0,d.ZC)(h))return(0,d.U9)(h)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;z=rt(h).rings}A||(A=k.width);const F=(0,E.UE)(M)||"src"in k&&(0,E.UE)(k.src);let R="getFrame"in k?S(k):k;b&&(R=this._colorSubstitutionHelper.applyColorSubstituition(R,b)),this._applyAdditionalRenderProps&&(F||f&&(R=this._colorSubstitutionHelper.tintImageData(R,f)));const J=Math.max(this.transformSize((0,x.Lz)(A)),.5),X=J/R.width,Y=this._ctx,ot=Y.createPattern(R,"repeat-y");let it,ft;Y.save(),this._setCapStyle(C),this._setJoinStyle(y),void 0!==m&&(Y.miterLimit=m),Y.lineWidth=J;for(let nt of z)if(nt=(0,N.o8)(nt),at(nt),nt&&!(nt.length<=1)){it=this.transformPt(nt[0]);for(let ut=1;ut<nt.length;ut++){ft=this.transformPt(nt[ut]);const gt=q(it,ft),dt=new DOMMatrix;dt.translateSelf(0,it[1]-J/2).scaleSelf(X,X,1).rotateSelf(0,0,90-gt),ot.setTransform(dt),Y.strokeStyle=ot,Y.beginPath(),Y.moveTo(it[0],it[1]),Y.lineTo(ft[0],ft[1]),Y.stroke(),it=ft}}Y.restore()}_buildPath(h,p){const b=this._ctx;if(b.beginPath(),h)for(const C of h){const y=C?C.length:0;if(y>1){let m=this.transformPt(C[0]);b.moveTo(m[0],m[1]);for(let f=1;f<y;f++)m=this.transformPt(C[f]),b.lineTo(m[0],m[1]);p&&b.closePath()}}}_setCapStyle(h){switch(h){case g.uT.Butt:this._ctx.lineCap="butt";break;case g.uT.Round:this._ctx.lineCap="round";break;case g.uT.Square:this._ctx.lineCap="square"}}_setJoinStyle(h){switch(h){case g.wd.Bevel:this._ctx.lineJoin="bevel";break;case g.wd.Round:this._ctx.lineJoin="round";break;case g.wd.Miter:this._ctx.lineJoin="miter"}}}function q(Z,h){return 180/Math.PI*Math.atan2(h[1]-Z[1],h[0]-Z[0])}const rt=Z=>Z?{spatialReference:Z.spatialReference,rings:[[[Z.xmin,Z.ymin],[Z.xmin,Z.ymax],[Z.xmax,Z.ymax],[Z.xmax,Z.ymin],[Z.xmin,Z.ymin]]]}:null,ct=(Z,h,p)=>{switch(Z){case"ExtraLeading":return 1+h/p;case"Multiple":return h;case"Exact":return h/p}};function _t(Z,h=1){var p,b,C;const y=(0,E.DW)(Z),m=(0,E._d)(Z.fontStyleName),f=null!==(p=Z.fontFamilyName)&&void 0!==p?p:st.Vb,{weight:M,style:A}=m,k=h*(Z.height||5),z=(0,E.Bu)(Z.horizontalAlignment),F=(0,E.Nl)(Z.verticalAlignment),R=(0,E.pM)(Z),J=(0,E.pM)(Z.haloSymbol),X=null!=J?h*(null!==(b=Z.haloSize)&&void 0!==b?b:0):0,Y="CIMBackgroundCallout"===(null===(C=Z.callout)||void 0===C?void 0:C.type)?Z.callout.backgroundSymbol:null,ot=(0,E.pM)(Y),it=(0,E.xo)(Y),ft=(0,E._1)(Y);return{color:R,size:k,horizontalAlignment:z,verticalAlignment:F,font:{family:f,style:(0,E.pV)(A),weight:(0,E.Kn)(M),decoration:y},halo:{size:X||0,color:J,style:A},backgroundColor:ot,borderLine:null!=it&&null!=ft?{size:it,color:ft}:null,pixelRatio:1,premultiplyColors:!0}}const mt=1e-4;function at(Z){let h,p,b,C,y,m=Z[0],f=1;for(;f<Z.length;)h=Z[f][0]-m[0],p=Z[f][1]-m[1],C=0!==h?p/h:Math.PI/2,void 0!==b&&C-b<=mt?(Z.splice(f-1,1),m=y):(y=m,m=Z[f],f++),b=C}},26747:(pt,ht,v)=>{v.d(ht,{BW:()=>at,Sc:()=>U,Vb:()=>E,ll:()=>T,ni:()=>$,wp:()=>B});var st=v(47139),Q=v(3248),N=v(77806),O=v(35150),j=v(40707),x=v(67685),P=v(51995),_=v(83065),u=v(9015),c=v(76571),d=v(91767),r=v(46988),n=v(65374),l=v(32117),e=v(91644),o=v(4139),g=v(47669),S=v(42058);const w=Math.PI,W=w/2,K=Math.PI/180,H=96/72,et=()=>O.A.getLogger("esri.symbols.cim.CIMSymbolHelper");function E(y){let m;switch(y.type){case"cim":return y.data;case"web-style":return y;case"simple-marker":{const f=B.fromSimpleMarker(y);if(!f)throw new Error("InternalError: Cannot convert symbol to CIM");m=f;break}case"picture-marker":m=B.fromPictureMarker(y);break;case"simple-line":m=B.fromSimpleLineSymbol(y);break;case"simple-fill":m=B.fromSimpleFillSymbol(y);break;case"picture-fill":m=B.fromPictureFillSymbol(y);break;case"text":m=B.fromTextSymbol(y)}return{type:"CIMSymbolReference",symbol:m}}function L(y,m,f){switch(m.type){case"CIMSymbolReference":return L(y,m.symbol,f);case"CIMPointSymbol":null==f&&(f={x:0,y:0}),y.drawSymbol(m,f);break;case"CIMLineSymbol":null==f&&(f={paths:[[[0,0],[10,0]]]}),y.drawSymbol(m,f);break;case"CIMPolygonSymbol":null==f&&(f={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),y.drawSymbol(m,f);break;case"CIMTextSymbol":y.drawSymbol(m,{x:0,y:0});break;case"CIMVectorMarker":{const M=new c.W;y.drawMarker(m,M);break}}return y.envelope()}function I(y){if(!y)return 0;switch(y.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(y.offset);default:return 0}}function D(y){if(!y)return 0;switch(y.type){case"CIMGeometricEffectArrow":return Math.abs(.5*y.width);case"CIMGeometricEffectBuffer":return Math.abs(y.size);case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(y.length);case"CIMGeometricEffectJog":return Math.abs(.5*y.length);case"CIMGeometricEffectMove":return Math.max(Math.abs((0,l._W)(y.offsetX)),Math.abs((0,l._W)(y.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(y.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(y.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(y.fromWidth),Math.abs(y.toWidth));case"CIMGeometricEffectWave":return Math.abs(y.amplitude);case"CIMGeometricEffectDonut":return Math.abs(y.width)}}function T(y){if(!y)return 0;let m=0;for(const f of y)m+=D(f);return m}class U{static getSymbolInflateSize(m,f,M,A,k){return m||(m=[0,0,0,0]),f?this._getInflateSize(m,f,M,A,k):m}static safeSize(m){const f=Math.max(Math.abs(m[0]),Math.abs(m[2])),M=Math.max(Math.abs(m[1]),Math.abs(m[3]));return Math.sqrt(f*f+M*M)}static _vectorMarkerBounds(m,f,M,A){let k=!0;const z=(0,P.vt)();if(null!=f&&f.markerGraphics)for(const F of f.markerGraphics){const R=[0,0,0,0];F.geometry&&((0,_.Rg)(z,F.geometry),R[0]=0,R[1]=0,R[2]=0,R[3]=0,this.getSymbolInflateSize(R,F.symbol,M,0,A),z[0]+=R[0],z[1]+=R[1],z[2]+=R[2],z[3]+=R[3],k?(m[0]=z[0],m[1]=z[1],m[2]=z[2],m[3]=z[3],k=!1):(m[0]=Math.min(m[0],z[0]),m[1]=Math.min(m[1],z[1]),m[2]=Math.max(m[2],z[2]),m[3]=Math.max(m[3],z[3])))}return m}static _getInflateSize(m,f,M,A,k){if(function Z(y){return void 0!==y.symbolLayers}(f)){const z=this._getLayersInflateSize(m,f.symbolLayers,M,A,k),F=T(f.effects);return F>0&&(z[0]-=F,z[1]-=F,z[2]+=F,z[3]+=F),z}return this._getTextInflatedSize(m,f,k)}static _getLayersInflateSize(m,f,M,A,k){let z=!0;if(!f)return m;for(const F of f){if(!F)continue;let R=[0,0,0,0];switch(F.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{let Y=F.width;null!=Y&&(Y/=F.capStyle===n.uT.Square||F.joinStyle===n.wd.Miter?1.4142135623730951:2,R[0]=-Y,R[1]=-Y,R[2]=Y,R[3]=Y);break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const X=F;if("CIMVectorMarker"===F.type){const nt=F;if(R=this._vectorMarkerBounds(R,nt,M,k),nt.frame){const ut=(nt.frame.xmin+nt.frame.xmax)/2,gt=(nt.frame.ymin+nt.frame.ymax)/2;if(R[0]-=ut,R[1]-=gt,R[2]-=ut,R[3]-=gt,null!=nt.size){const dt=nt.size/(nt.frame.ymax-nt.frame.ymin);R[0]*=dt,R[1]*=dt,R[2]*=dt,R[3]*=dt}}}else if("CIMPictureMarker"===F.type){const nt=F,ut=M.getResource(nt.url);let gt=1;if(null!=ut&&ut.height&&(gt=ut.width/ut.height),null!=X.size){const dt=X.size/2,Pt=X.size*gt*nt.scaleX/2;R=[-Pt,-dt,Pt,dt]}}else if(null!=X.size){const nt=X.size/2;R=[-nt,-nt,nt,nt]}if(X.anchorPoint){let nt,ut;"Absolute"===X.anchorPointUnits?(nt=X.anchorPoint.x,ut=X.anchorPoint.y):(nt=X.anchorPoint.x*(R[2]-R[0]),ut=X.anchorPoint.y*(R[3]-R[1])),R[0]-=nt,R[1]-=ut,R[2]-=nt,R[3]-=ut}let Y=(0,l._W)(X.rotation);if(X.rotateClockwise&&(Y=-Y),A&&(Y-=A),Y){const nt=K*Y,ut=Math.cos(nt),gt=Math.sin(nt),dt=(0,P.vt)([o.MG,o.MG,-o.MG,-o.MG]);(0,P.tK)(dt,[R[0]*ut-R[1]*gt,R[0]*gt+R[1]*ut]),(0,P.tK)(dt,[R[0]*ut-R[3]*gt,R[0]*gt+R[3]*ut]),(0,P.tK)(dt,[R[2]*ut-R[1]*gt,R[2]*gt+R[1]*ut]),(0,P.tK)(dt,[R[2]*ut-R[3]*gt,R[2]*gt+R[3]*ut]),R=dt}let ot=(0,l._W)(X.offsetX),it=(0,l._W)(X.offsetY);if(A){const nt=K*A,ut=Math.cos(nt),gt=Math.sin(nt),dt=ot*gt+it*ut;ot=ot*ut-it*gt,it=dt}R[0]+=ot,R[1]+=it,R[2]+=ot,R[3]+=it;const ft=I(X.markerPlacement);ft>0&&(R[0]-=ft,R[1]-=ft,R[2]+=ft,R[3]+=ft);break}}const J=T(F.effects);J>0&&(R[0]-=J,R[1]-=J,R[2]+=J,R[3]+=J),z?(m[0]=R[0],m[1]=R[1],m[2]=R[2],m[3]=R[3],z=!1):(m[0]=Math.min(m[0],R[0]),m[1]=Math.min(m[1],R[1]),m[2]=Math.max(m[2],R[2]),m[3]=Math.max(m[3],R[3]))}return m}static _getTextInflatedSize(m,f,M){var A,k;const z=null!==(A=f.height)&&void 0!==A?A:r.D.CIMTextSymbol.height;if(m[0]=-z/2,m[1]=-z/2,m[2]=z/2,m[3]=z/2,!M)return m;const F=M.get(f);if(!F||!F.glyphMosaicItems.glyphs.length)return m;const{lineGapType:R,lineGap:J}=f,X=R?(0,d.QF)(R,null!=J?J:0,z):0,Y="CIMBackgroundCallout"===(null===(k=f.callout)||void 0===k?void 0:k.type),ot=(0,S.Tl)(F.glyphMosaicItems,{scale:z/g.eG,angle:(0,l._W)(f.angle),xOffset:(0,l._W)(f.offsetX),yOffset:(0,l._W)(f.offsetY),horizontalAlignment:f.horizontalAlignment,verticalAlignment:f.verticalAlignment,maxLineWidth:512,lineHeight:g.DY*Math.max(.25,Math.min(X||1,4)),decoration:f.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:Y}).boundsT;return m[0]=ot.x-ot.halfWidth,m[1]=-ot.y-ot.halfHeight,m[2]=ot.x+ot.halfWidth,m[3]=-ot.y+ot.halfHeight,m}}class B{static getEnvelope(m,f,M){if(!m)return null;const A=new d.mx(M);if(Array.isArray(m)){let k;for(const z of m)k?k.union(L(A,z,f)):k=L(A,z,f);return k}return L(A,m,f)}static getTextureAnchor(m,f){const M=this.getEnvelope(m,null,f);if(!M)return[0,0,0];const F=M.height*H+2;return[-(M.x+.5*M.width)*H/(M.width*H+2),-(M.y+.5*M.height)*H/F,F]}static rasterize(m,f,M,A,k=!0){const z=M||this.getEnvelope(f,null,A);if(!z)return[null,0,0,0,0];const F=(z.x+.5*z.width)*H,R=(z.y+.5*z.height)*H;m.width=z.width*H,m.height=z.height*H,M||(m.width+=2,m.height+=2);const J=m.getContext("2d",{willReadFrequently:!0}),X=d.IT.createScale(H,-H);X.translate(.5*m.width-F,.5*m.height+R);const Y=new d.Rj(J,A,X);switch(f.type){case"CIMPointSymbol":Y.drawSymbol(f,{type:"point",x:0,y:0});break;case"CIMVectorMarker":{const ft=new c.W;Y.drawMarker(f,ft);break}}const ot=J.getImageData(0,0,m.width,m.height),it=new Uint8Array(ot.data);if(k){let ft;for(let nt=0;nt<it.length;nt+=4)ft=it[nt+3]/255,it[nt]=it[nt]*ft,it[nt+1]=it[nt+1]*ft,it[nt+2]=it[nt+2]*ft}return[it,m.width,m.height,-F/m.width,-R/m.height]}static fromTextSymbol(m){const{text:f}=m;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:B.createCIMTextSymbolfromTextSymbol(m),textString:f}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(m){var f;const{height:M,outline:A,width:k,xoffset:z,xscale:F,yoffset:R,yscale:J}=m,X=[],Y={type:"CIMPolygonSymbol",symbolLayers:X};if(A){const ut=C(A);ut&&X.push(ut)}let ot=m.url;"esriPFS"===m.type&&m.imageData&&(ot=m.imageData);const it="angle"in m&&null!==(f=m.angle)&&void 0!==f?f:0;return X.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:n.O$.Picture,tintColor:null,url:ot,height:(null!=M?M:0)*(J||1),width:(null!=k?k:0)*(F||1),offsetX:(0,l._W)(z),offsetY:(0,l._W)(R),rotation:(0,l._W)(-it),colorSubstitutions:null}),Y}static fromSimpleFillSymbol(m){const{color:f,style:M,outline:A}=m,k=[],z={type:"CIMPolygonSymbol",symbolLayers:k};if(A){const F=C(A);F&&k.push(F)}if(M&&"solid"!==M&&"none"!==M&&"esriSFSSolid"!==M&&"esriSFSNull"!==M){const F={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:rt(f),capStyle:n.uT.Butt,joinStyle:n.wd.Miter,width:.75}]};let R=0;const J=(0,x.PN)(p(M)?8:10);switch(M){case"vertical":case"esriSFSVertical":R=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":R=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":R=45;break;case"cross":case"esriSFSCross":R=0}k.push({type:"CIMHatchFill",lineSymbol:F,offsetX:0,offsetY:0,rotation:R,separation:J}),"cross"===M||"esriSFSCross"===M?k.push({type:"CIMHatchFill",lineSymbol:(0,N.o8)(F),offsetX:0,offsetY:0,rotation:90,separation:J}):"diagonal-cross"!==M&&"esriSFSDiagonalCross"!==M||k.push({type:"CIMHatchFill",lineSymbol:(0,N.o8)(F),offsetX:0,offsetY:0,rotation:45,separation:J})}else!M||"solid"!==M&&"esriSFSSolid"!==M||k.push({type:"CIMSolidFill",enable:!0,color:rt(f)});return z}static fromSimpleLineSymbol(m){const{cap:f,color:M,join:A,marker:k,miterLimit:z,style:F,width:R}=m;let J=null;"solid"!==F&&"none"!==F&&"esriSLSSolid"!==F&&"esriSLSNull"!==F&&(J=[{type:"CIMGeometricEffectDashes",dashTemplate:at(F,f),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const X=[];if(k){let Y;switch(k.placement){case"begin-end":Y=n.$2.Both;break;case"begin":Y=n.$2.JustBegin;break;case"end":Y=n.$2.JustEnd;break;default:Y=n.$2.None}const ot=B.fromSimpleMarker(k,R,M).symbolLayers[0];ot.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:Y,offsetAlongLine:0},X.push(ot)}return X.push({type:"CIMSolidStroke",color:"none"!==F&&"esriSLSNull"!==F?rt(M):[0,0,0,0],capStyle:$(f),joinStyle:tt(A),miterLimit:z,width:R,effects:J}),{type:"CIMLineSymbol",symbolLayers:X}}static fromPictureMarker(m){const{angle:f,height:M,width:A,xoffset:k,yoffset:z}=m;let F=m.url;return"esriPMS"===m.type&&m.imageData&&(F=m.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:n.O$.Picture,tintColor:null,url:F,size:M,width:A,offsetX:(0,l._W)(k),offsetY:(0,l._W)(z),rotation:(0,l._W)(-f)}]}}static createCIMTextSymbolfromTextSymbol(m){const{angle:f,color:M,font:A,haloColor:k,haloSize:z,horizontalAlignment:F,kerning:R,text:J,verticalAlignment:X,xoffset:Y,yoffset:ot,backgroundColor:it,borderLineColor:ft,borderLineSize:nt}=m;let ut,gt,dt,Pt,yt,Mt;A&&(ut=A.family,gt=A.style,dt=A.weight,Pt=A.size,yt=A.decoration);let vt=!1;return J&&(vt=(0,st.y)(J)[1]),(it||nt)&&(Mt={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:rt(it)},{type:"CIMSolidStroke",color:rt(ft),width:nt}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMTextSymbol",angle:f,blockProgression:n.TZ.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:n.Y.Normal,fontEncoding:n.bj.Unicode,fontFamilyName:ut||"Arial",fontStyleName:ct(gt,dt),fontType:n.g7.Unspecified,haloSize:z,height:Pt,hinting:n.mU.Default,horizontalAlignment:lt(null!=F?F:"center"),kerning:R,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:(0,l._W)(Y),offsetY:(0,l._W)(ot),strikethrough:"line-through"===yt,underline:"underline"===yt,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:rt(M)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:rt(k)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:vt?n.f0.RTL:n.f0.LTR,verticalAlignment:q(null!=X?X:"baseline"),verticalGlyphOrientation:n.vG.Right,wordSpacing:100,billboardMode3D:n.xn.FaceNearPlane,callout:Mt}}static createPictureMarkerRasterizationParam(m){var f,M,A,k;const{angle:z,height:F,width:R,xoffset:J,yoffset:X}=m,Y=null!==(f=null!==(M=m.url)&&void 0!==M?M:null===(A=m.source)||void 0===A?void 0:A.url)&&void 0!==f?f:null===(k=m.source)||void 0===k?void 0:k.imageData;return Y?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:n.O$.Picture,tintColor:null,url:Y,size:F,width:R,offsetX:(0,l._W)(J),offsetY:(0,l._W)(X),rotation:(0,l._W)(-z)}}:null}static createPictureFillRasterizationParam(m){const{width:f,height:M,xoffset:A,yoffset:k,url:z}=m;return z?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureFill",scaleX:1,textureFilter:n.O$.Picture,tintColor:null,url:z,width:f,height:M,offsetX:(0,l._W)(A),offsetY:(0,l._W)(k),rotation:0}}:null}static fromSimpleMarker(m,f,M){var A;const{style:k}=m,z=null!==(A=m.color)&&void 0!==A?A:M;if("path"===k||"esriSMSPath"===k){const it=[];if("outline"in m&&m.outline){const ut=m.outline;it.push({type:"CIMSolidStroke",enable:!0,width:ut.width,color:rt(ut.color),path:m.path})}it.push({type:"CIMSolidFill",enable:!0,color:rt(z),path:m.path});const[ft,nt]=h("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:-(0,l._W)(m.angle),size:(0,l._W)(m.size||6),offsetX:(0,l._W)(m.xoffset),offsetY:(0,l._W)(m.yoffset),scaleSymbolsProportionally:!1,frame:ft,markerGraphics:[{type:"CIMMarkerGraphic",geometry:nt,symbol:{type:"CIMPolygonSymbol",symbolLayers:it}}]}]}}const F=[];let R,J,X=m.size;if("outline"in m&&m.outline&&"none"!==m.outline.style&&"esriSLSNull"!==m.outline.style){var Y;const it=m.outline,ft="solid"!==it.style&&"esriSLSSolid"!==it.style;[R,J]=ft?h(k,m.size):h(k);const nt=null!==(Y=it.width)&&void 0!==Y?Y:e.A7.width;if(ft){const dt=nt/m.size,Pt=(R.xmax-R.xmin)*dt/2,yt=(R.ymax-R.ymin)*dt/2;R.xmin-=Pt,R.xmax+=Pt,R.ymin-=yt,R.ymax+=yt,X&&(X+=nt)}const ut="cross"!==m.style&&"x"!==m.style||"dot"===(null==m?void 0:m.outline.style)||"short-dot"===(null==m?void 0:m.outline.style)?n.yS.HalfGap:n.yS.FullPattern,gt=ft?[{type:"CIMGeometricEffectAddControlPoints"},{type:"CIMGeometricEffectDashes",dashTemplate:at(it.style,null).map(dt=>it.width&&it.width>0?dt*it.width:dt),lineDashEnding:ut,controlPointEnding:n.yS.FullPattern}]:void 0;F.push({type:"CIMSolidStroke",capStyle:ft?n.uT.Round:n.uT.Butt,enable:!0,width:nt,color:rt(it.color),effects:gt})}else!f||"line-marker"!==m.type||"cross"!==m.style&&"x"!==m.style?[R,J]=h(k):([R,J]=h(k),F.push({type:"CIMSolidStroke",enable:!0,width:f,color:rt(z)}));F.push({type:"CIMSolidFill",enable:!0,color:rt(z)});const ot={type:"CIMPolygonSymbol",symbolLayers:F};return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,l._W)(-m.angle),size:(0,l._W)(X||6*f),offsetX:(0,l._W)(m.xoffset),offsetY:(0,l._W)(m.yoffset),scaleSymbolsProportionally:!1,frame:R,markerGraphics:[{type:"CIMMarkerGraphic",geometry:J,symbol:ot}]}]}}static fromCIMHatchFill(m,f){var M,A;const k=f*(null!==(M=m.separation)&&void 0!==M?M:r.D.CIMHatchFill.separation),z=k/2,F=(0,N.o8)(m.lineSymbol);null===(A=F.symbolLayers)||void 0===A||A.forEach(X=>{var Y;switch(X.type){case"CIMSolidStroke":null!=X.width&&(X.width*=f),null===(Y=X.effects)||void 0===Y||Y.forEach(ot=>{"CIMGeometricEffectDashes"===ot.type&&(ot.dashTemplate=ot.dashTemplate.map(ft=>ft*f))});break;case"CIMVectorMarker":{null!=X.size&&(X.size*=f);const ot=X.markerPlacement;null!=ot&&"placementTemplate"in ot&&(ot.placementTemplate=ot.placementTemplate.map(it=>it*f));break}}});let R=this._getLineSymbolPeriod(F)||4;for(;R<4;)R*=2;const J=R/2;return{type:"CIMVectorMarker",frame:{xmin:-J,xmax:J,ymin:-z,ymax:z},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-J,0],[J,0]]]},symbol:F}],size:k}}static fetchResources(m,f,M,A=null){return m&&f&&G(m,k=>{(function b(y,m,f){if(y.effects&&null==m.geometryEngine){if(m.geometryEnginePromise)return void f.push(m.geometryEnginePromise);(0,l.yH)(y.effects)&&(m.geometryEnginePromise=(0,l._H)(),f.push(m.geometryEnginePromise),m.geometryEnginePromise.then(M=>m.geometryEngine=M))}})(k,f,M),"url"in k&&k.url&&M.push(f.fetchResource(k.url,{signal:A}))}),M}static fetchFonts(m,f,M){if(m&&f)if("symbolLayers"in m&&m.symbolLayers){for(const A of m.symbolLayers)if("CIMVectorMarker"===A.type&&A.markerGraphics)for(const k of A.markerGraphics)null!=k&&k.symbol&&B.fetchFonts(k.symbol,f,M)}else if("CIMTextSymbol"===m.type){const{fontFamilyName:A,fontStyleName:k}=m;if(!A||"calcitewebcoreicons"===A.toLowerCase())return;const{style:z,weight:F}=(0,l._d)(k),R=(0,l.DW)(m),J=new u.A({family:A,style:z,weight:F,decoration:R});M.push(f.loadFont(J).catch(()=>{et().error(`Unsupported font ${A} in CIM symbol`)}))}}static _getLineSymbolPeriod(m){if(m){const f=this._getEffectsRepeat(m.effects);if(f)return f;if(m.symbolLayers)for(const M of m.symbolLayers)if(M){const A=this._getEffectsRepeat(M.effects);if(A)return A;switch(M.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const k=this._getPlacementRepeat(M.markerPlacement);if(k)return k}}}}return 0}static _getEffectsRepeat(m){if(m)for(const f of m)if(f)switch(f.type){case"CIMGeometricEffectDashes":{const M=f.dashTemplate;if(M&&M.length){let A=0;for(const k of M)A+=k;return 1&M.length&&(A*=2),A}break}case"CIMGeometricEffectWave":return f.period;default:et().error(`unsupported geometric effect type ${f.type}`)}return 0}static _getPlacementRepeat(m){if(m)switch(m.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const f=m.placementTemplate;if(f&&f.length){let M=0;for(const A of f)M+=+A;return 1&f.length&&(M*=2),M}break}}return 0}static fromCIMInsidePolygon(m){var f;const M=m.markerPlacement,A={...m};A.markerPlacement=null,A.anchorPoint=null;const k=Math.abs(M.stepX),z=Math.abs(M.stepY),F=(null!==(f=M.randomness)&&void 0!==f?f:100)/100;let R,J,X,Y;if("Random"===M.gridType){const ot=(0,x.PN)(g.yv),it=Math.max(Math.floor(ot/k),1),ft=Math.max(Math.floor(ot/z),1);R=it*k/2,J=ft*z/2,X=2*J;const nt=new j.A(M.seed),ut=F*k/1.5,gt=F*z/1.5;Y=[];for(let dt=0;dt<it;dt++)for(let Pt=0;Pt<ft;Pt++){const yt=dt*k-R+ut*(.5-nt.getFloat()),Mt=Pt*z-J+gt*(.5-nt.getFloat());Y.push({x:yt,y:Mt}),0===dt&&Y.push({x:yt+2*R,y:Mt}),0===Pt&&Y.push({x:yt,y:Mt+2*J})}}else!0===M.shiftOddRows?(R=k/2,J=z,X=2*z,Y=[{x:-R,y:0},{x:R,y:0},{x:0,y:J},{x:0,y:-J}]):(R=k/2,J=z/2,X=z,Y=[{x:-k,y:0},{x:0,y:-z},{x:-k,y:-z},{x:0,y:0},{x:k,y:0},{x:0,y:z},{x:k,y:z},{x:-k,y:z},{x:k,y:-z}]);return{type:"CIMVectorMarker",frame:{xmin:-R,xmax:R,ymin:-J,ymax:J},markerGraphics:Y.map(ot=>({type:"CIMMarkerGraphic",geometry:ot,symbol:{type:"CIMPointSymbol",symbolLayers:[A]}})),size:X}}}function G(y,m){if(y)switch(y.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const f=y.symbolLayers;if(!f)return;for(const M of f)if(m(M),"CIMVectorMarker"===M.type){const A=M.markerGraphics;if(!A)continue;for(const k of A)if(k){const z=k.symbol;z&&G(z,m)}}break}}}const $=y=>{if(!y)return n.uT.Butt;switch(y){case"butt":return n.uT.Butt;case"square":return n.uT.Square;case"round":return n.uT.Round}},tt=y=>{if(!y)return n.wd.Miter;switch(y){case"miter":return n.wd.Miter;case"round":return n.wd.Round;case"bevel":return n.wd.Bevel}},lt=y=>{if(null==y)return"Center";switch(y){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},q=y=>{if(null==y)return"Center";switch(y){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},rt=y=>{if(!y)return[0,0,0,0];const{r:m,g:f,b:M,a:A}=y;return[m,f,M,255*A]},ct=(y,m)=>{const f=_t(m),M=mt(y);return f&&M?`${f}-${M}`:`${f}${M}`},_t=y=>{if(!y)return"";switch(y.toLowerCase()){case"bold":case"bolder":return"bold"}return""},mt=y=>{if(!y)return"";switch(y.toLowerCase()){case"italic":case"oblique":return"italic"}return""},at=(y,m)=>{const f=(0,Q.A)("safari")?.001:0,M="butt"===m;switch(y){case"dash":case"esriSLSDash":return M?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return M?[4,3,1,3]:[3,4,f,4];case"dot":case"esriSLSDot":return M?[1,3]:[f,4];case"long-dash":case"esriSLSLongDash":return M?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return M?[8,3,1,3]:[7,4,f,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return M?[8,3,1,3,1,3]:[7,4,f,4,f,4];case"short-dash":case"esriSLSShortDash":return M?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return M?[4,1,1,1]:[3,2,f,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return M?[4,1,1,1,1,1]:[3,2,f,2,f,2];case"short-dot":case"esriSLSShortDot":return M?[1,1]:[f,2];case"solid":case"esriSLSSolid":case"none":return et().error("Unexpected: style does not require rasterization"),[0,0];default:return et().error(`Tried to rasterize SLS, but found an unexpected style: ${y}!`),[0,0]}},h=(y,m=100)=>{const f=m/2;let M,A;const k=y;if("circle"===k||"esriSMSCircle"===k){let F=Math.acos(1-.25/f),R=Math.ceil(w/F/4);0===R&&(R=1),F=W/R,R*=4;const J=[];J.push([f,0]);for(let X=1;X<R;X++)J.push([f*Math.cos(X*F),-f*Math.sin(X*F)]);J.push([f,0]),M={rings:[J]},A={xmin:-f,ymin:-f,xmax:f,ymax:f}}else if("cross"===k||"esriSMSCross"===k)M={paths:[[[0,f],[0,-f]],[[f,0],[-f,0]]]},A={xmin:-f,ymin:-f,xmax:f,ymax:f};else if("diamond"===k||"esriSMSDiamond"===k)M={rings:[[[-f,0],[0,f],[f,0],[0,-f],[-f,0]]]},A={xmin:-f,ymin:-f,xmax:f,ymax:f};else if("square"===k||"esriSMSSquare"===k)M={rings:[[[-f,-f],[-f,f],[f,f],[f,-f],[-f,-f]]]},A={xmin:-f,ymin:-f,xmax:f,ymax:f};else if("x"===k||"esriSMSX"===k)M={paths:[[[f,f],[-f,-f]],[[f,-f],[-f,f]]]},A={xmin:-f,ymin:-f,xmax:f,ymax:f};else if("triangle"===k||"esriSMSTriangle"===k){const z=.5773502691896257*m,F=-z,R=2/3*m,J=R-m;M={rings:[[[F,J],[0,R],[z,J],[F,J]]]},A={xmin:F,ymin:J,xmax:z,ymax:R}}else"arrow"===k&&(M={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},A={xmin:-f,ymin:-f,xmax:f,ymax:f});return[A,M]},p=y=>"vertical"===y||"horizontal"===y||"cross"===y||"esriSFSCross"===y||"esriSFSVertical"===y||"esriSFSHorizontal"===y;function C(y){if(!y)return null;let m=null;const{cap:f,color:M,join:A,miterLimit:k,style:z,width:F}=y;return"solid"!==z&&"none"!==z&&"esriSLSSolid"!==z&&"esriSLSNull"!==z&&(m=[{type:"CIMGeometricEffectDashes",dashTemplate:at(z,f),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:"esriSLSNull"!==z&&"none"!==z?rt(M):[0,0,0,0],capStyle:$(f),joinStyle:tt(A),miterLimit:k,width:F,effects:m}}},67311:(pt,ht,v)=>{v.d(ht,{I:()=>O,U:()=>N});var st=v(72137),Q=v(65374);const N=.03;class O{constructor(x=0,P=!1){}isEmpty(x){if(!x.nextPoint())return!0;let P,_,u,c;for(P=x.x,_=x.y;x.nextPoint();P=_,_=c)if(u=x.x,c=x.y,u!==P||c!==_)return x.seekPathStart(),!1;return x.seekPathStart(),!0}normalize(x){const P=Math.sqrt(x[0]*x[0]+x[1]*x[1]);0!==P&&(x[0]/=P,x[1]/=P)}getLength(x,P,_,u){const c=_-x,d=u-P;return Math.sqrt(c*c+d*d)}getSegLength(x){const[[P,_],[u,c]]=x;return this.getLength(P,_,u,c)}getCoord2D(x,P,_,u,c){return[x+(_-x)*c,P+(u-P)*c]}getSegCoord2D(x,P){const[[_,u],[c,d]]=x;return this.getCoord2D(_,u,c,d,P)}getAngle(x,P,_,u,c){return Math.atan2(u-P,_-x)}getAngleCS(x,P,_,u,c){const d=_-x,r=u-P,n=Math.sqrt(d*d+r*r);return n>0?[d/n,r/n]:[1,0]}getSegAngleCS(x,P){const[[_,u],[c,d]]=x;return this.getAngleCS(_,u,c,d,P)}cut(x,P,_,u,c,d){return[c<=0?[x,P]:this.getCoord2D(x,P,_,u,c),d>=1?[_,u]:this.getCoord2D(x,P,_,u,d)]}getSubCurve(x,P,_){const u=st.z.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(u,x,P,_)?u:null}appendSubCurve(x,P,_,u){x.startPath(),P.seekPathStart();let c=0,d=!0;if(!P.nextPoint())return!1;let r=P.x,n=P.y;for(;P.nextPoint();){const l=this.getLength(r,n,P.x,P.y);if(0!==l){if(d){if(c+l>_){let o=1,g=!1;c+l>=u&&(o=(u-c)/l,g=!0);const S=this.cut(r,n,P.x,P.y,(_-c)/l,o);if(S&&x.pushPoints(S),g)break;d=!1}}else{if(c+l>u){const e=this.cut(r,n,P.x,P.y,0,(u-c)/l);e&&x.pushPoint(e[1]);break}x.pushXY(P.x,P.y)}c+=l,r=P.x,n=P.y}else r=P.x,n=P.y}return!0}getCIMPointAlong(x,P){if(!x.nextPoint())return null;let _,u,c,d,r=0;for(_=x.x,u=x.y;x.nextPoint();_=c,u=d){c=x.x,d=x.y;const n=this.getLength(_,u,c,d);if(0!==n){if(r+n>P)return this.getCoord2D(_,u,c,d,(P-r)/n);r+=n}}return null}offset(x,P,_,u,c){if(!x||x.length<2)return null;let d=0,r=x[d++],n=d;for(;d<x.length;){const g=x[d];g[0]===r[0]&&g[1]===r[1]||(d!==n&&(x[n]=x[d]),r=x[n++]),d++}const l=x[0][0]===x[n-1][0]&&x[0][1]===x[n-1][1];if(l&&--n,n<(l?3:2))return null;const e=[];r=l?x[n-1]:null;let o=x[0];for(let g=0;g<n;g++){const S=g===n-1?l?x[0]:null:x[g+1];if(r)if(S){const w=[S[0]-o[0],S[1]-o[1]];this.normalize(w);const W=[o[0]-r[0],o[1]-r[1]];this.normalize(W);const K=W[0]*w[1]-W[1]*w[0],H=W[0]*w[0]+W[1]*w[1];if(0===K&&1===H){o=S;continue}if(K>=0==P<=0){if(H<1){const V=[w[0]-W[0],w[1]-W[1]];this.normalize(V);const et=Math.sqrt((1+H)/2);if(et>1/u){const E=-Math.abs(P)/et;e.push([o[0]-V[0]*E,o[1]-V[1]*E])}}}else switch(_){case Q.xw.Mitered:{const V=Math.sqrt((1+H)/2);if(V>0&&1/V<u){const et=[w[0]-W[0],w[1]-W[1]];this.normalize(et);const E=Math.abs(P)/V;e.push([o[0]-et[0]*E,o[1]-et[1]*E]);break}}case Q.xw.Bevelled:e.push([o[0]+W[1]*P,o[1]-W[0]*P]),e.push([o[0]+w[1]*P,o[1]-w[0]*P]);break;case Q.xw.Rounded:if(H<1){e.push([o[0]+W[1]*P,o[1]-W[0]*P]);const V=Math.floor(2.5*(1-H));if(V>0){const et=1/V;let E=et;for(let L=1;L<V;L++,E+=et){const I=[W[1]*(1-E)+w[1]*E,-W[0]*(1-E)-w[0]*E];this.normalize(I),e.push([o[0]+I[0]*P,o[1]+I[1]*P])}}e.push([o[0]+w[1]*P,o[1]-w[0]*P])}break;default:if(K<0)e.push([o[0]+(W[1]+W[0])*P,o[1]+(W[1]-W[0])*P]),e.push([o[0]+(w[1]-w[0])*P,o[1]-(w[0]+w[1])*P]);else{const V=Math.sqrt((1+Math.abs(H))/2),et=[w[0]-W[0],w[1]-W[1]];this.normalize(et);const E=P/V;e.push([o[0]-et[0]*E,o[1]-et[1]*E])}}}else{const w=[o[0]-r[0],o[1]-r[1]];this.normalize(w),e.push([o[0]+w[1]*P,o[1]-w[0]*P])}else{const w=[S[0]-o[0],S[1]-o[1]];this.normalize(w),e.push([o[0]+w[1]*P,o[1]-w[0]*P])}r=o,o=S}return e.length<(l?3:2)?null:(l&&e.push([e[0][0],e[0][1]]),e)}}},61116:(pt,ht,v)=>{v.d(ht,{VA:()=>O,YQ:()=>x,Z1:()=>_,ps:()=>j});var x,u,st=v(72137),Q=v(67311);class O{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(c,d,r=!0){if(this._setEmpty(),!c||0===c.length)return!1;for(let n=0;n<c.length;n++){let l=Math.abs(c[n]);r&&l<1e-7&&(l=1e-7),this._values.push(l),this._length+=l}return d&&1&c.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(c){const d=this._values?this._values.length:0;for(let r=0;r<d;++r)this._values[r]*=c;this._length*=c,this.extPtGap*=c,this.ctrlPtGap*=c}addValue(c){this._length+=c,this._values.push(c)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}class j{constructor(){this.pt=null,this.ca=0,this.sa=0}}(u=x||(x={}))[u.FAIL=0]="FAIL",u[u.END=1]="END",u[u.CONTINUE=2]="CONTINUE";class P{constructor(){this.reset()}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return null!==this.segment}copyTo(c){c.segment=this.segment,c.segmentLength=this.segmentLength,c.abscissa=this.abscissa,c.isPathEnd=this.isPathEnd,c.isPartEnd=this.isPartEnd}}class _ extends Q.I{constructor(c=0,d=!1){super(c,d),this._tolerance=Q.U,this._currentPosition=new P}updateTolerance(c){this._tolerance=Q.U*c}init(c,d,r=!0){return r?(this._patternLength=d.length(),this._partExtPtGap=d.extPtGap,this._partCtrlPtGap=d.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=c,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(c,d=x.FAIL){const r=new P;return!!this._nextPosition(c,r,null,d)&&(r.copyTo(this._currentPosition),!0)}curPointAndAngle(c){c.pt=this._getPoint(this._currentPosition);const[d,r]=this._getAngleCS(this._currentPosition);c.ca=d,c.sa=r}nextPointAndAngle(c,d,r=x.FAIL){const n=new P;if(!this._nextPosition(c,n,null,r))return!1;n.copyTo(this._currentPosition),d.pt=this._getPoint(n);const[l,e]=this._getAngleCS(n);return d.ca=l,d.sa=e,!0}nextCurve(c){if(0===c)return null;const d=st.z.createEmptyOptimizedCIM("esriGeometryPolyline");d.startPath(),d.nextPath();const r=new P;return this._nextPosition(c,r,d,x.END)?(r.copyTo(this._currentPosition),d):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(c){return this._pathCursor.seekInPath(c),[this._pathCursor.x,this._pathCursor.y]}getSeg(c){return[this.getPt(c),this.getPt(c+1)]}_nextPosition(c,d,r,n){if(this._currentPosition.isPathEnd)return!1;let l=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(l/=this._currentPosition.segmentLength),this._currentPosition.copyTo(d);d.abscissa+c*this._partLengthRatio>d.segmentLength+this._tolerance;){if(r){if(0===r.pathSize)if(0===l){const o=d.segment[0];r.pushXY(o[0],o[1])}else r.pushPoint(this.getSegCoord2D(d.segment,l));const e=d.segment[1];r.pushXY(e[0],e[1])}if(l=0,c-=(d.segmentLength-d.abscissa)/this._partLengthRatio,this._partSegCount)d.segment=this._nextSegment(),d.segmentLength=this.getSegLength(d.segment),d.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return n!==x.FAIL&&(d.segmentLength=this.getSegLength(d.segment),d.isPartEnd=!0,n===x.END?(d.abscissa=d.segmentLength,d.isPathEnd=!0):d.abscissa=d.segmentLength+c,!0);this._currentPosition.copyTo(d)}}if(d.abscissa+=c*this._partLengthRatio,r){0===r.pathSize&&r.pushPoint(0===l?d.segment[0]:this.getSegCoord2D(d.segment,l));const e=d.abscissa/d.segmentLength;r.pushPoint(1===e?d.segment[1]:this.getSegCoord2D(d.segment,e))}return this._partSegCount||Math.abs(d.abscissa-d.segmentLength)<this._tolerance&&(d.isPathEnd=this._partIsLast,d.isPartEnd=!0),!0}_getPoint(c){return this.getSegCoord2D(this._currentPosition.segment,c.segmentLength<=0?0:c.abscissa/c.segmentLength)}_getAngleCS(c){return this.getSegAngleCS(this._currentPosition.segment,c.segmentLength<=0?0:c.abscissa/c.segmentLength)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let c=this._partSegCount;for(;c;)this._previousSegment(),--c;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const d=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(d);let r=d+this._partSegCount+1;if(r>=this._pathCursor.pathSize&&(r=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(r),this._patternLength>0){const n=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,l=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let e=Math.round((this._partLength-(n+l))/this._patternLength);e<=0&&(e=n+l>0?0:1),this._partLengthRatio=this._partLength/(n+l+e*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}}},9792:(pt,ht,v)=>{v.d(ht,{A:()=>st});class st{constructor(N=0,O=0,j=0,x=0){this.x=N,this.y=O,this.width=j,this.height=x}static fromExtent(N){return new st(N.xmin,-N.ymax,N.xmax-N.xmin,N.ymax-N.ymin)}get isEmpty(){return this.width<=0||this.height<=0}union(N){this.x=Math.min(this.x,N.x),this.y=Math.min(this.y,N.y),this.width=Math.max(this.width,N.width),this.height=Math.max(this.height,N.height)}}},47763:(pt,ht,v)=>{v.d(ht,{B:()=>u});var st=v(72137),Q=v(53262),N=v(61245),O=v(67311),j=v(65374);const x=1.7320508075688772,_=j.oF.OpenEnded;let u=(()=>{class d{static local(){return null===d.instance&&(d.instance=new d),d.instance}execute(n,l,e,o,g){return new c(n,l,e)}}return d.instance=null,d})();class c extends N.rx{constructor(r,n,l){super(r,!1,!0),this._curveHelper=new O.I,this._width=(void 0!==n.width?n.width:5)*l,this._arrowType=void 0!==n.geometricEffectArrowType?n.geometricEffectArrowType:void 0!==n.arrowType?n.arrowType:_,this._offsetFlattenError=O.U*l}processPath(r){const n=st.z.createEmptyOptimizedCIM(r.geometryType);switch(this._arrowType){case j.oF.OpenEnded:default:this._constructSimpleArrow(n,r,!0);break;case j.oF.Block:this._constructSimpleArrow(n,r,!1);break;case j.oF.Crossed:this._constructCrossedArrow(n,r)}return n}_constructSimpleArrow(r,n,l){const e=n.pathLength();let o=this._width;e<2*o&&(o=e/2);const g=this._curveHelper.getSubCurve(n,0,e-o);if(!g||!g.nextPath())return;g.seekPathStart();const S=o/2;if(this._curveHelper.isEmpty(g))return;const w=(0,Q.A)(g),W=this._constructOffset(w,-S);if(!W)return;const K=this._constructOffset(w,S);if(!K)return;const H=this._constructArrowBasePoint(W,-S/2);if(!H)return;const V=this._constructArrowBasePoint(K,S/2);if(!V)return;n.seekInPath(n.pathSize-1);const et=[n.x,n.y];r.pushPath(K),r.nextPath(),r.nextPoint(),r.setControlPoint(),r.pushPoint(V),r.nextPoint(),r.setControlPoint(),r.pushPoint(et),r.nextPoint(),r.setControlPoint(),r.pushPoint(H),r.nextPoint(),r.setControlPoint(),r.pushPoints(W.reverse()),r.setControlPoint(),l||(r.setControlPointAt(0),r.setControlPointAt(r.pathSize-1),r.pushPoint(K[0])),r.reset()}_constructCrossedArrow(r,n){const l=n.pathLength();let e=this._width;l<e*(1+x+1)&&(e=l/(1+x+1)),n.seekPathStart();const o=this._curveHelper.getSubCurve(n,0,l-e*(1+x));if(!o)return;o.nextPath();const g=e/2;if(this._curveHelper.isEmpty(o))return;const S=(0,Q.A)(o),w=this._constructOffset(S,g);if(!w)return;const W=this._constructOffset(S,-g);if(!W)return;const K=this._curveHelper.getSubCurve(n,0,l-e);if(!K||(K.nextPath(),this._curveHelper.isEmpty(K)))return;const H=(0,Q.A)(K),V=this._constructOffset(H,g);if(!V)return;const et=this._constructOffset(H,-g);if(!et)return;const E=V[V.length-1],L=this._constructArrowBasePoint(V,g/2);if(!L)return;const I=et[et.length-1],D=this._constructArrowBasePoint(et,-g/2);if(!D)return;n.seekInPath(n.pathSize-1);const T=[n.x,n.y];r.pushPath(w),r.nextPath(),r.nextPoint(),r.setControlPoint(),r.pushPoint(I),r.nextPoint(),r.setControlPoint(),r.pushPoint(D),r.nextPoint(),r.setControlPoint(),r.pushPoint(T),r.nextPoint(),r.setControlPoint(),r.pushPoint(L),r.nextPoint(),r.setControlPoint(),r.pushPoint(E),r.nextPoint(),r.setControlPoint(),r.pushPoints(W.reverse()),r.nextPoint(),r.setControlPoint(),r.reset()}_constructOffset(r,n){return this._curveHelper.offset(r,n,j.xw.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(r,n){if(!r||r.length<2)return null;const l=r[r.length-2],e=r[r.length-1],o=[e[0]-l[0],e[1]-l[1]];return this._curveHelper.normalize(o),[e[0]+o[1]*n,e[1]-o[0]*n]}}},69630:(pt,ht,v)=>{v.d(ht,{s:()=>_}),v(21152);var Q=v(72137),N=v(53262),O=v(47961),j=v(67311),x=v(65374),P=v(32034);let _=(()=>{class c{static local(){return null===c.instance&&(c.instance=new c),c.instance}execute(r,n,l,e,o,g){return new u(r,n,l,e,o,g)}}return c.instance=null,c})();class u{constructor(d,r,n,l,e,o){this._inputGeometries=d,this._tileKey=l,this._geometryEngine=e,this._curveHelper=new j.I,this._size=(void 0!==r.size?r.size:1)*n,this._maxInflateSize=o*n,this._offsetFlattenError=j.U*n}next(){let d;for(;d=this._inputGeometries.next();){if(0===this._size)return d;if("esriGeometryEnvelope"===d.geometryType)if(this._size>0){const e=Q.z.createEmptyOptimizedCIM(d.geometryType),o=(0,N.x)(d)[0],g=this._curveHelper.offset(o,this._size,x.xw.Rounded,4,this._offsetFlattenError);if(g)return e.pushPath(g),e}else if(this._size<0){const e=d.asJSON();if(Math.min(e.xmax-e.xmin,e.ymax-e.ymin)+2*this._size>0)return Q.z.fromJSONCIM({xmin:e.xmin-this._size,xmax:e.xmax+this._size,ymin:e.ymin-this._size,ymax:e.ymax+this._size})}const r=this._geometryEngine;if(null==r)return null;const n=this._tileKey?(0,O.q)(d,this._maxInflateSize):d;if(!n)continue;const l=r.buffer(P.A.WebMercator,n.asJSON(),this._size,1);return l?Q.z.fromJSONCIM(l):null}return null}}},71045:(pt,ht,v)=>{v.d(ht,{v:()=>j});var st=v(72137),Q=v(53262),N=v(61245),O=v(65374);let j=(()=>{class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(u,c,d,r,n){return new x(u,c,d)}}return P.instance=null,P})();class x{constructor(_,u,c){var d;this._defaultPointSize=20,this._inputGeometries=_,this._geomUnitsPerPoint=c,this._rule=null!==(d=u.rule)&&void 0!==d?d:O.uQ.FullGeometry,this._defaultSize=this._defaultPointSize*c}next(){let _;for(;_=this._inputGeometries.next();){const u=this._processGeom((0,Q.x)(_));if(u&&u.length)return st.z.fromJSONCIM({paths:u})}return null}_clone(_){return[_[0],_[1]]}_mid(_,u){return[(_[0]+u[0])/2,(_[1]+u[1])/2]}_mix(_,u,c,d){return[_[0]*u+c[0]*d,_[1]*u+c[1]*d]}_add(_,u){return[_[0]+u[0],_[1]+u[1]]}_add2(_,u,c){return[_[0]+u,_[1]+c]}_sub(_,u){return[_[0]-u[0],_[1]-u[1]]}_dist(_,u){return Math.sqrt((_[0]-u[0])*(_[0]-u[0])+(_[1]-u[1])*(_[1]-u[1]))}_norm(_){return Math.sqrt(_[0]*_[0]+_[1]*_[1])}_normalize(_,u=1){const c=u/this._norm(_);_[0]*=c,_[1]*=c}_leftPerpendicular(_){const c=_[0];_[0]=-_[1],_[1]=c}_leftPerp(_){return[-_[1],_[0]]}_rightPerpendicular(_){const c=-_[0];_[0]=_[1],_[1]=c}_rightPerp(_){return[_[1],-_[0]]}_dotProduct(_,u){return _[0]*u[0]+_[1]*u[1]}_crossProduct(_,u){return _[0]*u[1]-_[1]*u[0]}_rotateDirect(_,u,c){const r=_[0]*c+_[1]*u;_[0]=_[0]*u-_[1]*c,_[1]=r}_makeCtrlPt(_){const u=[_[0],_[1]];return(0,N.Aq)(u,1),u}_addAngledTicks(_,u,c,d){const r=this._sub(c,u);this._normalize(r);const n=this._crossProduct(r,this._sub(d,u));let l;l=n>0?this._rightPerp(r):this._leftPerp(r);const e=Math.abs(n)/2,o=[];o.push([u[0]+(l[0]-r[0])*e,u[1]+(l[1]-r[1])*e]),o.push(u),o.push(c),o.push([c[0]+(l[0]+r[0])*e,c[1]+(l[1]+r[1])*e]),_.push(o)}_addBezier2(_,u,c,d,r){if(0==r--)return void _.push(d);const n=this._mid(u,c),l=this._mid(c,d),e=this._mid(n,l);this._addBezier2(_,u,n,e,r),this._addBezier2(_,e,l,d,r)}_addBezier3(_,u,c,d,r,n){if(0==n--)return void _.push(r);const l=this._mid(u,c),e=this._mid(c,d),o=this._mid(d,r),g=this._mid(l,e),S=this._mid(e,o),w=this._mid(g,S);this._addBezier3(_,u,l,g,w,n),this._addBezier3(_,w,S,o,r,n)}_add90DegArc(_,u,c,d,r){const n=null!=r?r:this._crossProduct(this._sub(c,u),this._sub(d,u))>0,l=this._mid(u,c),e=this._sub(l,u);n?this._leftPerpendicular(e):this._rightPerpendicular(e),l[0]+=e[0],l[1]+=e[1],this._addBezier3(_,u,this._mix(u,.33333,l,.66667),this._mix(c,.33333,l,.66667),c,4)}_addArrow(_,u,c){const d=u[0],r=u[1],n=u[u.length-1],l=this._sub(d,r);this._normalize(l);const e=this._crossProduct(l,this._sub(n,r)),o=.5*e,g=this._leftPerp(l),S=[n[0]-g[0]*e,n[1]-g[1]*e],w=u.length-1,W=[];W.push(c?[-g[0],-g[1]]:g);let K=[-l[0],-l[1]];for(let H=1;H<w-1;H++){const V=this._sub(u[H+1],u[H]);this._normalize(V);const et=this._dotProduct(V,K),E=this._crossProduct(V,K),L=Math.sqrt((1+et)/2),I=this._sub(V,K);this._normalize(I),I[0]/=L,I[1]/=L,W.push(E<0?[-I[0],-I[1]]:I),K=V}W.push(this._rightPerp(K));for(let H=W.length-1;H>0;H--)_.push([u[H][0]+W[H][0]*o,u[H][1]+W[H][1]*o]);_.push([S[0]+W[0][0]*o,S[1]+W[0][1]*o]),_.push([S[0]+W[0][0]*e,S[1]+W[0][1]*e]),_.push(d),_.push([S[0]-W[0][0]*e,S[1]-W[0][1]*e]),_.push([S[0]-W[0][0]*o,S[1]-W[0][1]*o]);for(let H=1;H<W.length;H++)_.push([u[H][0]-W[H][0]*o,u[H][1]-W[H][1]*o])}_cp2(_,u,c){return _.length>=2?_[1]:this._add2(_[0],u*this._defaultSize,c*this._defaultSize)}_cp3(_,u,c,d){if(_.length>=3)return _[2];const r=this._mix(_[0],1-c,u,c),n=this._sub(u,_[0]);return this._normalize(n),this._rightPerpendicular(n),[r[0]+n[0]*d*this._defaultSize,r[1]+n[1]*d*this._defaultSize]}_arrowPath(_){if(_.length>2)return _;const u=_[0],c=this._cp2(_,-4,0),d=this._sub(u,c);this._normalize(d);const r=this._rightPerp(d);return[u,c,[u[0]+(r[0]-d[0])*this._defaultSize,u[1]+(r[1]-d[1])*this._defaultSize]]}_arrowLastSeg(_){const u=_[0],c=this._cp2(_,-4,0);let d;if(_.length>=3)d=_[_.length-1];else{const r=this._sub(u,c);this._normalize(r);const n=this._rightPerp(r);d=[u[0]+(n[0]-r[0])*this._defaultSize,u[1]+(n[1]-r[1])*this._defaultSize]}return[c,d]}_processGeom(_){if(!_)return null;const u=[];for(const c of _){if(!c||0===c.length)continue;const d=c.length;let r=c[0];switch(this._rule){case O.uQ.PerpendicularFromFirstSegment:{const n=this._cp2(c,0,-1),l=this._cp3(c,n,.5,4),e=[];e.push(l),e.push(this._mid(r,n)),u.push(e);break}case O.uQ.ReversedFirstSegment:{const n=this._cp2(c,0,-1);u.push([n,r]);break}case O.uQ.PerpendicularToSecondSegment:{const n=this._cp2(c,-4,1),l=this._cp3(c,n,.882353,-1.94),e=[];e.push(this._mid(n,l)),e.push(r),u.push(e);break}case O.uQ.SecondSegmentWithTicks:{const n=this._cp2(c,-4,1),l=this._cp3(c,n,.882353,-1.94),e=this._sub(l,n);let o;o=this._crossProduct(e,this._sub(r,n))>0?this._rightPerp(o):this._leftPerp(e);const g=[];g.push([n[0]+(o[0]-e[0])/3,n[1]+(o[1]-e[1])/3]),g.push(n),g.push(l),g.push([l[0]+(o[0]+e[0])/3,l[1]+(o[1]+e[1])/3]),u.push(g);break}case O.uQ.DoublePerpendicular:{const n=this._cp2(c,0,-1),l=this._cp3(c,n,.5,3),e=this._mid(r,n),o=this._sub(e,l);this._normalize(o);const g=this._crossProduct(o,this._sub(r,l));this._leftPerpendicular(o);const S=[];S.push(r),S.push([l[0]+o[0]*g,l[1]+o[1]*g]),u.push(S);const w=[];w.push([l[0]-o[0]*g,l[1]-o[1]*g]),w.push(n),u.push(w);break}case O.uQ.OppositeToFirstSegment:{const n=this._cp2(c,0,-1),l=this._cp3(c,n,.5,3),e=this._mid(r,n),o=this._sub(e,l);this._normalize(o);const g=this._crossProduct(o,this._sub(r,l));this._leftPerpendicular(o);const S=[];S.push([l[0]+o[0]*g,l[1]+o[1]*g]),S.push([l[0]-o[0]*g,l[1]-o[1]*g]),u.push(S);break}case O.uQ.TriplePerpendicular:{const n=this._cp2(c,0,-1),l=this._cp3(c,n,.5,4),e=this._mid(r,n),o=this._sub(e,l);this._normalize(o);const g=this._crossProduct(o,this._sub(r,l));this._leftPerpendicular(o);const S=[];S.push([l[0]+o[0]*g*.8,l[1]+o[1]*g*.8]),S.push([e[0]+.8*(r[0]-e[0]),e[1]+.8*(r[1]-e[1])]),u.push(S),u.push([l,e]);const w=[];w.push([l[0]-o[0]*g*.8,l[1]-o[1]*g*.8]),w.push([e[0]+.8*(n[0]-e[0]),e[1]+.8*(n[1]-e[1])]),u.push(w);break}case O.uQ.HalfCircleFirstSegment:{const n=this._cp2(c,0,-1),l=this._cp3(c,n,.5,4),e=this._mid(r,n);let o=this._sub(n,r);const g=Math.cos(Math.PI/18),S=Math.sin(Math.PI/18),w=Math.sqrt((1+g)/2),W=Math.sqrt((1-g)/2),K=[];let H;this._crossProduct(o,this._sub(l,r))>0?(K.push(r),o=this._sub(r,e),H=n):(K.push(n),o=this._sub(n,e),H=r),this._rotateDirect(o,w,W),o[0]/=w,o[1]/=w;for(let V=1;V<=18;V++)K.push(this._add(e,o)),this._rotateDirect(o,g,S);K.push(H),u.push(K);break}case O.uQ.HalfCircleSecondSegment:{const n=this._cp2(c,0,-1),l=this._cp3(c,n,1,-1);let e=this._sub(r,n);this._normalize(e);const o=this._crossProduct(e,this._sub(l,n))/2;this._leftPerpendicular(e);const g=[n[0]+e[0]*o,n[1]+e[1]*o];e=this._sub(n,g);const S=Math.cos(Math.PI/18);let w=Math.sin(Math.PI/18);o>0&&(w=-w);const W=[n];for(let K=1;K<=18;K++)this._rotateDirect(e,S,w),W.push(this._add(g,e));u.push(W);break}case O.uQ.HalfCircleExtended:{const n=this._cp2(c,0,-2),l=this._cp3(c,n,1,-1);let e;if(d>=4)e=c[3];else{const K=this._sub(r,n);e=this._add(l,K)}const o=this._dist(n,l)/2/.75,g=this._sub(n,r);this._normalize(g,o);const S=this._sub(l,e);this._normalize(S,o),u.push([e,l]);const W=[this._clone(l)];this._addBezier3(W,l,this._add(l,S),this._add(n,g),n,4),W.push(r),u.push(W);break}case O.uQ.OpenCircle:{const n=this._cp2(c,-2,0),l=this._sub(n,r),e=Math.cos(Math.PI/18),o=-Math.sin(Math.PI/18),g=[n];for(let S=1;S<=33;S++)this._rotateDirect(l,e,o),g.push(this._add(r,l));u.push(g);break}case O.uQ.CoverageEdgesWithTicks:{const n=this._cp2(c,0,-1);let l,e;if(d>=3)l=c[2];else{const w=this._sub(n,r),W=this._leftPerp(w);l=[r[0]+W[0]-.25*w[0],r[1]+W[1]-.25*w[1]]}if(d>=4)e=c[3];else{const w=this._mid(r,n),W=this._sub(r,n);this._normalize(W),this._leftPerpendicular(W);const K=this._crossProduct(W,this._sub(l,w));this._rightPerpendicular(W),e=[l[0]+W[0]*K*2,l[1]+W[1]*K*2]}const o=this._sub(n,r);let g,S;g=this._crossProduct(o,this._sub(l,r))>0?this._rightPerp(o):this._leftPerp(o),S=[],S.push(l),S.push(r),S.push([r[0]+(g[0]-o[0])/3,r[1]+(g[1]-o[1])/3]),u.push(S),g=this._crossProduct(o,this._sub(e,n))>0?this._rightPerp(g):this._leftPerp(o),S=[],S.push([n[0]+(g[0]+o[0])/3,n[1]+(g[1]+o[1])/3]),S.push(n),S.push(e),u.push(S);break}case O.uQ.GapExtentWithDoubleTicks:{const n=this._cp2(c,0,2),l=this._cp3(c,n,0,1);let e;if(d>=4)e=c[3];else{const o=this._sub(n,r);e=this._add(l,o)}this._addAngledTicks(u,r,n,this._mid(l,e)),this._addAngledTicks(u,l,e,this._mid(r,n));break}case O.uQ.GapExtentMidline:{const n=this._cp2(c,2,0),l=this._cp3(c,n,0,1);let e;if(d>=4)e=c[3];else{const g=this._sub(n,r);e=this._add(l,g)}const o=[];o.push(this._mid(r,l)),o.push(this._mid(n,e)),u.push(o);break}case O.uQ.Chevron:{const n=this._cp2(c,-1,-1);let l;if(d>=3)l=c[2];else{const e=this._sub(n,r);this._leftPerpendicular(e),l=this._add(r,e)}u.push([n,this._makeCtrlPt(r),l]);break}case O.uQ.PerpendicularWithArc:{const n=this._cp2(c,0,-2),l=this._cp3(c,n,.5,-1);let e=this._sub(n,r);const o=this._norm(e);e[0]/=o,e[1]/=o;const g=this._crossProduct(e,this._sub(l,r));let S=this._dotProduct(e,this._sub(l,r));S<.05*o?S=.05*o:S>.95*o&&(S=.95*o);const w=[r[0]+e[0]*S,r[1]+e[1]*S];this._leftPerpendicular(e);let W=[];W.push([w[0]-e[0]*g,w[1]-e[1]*g]),W.push([w[0]+e[0]*g,w[1]+e[1]*g]),u.push(W);const K=[n[0]+e[0]*g,n[1]+e[1]*g];e=this._sub(n,K);const H=Math.cos(Math.PI/18);let V=Math.sin(Math.PI/18);g<0&&(V=-V),W=[r,n];for(let et=1;et<=9;et++)this._rotateDirect(e,H,V),W.push(this._add(K,e));u.push(W);break}case O.uQ.ClosedHalfCircle:{const n=this._cp2(c,2,0),l=this._mid(r,n),e=this._sub(n,l),o=Math.cos(Math.PI/18),g=Math.sin(Math.PI/18),S=[r,n];for(let w=1;w<=18;w++)this._rotateDirect(e,o,g),S.push(this._add(l,e));u.push(S);break}case O.uQ.TripleParallelExtended:{const n=this._cp2(c,0,-2),l=this._cp3(c,n,1,-2),e=this._mid(r,n),o=this._sub(l,n);this._normalize(o);const g=Math.abs(this._crossProduct(o,this._sub(e,n)))/2,S=this._dist(n,l),w=[n,r];w.push([r[0]+o[0]*S*.5,r[1]+o[1]*S*.5]),u.push(w);const W=[];W.push([e[0]-o[0]*g,e[1]-o[1]*g]),W.push([e[0]+o[0]*S*.375,e[1]+o[1]*S*.375]),(0,N.Aq)(W[W.length-1],1),W.push([e[0]+o[0]*S*.75,e[1]+o[1]*S*.75]),u.push(W),u.push([n,l]);break}case O.uQ.ParallelWithTicks:{const n=this._cp2(c,3,0),l=this._cp3(c,n,.5,-1),e=this._sub(l,n);this._normalize(e);const o=this._crossProduct(e,this._sub(l,r));this._leftPerpendicular(e),this._addAngledTicks(u,r,n,l),this._addAngledTicks(u,this._mix(r,1,e,o),this._mix(n,1,e,o),this._mid(r,n));break}case O.uQ.Parallel:{const n=this._cp2(c,3,0),l=this._cp3(c,n,.5,-1),e=this._sub(n,r);this._normalize(e);const o=this._leftPerp(e),g=this._crossProduct(e,this._sub(l,r));let S=[r,n];u.push(S),S=[],S.push([r[0]+o[0]*g,r[1]+o[1]*g]),S.push([n[0]+o[0]*g,n[1]+o[1]*g]),u.push(S);break}case O.uQ.PerpendicularToFirstSegment:{const n=this._cp2(c,3,0),l=this._cp3(c,n,.5,-1),e=this._mid(r,n),o=this._sub(n,r);this._normalize(o);const g=this._crossProduct(o,this._sub(l,r));this._leftPerpendicular(o);const S=[];S.push([e[0]-o[0]*g*.25,e[1]-o[1]*g*.25]),S.push([e[0]+o[0]*g*1.25,e[1]+o[1]*g*1.25]),u.push(S);break}case O.uQ.ParallelOffset:{const n=this._cp2(c,3,0),l=this._cp3(c,n,.5,-1),e=this._sub(n,r);this._normalize(e);const o=this._crossProduct(e,this._sub(l,r));this._leftPerpendicular(e);const g=[];g.push([r[0]-e[0]*o,r[1]-e[1]*o]),g.push([n[0]-e[0]*o,n[1]-e[1]*o]),u.push(g);const S=[];S.push([r[0]+e[0]*o,r[1]+e[1]*o]),S.push([n[0]+e[0]*o,n[1]+e[1]*o]),u.push(S);break}case O.uQ.OffsetOpposite:{const n=this._cp2(c,3,0),l=this._cp3(c,n,.5,-1),e=this._sub(n,r);this._normalize(e);const o=this._crossProduct(e,this._sub(l,r));this._leftPerpendicular(e);const g=[];g.push([r[0]-e[0]*o,r[1]-e[1]*o]),g.push([n[0]-e[0]*o,n[1]-e[1]*o]),u.push(g);break}case O.uQ.OffsetSame:{const n=this._cp2(c,3,0),l=this._cp3(c,n,.5,-1),e=this._sub(n,r);this._normalize(e);const o=this._crossProduct(e,this._sub(l,r));this._leftPerpendicular(e);const g=[];g.push([r[0]+e[0]*o,r[1]+e[1]*o]),g.push([n[0]+e[0]*o,n[1]+e[1]*o]),u.push(g);break}case O.uQ.CircleWithArc:{let n=this._cp2(c,3,0);const l=this._cp3(c,n,.5,-1);let e,o;if(d>=4)e=c[3],o=this._crossProduct(this._sub(e,n),this._sub(l,n))>0;else{e=n,o=this._crossProduct(this._sub(e,r),this._sub(l,r))>0;const K=24*this._geomUnitsPerPoint,H=this._sub(e,r);this._normalize(H,K);const V=Math.sqrt(2)/2;this._rotateDirect(H,V,o?V:-V),n=this._add(r,H)}const g=this._sub(n,r),S=Math.cos(Math.PI/18),w=Math.sin(Math.PI/18),W=[n];for(let K=1;K<=36;K++)this._rotateDirect(g,S,w),W.push(this._add(r,g));this._add90DegArc(W,n,e,l,o),(0,N.Aq)(W[W.length-8],1),u.push(W);break}case O.uQ.DoubleJog:{let n,l,e=this._cp2(c,-3,1);if(n=d>=3?c[2]:this._add(r,this._sub(r,e)),d>=4)l=c[3];else{const et=r;r=e,l=n;const E=this._dist(r,et),L=this._dist(l,et);let I=30*this._geomUnitsPerPoint;.5*E<I&&(I=.5*E),.5*L<I&&(I=.5*L),e=this._mix(r,I/E,et,(E-I)/E),n=this._mix(l,I/L,et,(L-I)/L)}const o=this._mid(r,e),g=this._mid(l,n),S=this._dist(r,e),w=this._dist(n,l);let W=Math.min(S,w)/8;W=Math.min(W,24*this._geomUnitsPerPoint);const K=Math.cos(Math.PI/4);let H=this._sub(r,e);this._normalize(H,W),this._crossProduct(H,this._sub(l,e))>0?this._rotateDirect(H,K,-K):this._rotateDirect(H,K,K);let V=[];V.push(e),V.push(this._add(o,H)),V.push(this._sub(o,H)),V.push(r),u.push(V),H=this._sub(l,n),this._normalize(H,W),this._crossProduct(H,this._sub(r,n))<0?this._rotateDirect(H,K,K):this._rotateDirect(H,K,-K),V=[],V.push(n),V.push(this._add(g,H)),V.push(this._sub(g,H)),V.push(l),u.push(V);break}case O.uQ.PerpendicularOffset:{const n=this._cp2(c,-4,1),l=this._cp3(c,n,.882353,-1.94),e=this._sub(l,n);this._crossProduct(e,this._sub(r,n))>0?this._rightPerpendicular(e):this._leftPerpendicular(e);const o=[e[0]/8,e[1]/8],g=this._sub(this._mid(n,l),o);u.push([g,r]);break}case O.uQ.LineExcludingLastSegment:{const n=this._arrowPath(c),l=[];let e=n.length-2;for(;e--;)l.push(n[e]);u.push(l);break}case O.uQ.MultivertexArrow:{const n=this._arrowPath(c),l=[];this._addArrow(l,n,!1),u.push(l);break}case O.uQ.CrossedArrow:{const n=this._arrowPath(c),l=[];this._addArrow(l,n,!0),u.push(l);break}case O.uQ.ChevronArrow:{const[n,l]=this._arrowLastSeg(c),e=10*this._geomUnitsPerPoint,o=this._sub(r,n);this._normalize(o);const g=this._crossProduct(o,this._sub(l,n)),S=this._leftPerp(o),w=[l[0]-S[0]*g*2,l[1]-S[1]*g*2],W=[];W.push([l[0]+o[0]*e,l[1]+o[1]*e]),W.push(r),W.push([w[0]+o[0]*e,w[1]+o[1]*e]),u.push(W);break}case O.uQ.ChevronArrowOffset:{const[n,l]=this._arrowLastSeg(c),e=this._sub(r,n);this._normalize(e);const o=this._crossProduct(e,this._sub(l,n));this._leftPerpendicular(e);const g=[l[0]-e[0]*o,l[1]-e[1]*o],S=[];S.push([g[0]+e[0]*o*.5,g[1]+e[1]*o*.5]),S.push(this._mid(g,r)),S.push([g[0]-e[0]*o*.5,g[1]-e[1]*o*.5]),u.push(S);break}case O.uQ.PartialFirstSegment:{const[n,l]=this._arrowLastSeg(c),e=this._sub(r,n);this._normalize(e);const o=this._crossProduct(e,this._sub(l,n));this._leftPerpendicular(e),u.push([n,[l[0]-e[0]*o,l[1]-e[1]*o]]);break}case O.uQ.Arch:{const n=this._cp2(c,0,-1),l=this._cp3(c,n,.5,1),e=this._sub(r,n),o=this._mix(l,1,e,.55),g=this._mix(l,1,e,-.55),S=[r];this._addBezier2(S,r,o,l,4),this._addBezier2(S,l,g,n,4),u.push(S);break}case O.uQ.CurvedParallelTicks:{const n=this._cp2(c,-4,1),l=this._cp3(c,n,.882353,-1.94),e=this._sub(l,n);this._crossProduct(e,this._sub(r,n))>0?this._rightPerpendicular(e):this._leftPerpendicular(e);const o=[e[0]/8,e[1]/8],g=this._sub(this._mid(n,l),o),S=this._sub(this._mix(n,.75,l,.25),o),w=this._sub(this._mix(n,.25,l,.75),o),W=[n];this._addBezier2(W,n,S,g,3),this._addBezier2(W,g,w,l,3),u.push(W);for(let K=0;K<8;K++){const H=W[2*K+1],V=[this._clone(H)];V.push(this._add(H,[e[0]/4,e[1]/4])),u.push(V)}break}case O.uQ.Arc90Degrees:{const n=this._cp2(c,0,-1),l=this._cp3(c,n,.5,1),e=[n];this._add90DegArc(e,n,r,l),u.push(e);break}default:u.push(c)}}return u}}},82854:(pt,ht,v)=>{v.d(ht,{y:()=>O});var st=v(72137),Q=v(61245),N=v(67311);let O=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,u,c,d,r){return new j(_,u,c)}}return x.instance=null,x})();class j extends Q.rx{constructor(P,_,u){super(P,!0,!0),this._curveHelper=new N.I,this._beginCut=(void 0!==_.beginCut?_.beginCut:1)*u,this._endCut=(void 0!==_.endCut?_.endCut:1)*u,this._middleCut=(void 0!==_.middleCut?_.middleCut:0)*u,this._invert=void 0!==_.invert&&_.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(P){const{_beginCut:_,_endCut:u,_middleCut:c}=this,d=P.pathLength(),r=st.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(0!==_||0!==u||0!==c)if(_+u+c>=d)for(r.startPath();P.nextPoint();)r.pushXY(P.x,P.y);else this._curveHelper.appendSubCurve(r,P,0,_),this._curveHelper.appendSubCurve(r,P,.5*(d-c),.5*(d+c)),this._curveHelper.appendSubCurve(r,P,d-u,u)}else if(0===_&&0===u&&0===c)for(r.startPath();P.nextPoint();)r.pushXY(P.x,P.y);else _+u+c<d&&(0===c?this._curveHelper.appendSubCurve(r,P,_,d-u):(this._curveHelper.appendSubCurve(r,P,_,.5*(d-c)),this._curveHelper.appendSubCurve(r,P,.5*(d+c),d-u)));return 0===r.totalSize?null:r}}},65264:(pt,ht,v)=>{v.d(ht,{I:()=>P});var st=v(72137),Q=v(53262),N=v(61245),O=v(65374),j=v(61116),x=v(32117);let P=(()=>{class u{static local(){return null===u.instance&&(u.instance=new u),u.instance}execute(d,r,n,l,e){return new _(d,r,n)}}return u.instance=null,u})();class _ extends N.rx{constructor(c,d,r){var n,l;super(c,!0,!0),this._firstCurve=null,this._walker=new j.Z1,this._walker.updateTolerance(r),this._endings=d.lineDashEnding,this._customDashPos=-(null!==(n=d.offsetAlongLine)&&void 0!==n?n:0)*r,this._offsetAtEnd=(null!==(l=d.customEndingOffset)&&void 0!==l?l:0)*r,this._pattern=new j.VA,this._pattern.init((0,x.K3)(d).dashTemplate,!0),this._pattern.scale(r)}processPath(c){var d;if(0===this._pattern.length()){this.iteratePath=!1;const l=(0,Q.A)(c);return st.z.fromJSONCIM({paths:[l]})}if(!this.iteratePath){let l=!0;switch(this._endings){case O.yS.HalfPattern:case O.yS.HalfGap:default:this._pattern.extPtGap=0;break;case O.yS.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case O.yS.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case O.yS.NoConstraint:this.isClosed||(l=!1);break;case O.yS.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const e=c.pathLength();if(this._pattern.isEmpty()||e<.1*this._pattern.length()){const o=(0,Q.A)(c);return st.z.fromJSONCIM({paths:[o]})}if(!this._walker.init(c,this._pattern,l)){const o=(0,Q.A)(c);return st.z.fromJSONCIM({paths:[o]})}}let r;if(this.iteratePath)r=this._pattern.nextValue();else{let l;switch(this._endings){case O.yS.HalfPattern:default:l=.5*this._pattern.firstValue();break;case O.yS.HalfGap:l=.5*-this._pattern.lastValue();break;case O.yS.FullGap:l=-this._pattern.lastValue();break;case O.yS.FullPattern:l=0;break;case O.yS.NoConstraint:case O.yS.Custom:l=-this._customDashPos}let e=l/this._pattern.length();e-=Math.floor(e),l=e*this._pattern.length(),this._pattern.reset(),r=this._pattern.nextValue();let o=!1;for(;l>=r;)l-=r,r=this._pattern.nextValue(),o=!o;r-=l,o?(this._walker.nextPosition(r),r=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(r),r=this._pattern.nextValue(),this._walker.nextPosition(r),r=this._pattern.nextValue())}let n=this._walker.nextCurve(r);if(n)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)n.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else r=this._pattern.nextValue(),!this._walker.nextPosition(r)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(n.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,n=this._firstCurve,this._firstCurve=null;return null!==(d=n)&&void 0!==d&&d.reset(),n}}},70614:(pt,ht,v)=>{v.d(ht,{O:()=>x}),v(21152);var Q=v(72137),N=v(47961),j=(v(65374),v(32034));let x=(()=>{class _{static local(){return null===_.instance&&(_.instance=new _),_.instance}execute(c,d,r,n,l,e){return new P(c,d,r,n,l,e)}}return _.instance=null,_})();class P{constructor(u,c,d,r,n,l){this._inputGeometries=u,this._tileKey=r,this._geometryEngine=n,this._maxInflateSize=l*d,this._width=(void 0!==c.width?c.width:2)*d,this._option=c.option}next(){let u;for(;u=this._inputGeometries.next();){if("esriGeometryEnvelope"===u.geometryType&&this._width>0){const c=u.asJSON();return Math.min(c.xmax-c.xmin,c.ymax-c.ymin)-2*this._width<0?u:Q.z.fromJSONCIM({paths:[[[c.xmin+this._width,c.ymin+this._width],[c.xmax-this._width,c.ymin+this._width],[c.xmax-this._width,c.ymax-this._width],[c.xmin+this._width,c.ymax-this._width],[c.xmin+this._width,c.ymin+this._width]],[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]]})}if("esriGeometryPolygon"===u.geometryType){if(0===this._width)return u.clone();const c=this._geometryEngine;if(null==c)return null;const d=this._tileKey?(0,N.q)(u,this._maxInflateSize):u.clone();if(!d)continue;const r=c.buffer(j.A.WebMercator,d.asJSON(),-this._width,1);if(r)for(const n of r.rings)if(n){d.startPath();for(const l of n.reverse())d.pushXY(l[0],d.yFactor*l[1])}return d}}return null}}},88918:(pt,ht,v)=>{v.d(ht,{U:()=>O});var st=v(72137),Q=v(61245),N=v(67311);let O=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,u,c,d,r){return new j(_,u,c)}}return x.instance=null,x})();class j extends Q.rx{constructor(P,_,u){super(P,!1,!0),this._curveHelper=new N.I,this._length=(void 0!==_.length?_.length:20)*u,this._angle=void 0!==_.angle?_.angle:225,this._position=void 0!==_.position?_.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(P){const _=st.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(P))return null;P.seekInPath(0);const u=P.x,c=P.y;P.seekInPath(P.pathSize-1);const d=P.x,r=P.y;this._curveHelper.normalize([d-u,r-c]);const l=u+(d-u)*this._position/100,e=c+(r-c)*this._position/100,o=Math.cos((90-this._angle)/180*Math.PI);let g=Math.sin((90-this._angle)/180*Math.PI);return this._mirror&&(g=-g),this._mirror=!this._mirror,_.pushPath([[u,c],[l-this._length/2*o,e-this._length/2*g],[l+this._length/2*o,e+this._length/2*g],[d,r]]),_}}},3691:(pt,ht,v)=>{v.d(ht,{V:()=>c}),v(21152);var Q=v(72137),N=v(53262),O=v(61320),j=v(47961),x=v(67311),P=v(65374),_=v(32034);let c=(()=>{class r{static local(){return null===r.instance&&(r.instance=new r),r.instance}execute(l,e,o,g,S,w){return new d(l,e,o,g,S,w)}}return r.instance=null,r})();class d{constructor(n,l,e,o,g,S){var w;this._inputGeometries=n,this._tileKey=o,this._geometryEngine=g,this._curveHelper=new x.I,this._offset=(null!==(w=l.offset)&&void 0!==w?w:1)*e,this._method=l.method,this._maxInflateSize=Math.max(Math.abs(S*e),10),this._option=l.option,this._offsetFlattenError=x.U*e}next(){let n;for(;n=this._inputGeometries.next();){if(0===this._offset)return n.clone();if("esriGeometryEnvelope"===n.geometryType){if(this._method===P.xw.Rounded&&this._offset>0){const S=(0,N.A)(n),w=this._curveHelper.offset(S,-this._offset,this._method,4,this._offsetFlattenError);if(w){const W=Q.z.createEmptyOptimizedCIM(n.geometryType);return W.pushPath(w),W}return null}const g=n.asJSON();if((0,O.ZC)(g)&&Math.min(g.xmax-g.xmin,g.ymax-g.ymin)+2*this._offset>0)return Q.z.fromJSONCIM({xmin:g.xmin-this._offset,xmax:g.xmax+this._offset,ymin:g.ymin-this._offset,ymax:g.ymax+this._offset})}const l=this._geometryEngine;if(null==l)continue;const e=this._tileKey?(0,j.q)(n,this._maxInflateSize):n.clone();if(!e)continue;const o=l.offset(_.A.WebMercator,e.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return o?Q.z.fromJSONCIM(o):null}return null}}},25867:(pt,ht,v)=>{v.d(ht,{v:()=>Q});var st=v(83065);let Q=(()=>{class O{static local(){return null===O.instance&&(O.instance=new O),O.instance}execute(x,P,_,u,c){return new N(x,P,_)}}return O.instance=null,O})();class N{constructor(j,x,P){this._inputGeometries=j,this._rotateAngle=void 0!==x.angle?x.angle*Math.PI/180:0}next(){let j=this._inputGeometries.next();for(;j;){if(0===this._rotateAngle||"esriGeometryPoint"===j.geometryType)return j;if(j.totalSize>0){const x=(0,st.z8)(j),P=(x[2]+x[0])/2,_=(x[3]+x[1])/2;return j.reset(),this._rotate(j.clone(),P,_)}j=this._inputGeometries.next()}return null}_rotate(j,x,P){const _=Math.cos(this._rotateAngle),u=Math.sin(this._rotateAngle);for(;j.nextPath();)for(;j.nextPoint();){const c=j.x-x,d=j.y-P;j.x=x+c*_-d*u,j.y=P+c*u+d*_}return j.reset(),j}}},39516:(pt,ht,v)=>{v.d(ht,{W:()=>Q});var st=v(83065);let Q=(()=>{class O{static local(){return null===O.instance&&(O.instance=new O),O.instance}execute(x,P,_,u,c){return new N(x,P,_)}}return O.instance=null,O})();class N{constructor(j,x,P){this._inputGeometries=j,this._xFactor=void 0!==x.XScaleFactor?x.XScaleFactor:1.15,this._yFactor=void 0!==x.YScaleFactor?x.YScaleFactor:1.15}next(){const j=this._inputGeometries.next();if(j){if(1===this._xFactor&&1===this._yFactor||"esriGeometryPoint"===j.geometryType)return j;if(j.totalSize>0){const x=(0,st.z8)(j),P=(x[2]+x[0])/2,_=(x[3]+x[1])/2;return j.reset(),this._scaleCursor(j.clone(),P,_)}}return null}_scaleCursor(j,x,P){for(;j.nextPath();)for(;j.nextPoint();)j.x=x+(j.x-x)*this._xFactor,j.y=P+(j.y-P)*this._yFactor;return j.reset(),j}}},57249:(pt,ht,v)=>{v.d(ht,{l:()=>O});var st=v(72137),Q=v(65374),N=v(61116);let O=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,u,c,d,r){return new j(_,u,c)}}return x.instance=null,x})();class j{constructor(P,_,u){this._inputGeometries=P,this._height=(void 0!==_.amplitude?_.amplitude:2)*u,this._period=(void 0!==_.period?_.period:3)*u,this._style=_.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new N.VA,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new N.Z1,this._walker.updateTolerance(u)}next(){let P=this._inputGeometries.next();for(;P;){if(0===this._height||0===this._period)return P;const _=this._processGeom(P);if(_)return _;P=this._inputGeometries.next()}return null}_processGeom(P){const _=st.z.createEmptyOptimizedCIM(P.geometryType);for(;P.nextPath();){_.startPath();const u=P.pathLength();if(this._walker.init(P,this._pattern))switch(this._style){case Q.WE.Sinus:default:this._constructCurve(_,u,!1);break;case Q.WE.Square:this._constructSquare(_,u);break;case Q.WE.Triangle:this._constructTriangle(_,u);break;case Q.WE.Random:this._constructCurve(_,u,!0)}else for(;P.nextPoint();)_.pushXY(P.x,P.y)}return _}_constructCurve(P,_,u){let c=Math.round(_/this._period);0===c&&(c=1);const n=this._period/16,l=1/(16*c+1),e=2*Math.PI*_/(_/c),o=2*Math.PI*Math.random(),g=2*Math.PI*Math.random(),S=2*Math.PI*Math.random(),w=.75-Math.random()/2,W=.75-Math.random()/2,K=new N.ps;this._walker.curPointAndAngle(K),P.pushPoint(K.pt);let H=0;for(;;){if(!this._walker.nextPointAndAngle(n,K)){P.pushPoint(this._walker.getPathEnd());break}{const V=H;let et;if(H+=l,u){const E=this._height/2*(1+.3*Math.sin(w*e*V+o));et=E*Math.sin(e*V+g),et+=E*Math.sin(W*e*V+S),et/=2}else et=.5*this._height*Math.sin(.5*e*V);P.pushXY(K.pt[0]-et*K.sa,K.pt[1]+et*K.ca)}}}_constructSquare(P,_){Math.round(_/this._period);let u=!0;for(;;){let c=!1;if(this._walker.curPositionIsValid()){const d=new N.ps;this._walker.curPointAndAngle(d);const r=new N.ps;if(this._walker.nextPointAndAngle(this._period,r)){const n=new N.ps;this._walker.nextPointAndAngle(this._period,n)&&(u?(P.pushPoint(d.pt),u=!1):P.pushPoint(d.pt),P.pushXY(d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca),P.pushXY(r.pt[0]-this._height/2*r.sa,r.pt[1]+this._height/2*r.ca),P.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca),P.pushXY(n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca),c=!0)}}if(!c){P.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(P,_){Math.round(_/this._period);let u=!0;for(;;){let c=!1;if(this._walker.curPositionIsValid()){const d=new N.ps;this._walker.curPointAndAngle(d);const r=new N.ps;if(this._walker.nextPointAndAngle(this._period/2,r)){const n=new N.ps;this._walker.nextPointAndAngle(this._period,n)&&(this._walker.nextPosition(this._period/2)&&(u?(P.pushPoint(d.pt),u=!1):P.pushPoint(d.pt),P.pushXY(r.pt[0]-this._height/2*r.sa,r.pt[1]+this._height/2*r.ca),P.pushXY(n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca)),c=!0)}}if(!c){P.pushPoint(this._walker.getPathEnd());break}}}}},2544:(pt,ht,v)=>{v.d(ht,{e:()=>O});var st=v(61245),Q=v(65374),N=v(61116);let O=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,u,c,d,r){return new j(_,u,c)}}return x.instance=null,x})();class j extends st.pC{constructor(P,_,u){var c;super(P),this._geometryWalker=new N.Z1,this._geometryWalker.updateTolerance(u),this._angleToLine=null===(c=_.angleToLine)||void 0===c||c,this._offset=(_.offset?_.offset:0)*u,this._originalEndings=_.endings,this._offsetAtEnd=(_.customEndingOffset?_.customEndingOffset:0)*u,this._position=-(_.offsetAlongLine?_.offsetAlongLine:0)*u,this._pattern=new N.VA,this._pattern.init(_.placementTemplate,!1),this._pattern.scale(u),this._endings=this._originalEndings}processPath(P){if(this._pattern.isEmpty())return null;let _;if(this.iteratePath)_=this._pattern.nextValue();else{this._endings=this._originalEndings===Q.e_.WithFullGap&&this.isClosed?Q.e_.WithMarkers:this._originalEndings,this._pattern.extPtGap=0;let c,d=!0;switch(this._endings){case Q.e_.NoConstraint:c=-this._position,c=this._adjustPosition(c),d=!1;break;case Q.e_.WithHalfGap:default:c=-this._pattern.lastValue()/2;break;case Q.e_.WithFullGap:c=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case Q.e_.WithMarkers:c=0;break;case Q.e_.Custom:c=-this._position,c=this._adjustPosition(c),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(P,this._pattern,d))return null;this._pattern.reset();let r=0;for(;c>r;)c-=r,r=this._pattern.nextValue();r-=c,_=r,this.iteratePath=!0}const u=new N.ps;return this._geometryWalker.nextPointAndAngle(_,u)?this._endings===Q.e_.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===Q.e_.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(u.pt[0]-this._offset*u.sa,u.pt[1]+this._offset*u.ca),this._angleToLine&&this.internalPlacement.setRotateCS(u.ca,u.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(P){let _=P/this._pattern.length();return _-=Math.floor(_),_*this._pattern.length()}}},34572:(pt,ht,v)=>{v.d(ht,{y:()=>O});var st=v(61245),Q=v(67311),N=v(65374);let O=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,u,c,d,r){return new j(_,u,c)}}return x.instance=null,x})();class j extends st.pC{constructor(P,_,u){super(P,!1,!0),this._curveHelper=new Q.I,this._angleToLine=void 0===_.angleToLine||_.angleToLine,this._offset=void 0!==_.offset?_.offset*u:0,this._type=_.extremityPlacement,this._position=void 0!==_.offsetAlongLine?_.offsetAlongLine*u:0,this._beginProcessed=!1}processPath(P){let _;switch(this._type){case N.$2.Both:default:this._beginProcessed?(_=this._atExtremities(P,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(_=this._atExtremities(P,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case N.$2.JustBegin:_=this._atExtremities(P,this._position,!0);break;case N.$2.JustEnd:_=this._atExtremities(P,this._position,!1);case N.$2.None:}return _}_atExtremities(P,_,u){if(u||P.seekPathEnd(),u?P.nextPoint():P.prevPoint()){let c=0,[d,r]=[0,0],[n,l]=[P.x,P.y];for(;u?P.nextPoint():P.prevPoint();){d=n,r=l,n=P.x,l=P.y;const e=this._curveHelper.getLength(d,r,n,l);if(c+e>_){const o=(_-c)/e,[g,S]=this._curveHelper.getAngleCS(d,r,n,l,o),w=this._curveHelper.getCoord2D(d,r,n,l,o);return this.internalPlacement.setTranslate(w[0]-this._offset*S,w[1]+this._offset*g),this._angleToLine&&this.internalPlacement.setRotateCS(-g,-S),this.internalPlacement}c+=e}}return null}}},56854:(pt,ht,v)=>{v.d(ht,{S:()=>N});var st=v(61245),Q=v(61116);let N=(()=>{class j{static local(){return null===j.instance&&(j.instance=new j),j.instance}execute(P,_,u,c,d){return new O(P,_,u)}}return j.instance=null,j})();class O extends st.pC{constructor(x,P,_){super(x),this._walker=new Q.Z1,this._walker.updateTolerance(_),this._angleToLine=void 0===P.angleToLine||P.angleToLine,this._offset=void 0!==P.offset?P.offset*_:0,this._beginGap=void 0!==P.beginPosition?P.beginPosition*_:0,this._endGap=void 0!==P.endPosition?P.endPosition*_:0,this._flipFirst=void 0===P.flipFirst||P.flipFirst,this._pattern=new Q.VA,this._pattern.init(P.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(x){if(this._pattern.isEmpty())return null;let P;if(this.iteratePath){const r=this._pattern.nextValue()*this._subPathLen,n=this._beginGap+r;P=n-this._prevPos,this._prevPos=n}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=x.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(x,this._pattern,!1))return null;this._pattern.reset();const r=this._pattern.nextValue()*this._subPathLen,n=this._beginGap+r;P=n-this._prevPos,this._prevPos=n,this.iteratePath=!0}const _=new Q.ps;if(!this._walker.nextPointAndAngle(P,_,Q.YQ.END))return this.iteratePath=!1,null;let c,d;return this.internalPlacement.setTranslate(_.pt[0]-this._offset*_.sa,_.pt[1]+this._offset*_.ca),this._angleToLine?(c=_.ca,d=_.sa):(c=1,d=0),this._isFirst&&this._flipFirst&&(c=-c,d=-d),this.internalPlacement.setRotateCS(c,d),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}},47942:(pt,ht,v)=>{v.d(ht,{M:()=>_});var st=v(40707),Q=v(76571),N=v(65374);const O=512,x=24,P=1e-6;let _=(()=>{class r{static local(){return null===r.instance&&(r.instance=new r),r.instance}execute(l,e,o,g,S){return new u(l,e,o,g,S)}}return r.instance=null,r})();class u{constructor(n,l,e,o,g){var S,w;if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(null!==(S=l.stepX)&&void 0!==S?S:16)*e,this._stepY=Math.abs(null!==(w=l.stepY)&&void 0!==w?w:16)*e,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,0!==this._stepX&&0!==this._stepY){var W;if(this._gridType=null!==(W=l.gridType)&&void 0!==W?W:N.Q1.Fixed,this._gridType===N.Q1.Random){var K,H;const I=null!==(K=l.seed)&&void 0!==K?K:13;this._randomLCG=new st.A(1*I),this._randomness=(null!==(H=l.randomness)&&void 0!==H?H:100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues()}else{var V,et,E,L;if(this._randomness=0,this._gridAngle=null!==(V=l.gridAngle)&&void 0!==V?V:0,this._shiftOddRows=null!==(et=l.shiftOddRows)&&void 0!==et&&et,this._offsetX=(null!==(E=l.offsetX)&&void 0!==E?E:0)*e,this._offsetY=(null!==(L=l.offsetY)&&void 0!==L?L:0)*e,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,null!=o){const[I,D,T,U]=o.split("/"),B=parseFloat(I),G=parseFloat(D),$=parseFloat(T),tt=parseFloat(U);this._graphicOriginX=-(tt*2**B+$)*O,this._graphicOriginY=G*O,this._testInsidePolygon=!0}this._internalPlacement=new Q.W,this._calculateMinMax(n),this._geometryCursor=n}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!u._randValues){u._randValues=[];for(let n=0;n<x;n++)for(let l=0;l<x;l++)u._randValues.push(this._randomLCG.getFloat()),u._randValues.push(this._randomLCG.getFloat())}}_calculateMinMax(n){let l,e,o,g,S,w,W,K,H,V,et,E,L,I;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,W=K=L=et=Number.MAX_VALUE,H=V=I=E=-Number.MAX_VALUE;const D=1!==this._cosAngle;for(n.reset();n.nextPath();)for(;n.nextPoint();)w=n.x,S=n.y,l=w-this._graphicOriginX-this._offsetX,e=S-this._graphicOriginY-this._offsetY,D?(o=this._cosAngle*l-this._sinAngle*e,g=this._sinAngle*l+this._cosAngle*e):(o=l,g=e),W=Math.min(W,o),H=Math.max(H,o),K=Math.min(K,g),V=Math.max(V,g),et=Math.min(et,S),E=Math.max(E,S),L=Math.min(L,w),I=Math.max(I,w);if(et=et!==Number.MAX_VALUE?et:-O-this._stepY,E=E!==-Number.MAX_VALUE?E:this._stepY,L=L!==Number.MAX_VALUE?L:-this._stepX,I=I!==-Number.MAX_VALUE?I:O+this._stepX,this._verticalSubdivision=E-et>=I-L,this._polygonMin=this._verticalSubdivision?et:L,this._testInsidePolygon){let B=0-this._graphicOriginX-this._offsetX-this._stepX,G=O-this._graphicOriginX-this._offsetX+this._stepX,$=-O-this._graphicOriginY-this._offsetY-this._stepY,tt=0-this._graphicOriginY-this._offsetY+this._stepY;if(D){const lt=[[B,$],[B,tt],[G,$],[G,tt]];B=$=Number.MAX_VALUE,G=tt=-Number.MAX_VALUE;for(const q of lt){const rt=this._cosAngle*q[0]-this._sinAngle*q[1],ct=this._sinAngle*q[0]+this._cosAngle*q[1];B=Math.min(B,rt),G=Math.max(G,rt),$=Math.min($,ct),tt=Math.max(tt,ct)}}W=W!==Number.MAX_VALUE?Math.max(W,B):B,K=K!==Number.MAX_VALUE?Math.max(K,$):$,H=H!==-Number.MAX_VALUE?Math.min(H,G):G,V=V!==-Number.MAX_VALUE?Math.min(V,tt):tt}this._xMin=Math.round(W/this._stepX),this._xMax=Math.round(H/this._stepX),this._yMin=Math.round(K/this._stepY),this._yMax=Math.round(V/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(n,L,I,et,E)}_buildAccelerationMap(n,l,e,o,g){n.reset();const S=new Map,w=this._verticalSubdivision,W=w?g-o:e-l;let K=Math.ceil(W/10);if(K<=1)return;const H=Math.floor(W/K);let V,et,E,L,I,D,T,U,B,G,$;for(K++,this._delta=H,w?(B=-O-2*this._stepY,G=2*this._stepY,$=o):(B=-2*this._stepX,G=O+2*this._stepX,$=l);n.nextPath();)if(!(n.pathSize<2)&&n.nextPoint())for(V=n.x,et=n.y;n.nextPoint();V=E,et=L){if(E=n.x,L=n.y,w){if(et===L||et<B&&L<B||et>G&&L>G)continue;I=Math.min(et,L),D=Math.max(et,L)}else{if(V===E||V<B&&E<B||V>G&&E>G)continue;I=Math.min(V,E),D=Math.max(V,E)}for(;I<D;)T=Math.floor((I-$)/H),d(T,V,et,E,L,S),I+=H;U=Math.floor((D-$)/H),U>T&&d(U,V,et,E,L,S)}this._accelerationMap=S}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let n=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(n+=.5*this._stepX);const l=this._currentY*this._stepY+this._offsetY;let e,o;if(this._currentX++,this._gridType===N.Q1.Random){const g=(this._currentX%x+x)%x,S=(this._currentY%x+x)%x;e=this._graphicOriginX+n+this._stepX*this._randomness*(.5-u._randValues[S*x+g])*2/3,o=this._graphicOriginY+l+this._stepY*this._randomness*(.5-u._randValues[S*x+g+1])*2/3}else e=this._graphicOriginX+this._cosAngle*n+this._sinAngle*l,o=this._graphicOriginY-this._sinAngle*n+this._cosAngle*l;if(!this._testInsidePolygon||this._isInsidePolygon(e,o,this._geometryCursor))return this._internalPlacement.setTranslate(e,o),this._internalPlacement}}_isInsidePolygon(n,l,e){if(null==this._accelerationMap)return function c(r,n,l){let e,o,g,S,w=0;for(r+=P,n+=P,l.reset();l.nextPath();)if(l.nextPoint())for(e=l.x,o=l.y;l.nextPoint();e=g,o=S)g=l.x,S=l.y,o>n!=S>n&&((g-e)*(n-o)-(S-o)*(r-e)>0?w++:w--);return 0!==w}(n,l,e);n+=P,l+=P;const o=this._verticalSubdivision,S=Math.floor(((o?l:n)-this._polygonMin)/this._delta),w=this._accelerationMap.get(S);if(!w)return!1;let W,K,H,V=0;for(const et of w){if(W=et[0],K=et[1],o){if(W[1]>l==K[1]>l)continue;H=(K[0]-W[0])*(l-W[1])-(K[1]-W[1])*(n-W[0])}else{if(W[0]>n==K[0]>n)continue;H=(K[1]-W[1])*(n-W[0])-(K[0]-W[0])*(l-W[1])}H>0?V++:V--}return 0!==V}}function d(r,n,l,e,o,g){let S=g.get(r);S||(S=[],g.set(r,S)),S.push([[n,l],[e,o]])}},53737:(pt,ht,v)=>{v.d(ht,{R:()=>j});var st=v(61245),Q=v(67311),N=v(65374);let j=(()=>{class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(u,c,d,r,n){return new x(u,c,d)}}return P.instance=null,P})();class x extends st.pC{constructor(_,u,c){super(_),this._curveHelper=new Q.I,this._angleToLine=void 0===u.angleToLine||u.angleToLine,this._offset=void 0!==u.offset?u.offset*c:0,this._relativeTo=u.relativeTo,this._position=void 0!==u.startPointOffset?u.startPointOffset*c:0,this._epsilon=.001*c}processPath(_){const u=this._position;if(this._relativeTo===N.ip.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),_.nextPoint()){let[d,r]=[_.x,_.y],[n,l]=[0,0];for(;_.nextPoint();){n=_.x,l=_.y;const e=this._curveHelper.getLength(d,r,n,l);if(e<this._epsilon){d=n,r=l;continue}const o=.5+this._position/e,[g,S]=this._curveHelper.getAngleCS(d,r,n,l,o),w=this._curveHelper.getCoord2D(d,r,n,l,o);return this.internalPlacement.setTranslate(w[0]-this._offset*S,w[1]+this._offset*g),this._angleToLine&&this.internalPlacement.setRotateCS(g,S),this.internalPlacement}}return this.iteratePath=!1,null}return this.onLine(_,u,this._relativeTo===N.ip.LineEnd)}onLine(_,u,c){let d,r=!1;switch(this._relativeTo){case N.ip.LineMiddle:default:_.seekPathStart(),d=_.pathLength()/2+u;break;case N.ip.LineBeginning:d=u;break;case N.ip.LineEnd:d=u,r=!0}c?_.seekPathEnd():_.seekPathStart();let n=0;if(c?_.prevPoint():_.nextPoint()){let[l,e]=[_.x,_.y],[o,g]=[0,0];for(;c?_.prevPoint():_.nextPoint();){o=_.x,g=_.y;const S=this._curveHelper.getLength(l,e,o,g);if(n+S>d){const w=(d-n)/S,[W,K]=this._curveHelper.getAngleCS(l,e,o,g,w),H=this._curveHelper.getCoord2D(l,e,o,g,w),V=r?-this._offset:this._offset;return this.internalPlacement.setTranslate(H[0]-V*K,H[1]+V*W),this._angleToLine&&(r?this.internalPlacement.setRotateCS(-W,-K):this.internalPlacement.setRotateCS(W,K)),this.internalPlacement}l=o,e=g,n+=S}}return null}}},3688:(pt,ht,v)=>{v.d(ht,{A:()=>O});var st=v(61245),Q=v(67311);let O=(()=>{class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(u,c,d,r,n){return new j(u,c,d)}}return P.instance=null,P})();class j extends st.pC{constructor(_,u,c){super(_),this._curveHelper=new Q.I,this._angleToLine=void 0===u.angleToLine||u.angleToLine,this._offset=void 0!==u.offset?u.offset*c:0,this._endPoints=void 0===u.placeOnEndPoints||u.placeOnEndPoints,this._controlPoints=void 0===u.placeOnControlPoints||u.placeOnControlPoints,this._regularVertices=void 0===u.placeOnRegularVertices||u.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(_){if(this.iteratePath||(this._preparePath(_),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const u=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(u[2]);let c=u[0],d=u[1];if(0!==this._offset){const r=Math.cos(u[2]),n=Math.sin(u[2]);c-=this._offset*n,d+=this._offset*r}return this.internalPlacement.setTranslate(c,d),this._tagIterator++,this.internalPlacement}_preparePath(_){this._tags.length=0,this._tagIterator=0,_.seekPathStart();const u=_.isClosed();let c=0,d=!1,r=0,n=0;if(_.seekPathStart(),_.nextPoint()){let l=_.x,e=_.y,o=_.getControlPoint(),g=!0,S=_.nextPoint();for(;S;){const w=_.x,W=_.y,K=_.getControlPoint();(this._angleToLine||0!==this._offset)&&(r=this._curveHelper.getAngle(l,e,w,W,0)),g?(g=!1,u?(c=r,d=o):(this._endPoints||this._controlPoints&&o)&&this._tags.push([l,e,r])):o?this._controlPoints&&this._tags.push([l,e,x(n,r)]):this._regularVertices&&this._tags.push([l,e,x(n,r)]),(this._angleToLine||0!==this._offset)&&(n=this._curveHelper.getAngle(l,e,w,W,1)),S=_.nextPoint(),S||(u?K||d?this._controlPoints&&this._tags.push([w,W,x(n,c)]):this._regularVertices&&this._tags.push([w,W,x(n,c)]):(this._endPoints||this._controlPoints&&K)&&this._tags.push([w,W,n])),l=w,e=W,o=K}}this._tagIterator=0}}function x(P,_){const u=Math.PI;for(;Math.abs(_-P)>u+2e-15;)_-P>u?_-=2*u:_+=2*u;return(P+_)/2}},68051:(pt,ht,v)=>{v.d(ht,{L:()=>x});var st=v(83065),Q=v(39239),N=v(13259),O=v(76571),j=v(65374);let x=(()=>{class _{static local(){return null===_.instance&&(_.instance=new _),_.instance}execute(c,d,r,n,l){return new P(c,d,r)}}return _.instance=null,_})();class P{constructor(u,c,d){this._geometryCursor=u,this._offsetX=void 0!==c.offsetX?c.offsetX*d:0,this._offsetY=void 0!==c.offsetY?c.offsetY*d:0,this._method=void 0!==c.method?c.method:j.YI.OnPolygon,this._internalPlacement=new O.W}next(){const u=this._geometryCursor;return this._geometryCursor=null,u?this._polygonCenter(u):null}_polygonCenter(u){let c=!1;switch(this._method){case j.YI.CenterOfMass:{const d=(0,Q.TP)(u);d&&(this._internalPlacement.setTranslate(d[0]+this._offsetX,d[1]+this._offsetY),c=!0)}break;case j.YI.BoundingBoxCenter:{const d=(0,st.z8)(u);d&&(this._internalPlacement.setTranslate((d[2]+d[0])/2+this._offsetX,(d[3]+d[1])/2+this._offsetY),c=!0)}break;default:{const d=(0,N.d)(u);null!==d&&(this._internalPlacement.setTranslate(d[0]+this._offsetX,d[1]+this._offsetY),c=!0)}}return c?this._internalPlacement:null}}},30365:(pt,ht,v)=>{v.d(ht,{Dy:()=>u,UD:()=>x,fO:()=>P,gy:()=>O,iT:()=>_,xy:()=>j});var st=v(35150);const Q=()=>st.A.getLogger("esri.views.2d.engine.webgl.alignmentUtils");var N,O,r;function j(r){if(!r)return N.Center;switch(r){case"Left":case"left":return N.Left;case"Right":case"right":return N.Right;case"Justify":return Q().warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),N.Center;case"Center":case"center":return N.Center}}function x(r){if(!r)return O.Center;switch(r){case"Top":case"top":return O.Top;case"Center":case"middle":return O.Center;case"Baseline":case"baseline":return O.Baseline;case"Bottom":case"bottom":return O.Bottom}}function P(r){switch(r){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return["right","bottom"];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return["center","bottom"];case"above-right":case"esriServerPointLabelPlacementAboveRight":return["left","bottom"];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return["right","middle"];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return["center","middle"];case"center-right":case"esriServerPointLabelPlacementCenterRight":return["left","middle"];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return["right","top"];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return["center","top"];case"below-right":case"esriServerPointLabelPlacementBelowRight":return["left","top"];default:return console.debug(`Found invalid placement type ${r}`),["center","middle"]}}function _(r){switch(r){case N.Right:case"right":return-1;case N.Center:case"center":return 0;case N.Left:case"left":return 1;default:return console.debug(`Found invalid horizontal alignment ${r}`),0}}function u(r){switch(r){case O.Top:case"top":return 1;case O.Center:case"middle":return 0;case O.Bottom:case O.Baseline:case"baseline":case"bottom":return-1;default:return console.debug(`Found invalid vertical alignment ${r}`),0}}(r=N||(N={}))[r.Left=-1]="Left",r[r.Center=0]="Center",r[r.Right=1]="Right",function(r){r[r.Top=1]="Top",r[r.Center=0]="Center",r[r.Bottom=-1]="Bottom",r[r.Baseline=2]="Baseline"}(O||(O={}))},42058:(pt,ht,v)=>{v.d(ht,{Tl:()=>E});var st=v(76329),Q=v(3672),N=v(83953),O=v(88532),j=v(30365),x=v(68973),P=v(21260);const _=22,u=4,c=_+u,d=_-6,r=3,n=Math.PI/180;class o{constructor(I,D,T,U){this._rotationT=(0,Q.vt)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const B=T.rect,G=new Float32Array(8);I*=U,D*=U;const $=T.code?B.width*U:T.metrics.width,tt=T.code?B.height*U:T.metrics.height;this.width=$,this.height=tt,G[0]=I,G[1]=D,G[2]=I+$,G[3]=D,G[4]=I,G[5]=D+tt,G[6]=I+$,G[7]=D+tt,this._data=G,this._setTextureCoords(B),this._scale=U,this._mosaic=T,this.x=I,this.y=D,this.maxOffset=Math.max(I+$,D+tt)}get mosaic(){return this._mosaic}set angle(I){this._angle=I,(0,st.$0)(this._rotationT,-I),this._setOffsets()}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:I,width:D}=this._mosaic.metrics,T=D*this._scale,U=Math.abs(I)*this._scale,B=new Float32Array(8);B[0]=this.x,B[1]=this.y,B[2]=this.x+T,B[3]=this.y,B[4]=this.x,B[5]=this.y+U,B[6]=this.x+T,B[7]=this.y+U;const G=(0,st.lw)((0,Q.vt)(),this._rotationT,this._transform);(0,Q.gb)(B,B,G);let $=1/0,tt=1/0,lt=0,q=0;for(let at=0;at<4;at++){const Z=B[2*at],h=B[2*at+1];$=Math.min($,Z),tt=Math.min(tt,h),lt=Math.max(lt,Z),q=Math.max(q,h)}const rt=lt-$,ct=q-tt;this._bounds=new P.A($+rt/2,tt+ct/2,rt,ct)}return this._bounds}setTransform(I){this._transform=I,this._offsets=null}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const I=(0,st.lw)((0,Q.vt)(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],(0,N.l0)(this._offsets.topLeft,this._offsets.topLeft,I),(0,N.l0)(this._offsets.topRight,this._offsets.topRight,I),(0,N.l0)(this._offsets.bottomLeft,this._offsets.bottomLeft,I),(0,N.l0)(this._offsets.bottomRight,this._offsets.bottomRight,I)}_setTextureCoords({x:I,y:D,width:T,height:U}){this._texcoords={topLeft:[I,D],topRight:[I+T,D],bottomLeft:[I,D+U],bottomRight:[I+T,D+U]}}}const g=(L,I)=>({code:0,page:0,sdf:!0,rect:new x.A(0,0,11,8),textureBinding:I,metrics:{advance:0,height:4,width:L,left:0,top:0}});function S(L,I){return L.forEach(D=>(0,N.l0)(D,D,I)),{topLeft:L[0],topRight:L[1],bottomLeft:L[2],bottomRight:L[3]}}class w{constructor(I,D,T){this._rotation=0,this._decorate(I,D,T),this.glyphs=I,this.bounds=this._createBounds(I),this.isMultiline=D.length>1,this._hasRotation=0!==T.angle,this._transform=this._createGlyphTransform(this.bounds,T),this._borderLineSizePx=T.borderLineSizePx,(T.borderLineSizePx||T.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const U of I)U.setTransform(this._transform)}setRotation(I){if(0===I&&0===this._rotation)return;this._rotation=I;const D=this._transform,T=(0,st.$0)((0,Q.vt)(),I);(0,st.lw)(D,T,D);for(const U of this.glyphs)U.setTransform(this._transform)}_decorate(I,D,T){if(!T.decoration||"none"===T.decoration||!I.length)return;const U=T.scale,B="underline"===T.decoration?c:d,G=I[0].textureBinding;for(const $ of D)I.push(new o($.startX*U,$.startY*U+B*U,g(($.width+$.glyphWidthEnd)*U,G),1))}shapeBackground(I){const T=(1.5+(this._borderLineSizePx||0))/2,U=this._borderLineSizePx?T:0,{xmin:B,ymin:G,xmax:$,ymax:tt,x:lt,y:q,width:rt,height:ct}=this.bounds,_t=[B-8,G-8],mt=[$+8,G-8],at=[B-8,tt+8],Z=[$+8,tt+8],h=S([[_t[0]-T,_t[1]-T],[mt[0]+T,mt[1]-T],[_t[0]+U,_t[1]+U],[mt[0]-U,mt[1]+U]],I),p=S([[at[0]+U,at[1]-U],[Z[0]-U,Z[1]-U],[at[0]-T,at[1]+T],[Z[0]+T,Z[1]+T]],I),b=S([[_t[0]-T,_t[1]-T],[_t[0]+U,_t[1]+U],[at[0]-T,at[1]+T],[at[0]+U,at[1]-U]],I),C=S([[mt[0]-U,mt[1]+U],[mt[0]+T,mt[1]-T],[Z[0]-U,Z[1]-U],[Z[0]+T,Z[1]+T]],I),y={main:S([_t,mt,at,Z],I),top:h,bot:p,left:b,right:C};return[new P.A(lt,q,rt+2*T,ct+2*T),y]}get boundsT(){const I=this.bounds,D=(0,N.hZ)((0,O.vt)(),I.x,I.y);if((0,N.l0)(D,D,this._transform),this._hasRotation){const T=Math.max(I.width,I.height);return new P.A(D[0],D[1],T,T)}return new P.A(D[0],D[1],I.width,I.height)}_createBounds(I){let D=1/0,T=1/0,U=0,B=0;for(const tt of I)D=Math.min(D,tt.xTopLeft),T=Math.min(T,tt.yTopLeft),U=Math.max(U,tt.xBottomRight),B=Math.max(B,tt.yBottomRight);const G=U-D,$=B-T;return new P.A(D+G/2,T+$/2,G,$)}_createGlyphTransform(I,D){const T=n*D.angle,U=(0,Q.vt)(),B=(0,O.vt)();return(0,st.Tl)(U,U,(0,N.hZ)(B,D.xOffset,-D.yOffset)),D.useCIMAngleBehavior?(0,st.e$)(U,U,T):((0,st.Tl)(U,U,(0,N.hZ)(B,I.x,I.y)),(0,st.e$)(U,U,T),(0,st.Tl)(U,U,(0,N.hZ)(B,-I.x,-I.y))),U}}class W{constructor(I,D,T,U,B,G){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(D,T)),this.end=Math.max(0,Math.max(D,T)),this.end<I.length&&(this.glyphWidthEnd=I[this.end].metrics.width),this.width=U,this.yMin=B,this.yMax=G}}const K=L=>10===L,H=L=>32===L;function E(L,I){const D=I.scale,T=new Array,{glyphs:U,isRightToLeft:B}=L,G=function V(L,I,D){const T=new Array,B=D.maxLineWidth*(1/D.scale),G=I?L.length-1:0,$=I?-1:L.length,tt=I?-1:1;let lt=G,q=0,rt=0,ct=lt,_t=ct,mt=0,at=1/0,Z=0;for(;lt!==$;){const{code:p,metrics:b}=L[lt],C=Math.abs(b.top);K(p)||H(p)||(at=Math.min(at,C),Z=Math.max(Z,C+b.height)),K(p)?(lt!==G&&(T.push(new W(L,ct,lt-tt,q,at,Z)),at=1/0,Z=0),q=0,ct=lt+tt,_t=lt+tt,rt=0):H(p)?(_t=lt+tt,rt=0,mt=b.advance,q+=b.advance):q>B?(_t!==ct?(q-=mt,T.push(new W(L,ct,_t-2*tt,q-rt,at,Z)),at=1/0,Z=0,ct=_t,q=rt):(T.push(new W(L,ct,lt-tt,q,at,Z)),at=1/0,Z=0,ct=lt,_t=lt,q=0),q+=b.advance,rt+=b.advance):(q+=b.advance,rt+=b.advance),lt+=tt}const h=new W(L,ct,lt-tt,q,at,Z);return h.start>=0&&h.end<L.length&&T.push(h),T}(U,B,I),$=function et(L,I){let D=0;for(let B=0;B<L.length;B++){const{width:G}=L[B];D=Math.max(G,D)}const U=L[0].yMin;return{x:0,y:U,height:L[L.length-1].yMax+I.lineHeight*(L.length-1)+("underline"===I.decoration?u:0)-U,width:D}}(G,I),tt=(0,j.xy)(I.horizontalAlignment),lt=(0,j.UD)(I.verticalAlignment),q=lt===j.gy.Baseline?1:0,ct=(1-q)*-$.y+$.height/2*(q?0:lt-1)+(q?1:0)*-_;for(let _t=0;_t<G.length;_t++){const{start:mt,end:at,width:Z}=G[_t];let h=-1*(tt+1)*(Z/2)-r;const p=_t*I.lineHeight+ct-r;G[_t].startX=h,G[_t].startY=p;for(let b=mt;b<=at;b++){const C=U[b];if(K(C.code))continue;const y=new o(h+C.metrics.left,p-C.metrics.top,C,D);h+=C.metrics.advance,T.push(y)}}return new w(T,G,I)}}}]);