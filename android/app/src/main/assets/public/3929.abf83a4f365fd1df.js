"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3929],{15590:(J,O,_)=>{_.d(O,{A:()=>f});class f{constructor(v){this.size=0,this._start=0,this.maxSize=v,this._buffer=new Array(v)}get entries(){return this._buffer}enqueue(v){if(this.size===this.maxSize){const h=this._buffer[this._start];return this._buffer[this._start]=v,this._start=(this._start+1)%this.maxSize,h}return this._buffer[(this._start+this.size++)%this.maxSize]=v,null}dequeue(){if(0===this.size)return null;const v=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,v}peek(){return 0===this.size?null:this._buffer[this._start]}find(v){if(0===this.size)return null;for(const h of this._buffer)if(null!=h&&v(h))return h;return null}clear(v){let h=this.dequeue();for(;null!=h;)v&&v(h),h=this.dequeue()}}},86468:(J,O,_)=>{_.d(O,{T:()=>v,U:()=>d});var f=_(69287);function d(E,o,t=0){const c=(0,f.qE)(E,0,m);for(let r=0;r<4;r++)o[t+r]=Math.floor(256*w(c*h[r]))}function v(E,o=0){let t=0;for(let c=0;c<4;c++)t+=E[o+c]*D[c];return t}const h=[1,256,65536,16777216],D=[1/256,1/65536,1/16777216,1/4294967296],m=v(new Uint8ClampedArray([255,255,255,255]));function w(E){return E-Math.floor(E)}},55912:(J,O,_)=>{_.d(O,{A:()=>w});var v,E,f=_(3248),d=_(61591);(E=v||(v={}))[E.varint=0]="varint",E[E.fixed64=1]="fixed64",E[E.delimited=2]="delimited",E[E.fixed32=5]="fixed32",E[E.unknown=99]="unknown";const h=4294967296,D=new TextDecoder("utf-8"),m=(0,f.A)("safari")||(0,f.A)("ios")?6:(0,f.A)("ff")?12:32;class w{constructor(o,t,c=0,r=(o?o.byteLength:0)){this._tag=0,this._dataType=v.unknown,this._init(o,t,c,r)}_init(o,t,c,r){this._data=o,this._dataView=t,this._pos=c,this._end=r}asUnsafe(){return this}clone(){return new w(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(o){this._pos=o}nextTag(o){for(;;){if(this._pos===this._end)return!1;const t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!o||o===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const o=this._decodeVarint();return this._tag=o>>3,this._dataType=7&o,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let o=4294967295;if(o=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128||(o=(o|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128)||(o=(o|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128)||(o=(o|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128)||(o=(o|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128))return o;throw new Error("Varint overflow")}getUInt64(){return this._decodeVarint()}getSInt32(){const o=this.getUInt32();return o>>>1^-(1&o)}getSInt64(){return this._decodeSVarint()}getBool(){const o=0!==this._data[this._pos];return this._skip(1),o}getEnum(){return this._decodeVarint()}getFixed64(){const o=this._dataView,t=this._pos,c=o.getUint32(t,!0)+o.getUint32(t+4,!0)*h;return this._skip(8),c}getSFixed64(){const o=this._dataView,t=this._pos,c=o.getUint32(t,!0)+o.getInt32(t+4,!0)*h;return this._skip(8),c}getDouble(){const o=this._dataView.getFloat64(this._pos,!0);return this._skip(8),o}getFixed32(){const o=this._dataView.getUint32(this._pos,!0);return this._skip(4),o}getSFixed32(){const o=this._dataView.getInt32(this._pos,!0);return this._skip(4),o}getFloat(){const o=this._dataView.getFloat32(this._pos,!0);return this._skip(4),o}getString(){const o=this._getLength(),t=this._pos,c=this._toString(this._data,t,t+o);return this._skip(o),c}getBytes(){const o=this._getLength(),t=this._pos,c=this._toBytes(this._data,t,t+o);return this._skip(o),c}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(o,t,c,r){const p=this.getMessage(),R=o(p,t,c,r);return p.release(),R}processMessage(o){const t=this.getMessage(),c=o(t);return t.release(),c}getMessage(){const o=this._getLength(),t=w.pool.acquire();return t._init(this._data,this._dataView,this._pos,this._pos+o),this._skip(o),t}release(){w.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case v.varint:this._decodeVarint();break;case v.fixed64:this._skip(8);break;case v.delimited:this._skip(this._getLength());break;case v.fixed32:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(o){this._skip(o)}_skip(o){if(this._pos+o>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=o}_decodeVarint(){const o=this._data;let t=this._pos,c=0,r=0;if(this._end-t>=10)do{if(r=o[t++],c|=127&r,!(128&r&&(r=o[t++],c|=(127&r)<<7,128&r)&&(r=o[t++],c|=(127&r)<<14,128&r)&&(r=o[t++],c|=(127&r)<<21,128&r)&&(r=o[t++],c+=268435456*(127&r),128&r)&&(r=o[t++],c+=34359738368*(127&r),128&r)&&(r=o[t++],c+=4398046511104*(127&r),128&r)&&(r=o[t++],c+=562949953421312*(127&r),128&r)&&(r=o[t++],c+=72057594037927940*(127&r),128&r)&&(r=o[t++],c+=0x8000000000000000*(127&r),128&r)))break;throw new Error("Varint too long!")}while(0);else{let p=1;for(;t!==this._end&&(r=o[t],128&r);)++t,c+=(127&r)*p,p*=128;if(t===this._end)throw new Error("Varint overrun!");++t,c+=r*p}return this._pos=t,c}_decodeSVarint(){const o=this._data;let t,c=0,r=0;const p=1&o[this._pos];if(r=o[this._pos++],c|=127&r,!(128&r&&(r=o[this._pos++],c|=(127&r)<<7,128&r)&&(r=o[this._pos++],c|=(127&r)<<14,128&r)&&(r=o[this._pos++],c|=(127&r)<<21,128&r)&&(r=o[this._pos++],c+=268435456*(127&r),128&r)&&(r=o[this._pos++],c+=34359738368*(127&r),128&r)&&(r=o[this._pos++],c+=4398046511104*(127&r),128&r)))return p?-(c+1)/2:c/2;if(t=BigInt(c),r=o[this._pos++],t+=0x2000000000000n*BigInt(127&r),!(128&r&&(r=o[this._pos++],t+=0x100000000000000n*BigInt(127&r),128&r)&&(r=o[this._pos++],t+=0x8000000000000000n*BigInt(127&r),128&r)))return Number(p?-(t+1n)/2n:t/2n);throw new Error("Varint too long!")}_getLength(){if(this._dataType!==v.delimited)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(o,t,c){if((c=Math.min(this._end,c))-t>m){const R=o.subarray(t,c);return D.decode(R)}let r="",p="";for(let R=t;R<c;++R){const W=o[R];128&W?p+="%"+W.toString(16):(r+=decodeURIComponent(p)+String.fromCharCode(W),p="")}return p.length&&(r+=decodeURIComponent(p)),r}_toBytes(o,t,c){return c=Math.min(this._end,c),new Uint8Array(o.buffer,t,c-t)}}w.pool=new d.A(w,void 0,E=>{E._data=null,E._dataView=null})},67399:(J,O,_)=>{_.d(O,{C:()=>Y});var f=_(8189),d=_(98877),h=(_(5922),_(3248)),m=(_(35150),_(85211)),E=(_(40707),_(76576)),o=_(47669),t=_(69287),c=_(42178);class nt{constructor(M,y,A){this._debugMap=new Map,this._width=M*A,this._height=y*A,this._pixelRatio=A;const x=Math.ceil(this._width/1),S=Math.ceil(this._height/1);this._cols=x,this._rows=S,this._cells=c.y.create(x*S)}insertMetrics(M){this._markMetrics(M)}hasCollision(M){let y=0;for(const{computedX:A,computedY:x,width:S,height:I}of M.bounds)switch(this._collide(A,x,(S+o.C2)*this._pixelRatio,(I+o.C2)*this._pixelRatio)){case 2:return 2;case 1:y++}return y===M.bounds.length?1:0}getCellId(M,y){return M+y*this._cols}has(M){return this._cells.has(M)}hasRange(M,y){return this._cells.hasRange(M,y)}set(M){this._cells.set(M)}setRange(M,y){this._cells.setRange(M,y)}_collide(M,y,A,x){const S=M-A/2,I=y-x/2,C=S+A,T=I+x;if(C<0||T<0||S>this._width||I>this._height)return 1;const z=(0,t.qE)(Math.floor(S/1),0,this._cols),B=(0,t.qE)(Math.floor(I/1),0,this._rows),G=(0,t.qE)(Math.ceil(C/1),0,this._cols),N=(0,t.qE)(Math.ceil(T/1),0,this._rows);for(let k=B;k<=N;k++)for(let U=z;U<=G;U++){const Q=this.getCellId(U,k);if(this.has(Q))return 2}return 0}_mark(M,y,A,x,S){const I=M-A/2,C=y-x/2,T=I+A,z=C+x,B=(0,t.qE)(Math.floor(I/1),0,this._cols),G=(0,t.qE)(Math.floor(C/1),0,this._rows),N=(0,t.qE)(Math.ceil(T/1),0,this._cols),k=(0,t.qE)(Math.ceil(z/1),0,this._rows);for(let U=G;U<=k;U++)for(let Q=B;Q<=N;Q++){const st=this.getCellId(Q,U);this._debugMap.set(st,S),this.set(st)}return!1}_markMetrics(M){for(const{computedX:y,computedY:A,width:x,height:S}of M.bounds)this._mark(y,A,(x+o.C2)*this._pixelRatio,(S+o.C2)*this._pixelRatio,M.entityTexel)}}const q=255;function j(P,M){const y=P.children.slice();y.sort((A,x)=>A.tileAge-x.tileAge),y.forEach(A=>{null!=A.labelMetrics&&A.isReady&&M(A,A.labelMetrics)})}function tt(P,M){return(!P.minScale||P.minScale>=M)&&(!P.maxScale||P.maxScale<=M)}class rt{run(M,y,A,x){const S=[];for(let C=M.length-1;C>=0;C--){var I;const T=M[C];null!==(I=T.labelingCollisionInfos)&&void 0!==I&&I.length&&S.push(...T.labelingCollisionInfos)}(0,h.A)("esri-2d-update-debug")&&S.length&&console.debug("CollisionEngine.run"),this._transformMetrics(S),this._runCollision(S,y,A,x);for(const C of S)C.container.requestRender()}_runCollision(M,y,A,x){const[S,I]=y.state.size,C=new nt(S,I,y.pixelRatio);for(const{container:T,deconflictionEnabled:z,visible:B}of M){const G=T.attributeView;z?B?(this._prepare(T),this._collideVisible(C,T,A,x),this._collideInvisible(C,T)):j(T,(N,k)=>{for(const U of k)G.setLabelMinZoom(U.entityTexel,q)}):j(T,(N,k)=>{for(const U of k)tt(U,A)?(G.setLabelMinZoom(U.entityTexel,0),B&&C.insertMetrics(U)):G.setLabelMinZoom(U.entityTexel,254)})}}_isFiltered(M,y,A){const x=y.getFilterFlags(M);return!((!A.hasFilter||x&o.LY)&&(null==A.featureEffect||A.featureEffect.excludedLabelsVisible||x&o.g0))}_prepare(M){const y=M.attributeView,A=new Set;j(M,(x,S)=>{for(const I of S){const C=I.entityTexel;if(!A.has(C)){if(A.add(C),this._isFiltered(C,y,M.layerView)){y.setLabelMinZoom(C,254);continue}0!==y.getLabelMinZoom(C)?y.setLabelMinZoom(C,q):y.setLabelMinZoom(C,0)}}})}_collideVisible(M,y,A,x){const S=y.attributeView,I=new Set;j(y,(C,T)=>{for(let z=0;z<T.length;z++){const B=T[z].entityTexel;if(I.has(B))continue;if(C.key.level!==x){S.setLabelMinZoom(B,254),I.add(B);continue}if(!tt(T[z],A)){S.setLabelMinZoom(B,254),I.add(B);continue}if(0!==S.getLabelMinZoom(B)){I.add(B);continue}let G=!1,N=!0;const k=z;let U=z;for(;U<T.length;U++){const Q=T[U];if(Q.entityTexel!==B)break;if(!G)switch(M.hasCollision(Q)){case 1:break;case 2:G=!0,N=!1;break;case 0:N=!1}}if(!G)for(let Q=k;Q<U;Q++)M.insertMetrics(T[Q]);z=U-1,N||(I.add(B),S.setLabelMinZoom(B,G?254:0))}})}_collideInvisible(M,y){const A=y.attributeView,x=new Set;j(y,(S,I)=>{for(let C=0;C<I.length;C++){const T=I[C].entityTexel;if(x.has(T))continue;if(A.getLabelMinZoom(T)!==q){x.add(T);continue}let z=!1,B=!0;const G=C;let N=C;for(;N<I.length;N++){const k=I[N];if(k.entityTexel!==T)break;if(!z)switch(M.hasCollision(k)){case 1:break;case 2:z=!0,B=!1;break;case 0:B=!1}}if(!z)for(let k=G;k<N;k++)M.insertMetrics(I[k]);C=N-1,B||(x.add(T),A.setLabelMinZoom(T,z?q:0))}})}_transformMetrics(M){for(const{container:y,geometryType:A,vvEvaluators:x}of M)j(y,(S,I)=>{const C=y.attributeView,T=S.transforms.labelMat2d;T[4]=Math.round(T[4]),T[5]=Math.round(T[5]);const z="polyline"===A;for(const N of I){var B,G;const{entityTexel:k,anchorX:U,anchorY:Q}=N;let st=null!==(B=null===(G=N.referenceBounds)||void 0===G?void 0:G.size)&&void 0!==B?B:0;const ut=x[0];if(null!=ut){const V=ut(C.getVVSize(k));st=isNaN(V)||null==V||V===1/0?st:V}const a=N.directionX*(st/2),b=N.directionY*(st/2);for(const V of N.bounds){let K=U,ot=Q;if(z){let H=K+V.x+a,at=ot+V.y+b;H=T[0]*H+T[2]*at+T[4],at=T[1]*H+T[3]*at+T[5],V.computedX=Math.floor(H),V.computedY=Math.floor(at)}else{K=T[0]*U+T[2]*Q+T[4],ot=T[1]*U+T[3]*Q+T[5];const at=ot+V.y+b;V.computedX=K+V.x+a,V.computedY=at}}}})}}let Y=class extends d.A{constructor(P){super(P),this._lastUpdate=0,this.collisionEngine=new rt,this.lastUpdateId=-1,this.updateRequested=!1,this.view=null}get updating(){return(0,h.A)("esri-2d-log-updating")&&console.log(`Updating LabelManager ${this.updateRequested}:\n-> updateRequested: ${this.updateRequested}`),this.updateRequested}update(P){const M=performance.now();M-this._lastUpdate>=32?(this._lastUpdate=M,this.doUpdate(P)):this.requestUpdate()}viewChange(){this.requestUpdate()}requestUpdate(){var P;this.updateRequested||(this.updateRequested=!0,null===(P=this.view)||void 0===P||P.requestUpdate())}processUpdate(P){this.updateRequested&&(this.updateRequested=!1,this.update(P))}doUpdate(P){const M=this.view;if(M)try{const y=P.state.scale,A=M.featuresTilingScheme.getClosestInfoForScale(y).level;this.collisionEngine.run(M.allLayerViews.items,P,y,A)}catch{}}};(0,f._)([(0,m.MZ)()],Y.prototype,"updateRequested",void 0),(0,f._)([(0,m.MZ)()],Y.prototype,"updating",null),(0,f._)([(0,m.MZ)()],Y.prototype,"view",void 0),Y=(0,f._)([(0,E.$)("esri.views.2d.LabelManager")],Y)},20904:(J,O,_)=>{var f,d,v,h;_.d(O,{$q:()=>v,NP:()=>f,kh:()=>d}),(h=f||(f={}))[h.FILL=1]="FILL",h[h.LINE=2]="LINE",h[h.SYMBOL=3]="SYMBOL",h[h.CIRCLE=4]="CIRCLE",function(h){h[h.BACKGROUND=0]="BACKGROUND",h[h.FILL=1]="FILL",h[h.OUTLINE=2]="OUTLINE",h[h.LINE=3]="LINE",h[h.ICON=4]="ICON",h[h.CIRCLE=5]="CIRCLE",h[h.TEXT=6]="TEXT",h[h.TILEINFO=7]="TILEINFO"}(d||(d={})),function(h){h[h.PAINTER_CHANGED=0]="PAINTER_CHANGED",h[h.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",h[h.LAYER_CHANGED=2]="LAYER_CHANGED",h[h.LAYER_REMOVED=3]="LAYER_REMOVED",h[h.SPRITES_CHANGED=4]="SPRITES_CHANGED"}(v||(v={}))},38730:(J,O,_)=>{_.d(O,{U:()=>m});var f=_(15590),d=_(42425),v=_(3248),h=_(54949);const D=(0,v.A)("esri-2d-profiler");class m{constructor(E,o){if(this._events=new d.A,this._entries=new Map,this._timings=new f.A(10),this._currentContainer=null,this._currentPass=null,this._currentBrush=null,this._currentSummary=null,!D)return;this._ext=(0,h._R)(E.gl,{}),this._debugOutput=o;const t=E.gl;if(!this.enableCommandLogging)return;let c;for(c in t)if("function"==typeof t[c]){const r=t[c],p=c.includes("draw");t[c]=(...R)=>(this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:c,args:R,isDrawCommand:p}),this._currentSummary&&(this._currentSummary.commands++,p&&this._currentSummary.drawCommands++),r.apply(t,R))}}get enableCommandLogging(){return!("object"==typeof D&&D.disableCommands)}recordContainerStart(E){D&&(this._currentContainer=E)}recordContainerEnd(){D&&(this._currentContainer=null)}recordPassStart(E){D&&(this._currentPass=E,this._initSummary())}recordPassEnd(){D&&(this._currentPass=null,this._emitSummary())}recordBrushStart(E){D&&(this._currentBrush=E)}recordBrushEnd(){D&&(this._currentBrush=null)}recordStart(E){if(D&&null!=this._ext){if(this._entries.has(E)){const t=this._entries.get(E),c=this._ext.resultAvailable(t.query),r=this._ext.disjoint();if(c&&!r){const p=this._ext.getResult(t.query)/1e6;let R=0;if(null!=this._timings.enqueue(p)){const et=this._timings.entries,q=et.length;let it=0;for(const j of et)it+=j;R=it/q}const W=p.toFixed(2),nt=R?R.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${E}, ${W} ms (${nt} last 10 avg)\n${t.commandsLen} Commands (${t.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(t.summaries),console.log("Commands: ",t.commands),console.groupEnd()):console.log(`Frame report for ${E}, ${W} ms (${nt} last 10 avg)`),this._debugOutput.innerHTML=`${W} (${nt})`}for(const p of t.handles)p.remove();this._ext.deleteQuery(t.query),this._entries.delete(E)}const o={name:E,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(o.handles.push(this._events.on("command",t=>{o.commandsLen++,o.commands.push(t),t.isDrawCommand&&o.drawCommands++})),o.handles.push(this._events.on("summary",t=>{o.summaries.push(t)}))),this._ext.beginTimeElapsed(o.query),this._entries.set(E,o)}}recordEnd(E){D&&null!=this._ext&&this._entries.has(E)&&this._ext.endTimeElapsed()}_initSummary(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})}_emitSummary(){this.enableCommandLogging&&this._currentSummary&&this._events.emit("summary",this._currentSummary)}}},6115:(J,O,_)=>{_.d(O,{J:()=>d});var f=_(73539);const d={shaders:{vertexShader:(0,f.Q)("bitBlit/bitBlit.vert"),fragmentShader:(0,f.Q)("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",0],["a_tex",1]])}},63367:(J,O,_)=>{_.d(O,{G:()=>v,Z:()=>d});var f=_(73539);const d={shaders:{vertexShader:(0,f.Q)("highlight/textured.vert"),fragmentShader:(0,f.Q)("highlight/highlight.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])},v={shaders:{vertexShader:(0,f.Q)("highlight/textured.vert"),fragmentShader:(0,f.Q)("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])}},43431:(J,O,_)=>{_.d(O,{h:()=>h,j:()=>v});var f=_(73539),d=_(80831);const v={shaders:{vertexShader:(0,f.Q)("magnifier/magnifier.vert"),fragmentShader:(0,f.Q)("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};function h(D){return(0,d.r)(D,v)}},64559:(J,O,_)=>{_.d(O,{P:()=>d});var f=_(73539);const d={shaders:{vertexShader:(0,f.Q)("stencil/stencil.vert"),fragmentShader:(0,f.Q)("stencil/stencil.frag")},attributes:new Map([["a_pos",0]])}},18800:(J,O,_)=>{_.d(O,{A:()=>at});var f=_(10467),d=_(8189),v=_(20351),h=_(98877),D=_(11432),m=_(85211),t=(_(3248),_(35150),_(40707),_(76576)),c=_(13303),r=_(6126),p=_(67685),R=_(21765);const W="esri-zoom-box",nt={container:`${W}__container`,overlay:`${W}__overlay`,background:`${W}__overlay-background`,box:`${W}__outline`};let q=class extends h.A{constructor(s){super(s),this._container=null,this._overlay=null,this._backgroundShape=null,this._boxShape=null,this._box={x:0,y:0,width:0,height:0},this._rafId=null,this._redraw=this._redraw.bind(this)}destroy(){this.view=null}set view(s){this.removeAllHandles(),this._destroyOverlay(),this._set("view",s),s&&this.addHandles([s.on("drag",["Shift"],e=>this._handleDrag(e,1),R.o.INTERNAL),s.on("drag",["Shift","Ctrl"],e=>this._handleDrag(e,-1),R.o.INTERNAL)])}_start(){this._createContainer(),this._createOverlay(),this.navigation.begin()}_update(s,e,i,l){this._box.x=s,this._box.y=e,this._box.width=i,this._box.height=l,this._rafId||(this._rafId=requestAnimationFrame(this._redraw))}_end(s,e,i,l,g){const L=this.view,Z=L.toMap((0,p.tc)(s+.5*i,e+.5*l));let F=Math.max(i/L.width,l/L.height);-1===g&&(F=1/F),this._destroyOverlay(),this.navigation.end(),L.goTo({center:Z,scale:L.scale*F})}_updateBox(s,e,i,l){const g=this._boxShape;g.setAttributeNS(null,"x",""+s),g.setAttributeNS(null,"y",""+e),g.setAttributeNS(null,"width",""+i),g.setAttributeNS(null,"height",""+l),g.setAttributeNS(null,"class",nt.box)}_updateBackground(s,e,i,l){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(s,e,i,l,this.view.width,this.view.height))}_createContainer(){const s=document.createElement("div");s.className=nt.container,this.view.root.appendChild(s),this._container=s}_createOverlay(){const s=this.view.width,e=this.view.height,i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttributeNS(null,"d","M 0 0 L "+s+" 0 L "+s+" "+e+" L 0 "+e+" Z"),i.setAttributeNS(null,"class",nt.background);const l=document.createElementNS("http://www.w3.org/2000/svg","rect"),g=document.createElementNS("http://www.w3.org/2000/svg","svg");g.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),g.setAttributeNS(null,"class",nt.overlay),g.appendChild(i),g.appendChild(l),this._container.appendChild(g),this._backgroundShape=i,this._boxShape=l,this._overlay=g}_destroyOverlay(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=this._backgroundShape=this._boxShape=this._overlay=null}_toSVGPath(s,e,i,l,g,L){const Z=s+i,F=e+l;return"M 0 0 L "+g+" 0 L "+g+" "+L+" L 0 "+L+" ZM "+s+" "+e+" L "+s+" "+F+" L "+Z+" "+F+" L "+Z+" "+e+" Z"}_handleDrag(s,e){const i=s.x,l=s.y,g=s.origin.x,L=s.origin.y;let Z,F,X,$;switch(i>g?(Z=g,X=i-g):(Z=i,X=g-i),l>L?(F=L,$=l-L):(F=l,$=L-l),s.action){case"start":this._start();break;case"update":this._update(Z,F,X,$);break;case"end":this._end(Z,F,X,$,e)}s.stopPropagation()}_redraw(){if(!this._rafId||(this._rafId=null,!this._overlay))return;const{x:s,y:e,width:i,height:l}=this._box;this._updateBox(s,e,i,l),this._updateBackground(s,e,i,l),this._rafId=requestAnimationFrame(this._redraw)}};(0,d._)([(0,m.MZ)()],q.prototype,"navigation",void 0),(0,d._)([(0,m.MZ)()],q.prototype,"view",null),q=(0,d._)([(0,t.$)("esri.views.2d.navigation.ZoomBox")],q);const it=q;_(21152);var tt=_(48900),rt=_(28714),ht=_(25866);class Y{constructor(e){this._gain=e,this.lastValue=void 0,this.filteredDelta=void 0}update(e){if(this.hasLastValue()){const i=this.computeDelta(e);this._updateDelta(i)}this.lastValue=e}reset(){this.lastValue=void 0,this.filteredDelta=void 0}hasLastValue(){return void 0!==this.lastValue}hasFilteredDelta(){return void 0!==this.filteredDelta}computeDelta(e){return void 0===this.lastValue?NaN:e-this.lastValue}_updateDelta(e){this.filteredDelta=void 0!==this.filteredDelta?(1-this._gain)*this.filteredDelta+this._gain*e:e}}class P{constructor(e,i,l){this._initialVelocity=e,this._stopVelocity=i,this._friction=l,this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}get duration(){return this._duration}isFinished(e){return e>this.duration}get friction(){return this._friction}value(e){return this.valueFromInitialVelocity(this._initialVelocity,e)}valueDelta(e,i){const l=this.value(e);return this.value(e+i)-l}valueFromInitialVelocity(e,i){i=Math.min(i,this.duration);const l=1-this.friction;return e*(l**i-1)/Math.log(l)}}class M extends P{constructor(e,i,l,g,L){super(e,i,l),this._sceneVelocity=g,this.direction=L}value(e){return super.valueFromInitialVelocity(this._sceneVelocity,e)}}class y{constructor(e=300,i=12,l=.84){this._minimumInitialVelocity=e,this._stopVelocity=i,this._friction=l,this.enabled=!0,this._time=new Y(.6),this._screen=[new Y(.4),new Y(.4)],this._scene=[new Y(.6),new Y(.6),new Y(.6)],this._tmpDirection=(0,ht.vt)()}add(e,i,l){if(this.enabled){if(this._time.hasLastValue()&&this._time.computeDelta(l)<.015)return;this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._scene[0].update(i[0]),this._scene[1].update(i[1]),this._scene[2].update(i[2]),this._time.update(l)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._scene[0].reset(),this._scene[1].reset(),this._scene[2].reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;const e=this._screen[0].filteredDelta,i=this._screen[1].filteredDelta,l=null==e||null==i?0:Math.sqrt(e*e+i*i),g=this._time.filteredDelta,L=null==g||null==l?0:l/g;return Math.abs(L)<this._minimumInitialVelocity?null:this.createMomentum(L,this._stopVelocity,this._friction)}createMomentum(e,i,l){var g,L,Z;(0,rt.s)(this._tmpDirection,null!==(g=this._scene[0].filteredDelta)&&void 0!==g?g:0,null!==(L=this._scene[1].filteredDelta)&&void 0!==L?L:0,null!==(Z=this._scene[2].filteredDelta)&&void 0!==Z?Z:0);const F=(0,rt.l)(this._tmpDirection);F>0&&(0,rt.h)(this._tmpDirection,this._tmpDirection,1/F);const X=this._time.filteredDelta;return new M(e,i,l,null==X?0:F/X,this._tmpDirection)}}let A=class extends h.A{constructor(s){super(s),this.animationTime=0,this.momentumEstimator=new y(500,6,.92),this.momentum=null,this.tmpMomentum=(0,ht.vt)(),this.momentumFinished=!1,this.viewpoint=new v.A({targetGeometry:new c.A,scale:0,rotation:0}),this._previousDrag=null,(0,tt.z7)(()=>this.momentumFinished,()=>this.navigation.stop())}begin(s,e){this.navigation.begin(),this.momentumEstimator.reset(),this.addToEstimator(e),this._previousDrag=e}update(s,e){this.addToEstimator(e);let i=e.center.x,l=e.center.y;const g=this._previousDrag;i=g?g.center.x-i:-i,l=g?l-g.center.y:l,s.viewpoint=(0,r.aA)(this.viewpoint,s.viewpoint,[i||0,l||0]),this._previousDrag=e}end(s,e){this.addToEstimator(e),this.momentum=s.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null,this.animationTime=0,this.momentum&&this.onAnimationUpdate(s),this._previousDrag=null,this.navigation.end()}addToEstimator(s){const e=s.center.x,i=s.center.y,l=(0,p.gs)(-e,i),g=(0,ht.fA)(-e,i,0);this.momentumEstimator.add(l,g,.001*s.timestamp)}onAnimationUpdate(s){var e;null===(e=this.navigation.animationManager)||void 0===e||e.animateContinous(s.viewpoint,(i,l)=>{const{momentum:g,animationTime:L,tmpMomentum:Z}=this,F=.001*l;if(!(this.momentumFinished=!g||g.isFinished(L))){const X=g.valueDelta(L,F);(0,rt.h)(Z,g.direction,X),(0,r.aA)(i,i,Z),s.constraints.constrainByGeometry(i)}this.animationTime+=F})}stopMomentumNavigation(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())}};(0,d._)([(0,m.MZ)()],A.prototype,"momentumFinished",void 0),(0,d._)([(0,m.MZ)()],A.prototype,"viewpoint",void 0),(0,d._)([(0,m.MZ)()],A.prototype,"navigation",void 0),A=(0,d._)([(0,t.$)("esri.views.2d.navigation.actions.Pan")],A);const x=A;var S=_(83953),I=_(45475),C=_(69287);class T{constructor(e=2.5,i=.01,l=.95,g=12){this._minimumInitialVelocity=e,this._stopVelocity=i,this._friction=l,this._maxVelocity=g,this.enabled=!0,this.value=new Y(.8),this.time=new Y(.3)}add(e,i){if(this.enabled&&null!=i){if(this.time.hasLastValue()){if(this.time.computeDelta(i)<.01)return;if(this.value.hasFilteredDelta()){const l=this.value.computeDelta(e);this.value.filteredDelta*l<0&&this.value.reset()}}this.time.update(i),this.value.update(e)}}reset(){this.value.reset(),this.time.reset()}evaluateMomentum(){if(!this.enabled||!this.value.hasFilteredDelta()||!this.time.hasFilteredDelta())return null;let e=this.value.filteredDelta/this.time.filteredDelta;return e=(0,C.qE)(e,-this._maxVelocity,this._maxVelocity),Math.abs(e)<this._minimumInitialVelocity?null:this.createMomentum(e,this._stopVelocity,this._friction)}createMomentum(e,i,l){return new P(e,i,l)}}class z extends T{constructor(e=3,i=.01,l=.95,g=12){super(e,i,l,g)}add(e,i){const l=this.value.lastValue;if(null!=l){let g=e-l;for(;g>Math.PI;)g-=2*Math.PI;for(;g<-Math.PI;)g+=2*Math.PI;e=l+g}super.add(e,i)}}class B extends P{constructor(e,i,l){super(e,i,l)}value(e){const i=super.value(e);return Math.exp(i)}valueDelta(e,i){const l=super.value(e),g=super.value(e+i)-l;return Math.exp(g)}}class G extends T{constructor(e=2.5,i=.01,l=.95,g=12){super(e,i,l,g)}add(e,i){super.add(Math.log(e),i)}createMomentum(e,i,l){return new B(e,i,l)}}let N=class extends h.A{constructor(s){super(s),this._animationTime=0,this._momentumFinished=!1,this._previousAngle=0,this._previousRadius=0,this._previousCenter=null,this._rotationMomentumEstimator=new z(.6,.15,.95),this._rotationDirection=1,this._startAngle=0,this._startRadius=0,this._updateTimestamp=null,this._zoomDirection=1,this._zoomMomentumEstimator=new G,this._zoomOnly=null,this.zoomMomentum=null,this.rotateMomentum=null,this.viewpoint=new v.A({targetGeometry:new c.A,scale:0,rotation:0}),this.addHandles((0,tt.z7)(()=>this._momentumFinished,()=>this.navigation.stop()))}begin(s,e){this.navigation.begin(),this._rotationMomentumEstimator.reset(),this._zoomMomentumEstimator.reset(),this._zoomOnly=null,this._previousAngle=this._startAngle=e.angle,this._previousRadius=this._startRadius=e.radius,this._previousCenter=e.center,this._updateTimestamp=null,s.constraints.rotationEnabled&&this.addToRotateEstimator(0,e.timestamp),this.addToZoomEstimator(e,1)}update(s,e){null===this._updateTimestamp&&(this._updateTimestamp=e.timestamp);const i=e.angle,l=e.radius,g=e.center,L=Math.abs(180*(i-this._startAngle)/Math.PI),Z=Math.abs(l-this._startRadius),F=this._startRadius/l;if(this._previousRadius&&this._previousCenter){const X=l/this._previousRadius;let $=180*(i-this._previousAngle)/Math.PI;this._rotationDirection=$>=0?1:-1,this._zoomDirection=X>=1?1:-1,s.constraints.rotationEnabled?(null===this._zoomOnly&&e.timestamp-this._updateTimestamp>200&&(this._zoomOnly=Z-L>0),null===this._zoomOnly||this._zoomOnly?$=0:this.addToRotateEstimator(i-this._startAngle,e.timestamp)):$=0,this.addToZoomEstimator(e,F),this.navigation.setViewpoint([g.x,g.y],1/X,$,[this._previousCenter.x-g.x,g.y-this._previousCenter.y])}this._previousAngle=i,this._previousRadius=l,this._previousCenter=g}end(s){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum(),this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum(),this._animationTime=0,(this.rotateMomentum||this.zoomMomentum)&&this.onAnimationUpdate(s),this.navigation.end()}addToRotateEstimator(s,e){this._rotationMomentumEstimator.add(s,.001*e)}addToZoomEstimator(s,e){this._zoomMomentumEstimator.add(e,.001*s.timestamp)}canZoomIn(s){const i=s.constraints.effectiveMaxScale;return 0===i||s.scale>i}canZoomOut(s){const i=s.constraints.effectiveMinScale;return 0===i||s.scale<i}onAnimationUpdate(s){var e;null===(e=this.navigation.animationManager)||void 0===e||e.animateContinous(s.viewpoint,(i,l)=>{const g=!this.canZoomIn(s)&&this._zoomDirection>1||!this.canZoomOut(s)&&this._zoomDirection<1,L=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime),Z=g||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime),F=.001*l;if(this._momentumFinished=L&&Z,!this._momentumFinished){const X=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,F))*this._rotationDirection*180/Math.PI:0;let $=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,F)):1;const lt=(0,I.vt)(),dt=(0,I.vt)();if(this._previousCenter){(0,S.hZ)(lt,this._previousCenter.x,this._previousCenter.y),(0,r.b8)(dt,s.size,s.padding),(0,S.WQ)(lt,lt,dt);const{constraints:_t,scale:ct}=s,mt=ct*$;$<1&&!_t.canZoomInTo(mt)?($=ct/_t.effectiveMaxScale,this.zoomMomentum=null,this.rotateMomentum=null):$>1&&!_t.canZoomOutTo(mt)&&($=ct/_t.effectiveMinScale,this.zoomMomentum=null,this.rotateMomentum=null),(0,r.WK)(i,s.viewpoint,$,X,lt,s.size),s.constraints.constrainByGeometry(i)}}this._animationTime+=F})}stopMomentumNavigation(){(this.rotateMomentum||this.zoomMomentum)&&(this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop())}};(0,d._)([(0,m.MZ)()],N.prototype,"_momentumFinished",void 0),(0,d._)([(0,m.MZ)()],N.prototype,"viewpoint",void 0),(0,d._)([(0,m.MZ)()],N.prototype,"navigation",void 0),N=(0,d._)([(0,t.$)("esri.views.2d.navigation.actions.Pinch")],N);const k=N,U=(0,I.vt)(),Q=(0,I.vt)();let st=class extends h.A{constructor(s){super(s),this._previousCenter=(0,I.vt)(),this.viewpoint=new v.A({targetGeometry:new c.A,scale:0,rotation:0})}begin(s,e){this.navigation.begin(),(0,S.hZ)(this._previousCenter,e.center.x,e.center.y)}update(s,e){const{state:{size:i,padding:l}}=s;(0,S.hZ)(U,e.center.x,e.center.y),(0,r.iB)(Q,i,l),s.viewpoint=(0,r.tj)(this.viewpoint,s.state.paddedViewState.viewpoint,(0,r.s5)(Q,this._previousCenter,U)),(0,S.C)(this._previousCenter,U)}end(){this.navigation.end()}};(0,d._)([(0,m.MZ)()],st.prototype,"viewpoint",void 0),(0,d._)([(0,m.MZ)()],st.prototype,"navigation",void 0),st=(0,d._)([(0,t.$)("esri.views.2d.actions.Rotate")],st);const ut=st,a=10,V=new v.A({targetGeometry:new c.A}),K=[0,0];let H=class extends h.A{constructor(s){super(s),this._endTimer=null,this._lastEventTimestamp=null,this.animationManager=null,this.interacting=!1}initialize(){this.pan=new x({navigation:this}),this.rotate=new ut({navigation:this}),this.pinch=new k({navigation:this}),this.zoomBox=new it({view:this.view,navigation:this})}destroy(){this.pan=(0,D.pR)(this.pan),this.rotate=(0,D.pR)(this.rotate),this.pinch=(0,D.pR)(this.pinch),this.zoomBox=(0,D.pR)(this.zoomBox),this.animationManager=null}begin(){this.stop(),this._set("interacting",!0)}end(){this._lastEventTimestamp=performance.now(),this._startTimer(250)}zoom(s,e=this._getDefaultAnchor()){var i=this;return(0,f.A)(function*(){if(i.begin(),i.view.constraints.snapToZoom&&i.view.constraints.effectiveLODs)return s<1?i.zoomIn(e):i.zoomOut(e);i.setViewpoint(e,s,0,[0,0])})()}zoomIn(s){var e=this;return(0,f.A)(function*(){const i=e.view,l=i.constraints.snapToNextScale(i.scale);return e._zoomToScale(l,s)})()}zoomOut(s){var e=this;return(0,f.A)(function*(){const i=e.view,l=i.constraints.snapToPreviousScale(i.scale);return e._zoomToScale(l,s)})()}setViewpoint(s,e,i,l){this.begin(),this.view.stateManager.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,s,e,i,l),this.end()}setViewpointImmediate(s,e=0,i=[0,0],l=this._getDefaultAnchor()){this.view.stateManager.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,l,s,e,i)}continousRotateClockwise(){var s;null===(s=this.animationManager)||void 0===s||s.animateContinous(this.view.viewpoint,i=>{(0,r.tj)(i,i,-1)})}continousRotateCounterclockwise(){var s;null===(s=this.animationManager)||void 0===s||s.animateContinous(this.view.viewpoint,i=>{(0,r.tj)(i,i,1)})}resetRotation(){this.view.constraints.rotationEnabled&&(this.view.rotation=0)}continousPanLeft(){this._continuousPan([-a,0])}continousPanRight(){this._continuousPan([a,0])}continousPanUp(){this._continuousPan([0,a])}continousPanDown(){this._continuousPan([0,-a])}continuousPanVector({x:s,y:e}){this._continuousPan([s*a,e*a])}stop(){var s;this.pan.stopMomentumNavigation(),null!==(s=this.animationManager)&&void 0!==s&&s.stop(),this.end(),null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))}_continuousPan(s){var e;null===(e=this.animationManager)||void 0===e||e.animateContinous(this.view.viewpoint,l=>{(0,r.aA)(l,l,s),this.view.constraints.constrainByGeometry(l)})}_startTimer(s){return null!==this._endTimer||(this._endTimer=setTimeout(()=>{var e;this._endTimer=null;const i=performance.now()-(null!==(e=this._lastEventTimestamp)&&void 0!==e?e:0);i<250?this._endTimer=this._startTimer(i):this._set("interacting",!1)},s)),this._endTimer}_getDefaultAnchor(){const{size:s,padding:{left:e,right:i,top:l,bottom:g}}=this.view;return K[0]=.5*(s[0]-i+e),K[1]=.5*(s[1]-g+l),K}_zoomToScale(s,e=this._getDefaultAnchor()){var i=this;return(0,f.A)(function*(){const{view:l}=i,{constraints:g,scale:L,viewpoint:Z,size:F,padding:X}=l,$=g.canZoomInTo(s),lt=g.canZoomOutTo(s);if(!(s<L&&!$||s>L&&!lt))return(0,r.qV)(V,Z,s/L,0,e,F,X),g.constrainByGeometry(V),l.goTo(V,{animate:!0,pickClosestTarget:!1})})()}_scaleRotateTranslateViewpoint(s,e,i,l,g){const{view:L}=this,{size:Z,padding:F,constraints:X,scale:$,viewpoint:lt}=L,dt=$*i,_t=X.canZoomInTo(dt),ct=X.canZoomOutTo(dt);return(i<1&&!_t||i>1&&!ct)&&(i=1),(0,r.aA)(lt,lt,g),(0,r.qV)(s,lt,i,l,e,Z,F),X.constrainByGeometry(s)}};(0,d._)([(0,m.MZ)()],H.prototype,"animationManager",void 0),(0,d._)([(0,m.MZ)({type:Boolean,readOnly:!0})],H.prototype,"interacting",void 0),(0,d._)([(0,m.MZ)()],H.prototype,"pan",void 0),(0,d._)([(0,m.MZ)()],H.prototype,"pinch",void 0),(0,d._)([(0,m.MZ)()],H.prototype,"rotate",void 0),(0,d._)([(0,m.MZ)()],H.prototype,"view",void 0),(0,d._)([(0,m.MZ)()],H.prototype,"zoomBox",void 0),H=(0,d._)([(0,t.$)("esri.views.2d.navigation.MapViewNavigation")],H);const at=H},93093:(J,O,_)=>{_.d(O,{H:()=>v,Y:()=>d});const d=class f{};function v(h,...D){let m="";for(let w=0;w<D.length;w++)m+=h[w]+D[w];return m+=h[h.length-1],m}var h;(h=v||(v={})).int=function D(w){return Math.round(w).toString()},h.float=function m(w){return w.toPrecision(8)}},14356:(J,O,_)=>{_.d(O,{AJ:()=>m,K_:()=>r,V0:()=>h,aB:()=>c,ez:()=>w,xt:()=>o});var f=_(83415),d=_(50915),v=_(41396);const h=(0,v.p3)(d.dn.SRC_ALPHA,d.dn.ONE,d.dn.ONE_MINUS_SRC_ALPHA,d.dn.ONE_MINUS_SRC_ALPHA),D=(0,v.ox)(d.dn.ONE,d.dn.ONE),m=(0,v.ox)(d.dn.ZERO,d.dn.ONE_MINUS_SRC_ALPHA);function w(p){return p===f.y.FrontFace?null:p===f.y.Alpha?m:D}const o=5e5,t={factor:-1,units:-2};function c(p){return p?t:null}function r(p,R=d.MT.LESS){return p===f.y.NONE||p===f.y.FrontFace?R:d.MT.LEQUAL}},83415:(J,O,_)=>{var f,d;_.d(O,{y:()=>f}),(d=f||(f={}))[d.Color=0]="Color",d[d.Alpha=1]="Alpha",d[d.FrontFace=2]="FrontFace",d[d.NONE=3]="NONE",d[d.COUNT=4]="COUNT"},67496:(J,O,_)=>{var f,d,v,h,D,m,w,E,o,t;_.d(O,{Am:()=>h,ID:()=>E,JS:()=>o,Mg:()=>m,dd:()=>D,it:()=>d,s2:()=>f,sf:()=>w}),(t=f||(f={}))[t.None=0]="None",t[t.Front=1]="Front",t[t.Back=2]="Back",t[t.COUNT=3]="COUNT",function(t){t[t.Less=0]="Less",t[t.Lequal=1]="Lequal",t[t.COUNT=2]="COUNT"}(d||(d={})),function(t){t[t.BACKGROUND=0]="BACKGROUND",t[t.UPDATE=1]="UPDATE"}(v||(v={})),function(t){t[t.NOT_LOADED=0]="NOT_LOADED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED"}(h||(h={})),function(t){t[t.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",t[t.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(D||(D={})),function(t){t[t.Highlight=0]="Highlight",t[t.MaskOccludee=1]="MaskOccludee",t[t.COUNT=2]="COUNT"}(m||(m={})),function(t){t[t.Blend=0]="Blend",t[t.Opaque=1]="Opaque",t[t.Mask=2]="Mask",t[t.MaskBlend=3]="MaskBlend",t[t.COUNT=4]="COUNT"}(w||(w={})),function(t){t[t.OFF=0]="OFF",t[t.ON=1]="ON"}(E||(E={})),function(t){t.DDS_ENCODING="image/vnd-ms.dds",t.KTX2_ENCODING="image/ktx2",t.BASIS_ENCODING="image/x.basis"}(o||(o={}))},52274:(J,O,_)=>{_.d(O,{_:()=>d});var f=_(11432);class d{constructor(){this._result=!1}dispose(){this._program=(0,f.WD)(this._program)}get result(){return null!=this._program&&(this._result=this._test(this._program),this.dispose()),this._result}}},54949:(J,O,_)=>{_.d(O,{_R:()=>v});class f{constructor(D,m,w,E,o,t,c,r,p){this.createQuery=D,this.deleteQuery=m,this.resultAvailable=w,this.getResult=E,this.disjoint=o,this.beginTimeElapsed=t,this.endTimeElapsed=c,this.createTimestamp=r,this.timestampBits=p}}let d=!1;function v(h,D){if(D.disjointTimerQuery)return null;let m=h.getExtension("EXT_disjoint_timer_query_webgl2");return m?new f(()=>h.createQuery(),w=>{h.deleteQuery(w),d=!1},w=>h.getQueryParameter(w,h.QUERY_RESULT_AVAILABLE),w=>h.getQueryParameter(w,h.QUERY_RESULT),()=>h.getParameter(m.GPU_DISJOINT_EXT),w=>{d||(d=!0,h.beginQuery(m.TIME_ELAPSED_EXT,w))},()=>{h.endQuery(m.TIME_ELAPSED_EXT),d=!1},w=>m.queryCounterEXT(w,m.TIMESTAMP_EXT),()=>h.getQuery(m.TIMESTAMP_EXT,m.QUERY_COUNTER_BITS_EXT)):(m=h.getExtension("EXT_disjoint_timer_query"),m?new f(()=>m.createQueryEXT(),w=>{m.deleteQueryEXT(w),d=!1},w=>m.getQueryObjectEXT(w,m.QUERY_RESULT_AVAILABLE_EXT),w=>m.getQueryObjectEXT(w,m.QUERY_RESULT_EXT),()=>h.getParameter(m.GPU_DISJOINT_EXT),w=>{d||(d=!0,m.beginQueryEXT(m.TIME_ELAPSED_EXT,w))},()=>{m.endQueryEXT(m.TIME_ELAPSED_EXT),d=!1},w=>m.queryCounterEXT(w,m.TIMESTAMP_EXT),()=>m.getQueryEXT(m.TIMESTAMP_EXT,m.QUERY_COUNTER_BITS_EXT)):null)}},41396:(J,O,_)=>{_.d(O,{Ey:()=>it,Ms:()=>ut,Xt:()=>w,kn:()=>E,ox:()=>v,p3:()=>h,wE:()=>o});var f=_(67496),d=_(50915);function v(a,b,V=d.Tb.ADD,K=[0,0,0,0]){return{srcRgb:a,srcAlpha:a,dstRgb:b,dstAlpha:b,opRgb:V,opAlpha:V,color:{r:K[0],g:K[1],b:K[2],a:K[3]}}}function h(a,b,V,K,ot=d.Tb.ADD,H=d.Tb.ADD,at=[0,0,0,0]){return{srcRgb:a,srcAlpha:b,dstRgb:V,dstAlpha:K,opRgb:ot,opAlpha:H,color:{r:at[0],g:at[1],b:at[2],a:at[3]}}}const D={face:d.Y7.BACK,mode:d.Ac.CCW},m={face:d.Y7.FRONT,mode:d.Ac.CCW},w=a=>a===f.s2.Back?D:a===f.s2.Front?m:null,E={zNear:0,zFar:1},o={r:!0,g:!0,b:!0,a:!0};function t(a){return rt.intern(a)}function c(a){return Y.intern(a)}function r(a){return M.intern(a)}function p(a){return A.intern(a)}function R(a){return S.intern(a)}function W(a){return C.intern(a)}function nt(a){return z.intern(a)}function et(a){return G.intern(a)}function q(a){return k.intern(a)}function it(a){return Q.intern(a)}class j{constructor(b,V){this._makeKey=b,this._makeRef=V,this._interns=new Map}intern(b){var V;if(!b)return null;const K=this._makeKey(b),ot=this._interns;return ot.has(K)||ot.set(K,this._makeRef(b)),null!==(V=ot.get(K))&&void 0!==V?V:null}}function tt(a){return"["+a.join(",")+"]"}const rt=new j(ht,a=>({__tag:"Blending",...a}));function ht(a){return a?tt([a.srcRgb,a.srcAlpha,a.dstRgb,a.dstAlpha,a.opRgb,a.opAlpha,a.color.r,a.color.g,a.color.b,a.color.a]):null}const Y=new j(P,a=>({__tag:"Culling",...a}));function P(a){return a?tt([a.face,a.mode]):null}const M=new j(y,a=>({__tag:"PolygonOffset",...a}));function y(a){return a?tt([a.factor,a.units]):null}const A=new j(x,a=>({__tag:"DepthTest",...a}));function x(a){return a?tt([a.func]):null}const S=new j(I,a=>({__tag:"StencilTest",...a}));function I(a){return a?tt([a.function.func,a.function.ref,a.function.mask,a.operation.fail,a.operation.zFail,a.operation.zPass]):null}const C=new j(T,a=>({__tag:"DepthWrite",...a}));function T(a){return a?tt([a.zNear,a.zFar]):null}const z=new j(B,a=>({__tag:"ColorWrite",...a}));function B(a){return a?tt([a.r,a.g,a.b,a.a]):null}const G=new j(N,a=>({__tag:"StencilWrite",...a}));function N(a){return a?tt([a.mask]):null}const k=new j(U,a=>({__tag:"DrawBuffers",...a}));function U(a){return a?tt(a.buffers):null}const Q=new j(function st(a){return a?tt([ht(a.blending),P(a.culling),y(a.polygonOffset),x(a.depthTest),I(a.stencilTest),T(a.depthWrite),B(a.colorWrite),N(a.stencilWrite),U(a.drawBuffers)]):null},a=>({blending:t(a.blending),culling:c(a.culling),polygonOffset:r(a.polygonOffset),depthTest:p(a.depthTest),stencilTest:R(a.stencilTest),depthWrite:W(a.depthWrite),colorWrite:nt(a.colorWrite),stencilWrite:et(a.stencilWrite),drawBuffers:q(a.drawBuffers)}));class ut{constructor(b){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._drawBuffersInvalid=!0,this._stateSetters=b}setPipeline(b){(this._pipelineInvalid||b!==this._pipeline)&&(this._setBlending(b.blending),this._setCulling(b.culling),this._setPolygonOffset(b.polygonOffset),this._setDepthTest(b.depthTest),this._setStencilTest(b.stencilTest),this._setDepthWrite(b.depthWrite),this._setColorWrite(b.colorWrite),this._setStencilWrite(b.stencilWrite),this._setDrawBuffers(b.drawBuffers),this._pipeline=b),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDrawBuffers(){this._drawBuffersInvalid=!0,this._pipelineInvalid=!0}_setBlending(b){this._blending=this._setSubState(b,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}_setCulling(b){this._culling=this._setSubState(b,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}_setPolygonOffset(b){this._polygonOffset=this._setSubState(b,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}_setDepthTest(b){this._depthTest=this._setSubState(b,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}_setStencilTest(b){this._stencilTest=this._setSubState(b,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}_setDepthWrite(b){this._depthWrite=this._setSubState(b,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}_setColorWrite(b){this._colorWrite=this._setSubState(b,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}_setStencilWrite(b){this._stencilWrite=this._setSubState(b,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}_setDrawBuffers(b){this._drawBuffers=this._setSubState(b,this._drawBuffers,this._drawBuffersInvalid,this._stateSetters.setDrawBuffers),this._drawBuffersInvalid=!1}_setSubState(b,V,K,ot){return(K||b!==V)&&(ot(b),this._pipelineInvalid=!0),b}}},20047:(J,O,_)=>{_.d(O,{H:()=>o});var f=_(9599),d=_(32788),v=_(50915),h=_(79061),D=_(26136),m=_(4931),w=_(45513),E=_(52274);class o extends E._{constructor(r){super(),this._rctx=r,this._program=r.programCache.acquire("\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv = a_pos;\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ","\n    precision highp float;\n\n    varying vec2 v_uv;\n\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor = texture2D(u_texture, v_uv);\n    }\n    ",new Map([["a_pos",0]]))}dispose(){super.dispose()}_test(r){const p=this._rctx;if(!p.gl)return r.dispose(),!0;const R=new m.R(1);R.wrapMode=v.pF.CLAMP_TO_EDGE,R.samplingMode=v.Cj.NEAREST;const W=new h.H(p,R),nt=d.g.createVertex(p,v._U.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),et=new w.Z(p,new Map([["a_pos",0]]),f.VS,{geometry:nt}),q=new m.R;q.samplingMode=v.Cj.LINEAR,q.wrapMode=v.pF.CLAMP_TO_EDGE;const it=new D.g(p,q,t);p.useProgram(r),p.bindTexture(it,0),r.setUniform1i("u_texture",0);const j=p.getBoundFramebufferObject(),{x:tt,y:rt,width:ht,height:Y}=p.getViewport();p.bindFramebuffer(W),p.setViewport(0,0,1,1),p.setClearColor(0,0,0,0),p.setBlendingEnabled(!1),p.clearSafe(v.hn.COLOR_BUFFER_BIT),p.bindVAO(et),p.drawArrays(v.WR.TRIANGLE_STRIP,0,4);const P=new Uint8Array(4);return W.readPixels(0,0,1,1,v.Ab.RGBA,v.ld.UNSIGNED_BYTE,P),et.dispose(),W.dispose(),it.dispose(),p.setViewport(tt,rt,ht,Y),p.bindFramebuffer(j),255!==P[0]}}const t=new Image;t.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",t.width=5,t.height=5,t.decode()}}]);