"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1365,93,9927],{99980:(z,Z,r)=>{r.d(Z,{A:()=>D});var y=r(8189),h=r(90660),$=r(71065),R=r(97442),G=r(85211),O=(r(3248),r(35150),r(40707),r(15463)),A=r(76576),U=r(26957);let M=class extends((0,h.O)($.oY)){constructor(S){super(S),this.unit="milliseconds",this.value=0}toMilliseconds(){return(0,R.t)(this.value,this.unit,"milliseconds")}};(0,y._)([(0,O.e)(U.j,{nonNullable:!0})],M.prototype,"unit",void 0),(0,y._)([(0,G.MZ)({type:Number,json:{write:!0},nonNullable:!0})],M.prototype,"value",void 0),M=(0,y._)([(0,A.$)("esri.TimeInterval")],M);const D=M},55144:(z,Z,r)=>{r.d(Z,{T:()=>y,d:()=>I});const y={Base64:0,Hex:1,String:2,Raw:3},h=8,$=(1<<h)-1;function R(d,v){const o=(65535&d)+(65535&v);return(d>>16)+(v>>16)+(o>>16)<<16|65535&o}function A(d,v,o,i,n,p){return R(function O(d,v){return d<<v|d>>>32-v}(R(R(v,d),R(i,p)),n),o)}function U(d,v,o,i,n,p,_){return A(v&o|~v&i,d,v,n,p,_)}function M(d,v,o,i,n,p,_){return A(v&i|o&~i,d,v,n,p,_)}function D(d,v,o,i,n,p,_){return A(v^o^i,d,v,n,p,_)}function S(d,v,o,i,n,p,_){return A(o^(v|~i),d,v,n,p,_)}function I(d,v=y.Hex){const o=v||y.Base64,i=function j(d,v){d[v>>5]|=128<<v%32,d[14+(v+64>>>9<<4)]=v;let o=1732584193,i=-271733879,n=-1732584194,p=271733878;for(let _=0;_<d.length;_+=16){const E=o,X=i,N=n,F=p;o=U(o,i,n,p,d[_],7,-680876936),p=U(p,o,i,n,d[_+1],12,-389564586),n=U(n,p,o,i,d[_+2],17,606105819),i=U(i,n,p,o,d[_+3],22,-1044525330),o=U(o,i,n,p,d[_+4],7,-176418897),p=U(p,o,i,n,d[_+5],12,1200080426),n=U(n,p,o,i,d[_+6],17,-1473231341),i=U(i,n,p,o,d[_+7],22,-45705983),o=U(o,i,n,p,d[_+8],7,1770035416),p=U(p,o,i,n,d[_+9],12,-1958414417),n=U(n,p,o,i,d[_+10],17,-42063),i=U(i,n,p,o,d[_+11],22,-1990404162),o=U(o,i,n,p,d[_+12],7,1804603682),p=U(p,o,i,n,d[_+13],12,-40341101),n=U(n,p,o,i,d[_+14],17,-1502002290),i=U(i,n,p,o,d[_+15],22,1236535329),o=M(o,i,n,p,d[_+1],5,-165796510),p=M(p,o,i,n,d[_+6],9,-1069501632),n=M(n,p,o,i,d[_+11],14,643717713),i=M(i,n,p,o,d[_],20,-373897302),o=M(o,i,n,p,d[_+5],5,-701558691),p=M(p,o,i,n,d[_+10],9,38016083),n=M(n,p,o,i,d[_+15],14,-660478335),i=M(i,n,p,o,d[_+4],20,-405537848),o=M(o,i,n,p,d[_+9],5,568446438),p=M(p,o,i,n,d[_+14],9,-1019803690),n=M(n,p,o,i,d[_+3],14,-187363961),i=M(i,n,p,o,d[_+8],20,1163531501),o=M(o,i,n,p,d[_+13],5,-1444681467),p=M(p,o,i,n,d[_+2],9,-51403784),n=M(n,p,o,i,d[_+7],14,1735328473),i=M(i,n,p,o,d[_+12],20,-1926607734),o=D(o,i,n,p,d[_+5],4,-378558),p=D(p,o,i,n,d[_+8],11,-2022574463),n=D(n,p,o,i,d[_+11],16,1839030562),i=D(i,n,p,o,d[_+14],23,-35309556),o=D(o,i,n,p,d[_+1],4,-1530992060),p=D(p,o,i,n,d[_+4],11,1272893353),n=D(n,p,o,i,d[_+7],16,-155497632),i=D(i,n,p,o,d[_+10],23,-1094730640),o=D(o,i,n,p,d[_+13],4,681279174),p=D(p,o,i,n,d[_],11,-358537222),n=D(n,p,o,i,d[_+3],16,-722521979),i=D(i,n,p,o,d[_+6],23,76029189),o=D(o,i,n,p,d[_+9],4,-640364487),p=D(p,o,i,n,d[_+12],11,-421815835),n=D(n,p,o,i,d[_+15],16,530742520),i=D(i,n,p,o,d[_+2],23,-995338651),o=S(o,i,n,p,d[_],6,-198630844),p=S(p,o,i,n,d[_+7],10,1126891415),n=S(n,p,o,i,d[_+14],15,-1416354905),i=S(i,n,p,o,d[_+5],21,-57434055),o=S(o,i,n,p,d[_+12],6,1700485571),p=S(p,o,i,n,d[_+3],10,-1894986606),n=S(n,p,o,i,d[_+10],15,-1051523),i=S(i,n,p,o,d[_+1],21,-2054922799),o=S(o,i,n,p,d[_+8],6,1873313359),p=S(p,o,i,n,d[_+15],10,-30611744),n=S(n,p,o,i,d[_+6],15,-1560198380),i=S(i,n,p,o,d[_+13],21,1309151649),o=S(o,i,n,p,d[_+4],6,-145523070),p=S(p,o,i,n,d[_+11],10,-1120210379),n=S(n,p,o,i,d[_+2],15,718787259),i=S(i,n,p,o,d[_+9],21,-343485551),o=R(o,E),i=R(i,X),n=R(n,N),p=R(p,F)}return[o,i,n,p]}(function G(d){const v=[];for(let o=0,i=d.length*h;o<i;o+=h)v[o>>5]|=(d.charCodeAt(o/h)&$)<<o%32;return v}(d),d.length*h);switch(o){case y.Raw:return i;case y.Hex:return function C(d){const v="0123456789abcdef",o=[];for(let i=0,n=4*d.length;i<n;i++)o.push(v.charAt(d[i>>2]>>i%4*8+4&15)+v.charAt(d[i>>2]>>i%4*8&15));return o.join("")}(i);case y.String:return function B(d){const v=[];for(let o=0,i=32*d.length;o<i;o+=h)v.push(String.fromCharCode(d[o>>5]>>>o%32&$));return v.join("")}(i);case y.Base64:return function x(d){const i=[];for(let n=0,p=4*d.length;n<p;n+=3){const _=(d[n>>2]>>n%4*8&255)<<16|(d[n+1>>2]>>(n+1)%4*8&255)<<8|d[n+2>>2]>>(n+2)%4*8&255;for(let E=0;E<4;E++)i.push(8*n+6*E>32*d.length?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(_>>6*(3-E)&63))}return i.join("")}(i)}}},82262:(z,Z,r)=>{r.r(Z),r.d(Z,{default:()=>it});var y=r(10467),h=r(8189),$=r(81098),R=r(92165),S=(r(79122),r(70176),r(92089),r(9826),r(15317),r(38582),r(73747),r(13318),r(85718),r(36156)),j=r(89563),I=r(90660),d=r(31178),v=r(5922),o=r(35150),i=r(39693),n=r(56492),p=r(48900),_=r(45272),E=r(85211),F=(r(3248),r(40707),r(74220)),m=r(17221),g=r(76576),f=r(26514),L=r(58864),b=r(13303),K=r(95478),V=r(63758),Y=r(94376),H=r(25936),k=r(23e3),ue=r(58277),ie=r(17049),ce=r(85551),pe=r(33036),ne=r(46406),ee=r(91297),De=r(68438),we=r(86537),Be=r(75783),le=r(81687),Se=r(47516),Ke=r(27378),We=r(71906),Ze=r(3404),$e=r(73258),fe=r(86300),de=r(10581),je=r(6829),Ne=r(20329),Te=r(73975),Ge=r(64584),He=r(64833),_e=r(71065);let re=class extends _e.oY{constructor(){super(...arguments),this.name=null,this.field=null,this.currentRangeExtent=null,this.fullRangeExtent=null,this.type="rangeInfo"}};(0,h._)([(0,E.MZ)({type:String,json:{read:!0,write:!0}})],re.prototype,"name",void 0),(0,h._)([(0,E.MZ)({type:String,json:{read:!0,write:!0}})],re.prototype,"field",void 0),(0,h._)([(0,E.MZ)({type:[Number],json:{read:!0,write:!0}})],re.prototype,"currentRangeExtent",void 0),(0,h._)([(0,E.MZ)({type:[Number],json:{read:!0,write:!0}})],re.prototype,"fullRangeExtent",void 0),(0,h._)([(0,E.MZ)({type:["rangeInfo"],readOnly:!0,json:{read:!1,write:!0}})],re.prototype,"type",void 0),re=(0,h._)([(0,g.$)("esri.layers.support.RangeInfo")],re);var ye,Ve=r(77806),Je=r(25968),be=r(96996),Ee=r(55861),Ue=r(11817);let ge=ye=class extends((0,_e.Te)(d.A.ofType(Ee.A))){constructor(t){super(t)}clone(){return new ye(this.items.map(t=>t.clone()))}write(t,u){return this.toJSON(u)}toJSON(t){var u;const c=null==t||null===(u=t.layer)||void 0===u?void 0:u.spatialReference;return c?this.toArray().map(P=>{if(!c.equals(P.spatialReference)){if(!(0,Ue.canProjectWithoutEngine)(P.spatialReference,c))return null!=t&&t.messages&&t.messages.push(new be.A("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})),null;const W=new Ee.A;(0,Ue.projectPolygon)(P,W,c),P=W}const w=P.toJSON(t);return delete w.spatialReference,w}).filter(P=>null!=P):(null!=t&&t.messages&&t.messages.push(new be.A("scenefilter:unsupported","Writing Scene filters without context layer is not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})),this.toArray().map(P=>P.toJSON(t)))}static fromJSON(t,u){const c=new ye;return t.forEach(P=>c.add(Ee.A.fromJSON(P,u))),c}};ge=ye=(0,h._)([(0,g.$)("esri.layers.support.PolygonCollection")],ge);const ve=ge;var Me,Qe=r(88135);let ae=Me=class extends _e.oY{constructor(t){super(t),this.spatialRelationship="disjoint",this.geometries=new ve,this._geometriesSource=null}initialize(){this.addHandles((0,p.on)(()=>this.geometries,"after-changes",()=>this.geometries=this.geometries,p.OH))}readGeometries(t,u,c){Array.isArray(t)?this.geometries=ve.fromJSON(t,c):this._geometriesSource={url:(0,Qe.f)(t,c),context:c}}loadGeometries(t,u){var c=this;return(0,y.A)(function*(){if(null==c._geometriesSource)return;const{url:P,context:w}=c._geometriesSource,W=yield(0,j.A)(P,{responseType:"json",signal:null==u?void 0:u.signal}),J=t.toJSON(),Q=W.data.map(q=>({...q,spatialReference:J}));c.geometries=ve.fromJSON(Q,w),c._geometriesSource=null})()}clone(){const t=new Me({geometries:(0,Ve.o8)(this.geometries),spatialRelationship:this.spatialRelationship});return t._geometriesSource=this._geometriesSource,t}};(0,h._)([(0,E.MZ)({type:["disjoint","contains"],nonNullable:!0,json:{write:!0}})],ae.prototype,"spatialRelationship",void 0),(0,h._)([(0,E.MZ)({type:ve,nonNullable:!0,json:{write:!0}}),(0,Je.P)({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],ae.prototype,"geometries",void 0),(0,h._)([(0,m.w)(["web-scene","portal-item"],"geometries")],ae.prototype,"readGeometries",null),ae=Me=(0,h._)([(0,g.$)("esri.layers.support.SceneFilter")],ae);const Ye=ae;var ze=r(8691),Xe=r(87086),he=r(73812),Re=r(12089),ke=r(41843);function Pe(){return(Pe=(0,y.A)(function*(t){const u=[];for(const c of t)c.name.toLowerCase().endsWith(".zip")?u.push(et(c)):u.push(Promise.resolve(c));return(yield Promise.all(u)).flat()})).apply(this,arguments)}function et(t){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,y.A)(function*(t){const{BlobReader:u,ZipReader:c,BlobWriter:P}=yield Promise.all([r.e(2076),r.e(7344)]).then(r.bind(r,47344)),w=[];return(yield new c(new u(t)).getEntries()).forEach(J=>{var Q;if(J.directory||/^__MACOS/i.test(J.filename))return;const q=new P,te=null===(Q=J.getData)||void 0===Q?void 0:Q.call(J,q).then(se=>new File([se],J.filename));te&&w.push(te)}),Promise.all(w)})).apply(this,arguments)}var tt=r(99550),Ce=r(64935),rt=r(46873);const st=new Set(["3DObject","Point"]),Fe=(0,Ze.p)();let T=class extends((0,ee.M)((0,ue.w6)((0,ne.w6)((0,H.b)((0,ie.q)((0,ce.A)((0,pe.j)((0,i.P)((0,k.d)((0,Y.p)((0,I.O)(K.A)))))))))))){constructor(...t){super(...t),this.featureReduction=null,this.rangeInfos=null,this.operationalLayerType="ArcGISSceneServiceLayer",this.type="scene",this.fields=null,this.floorInfo=null,this.outFields=null,this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.excludeObjectIds=new d.A,this.definitionExpression=null,this.filter=null,this.path=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.priority=null,this.semantic=null,this.cachedDrawingInfo={color:!1},this.popupEnabled=!0,this.popupTemplate=null,this.objectIdField=null,this.globalIdField=null,this._fieldUsageInfo={},this.screenSizePerspectiveEnabled=!0,this.serviceItemId=void 0}normalizeCtorArgs(t,u){return"string"==typeof t?{url:t,...u}:t}destroy(){this._set("renderer",null)}getField(t){return this.fieldsIndex.get(t)}getFieldDomain(t,u){var c,P,w;const W=null===(c=this.getFeatureType(null==u?void 0:u.feature))||void 0===c||null===(c=c.domains)||void 0===c?void 0:c[t];return W&&"inherited"!==W.type?W:null!==(P=null===(w=this.getField(t))||void 0===w?void 0:w.domain)&&void 0!==P?P:null}getFeatureType(t){return t&&this.associatedLayer?this.associatedLayer.getFeatureType(t):null}get types(){var t,u;return null!==(t=null===(u=this.associatedLayer)||void 0===u?void 0:u.types)&&void 0!==t?t:[]}get typeIdField(){var t,u;return null!==(t=null===(u=this.associatedLayer)||void 0===u?void 0:u.typeIdField)&&void 0!==t?t:null}get templates(){var t,u;return null!==(t=null===(u=this.associatedLayer)||void 0===u?void 0:u.templates)&&void 0!==t?t:null}get formTemplate(){var t,u;return null!==(t=null===(u=this.associatedLayer)||void 0===u?void 0:u.formTemplate)&&void 0!==t?t:null}get fieldsIndex(){return new $e.A(this.fields)}readNodePages(t,u,c){return"Point"===u.layerType&&(t=u.pointNodePages),null==t||"object"!=typeof t?null:de.W4.fromJSON(t,c)}set elevationInfo(t){this._set("elevationInfo",t),this.loaded&&this._validateElevationInfo()}get effectiveCapabilities(){var t;return this._capabilitiesFromAssociatedFeatureLayer(null===(t=this.associatedLayer)||void 0===t?void 0:t.effectiveCapabilities)}get effectiveEditingEnabled(){return null!=this.associatedLayer&&(0,Se.C$)(this.associatedLayer)}get geometryType(){return ot[this.profile]||"mesh"}set renderer(t){(0,fe.yp)(t,this.fieldsIndex),this._set("renderer",t)}readCachedDrawingInfo(t){return null!=t&&"object"==typeof t||(t={}),null==t.color&&(t.color=!1),t}get capabilities(){var t;return this._capabilitiesFromAssociatedFeatureLayer(null===(t=this.associatedLayer)||void 0===t?void 0:t.capabilities)}_capabilitiesFromAssociatedFeatureLayer(t){var u;t=null!=t?t:Be.P;const{query:c,queryRelated:P,editing:{supportsGlobalId:w,supportsRollbackOnFailure:W,supportsUploadWithItemId:J,supportsGeometryUpdate:Q,supportsReturnServiceEditsInSourceSpatialReference:q},data:{supportsZ:te,supportsM:se,isVersioned:Le,supportsAttachment:oe},operations:{supportsEditing:Oe,supportsAdd:nt,supportsUpdate:at,supportsDelete:lt,supportsQuery:dt,supportsQueryAttachments:ut,supportsAsyncConvert3D:ct}}=t,me=t.operations.supportsChangeTracking,Ae=!(null===(u=this.associatedLayer)||void 0===u||!u.infoFor3D)&&(0,Re.Vo)();return{query:c,queryRelated:P,editing:{supportsGlobalId:w,supportsReturnServiceEditsInSourceSpatialReference:q,supportsRollbackOnFailure:W,supportsGeometryUpdate:Ae&&Q,supportsUploadWithItemId:J},data:{supportsAttachment:oe,supportsZ:te,supportsM:se,isVersioned:Le},operations:{supportsQuery:dt,supportsQueryAttachments:ut,supportsEditing:Oe&&me,supportsAdd:Ae&&nt&&me,supportsDelete:Ae&&lt&&me,supportsUpdate:at&&me,supportsAsyncConvert3D:ct}}}get editingEnabled(){var t,u;return this._isOverridden("editingEnabled")?this._get("editingEnabled"):null!==(t=null===(u=this.associatedLayer)||void 0===u?void 0:u.editingEnabled)&&void 0!==t&&t}set editingEnabled(t){this._overrideIfSome("editingEnabled",t)}get infoFor3D(){var t,u;return null!==(t=null===(u=this.associatedLayer)||void 0===u?void 0:u.infoFor3D)&&void 0!==t?t:null}get relationships(){var t;return null===(t=this.associatedLayer)||void 0===t?void 0:t.relationships}get defaultPopupTemplate(){return this.associatedLayer||this.attributeStorageInfo?this.createPopupTemplate():null}readObjectIdField(t,u){return!t&&u.fields&&u.fields.some(c=>("esriFieldTypeOID"===c.type&&(t=c.name),!!t)),t||void 0}readGlobalIdField(t,u){return!t&&u.fields&&u.fields.some(c=>("esriFieldTypeGlobalID"===c.type&&(t=c.name),!!t)),t||void 0}get displayField(){var t,u;return null!==(t=null===(u=this.associatedLayer)||void 0===u?void 0:u.displayField)&&void 0!==t?t:null}readProfile(t,u){const c=u.store.profile;return null!=c&&xe[c]?xe[c]:(o.A.getLogger(this).error("Unknown or missing profile",{profile:c,layer:this}),"mesh-pyramids")}load(t){return this.addResolvingPromise(this._load(t)),Promise.resolve(this)}_load(t){var u=this;return(0,y.A)(function*(){const c=null!=t?t.signal:null;yield u.loadFromPortal({supportedTypes:["Scene Service"]},t).catch(n.QP),yield u._fetchService(c),yield Promise.all([u._fetchIndexAndUpdateExtent(u.nodePages,c),u._setAssociatedFeatureLayer(c),u._loadFilterGeometries()]),u._validateElevationInfo(),u._applyAssociatedLayerOverrides(),u._populateFieldUsageInfo(),yield(0,ze.L)(u,{origin:"service"},c),(0,fe.yp)(u.renderer,u.fieldsIndex),yield u.finishLoadEditablePortalLayer(t)})()}beforeSave(){var t=this;return(0,y.A)(function*(){null!=t.filter&&(t.filter=t.filter.clone(),yield t.load())})()}_loadFilterGeometries(){var t=this;return(0,y.A)(function*(){if(t.filter)try{yield t.filter.loadGeometries(t.spatialReference)}catch(u){o.A.getLogger(t).error("#_loadFilterGeometries()",t,"Failed to load filter geometries. Geometry filter will not be applied for this layer.",{error:u}),t.filter=null}})()}createQuery(){const t=new Xe.A;return"mesh"!==this.geometryType&&(t.returnGeometry=!0,t.returnZ=!0),t.where=this.definitionExpression||"1=1",t.sqlFormat="standard",t.outFields=["*"],t}queryExtent(t,u){return this._getAssociatedLayerForQuery().then(c=>c.queryExtent(t||this.createQuery(),u))}queryFeatureCount(t,u){return this._getAssociatedLayerForQuery().then(c=>c.queryFeatureCount(t||this.createQuery(),u))}queryFeatures(t,u){return this._getAssociatedLayerForQuery().then(c=>c.queryFeatures(t||this.createQuery(),u)).then(c=>{if(null!=c&&c.features)for(const P of c.features)P.layer=this,P.sourceLayer=this;return c})}queryRelatedFeatures(t,u){var c=this;return(0,y.A)(function*(){if(yield c.load(),!c.associatedLayer)throw new v.A("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:c});return c.associatedLayer.queryRelatedFeatures(t,u)})()}queryRelatedFeaturesCount(t,u){var c=this;return(0,y.A)(function*(){if(yield c.load(),!c.associatedLayer)throw new v.A("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:c});return c.associatedLayer.queryRelatedFeaturesCount(t,u)})()}queryCachedAttributes(t,u){var c=this;return(0,y.A)(function*(){var P;const w=(0,fe.hL)(c.fieldsIndex,yield(0,Ce.TO)(c,(0,Ce.D8)(c)));return(0,tt.s1)(c.parsedUrl.path,null!==(P=c.attributeStorageInfo)&&void 0!==P?P:[],t,u,w,c.apiKey,c.customParameters)})()}queryCachedFeature(t,u){var c=this;return(0,y.A)(function*(){const P=yield c.queryCachedAttributes(t,[u]);if(!P||0===P.length)throw new v.A("scenelayer:feature-not-in-cached-data","Feature not found in cached data");const w=new $.A;return w.attributes=P[0],w.layer=c,w.sourceLayer=c,w})()}queryObjectIds(t,u){return this._getAssociatedLayerForQuery().then(c=>c.queryObjectIds(t||this.createQuery(),u))}queryAttachments(t,u){return this._getAssociatedLayerForQuery().then(c=>c.queryAttachments(t,u))}getFieldUsageInfo(t){const u={supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};return this.loaded?this._fieldUsageInfo[t]||u:(o.A.getLogger(this).error("#getFieldUsageInfo()","Unavailable until layer is loaded"),u)}createPopupTemplate(t){return(0,ke.tn)(this,t)}_getAssociatedLayerForQuery(){const t=this.associatedLayer;return null!=t&&t.loaded?Promise.resolve(t):this._loadAssociatedLayerForQuery()}_loadAssociatedLayerForQuery(){var t=this;return(0,y.A)(function*(){if(yield t.load(),!t.associatedLayer)throw new v.A("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:t});try{yield t.associatedLayer.load()}catch(u){throw new v.A("scenelayer:query-not-available","SceneLayer associated feature layer could not be loaded",{layer:t,error:u})}return t.associatedLayer})()}hasCachedStatistics(t){return null!=this.statisticsInfo&&this.statisticsInfo.some(u=>u.name===t)}queryCachedStatistics(t,u){var c=this;return(0,y.A)(function*(){if(yield c.load(u),!c.statisticsInfo)throw new v.A("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");const P=c.fieldsIndex.get(t);if(!P)throw new v.A("scenelayer:field-unexisting",`Field '${t}' does not exist on the layer`);for(const w of c.statisticsInfo)if(w.name===P.name){const W=(0,_.fj)(c.parsedUrl.path,w.href);return(0,j.A)(W,{query:{f:"json",...c.customParameters,token:c.apiKey},responseType:"json",signal:u?u.signal:null}).then(J=>J.data)}throw new v.A("scenelayer:no-cached-statistics","Cached statistics for this attribute are not available")})()}saveAs(t,u){var c=this;return(0,y.A)(function*(){return c._debouncedSaveOperations(ne.Xh.SAVE_AS,{...u,getTypeKeywords:()=>c._getTypeKeywords(),portalItemLayerType:"scene"},t)})()}save(){var t=this;return(0,y.A)(function*(){const u={getTypeKeywords:()=>t._getTypeKeywords(),portalItemLayerType:"scene"};return t._debouncedSaveOperations(ne.Xh.SAVE,u)})()}applyEdits(t,u){var c=this;return(0,y.A)(function*(){var P,w;const{applyEdits:W}=yield r.e(1447).then(r.bind(r,13828));let J=u;yield c.load();const Q=c.associatedLayer;if(!Q)throw new v.A(`${c.type}-layer:not-editable`,"Service is not editable");yield Q.load();const{globalIdField:q}=Q,te=!!Q.infoFor3D,se=null===(P=null===(w=J)||void 0===w?void 0:w.globalIdUsed)||void 0===P||P;if(te&&null==q)throw new v.A(`${c.type}-layer:not-editable`,"Valid globalIdField expected on editable SceneLayer");if(te&&!se)throw new v.A(`${c.type}-layer:globalid-required`,"globalIdUsed must not be false for SceneLayer editing as globalIds are required.");return(0,De.Wo)(Q.url)&&te&&null!=t.deleteFeatures&&null!=q&&(J={...J,globalIdToObjectId:yield(0,Se.GA)(Q,t.deleteFeatures,q)}),W(c,Q.source,t,J)})()}uploadAssets(t,u){var c=this;return(0,y.A)(function*(){if(yield c.load(),null==c.associatedLayer)throw new v.A(`${c.type}-layer:not-editable`,"Service is not editable");return yield c.associatedLayer.load(),c.associatedLayer.uploadAssets(t,u)})()}on(t,u){return super.on(t,u)}convertMesh(t,u){var c=this;return(0,y.A)(function*(){var P;const w=oe=>{throw o.A.getLogger(c).error(".convertMesh()",oe.message),oe};yield c.load(),c.infoFor3D||w(new v.A("invalid:layer","SceneLayer has no capability for mesh conversion"));const W=yield c.extractAndFilterFiles(t),J=W.reduce((oe,Oe)=>(0,je.oF)(c.infoFor3D,Oe)?oe+1:oe,0);0===J&&w(new V.VP),J>1&&w(new V.XQ);const q=null!==(P=null==u?void 0:u.location)&&void 0!==P?P:new b.A({x:0,y:0,z:0,spatialReference:c.spatialReference}),se=L.A.createWithExternalSource(q,W,{vertexSpace:q.spatialReference.isGeographic?"local":"georeferenced"}),[Le]=yield c.uploadAssets([se],u);return Le})()}extractAndFilterFiles(t){var u=this;return(0,y.A)(function*(){yield u.load();const c=u.infoFor3D;return c?(yield function qe(t){return Pe.apply(this,arguments)}(t)).filter(P=>(0,je.fu)(c,P)):t})()}validateLayer(t){if(t.layerType&&!st.has(t.layerType))throw new v.A("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:t.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new v.A("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});if(this.version.major>2)throw new v.A("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});!function u(c,P){let w=!1,W=!1;if(null==c)w=!0,W=!0;else{const J=P&&P.isGeographic;switch(c){case"east-north-up":case"earth-centered":w=!0,W=J;break;case"vertex-reference-frame":w=!0,W=!J;break;default:w=!1}}if(!w)throw new v.A("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!W)throw new v.A("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.")}(this.normalReferenceFrame,this.spatialReference)}_getTypeKeywords(){const t=[];if("points"===this.profile)t.push("Point");else{if("mesh-pyramids"!==this.profile)throw new v.A("scenelayer:unknown-profile","SceneLayer:save() encountered an unknown SceneLayer profile: "+this.profile);t.push("3DObject")}return t}_populateFieldUsageInfo(){if(this._fieldUsageInfo={},this.fields)for(const u of this.fields){var t;const c=!(!this.attributeStorageInfo||!this.attributeStorageInfo.some(W=>W.name===u.name)),P=!(null===(t=this.associatedLayer)||void 0===t||null===(t=t.fields)||void 0===t||!t.some(W=>W&&u.name===W.name));this._fieldUsageInfo[u.name]={supportsLabelingInfo:c,supportsRenderer:c,supportsPopupTemplate:c||P,supportsLayerQuery:P}}}_applyAssociatedLayerOverrides(){this._applyAssociatedLayerFieldsOverrides(),this._applyAssociatedLayerPopupOverrides(),this._applyAssociatedLayerExtentOverride(),this._applyAssociatedLayerPrivileges()}_applyAssociatedLayerFieldsOverrides(){var t;if(null===(t=this.associatedLayer)||void 0===t||!t.fields)return;let u=null;for(const c of this.associatedLayer.fields){const P=this.getField(c.name);P?(!P.domain&&c.domain&&(P.domain=c.domain.clone()),P.editable=c.editable,P.nullable=c.nullable,P.length=c.length):(u||(u=this.fields?this.fields.slice():[]),u.push(c.clone()))}u&&this._set("fields",u)}_applyAssociatedLayerPopupOverrides(){if(!this.associatedLayer)return;const t=["popupTemplate","popupEnabled"],u=(0,F.oY)(this);for(let c=0;c<t.length;c++){const P=t[c],w=this.originIdOf(P),W=this.associatedLayer.originIdOf(P);w<W&&(W===f.Gr.SERVICE||W===f.Gr.PORTAL_ITEM)&&u.setAtOrigin(P,this.associatedLayer[P],W)}}_applyAssociatedLayerExtentOverride(){var t,u,c,P,w,W;const J=null===(t=this.associatedLayer)||void 0===t||null===(t=t.editingInfo)||void 0===t?void 0:t.lastEditDate,Q=null===(u=this.associatedLayer)||void 0===u?void 0:u.serverGens,q=null===(c=this.associatedLayer)||void 0===c?void 0:c.getAtOrigin("fullExtent","service");!(0,Re.Vo)()||null==(null===(P=this.associatedLayer)||void 0===P?void 0:P.infoFor3D)||!q||!(0,De.Wo)(null===(w=this.associatedLayer)||void 0===w?void 0:w.url)||!J||(null===(W=this.serviceUpdateTimeStamp)||void 0===W?void 0:W.lastUpdate)===J.getTime()||!this.serviceUpdateTimeStamp&&(null==Q?void 0:Q.minServerGen)===(null==Q?void 0:Q.serverGen)||(0,F.oY)(this).setAtOrigin("fullExtent",q.clone(),f.Gr.SERVICE)}_applyAssociatedLayerPrivileges(){const t=this.associatedLayer;t&&(this._set("userHasEditingPrivileges",t.userHasEditingPrivileges),this._set("userHasFullEditingPrivileges",t.userHasFullEditingPrivileges),this._set("userHasUpdateItemPrivileges",t.userHasUpdateItemPrivileges))}_setAssociatedFeatureLayer(t){var u=this;return(0,y.A)(function*(){if(["mesh-pyramids","points"].includes(u.profile))try{const{serverUrl:c,layerId:P,portalItem:w}=yield(0,we.L)(`${u.url}/layers/${u.layerId}`,{sceneLayerItem:u.portalItem,customParameters:u.customParameters,apiKey:u.apiKey,signal:t}),W=yield He.S.FeatureLayer();u.associatedLayer=new W({url:c,customParameters:u.customParameters,layerId:P,portalItem:w}),yield u.associatedLayer.load()}catch(c){(0,n.zf)(c)||u._logWarningOnPopupEnabled()}})()}_logWarningOnPopupEnabled(){var t=this;return(0,y.A)(function*(){yield(0,p.C_)(()=>t.popupEnabled&&null!=t.popupTemplate);const u=`this SceneLayer: ${t.title}`;null==t.attributeStorageInfo?o.A.getLogger(t).warn(`Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on ${u}`):o.A.getLogger(t).info(`Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on ${u}`)})()}_validateElevationInfo(){const t=this.elevationInfo;"mesh-pyramids"===this.profile&&(0,he.XF)(o.A.getLogger(this),(0,he.$7)("Mesh scene layers","relative-to-scene",t)),(0,he.XF)(o.A.getLogger(this),(0,he.tW)("Scene layers",t))}};(0,h._)([(0,E.MZ)({types:{key:"type",base:Ke.c,typeMap:{selection:We.A}},json:{origins:{"web-scene":{name:"layerDefinition.featureReduction",write:!0},"portal-item":{name:"layerDefinition.featureReduction",write:!0}}}})],T.prototype,"featureReduction",void 0),(0,h._)([(0,E.MZ)({type:[re],json:{read:!1,origins:{"web-scene":{name:"layerDefinition.rangeInfos",write:!0},"portal-item":{name:"layerDefinition.rangeInfos",write:!0}}}})],T.prototype,"rangeInfos",void 0),(0,h._)([(0,E.MZ)({json:{read:!1}})],T.prototype,"associatedLayer",void 0),(0,h._)([(0,E.MZ)({type:["show","hide"]})],T.prototype,"listMode",void 0),(0,h._)([(0,E.MZ)({type:["ArcGISSceneServiceLayer"]})],T.prototype,"operationalLayerType",void 0),(0,h._)([(0,E.MZ)({json:{read:!1},readOnly:!0})],T.prototype,"type",void 0),(0,h._)([(0,E.MZ)({...Fe.fields,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],T.prototype,"fields",void 0),(0,h._)([(0,E.MZ)()],T.prototype,"types",null),(0,h._)([(0,E.MZ)()],T.prototype,"typeIdField",null),(0,h._)([(0,E.MZ)()],T.prototype,"templates",null),(0,h._)([(0,E.MZ)()],T.prototype,"formTemplate",null),(0,h._)([(0,E.MZ)({readOnly:!0,clonable:!1})],T.prototype,"fieldsIndex",null),(0,h._)([(0,E.MZ)({type:Ge.A,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],T.prototype,"floorInfo",void 0),(0,h._)([(0,E.MZ)(Fe.outFields)],T.prototype,"outFields",void 0),(0,h._)([(0,E.MZ)({type:de.W4,readOnly:!0,json:{read:!1}})],T.prototype,"nodePages",void 0),(0,h._)([(0,m.w)("service","nodePages",["nodePages","pointNodePages"])],T.prototype,"readNodePages",null),(0,h._)([(0,E.MZ)({type:[de.uV],readOnly:!0})],T.prototype,"materialDefinitions",void 0),(0,h._)([(0,E.MZ)({type:[de.Ot],readOnly:!0})],T.prototype,"textureSetDefinitions",void 0),(0,h._)([(0,E.MZ)({type:[de.L0],readOnly:!0})],T.prototype,"geometryDefinitions",void 0),(0,h._)([(0,E.MZ)({readOnly:!0})],T.prototype,"serviceUpdateTimeStamp",void 0),(0,h._)([(0,E.MZ)({readOnly:!0})],T.prototype,"attributeStorageInfo",void 0),(0,h._)([(0,E.MZ)({readOnly:!0})],T.prototype,"statisticsInfo",void 0),(0,h._)([(0,E.MZ)({type:d.A.ofType(Number),nonNullable:!0,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.excludeObjectIds",write:{enabled:!0}}})],T.prototype,"excludeObjectIds",void 0),(0,h._)([(0,E.MZ)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],T.prototype,"definitionExpression",void 0),(0,h._)([(0,E.MZ)({type:Ye,json:{name:"layerDefinition.polygonFilter",write:{enabled:!0,allowNull:!0},origins:{service:{read:!1,write:!1}}}})],T.prototype,"filter",void 0),(0,h._)([(0,E.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],T.prototype,"path",void 0),(0,h._)([(0,E.MZ)(le.Yj)],T.prototype,"elevationInfo",null),(0,h._)([(0,E.MZ)({readOnly:!0,json:{read:!1}})],T.prototype,"effectiveCapabilities",null),(0,h._)([(0,E.MZ)({readOnly:!0})],T.prototype,"effectiveEditingEnabled",null),(0,h._)([(0,E.MZ)({type:String})],T.prototype,"geometryType",null),(0,h._)([(0,E.MZ)(le.kF)],T.prototype,"labelsVisible",void 0),(0,h._)([(0,E.MZ)({type:[Ne.A],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:{reader:Te.w},write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:Te.w},write:!0}})],T.prototype,"labelingInfo",void 0),(0,h._)([(0,E.MZ)(le.fV)],T.prototype,"legendEnabled",void 0),(0,h._)([(0,E.MZ)({type:Number,json:{origins:{"web-document":{default:1,write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}},read:{source:["opacity","layerDefinition.drawingInfo.transparency"],reader(t,u){var c;if("number"==typeof t&&t>=0&&t<=1)return t;const P=null===(c=u.layerDefinition)||void 0===c||null===(c=c.drawingInfo)||void 0===c?void 0:c.transparency;return void 0!==P?(0,rt.D)(P):void 0}}},"portal-item":{write:!0},service:{read:!1}}}})],T.prototype,"opacity",void 0),(0,h._)([(0,E.MZ)({type:["Low","High"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],T.prototype,"priority",void 0),(0,h._)([(0,E.MZ)({type:["Labels"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],T.prototype,"semantic",void 0),(0,h._)([(0,E.MZ)({types:S.X,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],T.prototype,"renderer",null),(0,h._)([(0,E.MZ)({json:{read:!1}})],T.prototype,"cachedDrawingInfo",void 0),(0,h._)([(0,m.w)("service","cachedDrawingInfo")],T.prototype,"readCachedDrawingInfo",null),(0,h._)([(0,E.MZ)({readOnly:!0,json:{read:!1}})],T.prototype,"capabilities",null),(0,h._)([(0,E.MZ)({type:Boolean,json:{read:!1}})],T.prototype,"editingEnabled",null),(0,h._)([(0,E.MZ)({readOnly:!0,json:{write:!1,read:!1}})],T.prototype,"infoFor3D",null),(0,h._)([(0,E.MZ)({readOnly:!0,json:{write:!1,read:!1}})],T.prototype,"relationships",null),(0,h._)([(0,E.MZ)(le.M6)],T.prototype,"popupEnabled",void 0),(0,h._)([(0,E.MZ)({type:R.A,json:{name:"popupInfo",write:!0}})],T.prototype,"popupTemplate",void 0),(0,h._)([(0,E.MZ)({readOnly:!0,json:{read:!1}})],T.prototype,"defaultPopupTemplate",null),(0,h._)([(0,E.MZ)({type:String,json:{read:!1}})],T.prototype,"objectIdField",void 0),(0,h._)([(0,m.w)("service","objectIdField",["objectIdField","fields"])],T.prototype,"readObjectIdField",null),(0,h._)([(0,E.MZ)({type:String,json:{read:!1}})],T.prototype,"globalIdField",void 0),(0,h._)([(0,m.w)("service","globalIdField",["globalIdField","fields"])],T.prototype,"readGlobalIdField",null),(0,h._)([(0,E.MZ)({readOnly:!0,type:String,json:{read:!1}})],T.prototype,"displayField",null),(0,h._)([(0,E.MZ)({type:String,json:{read:!1}})],T.prototype,"profile",void 0),(0,h._)([(0,m.w)("service","profile",["store.profile"])],T.prototype,"readProfile",null),(0,h._)([(0,E.MZ)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],T.prototype,"normalReferenceFrame",void 0),(0,h._)([(0,E.MZ)(le.PY)],T.prototype,"screenSizePerspectiveEnabled",void 0),(0,h._)([(0,E.MZ)({json:{read:!1,origins:{service:{read:!0}}}})],T.prototype,"serviceItemId",void 0),T=(0,h._)([(0,g.$)("esri.layers.SceneLayer")],T);const xe={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},ot={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"},it=T},23e3:(z,Z,r)=>{r.d(Z,{d:()=>C});var y=r(8189),h=r(85211),B=(r(3248),r(35150),r(40707),r(76576));const C=x=>{let O=class extends x{constructor(){super(...arguments),this.customParameters=null}};return(0,y._)([(0,h.MZ)({type:Object,json:{write:{overridePolicy:A=>({enabled:!!(A&&Object.keys(A).length>0)})}}})],O.prototype,"customParameters",void 0),O=(0,y._)([(0,B.$)("esri.layers.mixins.CustomParametersMixin")],O),O}},58277:(z,Z,r)=>{r.d(Z,{Mk:()=>d,Zk:()=>D,w6:()=>i});var y=r(8189),h=r(42425),$=r(77806),R=r(56492),x=(r(35150),r(3248),r(5922),r(76576)),O=r(30448);const A=new h.A.EventEmitter;function D(n,p,_=null,E=!1){const X=(0,R.Tw)();return A.emit("apply-edits",{serviceUrl:n,layerId:p,gdbVersion:_,mayReceiveServiceEdits:E=null==p||E,result:X.promise}),X}const j="esri.layers.mixins.EditBusLayer",I=Symbol(j);function d(n){return null!=n&&"object"==typeof n&&I in n}function v(n){return null!=n&&"object"==typeof n&&"gdbVersion"in n}function o(n,p,_){const E=new URL(n).host,X=O.Z3.get(E),N=F=>!F||F===X;return N(p)&&N(_)||p===_}const i=n=>{var p;let _=class extends n{constructor(...E){super(...E),this[p]=!0,this._applyEditsHandler=X=>{const{serviceUrl:N,layerId:F,gdbVersion:m,mayReceiveServiceEdits:g,result:f}=X,L=N===this.url,b=null!=F&&null!=this.layerId&&F===this.layerId,K=v(this),V=v(this)&&o(N,m,this.gdbVersion);if(!L||K&&!V||!b&&!g)return;const Y=f.then(H=>{var k;if(b&&(H.addedFeatures.length||H.updatedFeatures.length||H.deletedFeatures.length||H.addedAttachments.length||H.updatedAttachments.length||H.deletedAttachments.length))return this.emit("edits",(0,$.o8)(H)),H;const ue=null===(k=H.editedFeatures)||void 0===k?void 0:k.find(({layerId:ie})=>ie===this.layerId);if(ue){const{adds:ie,updates:ce,deletes:pe}=ue.editedFeatures,ne={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:ie?ie.map(({attributes:ee})=>({objectId:this.objectIdField&&ee[this.objectIdField],globalId:this.globalIdField&&ee[this.globalIdField]})):[],deletedFeatures:pe?pe.map(({attributes:ee})=>({objectId:this.objectIdField&&ee[this.objectIdField],globalId:this.globalIdField&&ee[this.globalIdField]})):[],updatedFeatures:ce?ce.map(({current:{attributes:ee}})=>({objectId:this.objectIdField&&ee[this.objectIdField],globalId:this.globalIdField&&ee[this.globalIdField]})):[],editedFeatures:(0,$.o8)(H.editedFeatures),exceededTransferLimit:!1,historicMoment:(0,$.o8)(H.historicMoment)};return this.emit("edits",ne),ne}return{edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:(0,$.o8)(H.editedFeatures),exceededTransferLimit:!1,historicMoment:(0,$.o8)(H.historicMoment)}}).then(H=>("historicMoment"in this&&this.historicMoment!==H.historicMoment&&(0,O.w5)(N,m)&&(this.historicMoment=H.historicMoment),H));this.emit("apply-edits",{result:Y})},this._updateMomentHandler=X=>{const{serviceUrl:N,gdbVersion:F,moment:m}=X,g=N===this.url,f=v(this),L=v(this)&&o(N,F,this.gdbVersion),b=v(this)&&!o(N,this.gdbVersion,null);g&&f&&L&&b&&"historicMoment"in this&&this.historicMoment!==m&&(this.historicMoment=m)},this.when().then(()=>{this.addHandles(function U(n){return A.on("apply-edits",new WeakRef(n))}(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(function M(n){return A.on("update-moment",new WeakRef(n))}(this._updateMomentHandler))},()=>{})}};return p=I,_=(0,y._)([(0,x.$)(j)],_),_}},85551:(z,Z,r)=>{r.d(Z,{A:()=>_});var y=r(10467),h=r(8189),$=r(23098),R=r(77469),G=r(89563),B=r(89447),C=r(5922),x=r(35150),O=r(11432),A=r(56492),U=r(45272),M=r(85211),j=(r(3248),r(40707),r(17221)),I=r(76576),d=r(50305),v=r(58443),o=r(73874),i=r(46577),n=r(52606),p=r(69927);const _=X=>{let N=class extends X{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,O.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(F){F!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",F))}readPortalItem(F,m,g){if(m.itemId)return new i.default({id:m.itemId,portal:null==g?void 0:g.portal})}writePortalItem(F,m){null!=F&&F.id&&(m.itemId=F.id)}loadFromPortal(F,m){var g=this;return(0,y.A)(function*(){var f;if(null!==(f=g.portalItem)&&void 0!==f&&f.id)try{const{load:L}=yield Promise.all([r.e(5565),r.e(2076),r.e(6180)]).then(r.bind(r,56180));return(0,A.Te)(m),yield L({instance:g,supportedTypes:F.supportedTypes,validateItem:F.validateItem,supportsData:F.supportsData,layerModuleTypeMap:F.layerModuleTypeMap},m)}catch(L){throw(0,A.zf)(L)||x.A.getLogger(g).warn(`Failed to load layer (${g.title}, ${g.id}) portal item (${g.portalItem.id})\n  ${L}`),L}})()}finishLoadEditablePortalLayer(F){var m=this;return(0,y.A)(function*(){m._set("userHasEditingPrivileges",yield m._fetchUserHasEditingPrivileges(F).catch(g=>((0,A.QP)(g),!0)))})()}setUserPrivileges(F,m){var g=this;return(0,y.A)(function*(){if(!$.A.userPrivilegesApplied)return g.finishLoadEditablePortalLayer(m);if(g.url)try{const{features:{edit:f,fullEdit:L},content:{updateItem:b}}=yield g._fetchUserPrivileges(F,m);g._set("userHasEditingPrivileges",f),g._set("userHasFullEditingPrivileges",L),g._set("userHasUpdateItemPrivileges",b)}catch(f){(0,A.QP)(f)}})()}_fetchUserPrivileges(F,m){var g=this;return(0,y.A)(function*(){let f=g.portalItem;if(!F||!f||!f.loaded||f.sourceUrl)return g._fetchFallbackUserPrivileges(m);const L=F===f.id;if(L&&f.portal.user)return(0,p.It)(f);let b,K;if(L)b=f.portal.url;else try{b=yield(0,v.wI)(g.url,m)}catch(k){(0,A.QP)(k)}if(!b||!(0,U.b8)(b,f.portal.url))return g._fetchFallbackUserPrivileges(m);try{const k=null!=m?m.signal:null;K=yield null==R.id?void 0:R.id.getCredential(`${b}/sharing`,{prompt:!1,signal:k})}catch(k){(0,A.QP)(k)}if(!K)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(L?yield f.reload():(f=new i.default({id:F,portal:{url:b}}),yield f.load(m)),f.portal.user)return(0,p.It)(f)}catch(k){(0,A.QP)(k)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_fetchFallbackUserPrivileges(F){var m=this;return(0,y.A)(function*(){let g=!0;try{g=yield m._fetchUserHasEditingPrivileges(F)}catch(f){(0,A.QP)(f)}return{features:{edit:g,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(F){var m=this;return(0,y.A)(function*(){const g=m.url?null==R.id?void 0:R.id.findCredential(m.url):null;if(!g)return!0;const f=E.credential===g?E.user:yield m._fetchEditingUser(F);return E.credential=g,E.user=f,null==(null==f?void 0:f.privileges)||f.privileges.includes("features:user:edit")})()}_fetchEditingUser(F){var m=this;return(0,y.A)(function*(){var g,f;const L=null===(g=m.portalItem)||void 0===g||null===(g=g.portal)||void 0===g?void 0:g.user;if(L)return L;const b=R.id.findServerInfo(null!==(f=m.url)&&void 0!==f?f:"");if(null==b||!b.owningSystemUrl)return null;const K=`${b.owningSystemUrl}/sharing/rest`,V=o.A.getDefault();if(V&&V.loaded&&(0,U.S8)(V.restUrl)===(0,U.S8)(K))return V.user;const Y=`${K}/community/self`,H=null!=F?F.signal:null,k=yield(0,B.Ke)((0,G.A)(Y,{authMode:"no-prompt",query:{f:"json"},signal:H}));return k.ok?n.A.fromJSON(k.value.data):null})()}read(F,m){m&&(m.layer=this),super.read(F,m)}write(F,m){var g;const f=null==m?void 0:m.portal,L=(null===(g=this.portalItem)||void 0===g?void 0:g.id)&&(this.portalItem.portal||o.A.getDefault());return f&&L&&!(0,U.ut)(L.restUrl,f.restUrl)?(m.messages&&m.messages.push(new C.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(F,{...m,layer:this})}};return(0,h._)([(0,M.MZ)({type:i.default})],N.prototype,"portalItem",null),(0,h._)([(0,j.w)("web-document","portalItem",["itemId"])],N.prototype,"readPortalItem",null),(0,h._)([(0,d.K)("web-document","portalItem",{itemId:{type:String}})],N.prototype,"writePortalItem",null),(0,h._)([(0,M.MZ)({clonable:!1})],N.prototype,"resourceReferences",void 0),(0,h._)([(0,M.MZ)({type:Boolean,readOnly:!0})],N.prototype,"userHasEditingPrivileges",void 0),(0,h._)([(0,M.MZ)({type:Boolean,readOnly:!0})],N.prototype,"userHasFullEditingPrivileges",void 0),(0,h._)([(0,M.MZ)({type:Boolean,readOnly:!0})],N.prototype,"userHasUpdateItemPrivileges",void 0),N=(0,h._)([(0,I.$)("esri.layers.mixins.PortalLayer")],N),N},E={credential:null,user:null}},33036:(z,Z,r)=>{r.d(Z,{j:()=>C});var y=r(8189),h=r(85211),B=(r(3248),r(35150),r(40707),r(76576));const C=O=>{let A=class extends O{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const U={minScale:this.minScale,maxScale:this.maxScale},M=this.parent;M&&"effectiveScaleRange"in M&&function x(O,A){O.minScale=O.minScale>0?A.minScale>0?Math.min(O.minScale,A.minScale):O.minScale:A.minScale,O.maxScale=O.maxScale>0?A.maxScale>0?Math.max(O.maxScale,A.maxScale):O.maxScale:A.maxScale}(U,M.effectiveScaleRange);const D=this._get("effectiveScaleRange");return D&&D.minScale===U.minScale&&D.maxScale===U.maxScale?D:U}};return(0,y._)([(0,h.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],A.prototype,"minScale",void 0),(0,y._)([(0,h.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],A.prototype,"maxScale",void 0),(0,y._)([(0,h.MZ)({readOnly:!0})],A.prototype,"effectiveScaleRange",null),A=(0,y._)([(0,B.$)("esri.layers.mixins.ScaleRangeLayer")],A),A}},27378:(z,Z,r)=>{r.d(Z,{c:()=>x});var y=r(8189),h=r(71065),$=r(85211),C=(r(3248),r(35150),r(40707),r(76576));let x=class extends h.oY{constructor(){super(...arguments),this.type=null}};(0,y._)([(0,$.MZ)({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],x.prototype,"type",void 0),x=(0,y._)([(0,C.$)("esri.layers.support.FeatureReduction")],x)},71906:(z,Z,r)=>{r.d(Z,{A:()=>A});var x,y=r(8189),h=r(85211),B=(r(3248),r(35150),r(40707),r(76576)),C=r(27378);let O=x=class extends C.c{constructor(U){super(U),this.type="selection"}clone(){return new x}};(0,y._)([(0,h.MZ)({type:["selection"]})],O.prototype,"type",void 0),O=x=(0,y._)([(0,B.$)("esri.layers.support.FeatureReductionSelection")],O);const A=O},20329:(z,Z,r)=>{r.d(Z,{A:()=>g});var j,y=r(8189),h=r(47280),$=r(49976),R=r(71065),G=r(77806),B=r(67685),C=r(85211),A=(r(3248),r(35150),r(17221)),U=r(76576),M=r(50305),S=(r(40707),r(4858));let I=j=class extends R.oY{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(f,L){return L.value?(0,S.mX)(L.value):f}writeExpression(f,L,b){null!=this.value&&(f=(0,S.mX)(this.value)),null!=f&&(L[b]=f)}clone(){return new j({expression:this.expression,title:this.title,value:this.value})}};(0,y._)([(0,C.MZ)({type:String,json:{write:{writerEnsuresNonNull:!0}}})],I.prototype,"expression",void 0),(0,y._)([(0,A.w)("expression",["expression","value"])],I.prototype,"readExpression",null),(0,y._)([(0,M.K)("expression")],I.prototype,"writeExpression",null),(0,y._)([(0,C.MZ)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],I.prototype,"title",void 0),(0,y._)([(0,C.MZ)({json:{read:!1,write:!1}})],I.prototype,"value",void 0),I=j=(0,y._)([(0,U.$)("esri.layers.support.LabelExpressionInfo")],I);const d=I;var n,v=r(58443),o=r(91644),i=r(35564);const p=new $.J({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function _(f,L,b){return{enabled:!(0,v.TU)(null==b?void 0:b.layer)}}function E(f){var L;return!f||"service"!==f.origin&&"map-image"!==(null===(L=f.layer)||void 0===L?void 0:L.type)}function N(f){var L;return!!function X(f){return"map-image"===(null==f?void 0:f.type)}(f)&&!(null===(L=f.capabilities)||void 0===L||null===(L=L.exportMap)||void 0===L||!L.supportsArcadeExpressionForLabeling)}let m=n=class extends R.oY{static evaluateWhere(f,L){const b=(K,V,Y)=>{switch(V){case"=":return K==Y;case"<>":return K!=Y;case">":return K>Y;case">=":return K>=Y;case"<":return K<Y;case"<=":return K<=Y}return!1};try{if(null==f)return!0;const K=f.split(" ");if(3===K.length)return b(L[K[0]],K[1],K[2]);if(7===K.length){const V=b(L[K[0]],K[1],K[2]),Y=K[3],H=b(L[K[4]],K[5],K[6]);switch(Y){case"AND":return V&&H;case"OR":return V||H}}return!1}catch{console.log("Error.: can't parse = "+f)}}constructor(f){super(f),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=o.Hk,this.useCodedValues=void 0,this.where=null}readLabelExpression(f,L){const b=L.labelExpressionInfo;if(!b||!b.value&&!b.expression)return f}writeLabelExpression(f,L,b){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)f=(0,S.D3)(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const K=(0,S.tH)(this.labelExpressionInfo.expression);K&&(f="["+K+"]")}null!=f&&(L[b]=f)}writeLabelExpressionInfo(f,L,b,K){if(null==f&&null!=this.labelExpression&&E(K))f=new d({expression:this.getLabelExpressionArcade()});else if(!f)return;const V=f.toJSON(K);V.expression&&(L[b]=V)}writeMaxScale(f,L){(f||this.minScale)&&(L.maxScale=f)}writeMinScale(f,L){(f||this.maxScale)&&(L.minScale=f)}getLabelExpression(){return(0,S.XJ)(this)}getLabelExpressionArcade(){return(0,S.BI)(this)}getLabelExpressionSingleField(){return(0,S.rU)(this)}hash(){return JSON.stringify(this)}clone(){return new n({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:(0,G.o8)(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:(0,G.o8)(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};(0,y._)([(0,C.MZ)({type:String,json:{write:!0}})],m.prototype,"name",void 0),(0,y._)([(0,C.MZ)({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:_}}}}})],m.prototype,"allowOverrun",void 0),(0,y._)([(0,C.MZ)({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:_}}}}})],m.prototype,"deconflictionStrategy",void 0),(0,y._)([(0,C.MZ)({type:String,json:{write:{overridePolicy(f,L,b){return this.labelExpressionInfo&&"service"===(null==b?void 0:b.origin)&&N(b.layer)?{enabled:!1}:{allowNull:!0}}}}})],m.prototype,"labelExpression",void 0),(0,y._)([(0,A.w)("labelExpression")],m.prototype,"readLabelExpression",null),(0,y._)([(0,M.K)("labelExpression")],m.prototype,"writeLabelExpression",null),(0,y._)([(0,C.MZ)({type:d,json:{write:{overridePolicy:(f,L,b)=>function F(f){return E(f)||N(null==f?void 0:f.layer)}(b)?{allowNull:!0}:{enabled:!1}}}})],m.prototype,"labelExpressionInfo",void 0),(0,y._)([(0,M.K)("labelExpressionInfo")],m.prototype,"writeLabelExpressionInfo",null),(0,y._)([(0,C.MZ)({type:p.apiValues,json:{type:p.jsonValues,read:p.read,write:p.write}})],m.prototype,"labelPlacement",void 0),(0,y._)([(0,C.MZ)({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],m.prototype,"labelPosition",void 0),(0,y._)([(0,C.MZ)({type:Number})],m.prototype,"maxScale",void 0),(0,y._)([(0,M.K)("maxScale")],m.prototype,"writeMaxScale",null),(0,y._)([(0,C.MZ)({type:Number})],m.prototype,"minScale",void 0),(0,y._)([(0,M.K)("minScale")],m.prototype,"writeMinScale",null),(0,y._)([(0,C.MZ)({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:_}}}}})],m.prototype,"repeatLabel",void 0),(0,y._)([(0,C.MZ)({type:Number,cast:B.cr,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:_}}}}})],m.prototype,"repeatLabelDistance",void 0),(0,y._)([(0,C.MZ)({types:h.em,json:{origins:{"web-scene":{types:h.Rv,write:i.oO,default:null}},write:i.oO,default:null}})],m.prototype,"symbol",void 0),(0,y._)([(0,C.MZ)({type:Boolean,json:{write:!0}})],m.prototype,"useCodedValues",void 0),(0,y._)([(0,C.MZ)({type:String,json:{write:!0}})],m.prototype,"where",void 0),m=n=(0,y._)([(0,U.$)("esri.layers.support.LabelClass")],m);const g=m},38488:(z,Z,r)=>{r.d(Z,{A:()=>I});var y=r(8189),h=r(12849),$=r(99980),R=r(90660),G=r(71065),B=r(85211),A=(r(3248),r(35150),r(40707),r(17221)),U=r(76576),M=r(50305),D=r(22639);function S(d,v){return $.A.fromJSON({value:d,unit:v})}let j=class extends((0,R.O)(G.oY)){constructor(d){super(d),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(d,v){if(!v.timeExtent||!Array.isArray(v.timeExtent)||2!==v.timeExtent.length)return null;const o=new Date(v.timeExtent[0]),i=new Date(v.timeExtent[1]);return new h.A({start:o,end:i})}writeFullTimeExtent(d,v){v.timeExtent=null!=(null==d?void 0:d.start)&&null!=d.end?[d.start.getTime(),d.end.getTime()]:null}readInterval(d,v){return v.timeInterval&&v.timeIntervalUnits?S(v.timeInterval,v.timeIntervalUnits):v.defaultTimeInterval&&v.defaultTimeIntervalUnits?S(v.defaultTimeInterval,v.defaultTimeIntervalUnits):null}writeInterval(d,v){var o,i;v.timeInterval=null!==(o=null==d?void 0:d.toJSON().value)&&void 0!==o?o:null,v.timeIntervalUnits=null!==(i=null==d?void 0:d.toJSON().unit)&&void 0!==i?i:null}};(0,y._)([(0,B.MZ)({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],j.prototype,"cumulative",void 0),(0,y._)([(0,B.MZ)({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],j.prototype,"endField",void 0),(0,y._)([(0,B.MZ)({type:h.A,json:{write:{enabled:!0,allowNull:!0}}})],j.prototype,"fullTimeExtent",void 0),(0,y._)([(0,A.w)("fullTimeExtent",["timeExtent"])],j.prototype,"readFullTimeExtent",null),(0,y._)([(0,M.K)("fullTimeExtent")],j.prototype,"writeFullTimeExtent",null),(0,y._)([(0,B.MZ)({type:Boolean,json:{write:!0}})],j.prototype,"hasLiveData",void 0),(0,y._)([(0,B.MZ)({type:$.A,json:{write:{enabled:!0,allowNull:!0}}})],j.prototype,"interval",void 0),(0,y._)([(0,A.w)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],j.prototype,"readInterval",null),(0,y._)([(0,M.K)("interval")],j.prototype,"writeInterval",null),(0,y._)([(0,B.MZ)({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],j.prototype,"startField",void 0),(0,y._)([(0,B.MZ)((0,D.P6)("timeReference",!0))],j.prototype,"timeZone",void 0),(0,y._)([(0,B.MZ)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],j.prototype,"trackIdField",void 0),(0,y._)([(0,B.MZ)({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],j.prototype,"useTime",void 0),j=(0,y._)([(0,U.$)("esri.layers.support.TimeInfo")],j);const I=j},6829:(z,Z,r)=>{r.d(Z,{E1:()=>C,Fm:()=>x,JZ:()=>v,R_:()=>B,fu:()=>h,oF:()=>$,rq:()=>O});const y=[["binary","application/octet-stream","bin",""]];function h(o,i){var n;return null!=D(i.name,null!==(n=null==o?void 0:o.supportedFormats)&&void 0!==n?n:[])}function $(o,i){var n;if(!o)return!1;const p=O(i,null!==(n=o.supportedFormats)&&void 0!==n?n:[]);return null!=p&&o.editFormats.includes(p)}function B(o,i){return S(function M(o,i){const n=o.toLowerCase();return A(i).find(p=>j(p)===n)}(o,i))}function C(o,i){return S(D(o,i))}function x(o,i){return j(function U(o,i){return A(i).find(n=>S(n)===o)}(o,i))}function O(o,i){var n;return null!==(n=C(o.name,i))&&void 0!==n?n:B(o.type,i)}function A(o){return[...y,...o]}function D(o,i){const n=o.toLowerCase();return A(i).find(p=>function I(o){var i;return null!==(i=null==o?void 0:o[2].split(",").map(n=>n.toLowerCase()))&&void 0!==i?i:[]}(p).some(_=>n.endsWith(_)))}function S(o){return null==o?void 0:o[0]}function j(o){return null==o?void 0:o[1].toLowerCase()}function v(o){var i;return null===(i=o.tables)||void 0===i?void 0:i.find(n=>"assetMaps"===n.role)}},73975:(z,Z,r)=>{r.d(Z,{w:()=>C,z:()=>A});var y=r(5922),h=r(77806),$=r(35150),R=r(20329);const G=()=>$.A.getLogger("esri.layers.support.labelingInfo"),B=/\[([^\[\]]+)\]/gi;function C(M,D,S){return M?M.map(j=>{const I=new R.A;if(I.read(j,S),I.labelExpression){var d;const v=D.fields||(null===(d=D.layerDefinition)||void 0===d?void 0:d.fields)||this.fields;I.labelExpression=I.labelExpression.replaceAll(B,(o,i)=>`[${function x(M,D){if(!D)return M;const S=M.toLowerCase();for(let j=0;j<D.length;j++){const I=D[j].name;if(I.toLowerCase()===S)return I}return M}(i,v)}]`)}return I}):null}const O={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function A(M,D){const S=(0,h.o8)(M);return S.some(j=>function U(M,D){const S=M.labelPlacement,j=O[D];if(!M.symbol)return G().warn("No ILabelClass symbol specified."),!0;if(!j)return G().error(new y.A("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${D}' is not supported`)),!0;if(!j.includes(S)){const I=j[0];S&&G().warn(`Found invalid label placement type ${S} for ${D}. Defaulting to ${I}`),M.labelPlacement=I}return!1}(j,D))?[]:S}},69927:(z,Z,r)=>{r.d(Z,{It:()=>j,LG:()=>C,OM:()=>A,Sm:()=>U,Y:()=>x,bK:()=>O,mm:()=>S,sQ:()=>M});var y=r(10467),h=r(11817),$=r(32034),R=r(55039);function B(){return(B=(0,y.A)(function*(I){const d=I.spatialReference;if(d.isWGS84)return I.clone();if(d.isWebMercator)return(0,R.ci)(I);const v=$.A.WGS84;return yield(0,h.initializeProjection)(d,v),(0,h.project)(I,v)})).apply(this,arguments)}function C(I,d){if(!x(I,d)){const v=I.typeKeywords;v?v.push(d):I.typeKeywords=[d]}}function x(I,d){var v;return!(null===(v=I.typeKeywords)||void 0===v||!v.includes(d))}function O(I){return x(I,S.HOSTED_SERVICE)}function A(I,d){const v=I.typeKeywords;if(v){const o=v.indexOf(d);o>-1&&v.splice(o,1)}}function U(I,d,v){v?C(I,d):A(I,d)}function M(I){return D.apply(this,arguments)}function D(){return D=(0,y.A)(function*(I){const d=I.clone().normalize();let v;if(d.length>1)for(const o of d)v?o.width>v.width&&(v=o):v=o;else v=d[0];return function G(I){return B.apply(this,arguments)}(v)}),D.apply(this,arguments)}const S={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function j(I){var d;const{portal:v,isOrgItem:o,itemControl:i}=I,n=null===(d=v.user)||void 0===d?void 0:d.privileges;let p=!n||n.includes("features:user:edit"),_=!!o&&!(null==n||!n.includes("features:user:fullEdit"));const E="update"===i||"admin"===i;return E?_=p=!0:_&&(p=!0),{features:{edit:p,fullEdit:_},content:{updateItem:E}}}},26957:(z,Z,r)=>{r.d(Z,{j:()=>h});const h=(0,r(49976).O)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},8691:(z,Z,r)=>{r.d(Z,{L:()=>G});var y=r(10467),h=r(89447),$=r(56492),R=r(96996);function G(C,x,O){return B.apply(this,arguments)}function B(){return(B=(0,y.A)(function*(C,x,O){const A=C&&C.getAtOrigin&&C.getAtOrigin("renderer",x.origin);if(A&&"unique-value"===A.type&&A.styleOrigin){const U=yield(0,h.Ke)(A.populateFromStyle());if((0,$.Te)(O),!1===U.ok){const M=U.error;null!=x&&x.messages&&x.messages.push(new R.A("renderer:style-reference",`Failed to create unique value renderer from style reference: ${M.message}`,{error:M,context:x})),C.clear("renderer",null==x?void 0:x.origin)}}})).apply(this,arguments)}},52466:(z,Z,r)=>{r.d(Z,{A:()=>A});var x,y=r(8189),h=r(71065),$=r(77806),R=r(85211),G=r(55739),B=r(76576),C=r(50305);let O=x=class extends h.oY{constructor(U){super(U),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(U,M){M.resultOffset=this.start,M.resultRecordCount=this.num||10}clone(){return new x((0,$.o8)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};(0,y._)([(0,R.MZ)({type:[String],json:{write:!0}})],O.prototype,"attachmentTypes",void 0),(0,y._)([(0,R.MZ)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],O.prototype,"attachmentsWhere",void 0),(0,y._)([(0,R.MZ)({type:Boolean,json:{write:!0}})],O.prototype,"cacheHint",void 0),(0,y._)([(0,R.MZ)({type:[String],json:{write:!0}})],O.prototype,"keywords",void 0),(0,y._)([(0,R.MZ)({type:[Number],json:{write:!0}})],O.prototype,"globalIds",void 0),(0,y._)([(0,R.MZ)({json:{write:!0}})],O.prototype,"name",void 0),(0,y._)([(0,R.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],O.prototype,"num",void 0),(0,y._)([(0,R.MZ)({type:[Number],json:{write:!0}})],O.prototype,"objectIds",void 0),(0,y._)([(0,R.MZ)({type:Boolean,json:{default:!1,write:!0}})],O.prototype,"returnMetadata",void 0),(0,y._)([(0,R.MZ)({type:[Number],json:{write:!0}})],O.prototype,"size",void 0),(0,y._)([(0,R.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],O.prototype,"start",void 0),(0,y._)([(0,C.K)("start"),(0,C.K)("num")],O.prototype,"writeStart",null),(0,y._)([(0,R.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],O.prototype,"where",void 0),O=x=(0,y._)([(0,B.$)("esri.rest.support.AttachmentQuery")],O),O.from=(0,G.dp)(O);const A=O},41843:(z,Z,r)=>{r.d(Z,{tn:()=>D});var y=r(92165),h=r(86300),$=r(54042),C=(r(75432),r(65121),r(558),r(8975)),U=(r(90792),r(83902),r(98089),r(61099)),M=r(17580);function D({displayField:m,editFieldsInfo:g,fields:f,objectIdField:L,title:b},K){if(!f)return null;const V=function o(m,g){var f;const L=null==g?void 0:g.visibleFieldNames;return function I(m,g){const f=m;return g&&(m=m.filter(L=>!g.includes(L.type))),m===f&&(m=m.slice()),m.sort(d),m}(null!==(f=m.fields)&&void 0!==f?f:[],(null==g?void 0:g.ignoreFieldTypes)||F).map(b=>new U.A({fieldName:b.name,isEditable:(0,h.R$)(b,m),label:b.alias,format:p(b),visible:j(b,{...m,visibleFieldNames:L})}))}({editFieldsInfo:g,fields:f,objectIdField:L},K);if(!V.length)return null;const Y=function X(m){const g=(0,h.mB)(m),{titleBase:f}=m;return g?`${f}: {${g.trim()}}`:null!=f?f:""}({titleBase:b,fields:f,displayField:m}),H=function _(){return[new C.A,new $.A]}();return new y.A({title:Y,content:H,fieldInfos:V})}const j=(m,g)=>g.visibleFieldNames?g.visibleFieldNames.has(m.name):(0,h.Bz)(m,g);function d(m,g){return"oid"===m.type?-1:"oid"===g.type?1:N(m)?-1:N(g)?1:(m.alias||m.name).toLocaleLowerCase().localeCompare((g.alias||g.name).toLocaleLowerCase())}function p(m){switch(m.type){case"small-integer":case"integer":case"single":return new M.A({digitSeparator:!0,places:0});case"double":return new M.A({digitSeparator:!0,places:2});case"string":return(0,h.JL)(m.name)?new M.A({digitSeparator:!0,places:0}):null;default:return null}}function N(m){return"name"===(m.name&&m.name.toLowerCase())||"name"===(m.alias&&m.alias.toLowerCase())}const F=["geometry","blob","raster","guid","xml"]},30448:(z,Z,r)=>{r.d(Z,{TA:()=>R,We:()=>x,Z3:()=>G,ZJ:()=>A,w5:()=>M});var y=r(10467),h=r(89563);const R=(0,r(43085).vD)(),G=new Map,B=new Map;function x(D,S,j){return O.apply(this,arguments)}function O(){return(O=(0,y.A)(function*(D,S,j){if(!D||!j)return!1;if(!S)return!0;const I=new URL(D).host;let d=G.get(I);if(!d){const v=D.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");d=(yield(0,h.A)(v,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return d===S})).apply(this,arguments)}function A(D,S){return U.apply(this,arguments)}function U(){return(U=(0,y.A)(function*(D,S,j=!1){var I;if(!D||!S)return!0;const d=D.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),v=null===(I=B.get(d))||void 0===I?void 0:I.entries();if(v)for(const[i,n]of v)if(n.name===S){var o;const p=!(null!==(o=n.stack)&&void 0!==o&&o.hasForwardEdits());if(!p&&j){const[{deleteForwardEdits:_},{default:E}]=yield Promise.all([r.e(4570).then(r.bind(r,44570)),r.e(5566).then(r.bind(r,55566))]);return _(d,i,new E({sessionId:R,moment:n.moment}))}return p}return!0})).apply(this,arguments)}function M(D,S){var j;if(!D)return!1;const I=D.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),d=null===(j=B.get(I))||void 0===j?void 0:j.entries();if(d)for(const[v,o]of d)if(o.name===S)return"edit"===o.lockType;return!1}}}]);