"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1812],{94268:($t,Tt,j)=>{j.d(Tt,{a:()=>q,b:()=>vt,c:()=>It,f:()=>at,g:()=>At,j:()=>Qt,n:()=>w}),j(3248);var rt=j(35150),Q=j(69287),dt=j(92771),V=j(28714),lt=j(25866),z=j(53781),k=j(89141),ot=j(85952),C=j(41510),mt=j(55703),K=j(99608),Ot=j(19741);const Mt=It();function It(){return(0,k.vt)()}const tt=z.e,_t=z.e;function q(b,U){return(0,z.c)(U,b)}function vt(b){return b[3]}function At(b){return b}function at(b,U,D,X){return(0,k.fA)(b,U,D,X)}function Ut(b,U,D){if(null==U||!ht(b,U,st))return!1;let{t0:X,t1:y}=st;if((X<0||y<X&&y>0)&&(X=y),X<0)return!1;if(D){const{origin:et,direction:Et}=U;D[0]=et[0]+Et[0]*X,D[1]=et[1]+Et[1]*X,D[2]=et[2]+Et[2]*X}return!0}const st={t0:0,t1:0};function ht(b,U,D){const{origin:X,direction:y}=U,et=rn;et[0]=X[0]-b[0],et[1]=X[1]-b[1],et[2]=X[2]-b[2];const Et=y[0]*y[0]+y[1]*y[1]+y[2]*y[2];if(0===Et)return!1;const pt=2*(y[0]*et[0]+y[1]*et[1]+y[2]*et[2]),Kt=pt*pt-4*Et*(et[0]*et[0]+et[1]*et[1]+et[2]*et[2]-b[3]*b[3]);if(Kt<0)return!1;const wt=Math.sqrt(Kt);return D.t0=(-pt-wt)/(2*Et),D.t1=(-pt+wt)/(2*Et),!0}const rn=(0,lt.vt)();function Qt(b,U){return Ut(b,U,null)}function on(b,U,D){const X=Ot.rq.get(),y=Ot.Rc.get();(0,V.b)(X,U.origin,U.direction);const et=vt(b);(0,V.b)(D,X,U.origin),(0,V.h)(D,D,1/(0,V.l)(D)*et);const Et=xt(b,U.origin),pt=(0,K.g7)(U.origin,D);return(0,dt.$0)(y,pt+Et,X),(0,V.e)(D,D,y),D}function Nt(b,U,D){const X=(0,V.f)(Ot.rq.get(),U,b),y=(0,V.h)(Ot.rq.get(),X,b[3]/(0,V.l)(X));return(0,V.g)(D,y,b)}function xt(b,U){const D=(0,V.f)(Ot.rq.get(),U,b),X=(0,V.l)(D),y=vt(b),et=y+Math.abs(y-X);return(0,Q.XM)(y/et)}const bt=(0,lt.vt)();function Yt(b,U,D,X){const y=(0,V.f)(bt,U,b);switch(D){case C._.X:{const et=(0,Q.jU)(y,bt)[2];return(0,V.s)(X,-Math.sin(et),Math.cos(et),0)}case C._.Y:{const et=(0,Q.jU)(y,bt),Et=et[1],pt=et[2],Kt=Math.sin(Et);return(0,V.s)(X,-Kt*Math.cos(pt),-Kt*Math.sin(pt),Math.cos(Et))}case C._.Z:return(0,V.n)(X,y);default:return}}function kt(b,U){const D=(0,V.f)(qt,U,b);return(0,V.l)(D)-b[3]}function w(b,U){const D=(0,V.a)(b,U),X=vt(b);return D<=X*X}const qt=(0,lt.vt)(),hn=It();Object.freeze(Object.defineProperty({__proto__:null,NullSphere:Mt,altitudeAt:kt,angleToSilhouette:xt,axisAt:Yt,clear:function it(b){b[0]=b[1]=b[2]=b[3]=0},closestPoint:function Zt(b,U,D){return Ut(b,U,D)?D:((0,mt.oC)(U,b,D),Nt(b,D,D))},closestPointOnSilhouette:on,containsPoint:w,copy:q,create:It,distanceToSilhouette:function Jt(b,U){const D=(0,V.f)(Ot.rq.get(),U,b),X=(0,V.p)(D);return Math.sqrt(Math.abs(X-b[3]*b[3]))},elevate:function Dt(b,U,D){return b!==D&&(D[0]=b[0],D[1]=b[1],D[2]=b[2]),D[3]=b[3]+U,D},equals:_t,exactEquals:tt,fromCenterAndRadius:function Gt(b,U){return(0,k.fA)(b[0],b[1],b[2],U)},fromRadius:function nt(b,U){return b[0]=b[1]=b[2]=0,b[3]=U,b},fromValues:at,getCenter:At,getRadius:vt,intersectLine:function zt(b,U,D){const X=(0,mt.Cr)(U,D);if(!ht(b,X,st))return[];const{origin:y,direction:et}=X,{t0:Et,t1:pt}=st,Kt=wt=>{const Vt=(0,lt.vt)();return(0,V.r)(Vt,y,et,wt),Nt(b,Vt,Vt)};return Math.abs(Et-pt)<(0,ot.FD)()?[Kt(Et)]:[Kt(Et),Kt(pt)]},intersectRay:Ut,intersectRayClosestSilhouette:function cn(b,U,D){if(Ut(b,U,D))return D;const X=on(b,U,Ot.rq.get());return(0,V.g)(D,U.origin,(0,V.h)(Ot.rq.get(),U.direction,(0,V.q)(U.origin,X)/(0,V.l)(U.direction))),D},intersectsRay:Qt,projectPoint:Nt,setAltitudeAt:function Ct(b,U,D,X){const y=kt(b,U),et=Yt(b,U,C._.Z,qt),Et=(0,V.h)(qt,et,D-y);return(0,V.g)(X,U,Et)},setExtent:function Ft(b,U,D){return rt.A.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),b!==D&&q(b,D),D},tmpSphere:hn,union:function ln(b,U,D=(0,k.vt)()){const X=(0,V.q)(b,U),y=b[3],et=U[3];return X+et<y?((0,z.c)(D,b),D):X+y<et?((0,z.c)(D,U),D):((0,V.m)(D,b,U,(X+et-y)/(2*X)),D[3]=(X+y+et)/2,D)},wrap:function Y(b){return b}},Symbol.toStringTag,{value:"Module"}))},84149:($t,Tt,j)=>{j.d(Tt,{I:()=>rt});var ut=j(64662);class rt{constructor(V){this._allocator=V,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,ut.d)(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const V=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*Q);this._items.length=Math.min(V,this._items.length),this._itemsPtr=0}_grow(){for(let V=0;V<Math.max(8,Math.min(this._items.length,Q));V++)this._items.push(this._allocator())}}const Q=1024},32954:($t,Tt,j)=>{function ut(){return[1,0,0,0,1,0,0,0,1]}function Q(z,k,ot,C,mt,K,Ot,Mt,It){return[z,k,ot,C,mt,K,Ot,Mt,It]}j.d(Tt,{fA:()=>Q,vt:()=>ut,zK:()=>V});const V=[1,0,0,0,1,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:V,clone:function rt(z){return[z[0],z[1],z[2],z[3],z[4],z[5],z[6],z[7],z[8]]},create:ut,createView:function dt(z,k){return new Float64Array(z,k,9)},fromValues:Q},Symbol.toStringTag,{value:"Module"}))},62789:($t,Tt,j)=>{function ut(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function rt(z){return[z[0],z[1],z[2],z[3],z[4],z[5],z[6],z[7],z[8],z[9],z[10],z[11],z[12],z[13],z[14],z[15]]}j.d(Tt,{o8:()=>rt,vt:()=>ut,zK:()=>V});const V=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:V,clone:rt,create:ut,createView:function dt(z,k){return new Float64Array(z,k,16)},fromValues:function Q(z,k,ot,C,mt,K,Ot,Mt,It,tt,_t,q,Gt,Y,it,nt){return[z,k,ot,C,mt,K,Ot,Mt,It,tt,_t,q,Gt,Y,it,nt]}},Symbol.toStringTag,{value:"Module"}))},14214:($t,Tt,j)=>{function ut(){return[0,0,0,1]}function rt(z){return[z[0],z[1],z[2],z[3]]}j.d(Tt,{o8:()=>rt,vt:()=>ut,zK:()=>V});const V=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:V,clone:rt,create:ut,createView:function dt(z,k){return new Float64Array(z,k,4)},fromValues:function Q(z,k,ot,C){return[z,k,ot,C]}},Symbol.toStringTag,{value:"Module"}))},71548:($t,Tt,j)=>{j.d(Tt,{Cr:()=>C,_I:()=>K,vt:()=>lt});var ut=j(69287),rt=j(84149),Q=j(28714),dt=j(25866),V=j(19741);function lt(Y){return Y?{origin:(0,dt.o8)(Y.origin),vector:(0,dt.o8)(Y.vector)}:{origin:(0,dt.vt)(),vector:(0,dt.vt)()}}function C(Y,it,nt=lt()){return(0,Q.c)(nt.origin,Y),(0,Q.f)(nt.vector,it,Y),nt}function K(Y,it,nt){return function Mt(Y,it,nt,vt,At){const{vector:at,origin:Dt}=Y,Ft=(0,Q.f)(V.rq.get(),it,Dt),Ut=(0,Q.k)(at,Ft)/(0,Q.p)(at);return(0,Q.h)(At,at,(0,ut.qE)(Ut,nt,vt)),(0,Q.g)(At,At,Y.origin)}(Y,it,0,1,nt)}(0,dt.vt)(),(0,dt.vt)(),new rt.I(()=>lt())},22515:($t,Tt,j)=>{j.d(Tt,{vt:()=>Dt,lU:()=>Zt,Qj:()=>ht}),j(69287);var rt=j(28714),Q=j(25866);function Dt(v=Ht){return[v[0],v[1],v[2],v[3]]}function ht(v){return v}function Zt(v,E,p,S=0,L=Math.floor(p*(1/3)),Z=Math.floor(p*(2/3))){if(p<3)return!1;E(xt,S);let J=L,ct=!1;for(;J<p-1&&!ct;)E(bt,J),J++,ct=!(0,rt.j)(xt,bt);if(!ct)return!1;for(J=Math.max(J,Z),ct=!1;J<p&&!ct;)E(Yt,J),J++,(0,rt.f)(kt,xt,bt),(0,rt.n)(kt,kt),(0,rt.f)(Ct,bt,Yt),(0,rt.n)(Ct,Ct),ct=!(0,rt.j)(xt,Yt)&&!(0,rt.j)(bt,Yt)&&Math.abs((0,rt.k)(kt,Ct))<Jt;return ct?(function on(v,E,p,S=Dt()){const L=p[0]-E[0],Z=p[1]-E[1],J=p[2]-E[2],ct=v[0]-E[0],jt=v[1]-E[1],Rt=v[2]-E[2],Wt=Z*Rt-J*jt,tn=J*ct-L*Rt,Xt=L*jt-Z*ct,Lt=Wt*Wt+tn*tn+Xt*Xt,nn=Math.abs(Lt-1)>1e-5&&Lt>1e-12?1/Math.sqrt(Lt):1;S[0]=Wt*nn,S[1]=tn*nn,S[2]=Xt*nn,S[3]=-(S[0]*v[0]+S[1]*v[1]+S[2]*v[2])}(xt,bt,Yt,v),!0):(0!==S||1!==L||2!==Z)&&Zt(v,E,p,0,1,2)}j(53781),j(99608),j(19741),(0,Q.vt)(),(0,Q.vt)(),(0,Q.vt)(),(0,Q.vt)(),(0,Q.vt)();const Jt=.99619469809,xt=(0,Q.vt)(),bt=(0,Q.vt)(),Yt=(0,Q.vt)(),kt=(0,Q.vt)(),Ct=(0,Q.vt)(),Ht=[0,0,1,0];var Bt,v;(v=Bt||(Bt={}))[v.NONE=0]="NONE",v[v.CLAMP=1]="CLAMP",v[v.INFINITE_MIN=4]="INFINITE_MIN",v[v.INFINITE_MAX=8]="INFINITE_MAX"},55703:($t,Tt,j)=>{j.d(Tt,{Cr:()=>mt,LV:()=>ot,oC:()=>Mt,vt:()=>lt}),j(89952);var rt=j(84149),Q=j(28714),dt=j(25866);function lt(tt){return tt?z((0,dt.o8)(tt.origin),(0,dt.o8)(tt.direction)):z((0,dt.vt)(),(0,dt.vt)())}function z(tt,_t){return{origin:tt,direction:_t}}function ot(tt,_t){const q=It.get();return q.origin=tt,q.direction=_t,q}function mt(tt,_t,q=lt()){return(0,Q.c)(q.origin,tt),(0,Q.f)(q.direction,_t,tt),q}function Mt(tt,_t,q){const Gt=(0,Q.k)(tt.direction,(0,Q.f)(q,_t,tt.origin));return(0,Q.g)(q,tt.origin,(0,Q.h)(q,tt.direction,Gt)),q}j(19741);const It=new rt.I(()=>lt())},99608:($t,Tt,j)=>{j.d(Tt,{g7:()=>lt});var ut=j(69287),rt=j(28714),Q=j(25866);function lt(C,mt){const K=(0,rt.k)(C,mt)/((0,rt.l)(C)*(0,rt.l)(mt));return-(0,ut.XM)(K)}(0,Q.vt)(),(0,Q.vt)()},19741:($t,Tt,j)=>{j.d(Tt,{Rc:()=>Ot,J8:()=>Mt,rq:()=>C});var ut=j(64662),rt=j(32954),Q=j(62789),dt=j(14214),V=j(45475),lt=j(25866),z=j(89141);class k{constructor(tt){this._create=tt,this._items=new Array,this._itemsPtr=0}get(){return 0===this._itemsPtr&&(0,ut.d)(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const tt=2*this._itemsPtr;this._items.length>tt&&(this._items.length=tt),this._itemsPtr=0}static createVec2f64(){return new k(V.vt)}static createVec3f64(){return new k(lt.vt)}static createVec4f64(){return new k(z.vt)}static createMat3f64(){return new k(rt.vt)}static createMat4f64(){return new k(Q.vt)}static createQuatf64(){return new k(dt.vt)}get test(){return{length:this._items.length}}}k.createVec2f64();const C=k.createVec3f64(),Ot=(k.createVec4f64(),k.createMat3f64(),k.createMat4f64()),Mt=k.createQuatf64()},31812:($t,Tt,j)=>{j.r(Tt),j.d(Tt,{default:()=>Mn});var Ct,w,A,ut=j(10467),rt=j(8189),Q=j(56492),k=(j(35150),j(3248),j(40707),j(5922),j(76576)),ot=j(28714),C=j(25866),mt=j(71548),K=j(94268),Ot=j(61591),Mt=j(12438),It=j(84149),q=(j(92771),j(53781),j(89141)),Gt=j(55703);function Y(A){return A?{ray:(0,Gt.vt)(A.ray),c0:A.c0,c1:A.c1}:{ray:(0,Gt.vt)(),c0:0,c1:Number.MAX_VALUE}}function Nt(A,d){for(let l=0;l<qt;l++){const T=A[l];if(T[0]*d[0]+T[1]*d[1]+T[2]*d[2]+T[3]>=d[3])return!1}return!0}new It.I(()=>Y()),j(22515),j(19741),(A=Ct||(Ct={}))[A.LEFT=0]="LEFT",A[A.RIGHT=1]="RIGHT",A[A.BOTTOM=2]="BOTTOM",A[A.TOP=3]="TOP",A[A.NEAR=4]="NEAR",A[A.FAR=5]="FAR",function(A){A[A.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",A[A.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",A[A.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",A[A.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",A[A.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",A[A.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",A[A.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",A[A.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(w||(w={}));const qt=6;(0,q.fA)(-1,-1,-1,1),(0,q.fA)(1,-1,-1,1),(0,q.fA)(1,1,-1,1),(0,q.fA)(-1,1,-1,1),(0,q.fA)(-1,-1,1,1),(0,q.fA)(1,-1,1,1),(0,q.fA)(1,1,1,1),(0,q.fA)(-1,1,1,1),new It.I(Y),function Qt(){(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)()}();var D=j(65388);class X{get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}constructor(d,l){this.objectToBoundingSphere=d,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new y,this._objectCount=0,l&&(void 0!==l.maximumObjectsPerNode&&(this._maximumObjectsPerNode=l.maximumObjectsPerNode),void 0!==l.maximumDepth&&(this._maximumDepth=l.maximumDepth))}destroy(){this._degenerateObjects.clear(),y.clearPool(),E[0]=null,ct.prune(),Lt.prune()}add(d,l=d.length){this._objectCount+=l,this._grow(d,l);const T=y.acquire();for(let P=0;P<l;P++){const x=d[P];this._isDegenerate(x)?this._degenerateObjects.add(x):(T.init(this._root),this._add(x,T))}y.release(T)}remove(d,l=null){this._objectCount-=d.length;const T=y.acquire();for(const P of d){const x=null!=l?l:(0,K.a)(this.objectToBoundingSphere(P),jt);Bt(x[3])?(T.init(this._root),this._remove(P,x,T)):this._degenerateObjects.delete(P)}y.release(T),this._shrink()}update(d,l){if(!Bt(l[3])&&this._isDegenerate(d))return;const T=function p(A){return E[0]=A,E}(d);this.remove(T,l),this.add(T)}forEachAlongRay(d,l,T){const P=(0,Gt.LV)(d,l);this._forEachNode(this._root,x=>{if(!this._intersectsNode(P,x))return!1;const H=x.node;return H.terminals.forAll($=>{this._intersectsObject(P,$)&&T($)}),null!==H.residents&&H.residents.forAll($=>{this._intersectsObject(P,$)&&T($)}),!0})}forEachAlongRayWithVerticalOffset(d,l,T,P){const x=(0,Gt.LV)(d,l);this._forEachNode(this._root,H=>{if(!this._intersectsNodeWithOffset(x,H,P))return!1;const $=H.node;return $.terminals.forAll(W=>{this._intersectsObjectWithOffset(x,W,P)&&T(W)}),null!==$.residents&&$.residents.forAll(W=>{this._intersectsObjectWithOffset(x,W,P)&&T(W)}),!0})}forEach(d){this._forEachNode(this._root,l=>{const T=l.node;return T.terminals.forAll(d),null!==T.residents&&T.residents.forAll(d),!0}),this._degenerateObjects.forEach(d)}forEachDegenerateObject(d){this._degenerateObjects.forEach(d)}findClosest(d,l,T,P=(()=>!0),x=1/0){let H=1/0,$=1/0,W=null;const ft=Vt(d,l),Pt=gt=>{if(--x,!P(gt))return;const yt=this.objectToBoundingSphere(gt);if(!Nt(T,yt))return;const en=Ht(d,l,(0,K.g)(yt)),an=en-yt[3];an<H&&(H=an,$=en+yt[3],W=gt)};return this._forEachNodeDepthOrdered(this._root,gt=>{if(x<=0||!Nt(T,gt.bounds)||((0,ot.h)(L,ft,gt.halfSize),(0,ot.g)(L,L,(0,K.g)(gt.bounds)),Ht(d,l,L)>$))return!1;const yt=gt.node;return yt.terminals.forAll(en=>Pt(en)),null!==yt.residents&&yt.residents.forAll(en=>Pt(en)),!0},d,l),W}forEachInDepthRange(d,l,T,P,x,H,$){let W=-1/0,ft=1/0;const Pt={setRange:St=>{T===X.DepthOrder.FRONT_TO_BACK?(W=Math.max(W,St.near),ft=Math.min(ft,St.far)):(W=Math.max(W,-St.far),ft=Math.min(ft,-St.near))}};Pt.setRange(P);const gt=Ht(l,T,d),yt=Vt(l,T),en=Vt(l,-T),an=St=>{if(!$(St))return;const sn=this.objectToBoundingSphere(St),un=(0,K.g)(sn),On=Ht(l,T,un)-gt;On-sn[3]>ft||On+sn[3]<W||!Nt(H,sn)||x(St,Pt)};this._forEachNodeDepthOrdered(this._root,St=>{if(!Nt(H,St.bounds)||((0,ot.h)(L,yt,St.halfSize),(0,ot.g)(L,L,(0,K.g)(St.bounds)),Ht(l,T,L)-gt>ft)||((0,ot.h)(L,en,St.halfSize),(0,ot.g)(L,L,(0,K.g)(St.bounds)),Ht(l,T,L)-gt<W))return!1;const sn=St.node;return sn.terminals.forAll(un=>an(un)),null!==sn.residents&&sn.residents.forAll(un=>an(un)),!0},l,T)}forEachNode(d){this._forEachNode(this._root,l=>d(l.node,l.bounds,l.halfSize,l.depth))}forEachNeighbor(d,l){const T=(0,K.b)(l),P=(0,K.g)(l),x=W=>{const ft=this.objectToBoundingSphere(W),Pt=(0,K.b)(ft),gt=T+Pt;return!((0,ot.a)((0,K.g)(ft),P)-gt*gt<=0)||d(W)};let H=!0;const $=W=>{H&&(H=x(W))};this._forEachNode(this._root,W=>{const ft=(0,K.b)(W.bounds),Pt=T+ft;if((0,ot.a)((0,K.g)(W.bounds),P)-Pt*Pt>0)return!1;const gt=W.node;return gt.terminals.forAll($),H&&null!==gt.residents&&gt.residents.forAll($),H}),H&&this.forEachDegenerateObject($)}_intersectsNode(d,l){return pt((0,K.g)(l.bounds),2*-l.halfSize,Z),pt((0,K.g)(l.bounds),2*l.halfSize,J),(0,D.O_)(d.origin,d.direction,Z,J)}_intersectsNodeWithOffset(d,l,T){return pt((0,K.g)(l.bounds),2*-l.halfSize,Z),pt((0,K.g)(l.bounds),2*l.halfSize,J),T.applyToMinMax(Z,J),(0,D.O_)(d.origin,d.direction,Z,J)}_intersectsObject(d,l){const T=this.objectToBoundingSphere(l);return!(T[3]>0)||(0,K.j)(T,d)}_intersectsObjectWithOffset(d,l,T){const P=this.objectToBoundingSphere(l);return!(P[3]>0)||(0,K.j)(T.applyToBoundingSphere(P),d)}_forEachNode(d,l){let T=y.acquire().init(d);const P=[T];for(;0!==P.length;){if(T=P.pop(),l(T)&&!T.isLeaf())for(let x=0;x<T.node.children.length;x++)T.node.children[x]&&P.push(y.acquire().init(T).advance(x));y.release(T)}}_forEachNodeDepthOrdered(d,l,T,P=X.DepthOrder.FRONT_TO_BACK){let x=y.acquire().init(d);const H=[x];for(function wt(A,d,l){if(!Lt.length)for(let T=0;T<8;++T)Lt.push({index:0,distance:0});for(let T=0;T<8;++T){const P=fn[T];Lt.data[T].index=T,Lt.data[T].distance=Ht(A,d,P)}Lt.sort((T,P)=>T.distance-P.distance);for(let T=0;T<8;++T)l[T]=Lt.data[T].index}(T,P,nn);0!==H.length;){if(x=H.pop(),l(x)&&!x.isLeaf())for(let $=7;$>=0;--$){const W=nn[$];x.node.children[W]&&H.push(y.acquire().init(x).advance(W))}y.release(x)}}_remove(d,l,T){ct.clear();const P=T.advanceTo(l,(x,H)=>{ct.push(x.node),ct.push(H)})?T.node.terminals:T.node.residents;if(P.removeUnordered(d),0===P.length)for(let x=ct.length-2;x>=0&&this._purge(ct.data[x],ct.data[x+1]);x-=2);}_nodeIsEmpty(d){if(0!==d.terminals.length)return!1;if(null!==d.residents)return 0===d.residents.length;for(let l=0;l<d.children.length;l++)if(d.children[l])return!1;return!0}_purge(d,l){return l>=0&&(d.children[l]=null),!!this._nodeIsEmpty(d)&&(null===d.residents&&(d.residents=new Mt.A({shrink:!0})),!0)}_add(d,l){l.advanceTo(this.objectToBoundingSphere(d))?l.node.terminals.push(d):(l.node.residents.push(d),l.node.residents.length>this._maximumObjectsPerNode&&l.depth<this._maximumDepth&&this._split(l))}_split(d){const l=d.node.residents;d.node.residents=null;for(let T=0;T<l.length;T++){const P=y.acquire().init(d);this._add(l.at(T),P),y.release(P)}}_grow(d,l){if(0!==l&&(Kt(d,l,T=>this.objectToBoundingSphere(T),Rt),Bt(Rt[3])&&!this._fitsInsideTree(Rt)))if(this._nodeIsEmpty(this._root.node))(0,K.a)(Rt,this._root.bounds),this._root.halfSize=1.25*this._root.bounds[3],this._root.updateBoundsRadiusFromHalfSize();else{const T=this._rootBoundsForRootAsSubNode(Rt);this._placingRootViolatesMaxDepth(T)?this._rebuildTree(Rt,T):this._growRootAsSubNode(T),y.release(T)}}_rebuildTree(d,l){(0,ot.c)((0,K.g)(Wt),(0,K.g)(l.bounds)),Wt[3]=l.halfSize,Kt([d,Wt],2,P=>P,tn);const T=y.acquire().init(this._root);this._root.initFrom(null,tn,tn[3]),this._root.increaseHalfSize(1.25),this._forEachNode(T,P=>(this.add(P.node.terminals.data,P.node.terminals.length),null!==P.node.residents&&this.add(P.node.residents.data,P.node.residents.length),!0)),y.release(T)}_placingRootViolatesMaxDepth(d){const l=Math.log(d.halfSize/this._root.halfSize)*Math.LOG2E;let T=0;return this._forEachNode(this._root,P=>(T=Math.max(T,P.depth),T+l<=this._maximumDepth)),T+l>this._maximumDepth}_rootBoundsForRootAsSubNode(d){const l=d[3],T=d;let P=-1/0;const x=this._root.bounds,H=this._root.halfSize;for(let W=0;W<3;W++){const Pt=T[W]+l-(x[W]+H),gt=Math.max(0,Math.ceil((x[W]-H-(T[W]-l))/(2*H))),yt=Math.max(0,Math.ceil(Pt/(2*H)))+1,en=2**Math.ceil(Math.log(gt+yt)*Math.LOG2E);P=Math.max(P,en),Xt[W].min=gt,Xt[W].max=yt}for(let W=0;W<3;W++){let ft=Xt[W].min,Pt=Xt[W].max;const gt=(P-(ft+Pt))/2;ft+=Math.ceil(gt),Pt+=Math.floor(gt),S[W]=x[W]-H-ft*H*2+(Pt+ft)*H}const $=P*H;return S[3]=$*v,y.acquire().initFrom(null,S,$,0)}_growRootAsSubNode(d){const l=this._root.node;(0,ot.c)((0,K.g)(Rt),(0,K.g)(this._root.bounds)),Rt[3]=this._root.halfSize,this._root.init(d),d.advanceTo(Rt,null,!0),d.node.children=l.children,d.node.residents=l.residents,d.node.terminals=l.terminals}_shrink(){for(;;){const d=this._findShrinkIndex();if(-1===d)break;this._root.advance(d),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let d=null;const l=this._root.node.children;let T=0,P=0;for(;P<l.length&&null==d;)T=P++,d=l[T];for(;P<l.length;)if(l[P++])return-1;return T}_isDegenerate(d){return!Bt(this.objectToBoundingSphere(d)[3])}_fitsInsideTree(d){const l=this._root.bounds,T=this._root.halfSize;return d[3]<=T&&d[0]>=l[0]-T&&d[0]<=l[0]+T&&d[1]>=l[1]-T&&d[1]<=l[1]+T&&d[2]>=l[2]-T&&d[2]<=l[2]+T}toJSON(){const{maximumDepth:d,maximumObjectsPerNode:l,_objectCount:T}=this,P=this._nodeToJSON(this._root.node);return{maximumDepth:d,maximumObjectsPerNode:l,objectCount:T,root:{bounds:this._root.bounds,halfSize:this._root.halfSize,depth:this._root.depth,node:P}}}_nodeToJSON(d){var l,T;return{children:d.children.map($=>$?this._nodeToJSON($):null),residents:null===(l=d.residents)||void 0===l?void 0:l.map($=>this.objectToBoundingSphere($)),terminals:null===(T=d.terminals)||void 0===T?void 0:T.map($=>this.objectToBoundingSphere($))}}static fromJSON(d){const l=new X(T=>T,{maximumDepth:d.maximumDepth,maximumObjectsPerNode:d.maximumObjectsPerNode});return l._objectCount=d.objectCount,l._root.initFrom(d.root.node,d.root.bounds,d.root.halfSize,d.root.depth),l}}class y{constructor(){this.bounds=(0,K.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}init(d){return this.initFrom(d.node,d.bounds,d.halfSize,d.depth)}initFrom(d,l,T,P=this.depth){return this.node=null!=d?d:y.createEmptyNode(),l&&(0,K.a)(l,this.bounds),this.halfSize=T,this.depth=P,this}increaseHalfSize(d){this.halfSize*=d,this.updateBoundsRadiusFromHalfSize()}updateBoundsRadiusFromHalfSize(){this.bounds[3]=this.halfSize*v}advance(d){let l=this.node.children[d];l||(l=y.createEmptyNode(),this.node.children[d]=l),this.node=l,this.halfSize/=2,this.depth++;const T=fn[d];return this.bounds[0]+=T[0]*this.halfSize,this.bounds[1]+=T[1]*this.halfSize,this.bounds[2]+=T[2]*this.halfSize,this.updateBoundsRadiusFromHalfSize(),this}advanceTo(d,l,T=!1){for(;;){if(this.isTerminalFor(d))return l&&l(this,-1),!0;if(this.isLeaf()){if(!T)return l&&l(this,-1),!1;this.node.residents=null}const P=this._childIndex(d);l&&l(this,P),this.advance(P)}}isLeaf(){return null!=this.node.residents}isTerminalFor(d){return d[3]>this.halfSize/2}_childIndex(d){const l=this.bounds;return(l[0]<d[0]?1:0)+(l[1]<d[1]?2:0)+(l[2]<d[2]?4:0)}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new Mt.A({shrink:!0}),residents:new Mt.A({shrink:!0})}}static acquire(){return y._pool.acquire()}static release(d){y._pool.release(d)}static clearPool(){y._pool.prune()}}function et(A,d){A[0]=Math.min(A[0],d[0]-d[3]),A[1]=Math.min(A[1],d[1]-d[3]),A[2]=Math.min(A[2],d[2]-d[3])}function Et(A,d){A[0]=Math.max(A[0],d[0]+d[3]),A[1]=Math.max(A[1],d[1]+d[3]),A[2]=Math.max(A[2],d[2]+d[3])}function pt(A,d,l){l[0]=A[0]+d,l[1]=A[1]+d,l[2]=A[2]+d}function Kt(A,d,l,T){if(1===d){const P=l(A[0]);(0,K.a)(P,T)}else{Z[0]=1/0,Z[1]=1/0,Z[2]=1/0,J[0]=-1/0,J[1]=-1/0,J[2]=-1/0;for(let P=0;P<d;P++){const x=l(A[P]);Bt(x[3])&&(et(Z,x),Et(J,x))}(0,ot.m)((0,K.g)(T),Z,J,.5),T[3]=Math.max(J[0]-Z[0],J[1]-Z[1],J[2]-Z[2])/2}}function Vt(A,d){let l,T=1/0;for(let P=0;P<8;++P){const x=Ht(A,d,dn[P]);x<T&&(T=x,l=dn[P])}return l}function Ht(A,d,l){return d*(A[0]*l[0]+A[1]*l[1]+A[2]*l[2])}function Bt(A){return!isNaN(A)&&A!==-1/0&&A!==1/0&&A>0}y._pool=new Ot.A(y),function(A){var d;(d=A.DepthOrder||(A.DepthOrder={}))[d.FRONT_TO_BACK=1]="FRONT_TO_BACK",d[d.BACK_TO_FRONT=-1]="BACK_TO_FRONT"}(X||(X={}));const fn=[(0,C.fA)(-1,-1,-1),(0,C.fA)(1,-1,-1),(0,C.fA)(-1,1,-1),(0,C.fA)(1,1,-1),(0,C.fA)(-1,-1,1),(0,C.fA)(1,-1,1),(0,C.fA)(-1,1,1),(0,C.fA)(1,1,1)],dn=[(0,C.fA)(-1,-1,-1),(0,C.fA)(-1,-1,1),(0,C.fA)(-1,1,-1),(0,C.fA)(-1,1,1),(0,C.fA)(1,-1,-1),(0,C.fA)(1,-1,1),(0,C.fA)(1,1,-1),(0,C.fA)(1,1,1)],v=Math.sqrt(3),E=[null],S=(0,K.c)(),L=(0,C.vt)(),Z=(0,C.vt)(),J=(0,C.vt)(),ct=new Mt.A,jt=(0,K.c)(),Rt=(0,K.c)(),Wt=(0,K.c)(),tn=(0,K.c)(),Xt=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],Lt=new Mt.A,nn=[0,0,0,0,0,0,0,0],mn=X;var Tn=j(15096);function En(A,d,l){const T=(0,K.c)(),P=(0,K.g)(T);return(0,ot.r)(P,P,A,.5),(0,ot.r)(P,P,d,.5),T[3]=(0,ot.q)(P,A),(0,ot.g)(P,P,l),T}let gn=class{constructor(){this._idToComponent=new Map,this._components=new mn(A=>A.bounds),this._edges=new mn(A=>A.bounds),this._tmpLineSegment=(0,mt.vt)(),this._tmpP1=(0,C.vt)(),this._tmpP2=(0,C.vt)(),this._tmpP3=(0,C.vt)(),this.remoteClient=null}fetchCandidates(A,d){var l=this;return(0,ut.A)(function*(){yield Promise.resolve(),(0,Q.Te)(d),yield l._ensureEdgeLocations(A,d);const T=[];return l._edges.forEachNeighbor(P=>(l._addCandidates(A,P,T),T.length<1e3),A.bounds),{result:{candidates:T}}})()}_ensureEdgeLocations(A,d){var l=this;return(0,ut.A)(function*(){const T=[];if(l._components.forEachNeighbor(H=>{if(null==H.info){const{id:$,uid:W}=H;T.push({id:$,uid:W})}return!0},A.bounds),!T.length)return;const P={components:T},x=yield l.remoteClient.invoke("fetchAllEdgeLocations",P,null!=d?d:{});for(const H of x.components)l._setFetchEdgeLocations(H)})()}add(A){var d=this;return(0,ut.A)(function*(){const l=new An(A.id,A.bounds);return d._idToComponent.set(l.id,l),d._components.add([l]),{result:{}}})()}remove(A){var d=this;return(0,ut.A)(function*(){const l=d._idToComponent.get(A.id);if(l){const T=[];d._edges.forEachNeighbor(P=>(P.component===l&&T.push(P),!0),l.bounds),d._edges.remove(T),d._components.remove([l]),d._idToComponent.delete(l.id)}return{result:{}}})()}_setFetchEdgeLocations(A){const d=this._idToComponent.get(A.id);if(null==d||A.uid!==d.uid)return;const l=Tn.HY.createView(A.locations),T=new Array(l.count),P=(0,C.vt)(),x=(0,C.vt)();for(let W=0;W<l.count;W++){l.position0.getVec(W,P),l.position1.getVec(W,x);const ft=En(P,x,A.origin),Pt=new pn(d,W,ft);T[W]=Pt}this._edges.add(T);const{objectIds:H,origin:$}=A;d.info={locations:l,objectIds:H,origin:$}}_addCandidates(A,d,l){const{info:T}=d.component,{origin:P,objectIds:x}=T,H=T.locations,$=H.position0.getVec(d.index,this._tmpP1),W=H.position1.getVec(d.index,this._tmpP2);(0,ot.g)($,$,P),(0,ot.g)(W,W,P);const ft=x[H.componentIndex.get(d.index)];this._addEdgeCandidate(A,ft,$,W,l),this._addVertexCandidate(A,ft,$,l),this._addVertexCandidate(A,ft,W,l)}_addEdgeCandidate(A,d,l,T,P){if(!A.returnEdge)return;const x=(0,K.g)(A.bounds),H=(0,mt.Cr)(l,T,this._tmpLineSegment),$=(0,mt._I)(H,x,this._tmpP3);(0,K.n)(A.bounds,$)&&P.push({type:"edge",objectId:d,target:(0,C.o8)($),distance:(0,ot.q)(x,$),start:(0,C.o8)(l),end:(0,C.o8)(T)})}_addVertexCandidate(A,d,l,T){if(!A.returnVertex||!(0,K.n)(A.bounds,l))return;const P=(0,K.g)(A.bounds);T.push({type:"vertex",objectId:d,target:(0,C.o8)(l),distance:(0,ot.q)(P,l)})}};gn=(0,rt._)([(0,k.$)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],gn);const Mn=gn;let An=(()=>{class A{constructor(l,T){this.id=l,this.bounds=T,this.info=null,this.uid=++A.uid}}return A.uid=0,A})();class pn{constructor(d,l,T){this.component=d,this.index=l,this.bounds=T}}}}]);