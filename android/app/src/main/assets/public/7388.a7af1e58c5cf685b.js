"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7388,9927],{53781:(je,de,h)=>{h.d(de,{a:()=>S,b:()=>W,c:()=>z,e:()=>x,f:()=>q,g:()=>b,i:()=>P,j:()=>n,l:()=>ue,n:()=>v,s:()=>H,t:()=>ce});var t=h(85952);function z(i,u){return i[0]=u[0],i[1]=u[1],i[2]=u[2],i[3]=u[3],i}function H(i,u,_,O,U){return i[0]=u,i[1]=_,i[2]=O,i[3]=U,i}function q(i,u,_){return i[0]=u[0]+_[0],i[1]=u[1]+_[1],i[2]=u[2]+_[2],i[3]=u[3]+_[3],i}function oe(i,u,_){return i[0]=u[0]-_[0],i[1]=u[1]-_[1],i[2]=u[2]-_[2],i[3]=u[3]-_[3],i}function B(i,u,_){return i[0]=u[0]*_[0],i[1]=u[1]*_[1],i[2]=u[2]*_[2],i[3]=u[3]*_[3],i}function r(i,u,_){return i[0]=u[0]/_[0],i[1]=u[1]/_[1],i[2]=u[2]/_[2],i[3]=u[3]/_[3],i}function W(i,u,_){return i[0]=u[0]*_,i[1]=u[1]*_,i[2]=u[2]*_,i[3]=u[3]*_,i}function Y(i,u){const _=u[0]-i[0],O=u[1]-i[1],U=u[2]-i[2],G=u[3]-i[3];return Math.sqrt(_*_+O*O+U*U+G*G)}function c(i,u){const _=u[0]-i[0],O=u[1]-i[1],U=u[2]-i[2],G=u[3]-i[3];return _*_+O*O+U*U+G*G}function P(i){const u=i[0],_=i[1],O=i[2],U=i[3];return Math.sqrt(u*u+_*_+O*O+U*U)}function n(i){const u=i[0],_=i[1],O=i[2],U=i[3];return u*u+_*_+O*O+U*U}function v(i,u){const _=u[0],O=u[1],U=u[2],G=u[3];let N=_*_+O*O+U*U+G*G;return N>0&&(N=1/Math.sqrt(N),i[0]=_*N,i[1]=O*N,i[2]=U*N,i[3]=G*N),i}function b(i,u){return i[0]*u[0]+i[1]*u[1]+i[2]*u[2]+i[3]*u[3]}function ue(i,u,_,O){const U=u[0],G=u[1],N=u[2],p=u[3];return i[0]=U+O*(_[0]-U),i[1]=G+O*(_[1]-G),i[2]=N+O*(_[2]-N),i[3]=p+O*(_[3]-p),i}function ce(i,u,_){const O=u[0],U=u[1],G=u[2],N=u[3];return i[0]=_[0]*O+_[4]*U+_[8]*G+_[12]*N,i[1]=_[1]*O+_[5]*U+_[9]*G+_[13]*N,i[2]=_[2]*O+_[6]*U+_[10]*G+_[14]*N,i[3]=_[3]*O+_[7]*U+_[11]*G+_[15]*N,i}function S(i,u){return i[0]===u[0]&&i[1]===u[1]&&i[2]===u[2]&&i[3]===u[3]}function x(i,u){const _=i[0],O=i[1],U=i[2],G=i[3],N=u[0],p=u[1],g=u[2],E=u[3],j=(0,t.FD)();return Math.abs(_-N)<=j*Math.max(1,Math.abs(_),Math.abs(N))&&Math.abs(O-p)<=j*Math.max(1,Math.abs(O),Math.abs(p))&&Math.abs(U-g)<=j*Math.max(1,Math.abs(U),Math.abs(g))&&Math.abs(G-E)<=j*Math.max(1,Math.abs(G),Math.abs(E))}Object.freeze(Object.defineProperty({__proto__:null,add:q,ceil:function R(i,u){return i[0]=Math.ceil(u[0]),i[1]=Math.ceil(u[1]),i[2]=Math.ceil(u[2]),i[3]=Math.ceil(u[3]),i},copy:z,copyVec3:function L(i,u){return i[0]=u[0],i[1]=u[1],i[2]=u[2],i},dist:Y,distance:Y,div:r,divide:r,dot:b,equals:x,exactEquals:S,floor:function C(i,u){return i[0]=Math.floor(u[0]),i[1]=Math.floor(u[1]),i[2]=Math.floor(u[2]),i[3]=Math.floor(u[3]),i},inverse:function m(i,u){return i[0]=1/u[0],i[1]=1/u[1],i[2]=1/u[2],i[3]=1/u[3],i},len:P,length:P,lerp:ue,max:function F(i,u,_){return i[0]=Math.max(u[0],_[0]),i[1]=Math.max(u[1],_[1]),i[2]=Math.max(u[2],_[2]),i[3]=Math.max(u[3],_[3]),i},min:function $(i,u,_){return i[0]=Math.min(u[0],_[0]),i[1]=Math.min(u[1],_[1]),i[2]=Math.min(u[2],_[2]),i[3]=Math.min(u[3],_[3]),i},mul:B,multiply:B,negate:function d(i,u){return i[0]=-u[0],i[1]=-u[1],i[2]=-u[2],i[3]=-u[3],i},normalize:v,random:function Ae(i,u){const _=t.Ov;let O,U,G,N,p,g;u=u||1;do{O=2*_()-1,U=2*_()-1,p=O*O+U*U}while(p>=1);do{G=2*_()-1,N=2*_()-1,g=G*G+N*N}while(g>=1);const E=Math.sqrt((1-p)/g);return i[0]=u*O,i[1]=u*U,i[2]=u*G*E,i[3]=u*N*E,i},round:function D(i,u){return i[0]=Math.round(u[0]),i[1]=Math.round(u[1]),i[2]=Math.round(u[2]),i[3]=Math.round(u[3]),i},scale:W,scaleAndAdd:function ne(i,u,_,O){return i[0]=u[0]+_[0]*O,i[1]=u[1]+_[1]*O,i[2]=u[2]+_[2]*O,i[3]=u[3]+_[3]*O,i},set:H,sqrDist:c,sqrLen:n,squaredDistance:c,squaredLength:n,str:function M(i){return"vec4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},sub:oe,subtract:oe,transformMat4:ce,transformQuat:function w(i,u,_){const O=u[0],U=u[1],G=u[2],N=_[0],p=_[1],g=_[2],E=_[3],j=E*O+p*G-g*U,I=E*U+g*O-N*G,Z=E*G+N*U-p*O,T=-N*O-p*U-g*G;return i[0]=j*E+T*-N+I*-g-Z*-p,i[1]=I*E+T*-p+Z*-N-j*-g,i[2]=Z*E+T*-g+j*-p-I*-N,i[3]=u[3],i}},Symbol.toStringTag,{value:"Module"}))},55144:(je,de,h)=>{h.d(de,{T:()=>t,d:()=>Y});const t={Base64:0,Hex:1,String:2,Raw:3},z=8,L=(1<<z)-1;function H(c,P){const n=(65535&c)+(65535&P);return(c>>16)+(P>>16)+(n>>16)<<16|65535&n}function C(c,P,n,d,m,v){return H(function R(c,P){return c<<P|c>>>32-P}(H(H(P,c),H(d,v)),m),n)}function $(c,P,n,d,m,v,b){return C(P&n|~P&d,c,P,m,v,b)}function F(c,P,n,d,m,v,b){return C(P&d|n&~d,c,P,m,v,b)}function D(c,P,n,d,m,v,b){return C(P^n^d,c,P,m,v,b)}function W(c,P,n,d,m,v,b){return C(n^(P|~d),c,P,m,v,b)}function Y(c,P=t.Hex){const n=P||t.Base64,d=function ne(c,P){c[P>>5]|=128<<P%32,c[14+(P+64>>>9<<4)]=P;let n=1732584193,d=-271733879,m=-1732584194,v=271733878;for(let b=0;b<c.length;b+=16){const ue=n,Ae=d,ce=m,w=v;n=$(n,d,m,v,c[b],7,-680876936),v=$(v,n,d,m,c[b+1],12,-389564586),m=$(m,v,n,d,c[b+2],17,606105819),d=$(d,m,v,n,c[b+3],22,-1044525330),n=$(n,d,m,v,c[b+4],7,-176418897),v=$(v,n,d,m,c[b+5],12,1200080426),m=$(m,v,n,d,c[b+6],17,-1473231341),d=$(d,m,v,n,c[b+7],22,-45705983),n=$(n,d,m,v,c[b+8],7,1770035416),v=$(v,n,d,m,c[b+9],12,-1958414417),m=$(m,v,n,d,c[b+10],17,-42063),d=$(d,m,v,n,c[b+11],22,-1990404162),n=$(n,d,m,v,c[b+12],7,1804603682),v=$(v,n,d,m,c[b+13],12,-40341101),m=$(m,v,n,d,c[b+14],17,-1502002290),d=$(d,m,v,n,c[b+15],22,1236535329),n=F(n,d,m,v,c[b+1],5,-165796510),v=F(v,n,d,m,c[b+6],9,-1069501632),m=F(m,v,n,d,c[b+11],14,643717713),d=F(d,m,v,n,c[b],20,-373897302),n=F(n,d,m,v,c[b+5],5,-701558691),v=F(v,n,d,m,c[b+10],9,38016083),m=F(m,v,n,d,c[b+15],14,-660478335),d=F(d,m,v,n,c[b+4],20,-405537848),n=F(n,d,m,v,c[b+9],5,568446438),v=F(v,n,d,m,c[b+14],9,-1019803690),m=F(m,v,n,d,c[b+3],14,-187363961),d=F(d,m,v,n,c[b+8],20,1163531501),n=F(n,d,m,v,c[b+13],5,-1444681467),v=F(v,n,d,m,c[b+2],9,-51403784),m=F(m,v,n,d,c[b+7],14,1735328473),d=F(d,m,v,n,c[b+12],20,-1926607734),n=D(n,d,m,v,c[b+5],4,-378558),v=D(v,n,d,m,c[b+8],11,-2022574463),m=D(m,v,n,d,c[b+11],16,1839030562),d=D(d,m,v,n,c[b+14],23,-35309556),n=D(n,d,m,v,c[b+1],4,-1530992060),v=D(v,n,d,m,c[b+4],11,1272893353),m=D(m,v,n,d,c[b+7],16,-155497632),d=D(d,m,v,n,c[b+10],23,-1094730640),n=D(n,d,m,v,c[b+13],4,681279174),v=D(v,n,d,m,c[b],11,-358537222),m=D(m,v,n,d,c[b+3],16,-722521979),d=D(d,m,v,n,c[b+6],23,76029189),n=D(n,d,m,v,c[b+9],4,-640364487),v=D(v,n,d,m,c[b+12],11,-421815835),m=D(m,v,n,d,c[b+15],16,530742520),d=D(d,m,v,n,c[b+2],23,-995338651),n=W(n,d,m,v,c[b],6,-198630844),v=W(v,n,d,m,c[b+7],10,1126891415),m=W(m,v,n,d,c[b+14],15,-1416354905),d=W(d,m,v,n,c[b+5],21,-57434055),n=W(n,d,m,v,c[b+12],6,1700485571),v=W(v,n,d,m,c[b+3],10,-1894986606),m=W(m,v,n,d,c[b+10],15,-1051523),d=W(d,m,v,n,c[b+1],21,-2054922799),n=W(n,d,m,v,c[b+8],6,1873313359),v=W(v,n,d,m,c[b+15],10,-30611744),m=W(m,v,n,d,c[b+6],15,-1560198380),d=W(d,m,v,n,c[b+13],21,1309151649),n=W(n,d,m,v,c[b+4],6,-145523070),v=W(v,n,d,m,c[b+11],10,-1120210379),m=W(m,v,n,d,c[b+2],15,718787259),d=W(d,m,v,n,c[b+9],21,-343485551),n=H(n,ue),d=H(d,Ae),m=H(m,ce),v=H(v,w)}return[n,d,m,v]}(function q(c){const P=[];for(let n=0,d=c.length*z;n<d;n+=z)P[n>>5]|=(c.charCodeAt(n/z)&L)<<n%32;return P}(c),c.length*z);switch(n){case t.Raw:return d;case t.Hex:return function B(c){const P="0123456789abcdef",n=[];for(let d=0,m=4*c.length;d<m;d++)n.push(P.charAt(c[d>>2]>>d%4*8+4&15)+P.charAt(c[d>>2]>>d%4*8&15));return n.join("")}(d);case t.String:return function oe(c){const P=[];for(let n=0,d=32*c.length;n<d;n+=z)P.push(String.fromCharCode(c[n>>5]>>>n%32&L));return P.join("")}(d);case t.Base64:return function r(c){const d=[];for(let m=0,v=4*c.length;m<v;m+=3){const b=(c[m>>2]>>m%4*8&255)<<16|(c[m+1>>2]>>(m+1)%4*8&255)<<8|c[m+2>>2]>>(m+2)%4*8&255;for(let ue=0;ue<4;ue++)d.push(8*m+6*ue>32*c.length?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(b>>6*(3-ue)&63))}return d.join("")}(d)}}},32954:(je,de,h)=>{function t(){return[1,0,0,0,1,0,0,0,1]}function L(B,r,R,C,$,F,D,W,ne){return[B,r,R,C,$,F,D,W,ne]}h.d(de,{fA:()=>L,vt:()=>t,zK:()=>q});const q=[1,0,0,0,1,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:q,clone:function z(B){return[B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8]]},create:t,createView:function H(B,r){return new Float64Array(B,r,9)},fromValues:L},Symbol.toStringTag,{value:"Module"}))},14214:(je,de,h)=>{function t(){return[0,0,0,1]}function z(B){return[B[0],B[1],B[2],B[3]]}h.d(de,{o8:()=>z,vt:()=>t,zK:()=>q});const q=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:q,clone:z,create:t,createView:function H(B,r){return new Float64Array(B,r,4)},fromValues:function L(B,r,R,C){return[B,r,R,C]}},Symbol.toStringTag,{value:"Module"}))},19890:(je,de,h)=>{h.d(de,{A6:()=>d,Xd:()=>R,Xr:()=>P,hZ:()=>b,lw:()=>C,t2:()=>ae,x8:()=>r});var t=h(32954),z=h(14214),L=h(25866),H=h(85952),q=h(28714),oe=h(53781);function r(p,g,E){E*=.5;const j=Math.sin(E);return p[0]=j*g[0],p[1]=j*g[1],p[2]=j*g[2],p[3]=Math.cos(E),p}function R(p,g){const E=2*Math.acos(g[3]),j=Math.sin(E/2);return j>(0,H.FD)()?(p[0]=g[0]/j,p[1]=g[1]/j,p[2]=g[2]/j):(p[0]=1,p[1]=0,p[2]=0),E}function C(p,g,E){const j=g[0],I=g[1],Z=g[2],T=g[3],X=E[0],K=E[1],fe=E[2],ve=E[3];return p[0]=j*ve+T*X+I*fe-Z*K,p[1]=I*ve+T*K+Z*X-j*fe,p[2]=Z*ve+T*fe+j*K-I*X,p[3]=T*ve-j*X-I*K-Z*fe,p}function ne(p,g,E,j){const I=g[0],Z=g[1],T=g[2],X=g[3];let K,fe,ve,_e,ge,Te=E[0],Ie=E[1],Se=E[2],Pe=E[3];return fe=I*Te+Z*Ie+T*Se+X*Pe,fe<0&&(fe=-fe,Te=-Te,Ie=-Ie,Se=-Se,Pe=-Pe),1-fe>(0,H.FD)()?(K=Math.acos(fe),ve=Math.sin(K),_e=Math.sin((1-j)*K)/ve,ge=Math.sin(j*K)/ve):(_e=1-j,ge=j),p[0]=_e*I+ge*Te,p[1]=_e*Z+ge*Ie,p[2]=_e*T+ge*Se,p[3]=_e*X+ge*Pe,p}function P(p,g){return p[0]=-g[0],p[1]=-g[1],p[2]=-g[2],p[3]=g[3],p}function n(p,g){const E=g[0]+g[4]+g[8];let j;if(E>0)j=Math.sqrt(E+1),p[3]=.5*j,j=.5/j,p[0]=(g[5]-g[7])*j,p[1]=(g[6]-g[2])*j,p[2]=(g[1]-g[3])*j;else{let I=0;g[4]>g[0]&&(I=1),g[8]>g[3*I+I]&&(I=2);const Z=(I+1)%3,T=(I+2)%3;j=Math.sqrt(g[3*I+I]-g[3*Z+Z]-g[3*T+T]+1),p[I]=.5*j,j=.5/j,p[3]=(g[3*Z+T]-g[3*T+Z])*j,p[Z]=(g[3*Z+I]+g[3*I+Z])*j,p[T]=(g[3*T+I]+g[3*I+T])*j}return p}function d(p,g,E,j){const I=.5*Math.PI/180;g*=I,E*=I,j*=I;const Z=Math.sin(g),T=Math.cos(g),X=Math.sin(E),K=Math.cos(E),fe=Math.sin(j),ve=Math.cos(j);return p[0]=Z*K*ve-T*X*fe,p[1]=T*X*ve+Z*K*fe,p[2]=T*K*fe-Z*X*ve,p[3]=T*K*ve+Z*X*fe,p}const v=oe.c,b=oe.s,ue=oe.f,Ae=C,ce=oe.b,w=oe.g,M=oe.l,S=oe.i,x=S,J=oe.j,Q=J,le=oe.n,ae=oe.a,ie=oe.e,se=(0,L.vt)(),we=(0,L.fA)(1,0,0),i=(0,L.fA)(0,1,0),_=(0,z.vt)(),O=(0,z.vt)(),G=(0,t.vt)();Object.freeze(Object.defineProperty({__proto__:null,add:ue,calculateW:function W(p,g){const E=g[0],j=g[1],I=g[2];return p[0]=E,p[1]=j,p[2]=I,p[3]=Math.sqrt(Math.abs(1-E*E-j*j-I*I)),p},conjugate:P,copy:v,dot:w,equals:ie,exactEquals:ae,fromEuler:d,fromMat3:n,getAxisAngle:R,identity:function B(p){return p[0]=0,p[1]=0,p[2]=0,p[3]=1,p},invert:function c(p,g){const E=g[0],j=g[1],I=g[2],Z=g[3],T=E*E+j*j+I*I+Z*Z,X=T?1/T:0;return p[0]=-E*X,p[1]=-j*X,p[2]=-I*X,p[3]=Z*X,p},len:x,length:S,lerp:M,mul:Ae,multiply:C,normalize:le,random:function Y(p){const g=H.Ov,E=g(),j=g(),I=g(),Z=Math.sqrt(1-E),T=Math.sqrt(E);return p[0]=Z*Math.sin(2*Math.PI*j),p[1]=Z*Math.cos(2*Math.PI*j),p[2]=T*Math.sin(2*Math.PI*I),p[3]=T*Math.cos(2*Math.PI*I),p},rotateX:function $(p,g,E){E*=.5;const j=g[0],I=g[1],Z=g[2],T=g[3],X=Math.sin(E),K=Math.cos(E);return p[0]=j*K+T*X,p[1]=I*K+Z*X,p[2]=Z*K-I*X,p[3]=T*K-j*X,p},rotateY:function F(p,g,E){E*=.5;const j=g[0],I=g[1],Z=g[2],T=g[3],X=Math.sin(E),K=Math.cos(E);return p[0]=j*K-Z*X,p[1]=I*K+T*X,p[2]=Z*K+j*X,p[3]=T*K-I*X,p},rotateZ:function D(p,g,E){E*=.5;const j=g[0],I=g[1],Z=g[2],T=g[3],X=Math.sin(E),K=Math.cos(E);return p[0]=j*K+I*X,p[1]=I*K-j*X,p[2]=Z*K+T*X,p[3]=T*K-Z*X,p},rotationTo:function Me(p,g,E){const j=(0,q.k)(g,E);return j<-.999999?((0,q.b)(se,we,g),(0,q.H)(se)<1e-6&&(0,q.b)(se,i,g),(0,q.n)(se,se),r(p,se,Math.PI),p):j>.999999?(p[0]=0,p[1]=0,p[2]=0,p[3]=1,p):((0,q.b)(se,g,E),p[0]=se[0],p[1]=se[1],p[2]=se[2],p[3]=1+j,le(p,p))},scale:ce,set:b,setAxes:function U(p,g,E,j){const I=G;return I[0]=E[0],I[3]=E[1],I[6]=E[2],I[1]=j[0],I[4]=j[1],I[7]=j[2],I[2]=-g[0],I[5]=-g[1],I[8]=-g[2],le(p,n(p,I))},setAxisAngle:r,slerp:ne,sqlerp:function u(p,g,E,j,I,Z){return ne(_,g,I,Z),ne(O,E,j,Z),ne(p,_,O,2*Z*(1-Z)),p},sqrLen:Q,squaredLength:J,str:function m(p){return"quat("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+")"}},Symbol.toStringTag,{value:"Module"}))},24149:(je,de,h)=>{h.r(de),h.d(de,{default:()=>ct});var t=h(8189),z=h(92165),L=h(31178),H=h(5922),q=h(35150),oe=h(39693),B=h(56492),r=h(85211),R=h(55739),F=(h(40707),h(3248),h(17221)),D=h(76576),W=h(28714),ne=h(25866),Y=h(28067),c=h(95478),P=h(94376),n=h(25936),d=h(23e3),m=h(17049),v=h(85551),b=h(33036),ue=h(46406),Ae=h(68438),ce=h(81687),w=h(29141),M=h(90660),S=h(73596),x=h(71065),J=h(25968),Q=h(19890),le=h(14214),ae=h(85952);const ie=(0,ne.vt)(),Me=(0,le.vt)(),se=(0,le.vt)(),we=(0,le.vt)(),i=(0,ne.fA)(0,0,1),u=(0,ne.fA)(0,1,0),_=(0,ne.fA)(1,0,0);function O(o){(0,W.c)(ie,o),(0,W.n)(ie,ie);const y=Math.atan2(ie[1],ie[0]),f=(0,Q.x8)((0,le.vt)(),i,-y);(0,W.u)(ie,ie,f);const A=-1*Math.atan2(ie[2],ie[0]);return[(0,ae.ct)(y)+270,(0,ae.ct)(A)+90]}function U(o,y){return(0,Q.x8)(se,i,(0,ae.DF)(o-270)),(0,Q.x8)(we,u,(0,ae.DF)(y-90)),(0,Q.lw)(Me,se,we),(0,W.c)(ie,_),(0,W.u)(ie,ie,Me),(0,W.n)(ie,ie),[ie[0],ie[1],ie[2]]}var G=h(48669);let N=class extends((0,M.O)(x.oY)){constructor(o){super(o),this.enabled=!0,this.label="",this.normal=null,this.point=null}get orientation(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[o,y]=O(this.normal);return S.ie.normalize((0,R.GB)(o),0,!0)}set orientation(o){const y=U(o,this.tilt);this._set("normal",y),this._set("orientation",o)}get tilt(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[o,y]=O(this.normal);return S.ie.normalize((0,R.GB)(y),0,!0)}set tilt(o){const y=U(this.orientation,o);this._set("normal",y),this._set("tilt",o)}};(0,t._)([(0,r.MZ)({type:Boolean,json:{write:!0}})],N.prototype,"enabled",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],N.prototype,"label",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{read:!1},clonable:!1,range:{min:0,max:360}}),(0,G.w)(o=>S.ie.normalize((0,R.GB)(o),0,!0))],N.prototype,"orientation",null),(0,t._)([(0,r.MZ)({type:Number,json:{read:!1},clonable:!1,range:{min:0,max:360}}),(0,G.w)(o=>S.ie.normalize((0,R.GB)(o),0,!0))],N.prototype,"tilt",null),(0,t._)([(0,r.MZ)({type:[Number],json:{write:!0}})],N.prototype,"normal",void 0),(0,t._)([(0,r.MZ)({type:[Number],json:{write:!0}})],N.prototype,"point",void 0),N=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelSlice")],N);const p=N;var g=h(88135);let E=class extends((0,M.O)(x.oY)){constructor(){super(...arguments),this.enabled=!0,this.href=null,this.id=null,this.label="",this.normal=null,this.point=null,this.sizeInPixel=null,this.slices=null,this.timeId=0,this.variableId=null}get orientation(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[o,y]=O(this.normal);return S.ie.normalize((0,R.GB)(o),0,!0)}get tilt(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[o,y]=O(this.normal);return S.ie.normalize((0,R.GB)(y),0,!0)}};(0,t._)([(0,r.MZ)({type:Boolean,json:{default:!0,write:!0}})],E.prototype,"enabled",void 0),(0,t._)([(0,r.MZ)({type:String,json:{origins:{service:{read:g.r}},write:{enabled:!0,isRequired:!0}}}),(0,J.P)({origins:["web-scene"],type:"resource",prefix:"sections",compress:!0})],E.prototype,"href",void 0),(0,t._)([(0,r.MZ)({type:R.jz,json:{write:{enabled:!0,isRequired:!0}}})],E.prototype,"id",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],E.prototype,"label",void 0),(0,t._)([(0,r.MZ)({type:Number,clonable:!1,readOnly:!0,range:{min:0,max:360}})],E.prototype,"orientation",null),(0,t._)([(0,r.MZ)({type:Number,clonable:!1,readOnly:!0,range:{min:0,max:360}})],E.prototype,"tilt",null),(0,t._)([(0,r.MZ)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],E.prototype,"normal",void 0),(0,t._)([(0,r.MZ)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],E.prototype,"point",void 0),(0,t._)([(0,r.MZ)({type:[R.jz],json:{write:{enabled:!0,isRequired:!0}}})],E.prototype,"sizeInPixel",void 0),(0,t._)([(0,r.MZ)({type:[p],json:{write:!0}})],E.prototype,"slices",void 0),(0,t._)([(0,r.MZ)({type:R.jz,json:{default:0,write:!0}})],E.prototype,"timeId",void 0),(0,t._)([(0,r.MZ)({type:R.jz,json:{write:{enabled:!0,isRequired:!0}}})],E.prototype,"variableId",void 0),E=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelSection")],E);const j=E;let I=class extends x.oY{constructor(){super(...arguments),this.diffuseFactor=.5,this.specularFactor=.5}};(0,t._)([(0,r.MZ)({type:Number,range:{min:0,max:1},json:{default:.5,write:!0}})],I.prototype,"diffuseFactor",void 0),(0,t._)([(0,r.MZ)({type:Number,range:{min:0,max:1},json:{default:.5,write:!0}})],I.prototype,"specularFactor",void 0),I=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelSimpleShading")],I);const Z=I;let T=class extends x.oY{constructor(){super(...arguments),this.continuity=null,this.hasNoData=!1,this.noData=0,this.offset=0,this.scale=1,this.type=null}};(0,t._)([(0,r.MZ)({type:["discrete","continuous"],json:{write:!0}})],T.prototype,"continuity",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{write:!0}})],T.prototype,"hasNoData",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:!0}})],T.prototype,"noData",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:!0}})],T.prototype,"offset",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:!0}})],T.prototype,"scale",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],T.prototype,"type",void 0),T=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelFormat")],T);const X=T;let K=class extends x.oY{constructor(){super(...arguments),this.id=null,this.description="",this.name=null,this.originalFormat=null,this.renderingFormat=null,this.unit="",this.volumeId=0,this.type=null}};(0,t._)([(0,r.MZ)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],K.prototype,"id",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],K.prototype,"description",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],K.prototype,"name",void 0),(0,t._)([(0,r.MZ)({type:X,json:{write:!0}})],K.prototype,"originalFormat",void 0),(0,t._)([(0,r.MZ)({type:X,json:{write:{enabled:!0,isRequired:!0}}})],K.prototype,"renderingFormat",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],K.prototype,"unit",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:!0}})],K.prototype,"volumeId",void 0),(0,t._)([(0,r.MZ)({type:["stc-hot-spot-results","stc-cluster-outlier-results","stc-estimated-bin","generic-nearest-interpolated"],json:{write:!0}})],K.prototype,"type",void 0),K=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelVariable")],K);const fe=K;var ve=h(77806),_e=h(68677);let ge=class extends((0,M.O)(x.oY)){constructor(){super(...arguments),this.color=_e.A.fromArray([0,0,0,0]),this.value=0,this.enabled=!0,this.label="",this.colorLocked=!1}};(0,t._)([(0,r.MZ)({type:_e.A,json:{type:[R.jz],write:{enabled:!0,isRequired:!0}}})],ge.prototype,"color",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],ge.prototype,"value",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{default:!0,write:!0}})],ge.prototype,"enabled",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],ge.prototype,"label",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{default:!1,write:!0}})],ge.prototype,"colorLocked",void 0),ge=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelIsosurface")],ge);const Te=ge;var Ie=h(5605),Se=h(69287);let Pe=class extends((0,M.O)(x.oY)){constructor(){super(...arguments),this.color=null,this.position=0}};(0,t._)([(0,r.MZ)({type:_e.A,json:{type:[R.jz],write:{enabled:!0,isRequired:!0}}})],Pe.prototype,"color",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Pe.prototype,"position",void 0),Pe=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelColorStop")],Pe);const Ke=Pe;let Ce=class extends((0,M.O)(x.oY)){constructor(){super(...arguments),this.opacity=1,this.position=0}};(0,t._)([(0,r.MZ)({type:Number,json:{name:"alpha",write:{enabled:!0,isRequired:!0}}})],Ce.prototype,"opacity",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Ce.prototype,"position",void 0),Ce=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelOpacityStop")],Ce);const We=Ce;let Ue=class extends((0,M.O)(x.oY)){constructor(){super(...arguments),this.enabled=!1,this.range=null}};(0,t._)([(0,r.MZ)({type:Boolean,json:{default:!1,write:!0}})],Ue.prototype,"enabled",void 0),(0,t._)([(0,r.MZ)({type:[Number],json:{write:!0}})],Ue.prototype,"range",void 0),Ue=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelRangeFilter")],Ue);const ot=Ue;var xe,o;(o=xe||(xe={}))[o.Color=1]="Color",o[o.Alpha=2]="Alpha",o[o.Both=3]="Both";let Ve=class extends((0,M.O)(x.oY)){constructor(o){super(o),this.interpolation=null,this.stretchRange=null,this.rangeFilter=null,this._colorMapSize=256,this.colorStops=new(L.A.ofType(Ke)),this.opacityStops=new(L.A.ofType(We))}set colorStops(o){this._set("colorStops",(0,Ie.V)(o,this._get("colorStops"),L.A.ofType(Ke)))}set opacityStops(o){this._set("opacityStops",(0,Ie.V)(o,this._get("opacityStops"),L.A.ofType(We)))}getPreviousNext(o,y,f){let A=o;for(;--A>0&&y[A].type!==f&&y[A].type!==xe.Both;);let V=o;const ee=y.length;for(;++V<ee&&y[V].type!==f&&y[V].type!==xe.Both;);return[A,V]}get rasterizedTransferFunction(){const o=[];if(this.colorStops.length<2)return o;const y=[],f=[];for(const te of this.colorStops){if(!te.color)return o;f.push({color:{r:te.color.r,g:te.color.g,b:te.color.b,a:Math.round(255*(1-te.color.a))},position:te.position,type:xe.Color})}if(0===this.opacityStops.length)for(const te of f)y.push({color:te.color,position:te.position});else{for(const re of this.opacityStops){const he=(0,Se.qE)(re.position,0,1),ye=Math.round(255*(0,Se.qE)(1-re.opacity,0,1));let pe=!1;for(const me of f)if(me.type===xe.Color&&Math.abs(me.position-he)<1e-5){me.color.a=ye,me.type=xe.Both,pe=!0;break}pe||f.push({color:{r:0,g:0,b:0,a:ye},position:re.position,type:xe.Alpha})}f.sort((re,he)=>re.position<he.position?-1:1);const te=f.length;for(let re=0;re<te;++re){const he=f[re];if(he.type!==xe.Both)if(he.type===xe.Color){const[ye,pe]=this.getPreviousNext(re,f,xe.Alpha);he.color.a=-1!==ye&&pe!==te?Math.round((0,Se.Cc)(f[ye].color.a,f[pe].color.a,(he.position-f[ye].position)/(f[pe].position-f[ye].position))):-1!==ye?f[ye].color.a:f[pe].color.a}else{const[ye,pe]=this.getPreviousNext(re,f,xe.Color);if(-1!==ye&&pe!==te){const me=(he.position-f[ye].position)/(f[pe].position-f[ye].position),Be=f[ye].color,pt=f[pe].color;Fe.forEach(Qe=>{he.color[Qe]=Math.round((0,Se.Cc)(Be[Qe],pt[Qe],me))})}else Fe.forEach(-1!==ye?me=>{he.color[me]=f[ye].color[me]}:me=>{he.color[me]=f[pe].color[me]})}}for(const re of f)y.push({color:re.color,position:re.position})}y[0].position=0,y[y.length-1].position=1;let V=0,ee=1;for(let te=0;te<this._colorMapSize;++te){const re=te/this._colorMapSize;for(;re>y[ee].position;)V=ee++;const he=(re-y[V].position)/(y[ee].position-y[V].position),ye=y[V].color,pe=y[ee].color,me=new _e.A;Fe.forEach(Be=>{me[Be]=Math.round((0,Se.Cc)(ye[Be],pe[Be],he))}),me.a=(0,Se.qE)(1-(0,Se.Cc)(ye.a,pe.a,he)/255,0,1),o.push(me)}return o}getColorForContinuousDataValue(o,y){const f=this.rasterizedTransferFunction;if(this.colorStops.length<2||!Array.isArray(this.stretchRange)||this.stretchRange.length<2||f.length<256)return null;let A=this.stretchRange[0],V=this.stretchRange[1];if(A>V){const te=A;A=V,V=te}o=(0,Se.qE)(o,A,V);const ee=f[Math.round((o-A)/(V-A)*(this._colorMapSize-1))].clone();return y||(ee.a=1),ee}};(0,t._)([(0,r.MZ)({type:["linear","nearest"],json:{write:!0}})],Ve.prototype,"interpolation",void 0),(0,t._)([(0,r.MZ)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],Ve.prototype,"stretchRange",void 0),(0,t._)([(0,r.MZ)({type:L.A.ofType(Ke),json:{write:{enabled:!0,overridePolicy(){return{enabled:!!this.colorStops&&this.colorStops.length>0}}}}})],Ve.prototype,"colorStops",null),(0,t._)([(0,r.MZ)({type:L.A.ofType(We),json:{read:{source:"alphaStops"},write:{enabled:!0,target:"alphaStops",overridePolicy(){return{enabled:!!this.opacityStops&&this.opacityStops.length>0}}}}})],Ve.prototype,"opacityStops",null),(0,t._)([(0,r.MZ)({type:ot,json:{write:!0}})],Ve.prototype,"rangeFilter",void 0),(0,t._)([(0,r.MZ)({type:[_e.A],clonable:!1,json:{read:!1}})],Ve.prototype,"rasterizedTransferFunction",null),Ve=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelTransferFunctionStyle")],Ve);const it=Ve,Fe=["r","g","b"];let Le=class extends((0,M.O)(x.oY)){constructor(){super(...arguments),this.color=_e.A.fromArray([0,0,0,0]),this.value=0,this.enabled=!0,this.label=""}};(0,t._)([(0,r.MZ)({type:_e.A,json:{type:[R.jz],write:{enabled:!0,isRequired:!0}}})],Le.prototype,"color",void 0),(0,t._)([(0,r.MZ)({type:R.jz,json:{write:{enabled:!0,isRequired:!0}}})],Le.prototype,"value",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{default:!0,write:!0}})],Le.prototype,"enabled",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],Le.prototype,"label",void 0),Le=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelUniqueValue")],Le);const Xe=Le;var $e;let Re=$e=class extends x.oY{constructor(o){super(o),this.variableId=0,this.label="",this.transferFunction=null,this.uniqueValues=null,this.isosurfaces=null,this.uniqueValues=new(L.A.ofType(Xe)),this.isosurfaces=new(L.A.ofType(Te))}clone(){return new $e({variableId:this.variableId,label:this.label,transferFunction:(0,ve.o8)(this.transferFunction),uniqueValues:(0,ve.o8)(this.uniqueValues),isosurfaces:(0,ve.o8)(this.isosurfaces)})}};(0,t._)([(0,r.MZ)({type:R.jz,json:{write:{enabled:!0,isRequired:!0}}})],Re.prototype,"variableId",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],Re.prototype,"label",void 0),(0,t._)([(0,r.MZ)({type:it,json:{write:{enabled:!0,overridePolicy(){return{enabled:!this.uniqueValues||this.uniqueValues.length<1}}}}})],Re.prototype,"transferFunction",void 0),(0,t._)([(0,r.MZ)({type:L.A.ofType(Xe),json:{write:{enabled:!0,overridePolicy(){return{enabled:!!this.uniqueValues&&this.uniqueValues.length>0}}}}})],Re.prototype,"uniqueValues",void 0),(0,t._)([(0,r.MZ)({type:L.A.ofType(Te),json:{write:{enabled:!0,overridePolicy(){return{enabled:(!this.uniqueValues||this.uniqueValues.length<1)&&!!this.isosurfaces&&this.isosurfaces.length>0}}}}})],Re.prototype,"isosurfaces",void 0),Re=$e=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelVariableStyle")],Re);const qe=Re;var Ye=h(13303),ke=h(32034),rt=h(58701);let Ne=class extends x.oY{constructor(){super(...arguments),this.values=null}};(0,t._)([(0,r.MZ)({type:[Number],json:{write:!0}})],Ne.prototype,"values",void 0),Ne=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelIrregularSpacing")],Ne);const st=Ne;let ze=class extends x.oY{constructor(){super(...arguments),this.scale=1,this.offset=0}};(0,t._)([(0,r.MZ)({type:Number,json:{write:!0}})],ze.prototype,"scale",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:!0}})],ze.prototype,"offset",void 0),ze=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelRegularSpacing")],ze);const nt=ze;let be=class extends x.oY{constructor(){super(...arguments),this.irregularSpacing=null,this.isPositiveUp=!0,this.isWrappedDateLine=!1,this.label=null,this.name=null,this.quantity=null,this.regularSpacing=null,this.size=0,this.unit=null}get isRegular(){return(null==this.irregularSpacing||void 0===this.irregularSpacing)&&null!==this.regularSpacing}getRange(){var o;return this.isRegular?[this.regularSpacing.offset,this.regularSpacing.offset+this.regularSpacing.scale*(this.size-1)]:Array.isArray(null===(o=this.irregularSpacing)||void 0===o?void 0:o.values)&&this.irregularSpacing.values.length>1?[this.irregularSpacing.values[0],this.irregularSpacing.values[this.irregularSpacing.values.length-1]]:[0,0]}};(0,t._)([(0,r.MZ)({type:st,json:{write:!0}})],be.prototype,"irregularSpacing",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{write:!0}})],be.prototype,"isPositiveUp",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{write:!0}})],be.prototype,"isWrappedDateLine",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],be.prototype,"label",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],be.prototype,"name",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],be.prototype,"quantity",void 0),(0,t._)([(0,r.MZ)({type:nt,json:{write:!0}})],be.prototype,"regularSpacing",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:!0}})],be.prototype,"size",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],be.prototype,"unit",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{read:!1}})],be.prototype,"isRegular",null),be=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelDimension")],be);const lt=be;let Ee=class extends x.oY{constructor(o){super(o),this.id=0,this.dimensions=null,this.spatialReference=ke.A.WGS84}get zDimension(){if(!this.dimensions||!Array.isArray(this.dimensions)||4!==this.dimensions.length)return-1;for(let o=2;o<4;++o)if(this.dimensions[o].size>0)return o;return-1}get isValid(){return!(!this.dimensions||!Array.isArray(this.dimensions)||4!==this.dimensions.length||this.dimensions[0].size<1||this.dimensions[1].size<1||-1===this.zDimension||this.dimensions[this.zDimension].size<1)}get originInLayerSpace3D(){if(!this.isValid||"xyt"===this.volumeType)return[0,0,0];const o=this.dimensions[0].getRange(),y=this.dimensions[1].getRange(),f=this.dimensions[2],A=f.isRegular?f.getRange():[0,f.size];return[o[0],y[0],A[0]]}get voxelSizeInLayerSpaceSigned(){if(!this.isValid||"xyt"===this.volumeType)return[0,0,0];const o=this.dimensions[0].getRange(),y=this.dimensions[1].getRange(),f=this.dimensions[2],A=f.isRegular?f.getRange():[0,f.size],V=[this.sizeInVoxels[0],this.sizeInVoxels[1],this.sizeInVoxels[2]];for(let ee=0;ee<3;++ee)V[ee]<2?V[ee]=1:V[ee]-=1;return f.isRegular&&!f.isPositiveUp&&(V[2]*=-1),[(o[1]-o[0])/V[0],(y[1]-y[0])/V[1],(A[1]-A[0])/V[2]]}get volumeType(){if(this.isValid){const o=this.dimensions[2].size>0,y=this.dimensions[3].size>0;if(!o&&y)return"xyt";if(o&&y)return"xyzt"}return"xyz"}get sizeInVoxels(){return this.isValid?[this.dimensions[0].size,this.dimensions[1].size,this.dimensions[this.zDimension].size]:[0,0,0]}computeVoxelSpaceLocation(o){var y,f;if(!this.isValid)return[0,0,0];if("xyt"===this.volumeType)return q.A.getLogger(this).error("computeVoxelSpacePosition cannot be used with XYT volumes."),[0,0,0];if(!(0,rt.aI)(this.spatialReference,o.spatialReference))return q.A.getLogger(this).error("pos argument should have the same spatial reference as the VoxelLayer."),[0,0,0];const A=(0,ne.fA)(o.x,o.y,null!==(y=o.z)&&void 0!==y?y:0);(0,W.f)(A,A,this.originInLayerSpace3D),(0,W.D)(A,A,this.voxelSizeInLayerSpaceSigned);const V=this.dimensions[this.zDimension];if(!V.isRegular&&Array.isArray(null===(f=V.irregularSpacing)||void 0===f?void 0:f.values)&&V.irregularSpacing.values.length>1){var ee;const te=null!==(ee=o.z)&&void 0!==ee?ee:0,re=V.irregularSpacing.values,he=V.isPositiveUp?1:-1,ye=re.reduce((pe,me)=>Math.abs(he*me-te)<Math.abs(he*pe-te)?me:pe);for(let pe=0;pe<re.length;++pe)if(re[pe]===ye){A[2]=pe;break}}return[A[0],A[1],A[2]]}computeLayerSpaceLocation(o){var y;if(!this.isValid)return new Ye.A({x:0,y:0,spatialReference:this.spatialReference});const f=(0,ne.ci)(o);if((0,W.B)(f,f,this.voxelSizeInLayerSpaceSigned),(0,W.g)(f,f,this.originInLayerSpace3D),"xyt"===this.volumeType)return new Ye.A({x:f[0],y:f[1],spatialReference:this.spatialReference});const A=this.dimensions[this.zDimension];return A.isRegular||Array.isArray(null===(y=A.irregularSpacing)||void 0===y?void 0:y.values)&&(f[2]=o[2]<0?A.irregularSpacing.values[0]:o[2]<A.irregularSpacing.values.length?A.irregularSpacing.values[o[2]]:A.irregularSpacing.values[A.irregularSpacing.values.length-1],A.isPositiveUp||(f[2]*=-1)),new Ye.A({x:f[0],y:f[1],z:f[2],spatialReference:this.spatialReference})}};(0,t._)([(0,r.MZ)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Ee.prototype,"id",void 0),(0,t._)([(0,r.MZ)({type:[lt],json:{write:{enabled:!0,isRequired:!0}}})],Ee.prototype,"dimensions",void 0),(0,t._)([(0,r.MZ)({type:ke.A,json:{read:{enabled:!1}}})],Ee.prototype,"spatialReference",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{read:!1}})],Ee.prototype,"zDimension",null),(0,t._)([(0,r.MZ)({type:[Boolean],json:{read:!1}})],Ee.prototype,"isValid",null),(0,t._)([(0,r.MZ)({type:[Number],json:{read:!1}})],Ee.prototype,"originInLayerSpace3D",null),(0,t._)([(0,r.MZ)({type:[Number],json:{read:!1}})],Ee.prototype,"voxelSizeInLayerSpaceSigned",null),(0,t._)([(0,r.MZ)({type:["xyz","xyzt","xyt"],json:{read:{enabled:!1}}})],Ee.prototype,"volumeType",null),(0,t._)([(0,r.MZ)({type:[Number],json:{read:!1}})],Ee.prototype,"sizeInVoxels",null),Ee=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelVolume")],Ee);const et=Ee;var Ge;let Ze=Ge=class extends x.oY{constructor(){super(...arguments),this.apronWidth=1,this.brickSize=[32,32,32],this.maxLodLevel=0,this.nodeSize=[4,4,4]}isValid(){const o=new Ge;return o.apronWidth===this.apronWidth&&o.maxLodLevel===this.maxLodLevel&&!!this.brickSize&&!!this.nodeSize&&!(!Array.isArray(this.brickSize)||!Array.isArray(this.nodeSize))&&3===this.brickSize.length&&3===this.nodeSize.length&&32===this.brickSize[0]&&32===this.brickSize[1]&&32===this.brickSize[2]&&4===this.nodeSize[0]&&4===this.nodeSize[1]&&4===this.nodeSize[2]}};(0,t._)([(0,r.MZ)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Ze.prototype,"apronWidth",void 0),(0,t._)([(0,r.MZ)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],Ze.prototype,"brickSize",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Ze.prototype,"maxLodLevel",void 0),(0,t._)([(0,r.MZ)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],Ze.prototype,"nodeSize",void 0),Ze=Ge=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelVolumeIndex")],Ze);const at=Ze;let De=class extends((0,M.O)(x.oY)){constructor(o){super(o),this.enabled=!0,this.label="",this.normal=null,this.point=null}get orientation(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[o,y]=O(this.normal);return S.ie.normalize((0,R.GB)(o),0,!0)}set orientation(o){const y=U(o,this.tilt);this._set("normal",y),this._set("orientation",o)}get tilt(){if(!Array.isArray(this.normal)||3!==this.normal.length)return 0;const[o,y]=O(this.normal);return S.ie.normalize((0,R.GB)(y),0,!0)}set tilt(o){const y=U(this.orientation,o);this._set("normal",y),this._set("tilt",o)}};(0,t._)([(0,r.MZ)({type:Boolean,json:{default:!0,write:!0}})],De.prototype,"enabled",void 0),(0,t._)([(0,r.MZ)({type:String,json:{write:!0}})],De.prototype,"label",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{read:!1},clonable:!1,range:{min:0,max:360}}),(0,G.w)(o=>S.ie.normalize((0,R.GB)(o),0,!0))],De.prototype,"orientation",null),(0,t._)([(0,r.MZ)({type:Number,json:{read:!1},clonable:!1,range:{min:0,max:360}}),(0,G.w)(o=>S.ie.normalize((0,R.GB)(o),0,!0))],De.prototype,"tilt",null),(0,t._)([(0,r.MZ)({type:[Number],json:{write:!0}})],De.prototype,"normal",void 0),(0,t._)([(0,r.MZ)({type:[Number],json:{write:!0}})],De.prototype,"point",void 0),De=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelDynamicSection")],De);const He=De;var Je;let Oe=Je=class extends x.oY{constructor(o){super(o),this.volumeId=0,this.verticalExaggeration=1,this.exaggerationMode="scale-height",this.verticalOffset=0,this.slices=new(L.A.ofType(p)),this.dynamicSections=new(L.A.ofType(He))}set slices(o){this._set("slices",(0,Ie.V)(o,this._get("slices"),L.A.ofType(p)))}set dynamicSections(o){this._set("dynamicSections",(0,Ie.V)(o,this._get("dynamicSections"),L.A.ofType(He)))}clone(){return new Je({volumeId:this.volumeId,verticalExaggeration:this.verticalExaggeration,exaggerationMode:this.exaggerationMode,verticalOffset:this.verticalOffset,slices:(0,ve.o8)(this.slices),dynamicSections:(0,ve.o8)(this.dynamicSections)})}};(0,t._)([(0,r.MZ)({type:R.jz,json:{write:{enabled:!0,isRequired:!0}}})],Oe.prototype,"volumeId",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{default:1,write:!0}})],Oe.prototype,"verticalExaggeration",void 0),(0,t._)([(0,r.MZ)({type:["scale-position","scale-height"],json:{default:"scale-height",write:!0}})],Oe.prototype,"exaggerationMode",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{default:0,write:!0}})],Oe.prototype,"verticalOffset",void 0),(0,t._)([(0,r.MZ)({type:L.A.ofType(p),json:{write:{enabled:!0,overridePolicy(){return{enabled:!!this.slices&&this.slices.length>0}}}}})],Oe.prototype,"slices",null),(0,t._)([(0,r.MZ)({type:L.A.ofType(He),json:{write:{enabled:!0,overridePolicy(){return{enabled:!!this.dynamicSections&&this.dynamicSections.length>0}}}}})],Oe.prototype,"dynamicSections",null),Oe=Je=(0,t._)([(0,D.$)("esri.layers.voxel.VoxelVolumeStyle")],Oe);const tt=Oe;var ut=h(41843);let k=class extends((0,ue.w6)((0,n.b)((0,m.q)((0,v.A)((0,b.j)((0,oe.P)((0,d.d)((0,P.p)(c.A))))))))){constructor(o){super(o),this.serviceRoot="",this.operationalLayerType="Voxel",this.legendEnabled=!0,this.title=null,this.sections=null,this.currentVariableId=0,this.volumeStyles=null,this.renderMode="volume",this.variableStyles=null,this.enableSlices=!0,this.enableSections=!0,this.enableDynamicSections=!0,this.enableIsosurfaces=!0,this.shading=new Z,this.opacity=1,this.variables=new L.A,this.volumes=new L.A,this.index=null,this.minScale=0,this.maxScale=0,this.type="voxel",this.version={major:Number.NaN,minor:Number.NaN,versionString:""},this.fullExtent=null,this.popupEnabled=!1,this.test=null,this.volumeStyles=new(L.A.ofType(tt)),this.variableStyles=new(L.A.ofType(qe)),this.sections=new(L.A.ofType(j))}normalizeCtorArgs(o){return null!=o&&o.constantUpscaling&&(this.test={constantUpscaling:!0},delete o.constantUpscaling),o}set url(o){this._set("url",(0,Ae.Jf)(o,q.A.getLogger(this)))}load(o){const y=null!=o?o.signal:null,f=this.loadFromPortal({supportedTypes:["Scene Service"]},o).catch(B.QP).then(()=>this._fetchService(y)).then(()=>this.serviceRoot=this.url);return this.addResolvingPromise(f),Promise.resolve(this)}read(o,y){super.read(o,y);for(const f of this.volumes)f.spatialReference=this.spatialReference}readVersion(o,y){return super.parseVersionString(o)}validateLayer(o){if(o.layerType&&o.layerType!==this.operationalLayerType)throw new H.A("voxel-layer:layer-type-not-supported","VoxelLayer does not support this layer type",{layerType:o.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor)||this.version.major<3)throw new H.A("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"3.x"});if(this.version.major>3)throw new H.A("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"3.x"})}readFullExtent(o,y,f){if(null!=o&&"object"==typeof o){const A=Y.A.fromJSON(o,f);if(0===A.zmin&&0===A.zmax&&Array.isArray(y.volumes)){const V=et.fromJSON(y.volumes[0]);if(V.isValid&&"xyt"!==V.volumeType){const ee=V.dimensions[2];if(ee.isRegular){let te=ee.regularSpacing.offset,re=ee.regularSpacing.offset+ee.regularSpacing.scale*(ee.size-1);if(te>re){const he=te;te=re,re=he}A.zmin=te,A.zmax=re}}}return A}return null}get voxelFields(){const o=[new w.A({name:"Voxel.ServiceValue",alias:"Value",domain:null,editable:!1,length:128,type:"string"}),new w.A({name:"Voxel.ServiceVariableLabel",alias:"Variable",domain:null,editable:!1,length:128,type:"string"}),new w.A({name:"Voxel.Position",alias:"Voxel Position",domain:null,editable:!1,length:128,type:"string"})],y=this.getVolume(null);if(null!=y){if("xyzt"===y.volumeType||"xyt"===y.volumeType){const f=new w.A({name:"Voxel.ServiceLocalTime",alias:"Local Time",domain:null,editable:!1,length:128,type:"string"});o.push(f);const A=new w.A({name:"Voxel.ServiceNativeTime",alias:"Native Time",domain:null,editable:!1,length:128,type:"string"});o.push(A)}if("xyt"!==y.volumeType){const f=new w.A({name:"Voxel.ServiceDepth",alias:"Depth",domain:null,editable:!1,length:128,type:"string"});o.push(f)}}return o}get popupTemplate(){return this.loaded?this.createPopupTemplate():null}get defaultPopupTemplate(){return this.createPopupTemplate()}createPopupTemplate(o){return(0,ut.tn)({fields:this.voxelFields,title:this.title},o)}getConfiguration(){var o,y;const f={layerType:this.operationalLayerType,version:this.version.versionString,name:this.title,spatialReference:this.spatialReference,fullExtent:this.fullExtent,volumes:this.volumes.toJSON(),variables:this.variables.toJSON(),index:null===(o=this.index)||void 0===o?void 0:o.toJSON(),sections:this.getSections(),style:{volumeStyles:this.getVolumeStyles(),currentVariableId:this.currentVariableId,renderMode:this.renderMode,variableStyles:this.getVariableStyles(),enableSections:this.enableSections,enableDynamicSections:this.enableDynamicSections,enableIsosurfaces:this.enableIsosurfaces,enableSlices:this.enableSlices,shading:this.shading}};return f.index&&null!==(y=this.index)&&void 0!==y&&y.isValid()?JSON.stringify(f):""}getVariableStyle(o){let y=-1;if(y=null!=o?o:this.currentVariableId,!this.variableStyles||-1===y)return null;const f=this.variableStyles.findIndex(A=>A.variableId===y);return f<0?null:this.variableStyles.at(f)}getVariable(o){let y=-1;if(y=null!=o?o:this.currentVariableId,!this.variables||-1===y)return null;const f=this.variables.findIndex(A=>A.id===y);return f<0?null:this.variables.at(f)}getVolume(o){const y=this.getVariable(o);return null!=y?this.volumes.find(({id:f})=>f===y.volumeId):null}getVolumeStyle(o){const y=this.getVariable(o);return null!=y?this.volumeStyles.find(({volumeId:f})=>f===y.volumeId):null}getColorForContinuousDataValue(o,y,f){var A;const V=this.getVariable(o);if(null==V||"continuous"!==(null===(A=V.renderingFormat)||void 0===A?void 0:A.continuity)||!this.variableStyles)return null;const ee=this.variableStyles.findIndex(re=>re.variableId===o);if(ee<0)return null;const te=this.variableStyles.at(ee);return null!=te&&te.transferFunction?te.transferFunction.getColorForContinuousDataValue(y,f):null}getSections(){const o=[];for(const y of this.sections)o.push(new j({enabled:y.enabled,href:y.href,id:y.id,label:y.label,normal:y.normal,point:y.point,sizeInPixel:y.sizeInPixel,slices:y.slices,timeId:y.timeId,variableId:y.variableId}));return o}getVariableStyles(){const o=[];for(const y of this.variableStyles){const f=this._getVariable(y);if(null!=f){const A=y.clone();A.isosurfaces.length>4&&(A.isosurfaces=A.isosurfaces.slice(0,3),q.A.getLogger(this).error("A maximum of 4 isosurfaces are supported for Voxel Layers."));for(const V of A.isosurfaces)if(!V.colorLocked){const ee=this.getColorForContinuousDataValue(A.variableId,V.value,!1);null===ee||ee.equals(V.color)||(V.color=ee)}if("continuous"===f.renderingFormat.continuity)(null===A.transferFunction||A.transferFunction.colorStops.length<2)&&q.A.getLogger(this).error(`VoxelVariableStyle for variable ${f.id} is invalid. At least 2 color stops are required in the transferFunction for continuous Voxel Layer variables.`),null!==A.transferFunction&&(Array.isArray(A.transferFunction.stretchRange)&&2===A.transferFunction.stretchRange.length||(q.A.getLogger(this).error(`VoxelVariableStyle for variable ${f.id} is invalid. The stretchRange of the transferFunction for continuous Voxel Layer variables must be of the form [minimumDataValue, maximumDataValue].`),A.transferFunction.stretchRange=[0,1],A.transferFunction.colorStops.removeAll()));else if("discrete"===f.renderingFormat.continuity)if(0===y.uniqueValues.length)q.A.getLogger(this).error(`VoxelVariableStyle for variable ${f.id} is invalid. Unique values are required for discrete Voxel Layer variables.`);else for(const V of y.uniqueValues)null!=V.label||null==V.value||(V.label=V.value.toString());o.push(A)}else q.A.getLogger(this).error(`VoxelVariable ID=${y.variableId} doesn't exist, VoxelVariableStyle for this VoxelVariable will be ignored.`)}return o}getVolumeStyles(){const o=[];for(const y of this.volumeStyles){const f=this._getVolumeFromVolumeId(y.volumeId);if(null!=f){const A=y.clone();for(const V of A.slices)this._isPlaneValid(V,[0,1,f.zDimension],f.dimensions)||(V.enabled=!1,V.label="invalid");for(const V of A.dynamicSections)this._isPlaneValid(V,[0,1,f.zDimension],f.dimensions)||(V.enabled=!1,V.label="invalid");o.push(A)}else q.A.getLogger(this).error(`VoxelVolume ID=${y.volumeId} doesn't exist, VoxelVolumeStyle for this VoxelVolume will be ignored.`)}return o}_getVariable(o){const y=o.variableId;for(const f of this.variables)if(f.id===y)return f;return null}_getVolumeFromVolumeId(o){for(const y of this.volumes)if(y.id===o)return y;return null}_isPlaneValid(o,y,f){if(!(o.point&&Array.isArray(o.point)&&3===o.point.length&&o.normal&&Array.isArray(o.normal)&&3===o.normal.length))return!1;const A=(0,ne.fA)(o.normal[0],o.normal[1],o.normal[2]);return(0,W.n)(A,A),!(Math.abs(A[0])+Math.abs(A[1])+Math.abs(A[2])<1e-6||(o.normal[0]=A[0],o.normal[1]=A[1],o.normal[2]=A[2],0))}};(0,t._)([(0,r.MZ)({type:["Voxel"]})],k.prototype,"operationalLayerType",void 0),(0,t._)([(0,r.MZ)(ce.fV)],k.prototype,"legendEnabled",void 0),(0,t._)([(0,r.MZ)({json:{write:!0}})],k.prototype,"title",void 0),(0,t._)([(0,r.MZ)(ce.OZ)],k.prototype,"url",null),(0,t._)([(0,r.MZ)({type:L.A.ofType(j),json:{origins:{"web-scene":{name:"layerDefinition.sections",write:!0}}}})],k.prototype,"sections",void 0),(0,t._)([(0,r.MZ)({type:R.jz,json:{origins:{"web-scene":{name:"layerDefinition.style.currentVariableId",write:{enabled:!0,isRequired:!0,ignoreOrigin:!0}},service:{name:"style.currentVariableId"}}}})],k.prototype,"currentVariableId",void 0),(0,t._)([(0,r.MZ)({type:L.A.ofType(tt),json:{origins:{"web-scene":{name:"layerDefinition.style.volumeStyles",write:!0},service:{name:"style.volumeStyles"}}}})],k.prototype,"volumeStyles",void 0),(0,t._)([(0,r.MZ)({type:["volume","surfaces"],json:{origins:{"web-scene":{name:"layerDefinition.style.renderMode",write:!0},service:{name:"style.renderMode"}}}})],k.prototype,"renderMode",void 0),(0,t._)([(0,r.MZ)({type:L.A.ofType(qe),json:{origins:{"web-scene":{name:"layerDefinition.style.variableStyles",write:!0},service:{name:"style.variableStyles"}}}})],k.prototype,"variableStyles",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{origins:{"web-scene":{name:"layerDefinition.style.enableSlices",write:!0},service:{name:"style.enableSlices"}}}})],k.prototype,"enableSlices",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{origins:{"web-scene":{name:"layerDefinition.style.enableSections",write:!0},service:{name:"style.enableSections"}}}})],k.prototype,"enableSections",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{origins:{"web-scene":{name:"layerDefinition.style.enableDynamicSections",write:!0},service:{name:"style.enableDynamicSections"}}}})],k.prototype,"enableDynamicSections",void 0),(0,t._)([(0,r.MZ)({type:Boolean,json:{origins:{"web-scene":{name:"layerDefinition.style.enableIsosurfaces",write:!0},service:{name:"style.enableIsosurfaces"}}}})],k.prototype,"enableIsosurfaces",void 0),(0,t._)([(0,r.MZ)({type:Z,json:{origins:{"web-scene":{name:"layerDefinition.style.shading",write:!0},service:{name:"style.shading"}}}})],k.prototype,"shading",void 0),(0,t._)([(0,r.MZ)({type:["show","hide"]})],k.prototype,"listMode",void 0),(0,t._)([(0,r.MZ)({type:Number,range:{min:0,max:1},nonNullable:!0,json:{read:!1,write:!1,origins:{"web-scene":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],k.prototype,"opacity",void 0),(0,t._)([(0,r.MZ)({type:L.A.ofType(fe)})],k.prototype,"variables",void 0),(0,t._)([(0,r.MZ)({type:L.A.ofType(et)})],k.prototype,"volumes",void 0),(0,t._)([(0,r.MZ)({type:at})],k.prototype,"index",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:!1,write:!1}}}})],k.prototype,"minScale",void 0),(0,t._)([(0,r.MZ)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:!1,write:!1}}}})],k.prototype,"maxScale",void 0),(0,t._)([(0,r.MZ)({json:{read:!1},readOnly:!0})],k.prototype,"type",void 0),(0,t._)([(0,r.MZ)({readOnly:!0,json:{name:"serviceVersion"}})],k.prototype,"version",void 0),(0,t._)([(0,F.w)("service","version")],k.prototype,"readVersion",null),(0,t._)([(0,r.MZ)({type:Y.A})],k.prototype,"fullExtent",void 0),(0,t._)([(0,F.w)("service","fullExtent",["fullExtent"])],k.prototype,"readFullExtent",null),(0,t._)([(0,r.MZ)({readOnly:!0,clonable:!1,json:{read:!1}})],k.prototype,"voxelFields",null),(0,t._)([(0,r.MZ)({type:Boolean,json:{name:"disablePopup",read:{reader:(o,y)=>!y.disablePopup},write:{enabled:!0,ignoreOrigin:!0,writer(o,y,f){y[f]=!o}},origins:{"portal-item":{default:!0},"web-scene":{default:!0}}}})],k.prototype,"popupEnabled",void 0),(0,t._)([(0,r.MZ)({type:z.A,json:{read:!1}})],k.prototype,"popupTemplate",null),(0,t._)([(0,r.MZ)({readOnly:!0})],k.prototype,"defaultPopupTemplate",null),k=(0,t._)([(0,D.$)("esri.layers.VoxelLayer")],k);const ct=k},23e3:(je,de,h)=>{h.d(de,{d:()=>B});var t=h(8189),z=h(85211),oe=(h(3248),h(35150),h(40707),h(76576));const B=r=>{let R=class extends r{constructor(){super(...arguments),this.customParameters=null}};return(0,t._)([(0,z.MZ)({type:Object,json:{write:{overridePolicy:C=>({enabled:!!(C&&Object.keys(C).length>0)})}}})],R.prototype,"customParameters",void 0),R=(0,t._)([(0,oe.$)("esri.layers.mixins.CustomParametersMixin")],R),R}},85551:(je,de,h)=>{h.d(de,{A:()=>b});var t=h(10467),z=h(8189),L=h(23098),H=h(77469),q=h(89563),oe=h(89447),B=h(5922),r=h(35150),R=h(11432),C=h(56492),$=h(45272),F=h(85211),ne=(h(3248),h(40707),h(17221)),Y=h(76576),c=h(50305),P=h(58443),n=h(73874),d=h(46577),m=h(52606),v=h(69927);const b=Ae=>{let ce=class extends Ae{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,R.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(w){w!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",w))}readPortalItem(w,M,S){if(M.itemId)return new d.default({id:M.itemId,portal:null==S?void 0:S.portal})}writePortalItem(w,M){null!=w&&w.id&&(M.itemId=w.id)}loadFromPortal(w,M){var S=this;return(0,t.A)(function*(){var x;if(null!==(x=S.portalItem)&&void 0!==x&&x.id)try{const{load:J}=yield Promise.all([h.e(5565),h.e(2076),h.e(6180)]).then(h.bind(h,56180));return(0,C.Te)(M),yield J({instance:S,supportedTypes:w.supportedTypes,validateItem:w.validateItem,supportsData:w.supportsData,layerModuleTypeMap:w.layerModuleTypeMap},M)}catch(J){throw(0,C.zf)(J)||r.A.getLogger(S).warn(`Failed to load layer (${S.title}, ${S.id}) portal item (${S.portalItem.id})\n  ${J}`),J}})()}finishLoadEditablePortalLayer(w){var M=this;return(0,t.A)(function*(){M._set("userHasEditingPrivileges",yield M._fetchUserHasEditingPrivileges(w).catch(S=>((0,C.QP)(S),!0)))})()}setUserPrivileges(w,M){var S=this;return(0,t.A)(function*(){if(!L.A.userPrivilegesApplied)return S.finishLoadEditablePortalLayer(M);if(S.url)try{const{features:{edit:x,fullEdit:J},content:{updateItem:Q}}=yield S._fetchUserPrivileges(w,M);S._set("userHasEditingPrivileges",x),S._set("userHasFullEditingPrivileges",J),S._set("userHasUpdateItemPrivileges",Q)}catch(x){(0,C.QP)(x)}})()}_fetchUserPrivileges(w,M){var S=this;return(0,t.A)(function*(){let x=S.portalItem;if(!w||!x||!x.loaded||x.sourceUrl)return S._fetchFallbackUserPrivileges(M);const J=w===x.id;if(J&&x.portal.user)return(0,v.It)(x);let Q,le;if(J)Q=x.portal.url;else try{Q=yield(0,P.wI)(S.url,M)}catch(se){(0,C.QP)(se)}if(!Q||!(0,$.b8)(Q,x.portal.url))return S._fetchFallbackUserPrivileges(M);try{const se=null!=M?M.signal:null;le=yield null==H.id?void 0:H.id.getCredential(`${Q}/sharing`,{prompt:!1,signal:se})}catch(se){(0,C.QP)(se)}if(!le)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(J?yield x.reload():(x=new d.default({id:w,portal:{url:Q}}),yield x.load(M)),x.portal.user)return(0,v.It)(x)}catch(se){(0,C.QP)(se)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_fetchFallbackUserPrivileges(w){var M=this;return(0,t.A)(function*(){let S=!0;try{S=yield M._fetchUserHasEditingPrivileges(w)}catch(x){(0,C.QP)(x)}return{features:{edit:S,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(w){var M=this;return(0,t.A)(function*(){const S=M.url?null==H.id?void 0:H.id.findCredential(M.url):null;if(!S)return!0;const x=ue.credential===S?ue.user:yield M._fetchEditingUser(w);return ue.credential=S,ue.user=x,null==(null==x?void 0:x.privileges)||x.privileges.includes("features:user:edit")})()}_fetchEditingUser(w){var M=this;return(0,t.A)(function*(){var S,x;const J=null===(S=M.portalItem)||void 0===S||null===(S=S.portal)||void 0===S?void 0:S.user;if(J)return J;const Q=H.id.findServerInfo(null!==(x=M.url)&&void 0!==x?x:"");if(null==Q||!Q.owningSystemUrl)return null;const le=`${Q.owningSystemUrl}/sharing/rest`,ae=n.A.getDefault();if(ae&&ae.loaded&&(0,$.S8)(ae.restUrl)===(0,$.S8)(le))return ae.user;const ie=`${le}/community/self`,Me=null!=w?w.signal:null,se=yield(0,oe.Ke)((0,q.A)(ie,{authMode:"no-prompt",query:{f:"json"},signal:Me}));return se.ok?m.A.fromJSON(se.value.data):null})()}read(w,M){M&&(M.layer=this),super.read(w,M)}write(w,M){var S;const x=null==M?void 0:M.portal,J=(null===(S=this.portalItem)||void 0===S?void 0:S.id)&&(this.portalItem.portal||n.A.getDefault());return x&&J&&!(0,$.ut)(J.restUrl,x.restUrl)?(M.messages&&M.messages.push(new B.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(w,{...M,layer:this})}};return(0,z._)([(0,F.MZ)({type:d.default})],ce.prototype,"portalItem",null),(0,z._)([(0,ne.w)("web-document","portalItem",["itemId"])],ce.prototype,"readPortalItem",null),(0,z._)([(0,c.K)("web-document","portalItem",{itemId:{type:String}})],ce.prototype,"writePortalItem",null),(0,z._)([(0,F.MZ)({clonable:!1})],ce.prototype,"resourceReferences",void 0),(0,z._)([(0,F.MZ)({type:Boolean,readOnly:!0})],ce.prototype,"userHasEditingPrivileges",void 0),(0,z._)([(0,F.MZ)({type:Boolean,readOnly:!0})],ce.prototype,"userHasFullEditingPrivileges",void 0),(0,z._)([(0,F.MZ)({type:Boolean,readOnly:!0})],ce.prototype,"userHasUpdateItemPrivileges",void 0),ce=(0,z._)([(0,Y.$)("esri.layers.mixins.PortalLayer")],ce),ce},ue={credential:null,user:null}},33036:(je,de,h)=>{h.d(de,{j:()=>B});var t=h(8189),z=h(85211),oe=(h(3248),h(35150),h(40707),h(76576));const B=R=>{let C=class extends R{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const $={minScale:this.minScale,maxScale:this.maxScale},F=this.parent;F&&"effectiveScaleRange"in F&&function r(R,C){R.minScale=R.minScale>0?C.minScale>0?Math.min(R.minScale,C.minScale):R.minScale:C.minScale,R.maxScale=R.maxScale>0?C.maxScale>0?Math.max(R.maxScale,C.maxScale):R.maxScale:C.maxScale}($,F.effectiveScaleRange);const D=this._get("effectiveScaleRange");return D&&D.minScale===$.minScale&&D.maxScale===$.maxScale?D:$}};return(0,t._)([(0,z.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],C.prototype,"minScale",void 0),(0,t._)([(0,z.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],C.prototype,"maxScale",void 0),(0,t._)([(0,z.MZ)({readOnly:!0})],C.prototype,"effectiveScaleRange",null),C=(0,t._)([(0,oe.$)("esri.layers.mixins.ScaleRangeLayer")],C),C}},69927:(je,de,h)=>{h.d(de,{It:()=>ne,LG:()=>B,OM:()=>C,Sm:()=>$,Y:()=>r,bK:()=>R,mm:()=>W,sQ:()=>F});var t=h(10467),z=h(11817),L=h(32034),H=h(55039);function oe(){return(oe=(0,t.A)(function*(Y){const c=Y.spatialReference;if(c.isWGS84)return Y.clone();if(c.isWebMercator)return(0,H.ci)(Y);const P=L.A.WGS84;return yield(0,z.initializeProjection)(c,P),(0,z.project)(Y,P)})).apply(this,arguments)}function B(Y,c){if(!r(Y,c)){const P=Y.typeKeywords;P?P.push(c):Y.typeKeywords=[c]}}function r(Y,c){var P;return!(null===(P=Y.typeKeywords)||void 0===P||!P.includes(c))}function R(Y){return r(Y,W.HOSTED_SERVICE)}function C(Y,c){const P=Y.typeKeywords;if(P){const n=P.indexOf(c);n>-1&&P.splice(n,1)}}function $(Y,c,P){P?B(Y,c):C(Y,c)}function F(Y){return D.apply(this,arguments)}function D(){return D=(0,t.A)(function*(Y){const c=Y.clone().normalize();let P;if(c.length>1)for(const n of c)P?n.width>P.width&&(P=n):P=n;else P=c[0];return function q(Y){return oe.apply(this,arguments)}(P)}),D.apply(this,arguments)}const W={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function ne(Y){var c;const{portal:P,isOrgItem:n,itemControl:d}=Y,m=null===(c=P.user)||void 0===c?void 0:c.privileges;let v=!m||m.includes("features:user:edit"),b=!!n&&!(null==m||!m.includes("features:user:fullEdit"));const ue="update"===d||"admin"===d;return ue?b=v=!0:b&&(v=!0),{features:{edit:v,fullEdit:b},content:{updateItem:ue}}}},41843:(je,de,h)=>{h.d(de,{tn:()=>D});var t=h(92165),z=h(86300),L=h(54042),B=(h(75432),h(65121),h(558),h(8975)),$=(h(90792),h(83902),h(98089),h(61099)),F=h(17580);function D({displayField:M,editFieldsInfo:S,fields:x,objectIdField:J,title:Q},le){if(!x)return null;const ae=function n(M,S){var x;const J=null==S?void 0:S.visibleFieldNames;return function Y(M,S){const x=M;return S&&(M=M.filter(J=>!S.includes(J.type))),M===x&&(M=M.slice()),M.sort(c),M}(null!==(x=M.fields)&&void 0!==x?x:[],(null==S?void 0:S.ignoreFieldTypes)||w).map(Q=>new $.A({fieldName:Q.name,isEditable:(0,z.R$)(Q,M),label:Q.alias,format:v(Q),visible:ne(Q,{...M,visibleFieldNames:J})}))}({editFieldsInfo:S,fields:x,objectIdField:J},le);if(!ae.length)return null;const ie=function Ae(M){const S=(0,z.mB)(M),{titleBase:x}=M;return S?`${x}: {${S.trim()}}`:null!=x?x:""}({titleBase:Q,fields:x,displayField:M}),Me=function b(){return[new B.A,new L.A]}();return new t.A({title:ie,content:Me,fieldInfos:ae})}const ne=(M,S)=>S.visibleFieldNames?S.visibleFieldNames.has(M.name):(0,z.Bz)(M,S);function c(M,S){return"oid"===M.type?-1:"oid"===S.type?1:ce(M)?-1:ce(S)?1:(M.alias||M.name).toLocaleLowerCase().localeCompare((S.alias||S.name).toLocaleLowerCase())}function v(M){switch(M.type){case"small-integer":case"integer":case"single":return new F.A({digitSeparator:!0,places:0});case"double":return new F.A({digitSeparator:!0,places:2});case"string":return(0,z.JL)(M.name)?new F.A({digitSeparator:!0,places:0}):null;default:return null}}function ce(M){return"name"===(M.name&&M.name.toLowerCase())||"name"===(M.alias&&M.alias.toLowerCase())}const w=["geometry","blob","raster","guid","xml"]}}]);